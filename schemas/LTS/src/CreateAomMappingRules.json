{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"AomMappingLogStreamInfo":{"properties":{"target_log_group_id":{"description":"日志组id","maxLength":36,"minLength":36,"type":"string"},"target_log_group_name":{"description":"目标日志组名称。","maxLength":64,"minLength":1,"type":"string"},"target_log_stream_id":{"description":"日志流id","maxLength":36,"minLength":36,"type":"string"},"target_log_stream_name":{"description":"目标日志组名称。","maxLength":64,"minLength":1,"type":"string"}},"required":["target_log_group_id","target_log_group_name","target_log_stream_id","target_log_stream_name"],"title":"AomMappingLogStreamInfo","type":"object"},"AomMappingRequestInfo":{"properties":{"project_id":{"description":"项目id","maxLength":32,"minLength":32,"type":"string"},"rule_id":{"description":"接入规则id","maxLength":100,"minLength":1,"type":"string"},"rule_info":{"$ref":"#/definitions/AomMappingRuleInfo","description":"接入规则详情","type":"object"},"rule_name":{"description":"接入规则名称","maxLength":64,"minLength":1,"type":"string"}},"required":["project_id","rule_name","rule_info"],"title":"AomMappingRequestInfo","type":"object"},"AomMappingRuleInfo":{"properties":{"cluster_id":{"description":"集群id","maxLength":36,"minLength":36,"type":"string"},"cluster_name":{"description":"集群名称","maxLength":10000,"minLength":1,"type":"string"},"container_name":{"description":"容器名称","maxLength":10000,"minLength":1,"type":"string"},"deployments":{"description":"工作负载","items":{"type":"string"},"maxItems":10000,"minItems":1,"type":"array"},"deployments_prefix":{"description":"日志流前缀","maxLength":64,"minLength":0,"type":"string"},"files":{"description":"接入规则详情","items":{"$ref":"#/definitions/AomMappingfilesInfo"},"maxItems":200,"minItems":1,"type":"array"},"namespace":{"description":"命名空间","maxLength":10000,"minLength":1,"type":"string"}},"required":["cluster_id","cluster_name","deployments","namespace","files"],"title":"AomMappingRuleInfo","type":"object"},"AomMappingRuleResp":{"properties":{"project_id":{"description":"项目id","maxLength":32,"minLength":32,"type":"string"},"rule_id":{"description":"接入规则id","maxLength":36,"minLength":36,"type":"string"},"rule_info":{"$ref":"#/definitions/AomMappingRuleInfo","description":"接入规则详情","type":"object"},"rule_name":{"description":"接入规则名称","maxLength":64,"minLength":1,"type":"string"}},"required":["project_id","rule_name","rule_info","rule_id"],"title":"AomMappingRuleResp","type":"object"},"AomMappingfilesInfo":{"properties":{"file_name":{"description":"路径名","pattern":"^\\/[A-Za-z0-9.*_\\/-]+|stdout\\.log|","type":"string"},"log_stream_info":{"$ref":"#/definitions/AomMappingLogStreamInfo","description":"接入规则详情","type":"object"}},"required":["file_name","log_stream_info"],"title":"AomMappingfilesInfo","type":"object"},"ErrorResultInfo":{"description":"调用失败时的返回值。","properties":{"error_code":{"description":"错误码。","enum":["LTS.0403"],"type":"string"},"error_msg":{"description":"调用失败响应信息描述。","enum":["Invalid projectId"],"type":"string"}},"type":"object"}},"description":null,"group_id":"8f58e31c452f407885dec582b8542111","host":"lts.cn-north-4.myhuaweicloud.com","id":"823d2cfff78649169e516a756c924894","info_version":"v2","method":"post","name":"CreateAomMappingRules","parameters":{},"paths":{"/v2/{project_id}/lts/aom-mapping":{"post":{"consumes":["application/json"],"description":"该接口用于创建aom日志接入lts规则","operationId":"CreateAomMappingRules","parameters":[{"description":"接入规则详情","in":"body","name":"CreateAomMappingRulesRequestBody","required":true,"schema":{"$ref":"#/definitions/AomMappingRequestInfo"}},{"default":false,"description":"是否开启自动映射","in":"query","name":"isBatch","required":true,"type":"boolean"},{"default":"None","description":"项目ID","in":"path","maxLength":32,"minLength":32,"name":"project_id","pattern":"project_id","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"}],"produces":["application/json"],"responses":{"200":{"description":"请求响应成功。","schema":{"items":{"$ref":"#/definitions/AomMappingRuleResp"},"type":"array"}},"400":{"description":"BadRequest。非法请求。 建议根据error_msg直接修改该请求,不要重试该请求。","examples":{"application/json":{"applications/json":{"error_code":"LTS.0742","error_msg":"AOM mapping rule log group id does not exsit"}}},"schema":{"$ref":"#/definitions/ErrorResultInfo"}},"401":{"description":"AuthFailed。鉴权失败, 请确认token后再次请求 。","examples":{"application/json":{"applications/json":{"error_code":"LTS.0414","error_msg":"Invalid token"}}},"schema":{"$ref":"#/definitions/ErrorResultInfo"}},"403":{"description":"Forbidden。\n请求被拒绝访问。\n返回该状态码,表明请求能够到达服务端,且服务端能够理解用户请求,但是拒绝做更多的事情,因为该请求被设置为拒绝访问,建议直接修改该请求,不要重试该请求。","examples":{"application/json":{"applications/json":{"error_code":"LTS.0003","error_msg":"parse_token_failed"}}},"schema":{"$ref":"#/definitions/ErrorResultInfo"}},"500":{"description":"InternalServerError。\n表明服务端能被请求访问到,但是服务内部出错。","examples":{"application/json":{"applications/json":{"error_code":"LTS.0202","error_msg":"Failed to query lts struct log"}}},"schema":{"$ref":"#/definitions/ErrorResultInfo"}},"503":{"description":"ServiceUnavailable。\n被请求的服务无效,服务不可用。","schema":{"type":"string"}}},"summary":"创建接入规则","tags":["AOM容器日志接入LTS"],"x-is-registered":"Y","x-publishpath":"lts_api_0052","x-request-examples-1":"/v2/{project_id}/lts/aom-mapping?isBatch=false\n{\n  \"rule_name\": \"abcde\",\n  \"project_id\": \"2a473356cca5487f8373be891bffc1cf\",\n  \"rule_info\": {\n    \"cluster_id\": \"4fae3587-0202-11eb-9ba9-0255ac100b02\",\n    \"cluster_name\": \"testdiskrate\",\n    \"deployments_prefix\":\"deployments_prefix\",\n    \"deployments\": [\n      \"__ALL_DEPLOYMENTS__\"\n    ],\n    \"namespace\": \"default\",\n    \"container_name\": \"container-0\",\n    \"files\": [\n    {\n      \"file_name\": \"__ALL_FILES__\",\n      \"log_stream_info\": {\n        \"target_log_group_id\": \"8c9dcda6-d048-43a7-989b-c76c34b0ac85\",\n        \"target_log_group_name\": \"lts-group-wb28\",\n        \"target_log_stream_id\": \"2c228bd1-cbf1-41fb-b563-0ca2769202b2\",\n        \"target_log_stream_name\": \"mysql\"\n      }\n    }\n    ]\n  }\n}","x-request-examples-text-1":"/v2/{project_id}/lts/aom-mapping?isBatch=false\n{\n  \"rule_name\": \"abcde\",\n  \"project_id\": \"2a473356cca5487f8373be891bffc1cf\",\n  \"rule_info\": {\n    \"cluster_id\": \"4fae3587-0202-11eb-9ba9-0255ac100b02\",\n    \"cluster_name\": \"testdiskrate\",\n    \"deployments_prefix\":\"deployments_prefix\",\n    \"deployments\": [\n      \"__ALL_DEPLOYMENTS__\"\n    ],\n    \"namespace\": \"default\",\n    \"container_name\": \"container-0\",\n    \"files\": [\n    {\n      \"file_name\": \"__ALL_FILES__\",\n      \"log_stream_info\": {\n        \"target_log_group_id\": \"8c9dcda6-d048-43a7-989b-c76c34b0ac85\",\n        \"target_log_group_name\": \"lts-group-wb28\",\n        \"target_log_stream_id\": \"2c228bd1-cbf1-41fb-b563-0ca2769202b2\",\n        \"target_log_stream_name\": \"mysql\"\n      }\n    }\n    ]\n  }\n}","x-request-examples-url-1":"POST https://{endpoint}/v2/{project_id}/lts/aom-mapping","x-support-sdk":"Y"}}},"product_short":"LTS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建接入规则","tags":"AOM容器日志接入LTS","uri":null,"version":"2.0"}