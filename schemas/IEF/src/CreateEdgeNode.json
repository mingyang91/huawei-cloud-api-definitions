{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"Attributes":{"description":"节点属性","properties":{"key":{"description":"节点属性的key值,长度取值范围为1~128, 仅允许大小写英文字母、数字、下划线、中划线","type":"string"},"value":{"description":"节点属性的value值,长度取值范围为1~256, 仅允许大小写英文字母、数字、下划线、中划线","type":"string"}}},"DeviceInfos":{"description":"关联设备信息","properties":{"comment":{"description":"设备和节点关系的描述,最大长度64,不允许^ ~ # $ % & * < > ( ) [ ] { } ' \" \\","type":"string"},"device_ids":{"description":"设备ID列表","items":{"type":"string"},"type":"array"},"relation":{"description":"设备和节点关系的名称,只允许中文字符、英文字母、数字、下划线、中划线,最大长度64","type":"string"}},"required":["relation","device_ids"]},"EdgeNode":{"description":"边缘节点参数","properties":{"attributes":{"description":"边缘节点属性,关联属性个数最多为32个","items":{"$ref":"#/definitions/Attributes"},"type":"array"},"description":{"description":"边缘节点描述,最大长度255,不允许^ ~ # $ % & * < > ( ) [ ] { } ' \" \\","example":"string","type":"string"},"device_infos":{"description":"关联设备信息","items":{"$ref":"#/definitions/DeviceInfos"},"type":"array"},"enable_docker":{"description":"边缘节点启用Docker,默认为true","type":"boolean"},"enable_gpu":{"description":"边缘节点是否开启GPU,默认为false","example":"boolean","type":"boolean"},"enable_npu":{"description":"边缘节点是否开启NPU,true表示开启,false表示不开启,默认为false","example":"boolean","type":"boolean"},"log_configs":{"description":"边缘节点日志配置","items":{"$ref":"#/definitions/LogConfigs"},"type":"array"},"mqtt_config":{"$ref":"#/definitions/MqttConfigs","description":"MQTT配置。"},"name":{"description":"边缘节点名称,只允许中文字符、英文字母、数字、下划线、中划线,最大长度64\nName为必填字段,且本帐号中唯一。","example":"string","type":"string"},"npu_type":{"description":"NPU类型,支持D310类型和D910类型。\n- D310表示D310类型。\n- D910表示D910类型。\n- 不填表示为D310类型。","example":"string","type":"string"},"tags":{"description":"边缘节点标签,标签个数最多为20个","items":{"$ref":"#/definitions/NodeResTag"},"type":"array"}},"required":["name"]},"EdgeNodeResp":{"description":"边缘节点参数","properties":{"arch":{"description":"边缘节点架构","type":"string"},"attributes":{"description":"边缘节点属性,关联属性个数最多为32个","items":{"$ref":"#/definitions/Attributes"},"type":"array"},"ca":{"description":"根证书","type":"string"},"cert_remaining_valid_time":{"description":"证书有效期持续时间","format":"int32","type":"integer"},"certificate":{"description":"证书","type":"string"},"comment":{"description":"与device绑定关系描述(通过device id查询node时有值)","example":"string","type":"string"},"container_runtime_version":{"description":"容器运行时版本","example":"string","type":"string"},"cpu":{"description":"边缘节点CPU核心数","format":"int32","type":"integer"},"created_at":{"description":"创建时间","type":"string"},"deployment_num":{"description":"部署在该边缘节点上的应用实例个数","format":"int32","type":"integer"},"description":{"description":"边缘节点描述,最大长度255,不允许^ ~ # $ % & * < > ( ) [ ] { } ' \" \\","example":"string","type":"string"},"device_infos":{"description":"关联设备信息","items":{"$ref":"#/definitions/DeviceInfos"},"type":"array"},"device_num":{"description":"关联设备数量","format":"int32","type":"integer"},"docker_enable":{"description":"节点是否开启Docker","example":"boolean","type":"boolean"},"edged_version":{"description":"edged版本","type":"string"},"enable_gpu":{"description":"边缘节点是否开启GPU,默认为false","example":"boolean","type":"boolean"},"enable_npu":{"description":"边缘节点是否开启NPU,true表示开启,false表示不开启,默认为false","example":"boolean","type":"boolean"},"error_reason":{"description":"节点故障原因","type":"string"},"gpu_info":{"description":"gpu型号和gpu memory大小","items":{"$ref":"#/definitions/GpuInfo"},"type":"array"},"gpu_num":{"description":"gpu个数","format":"int32","type":"integer"},"group_ids":{"description":"节点组ID(一个节点属于多个节点组)","items":{"type":"string"},"type":"array"},"host_ips":{"description":"主机IP,默认返回eth0网卡的IP。","items":{"type":"string"},"type":"array"},"host_name":{"description":"边缘节点主机名","type":"string"},"id":{"description":"边缘节点ID","type":"string"},"identifier":{"description":"边缘节点使用token注册时的凭证","type":"string"},"ief_node_version":{"description":"边缘节点版本","type":"string"},"log_configs":{"description":"边缘节点日志配置","items":{"$ref":"#/definitions/LogConfigs"},"type":"array"},"master_addr":{"description":"云端服务URL","type":"string"},"memory":{"description":"边缘节点内存大小,单位M","format":"int32","type":"integer"},"mqtt_external":{"description":"外置开源mqtt地址","type":"string"},"mqtt_internal":{"description":"edgecore内置的mqtt地址","example":"string","type":"string"},"mqtt_mode":{"description":"mqtt集成模式\n- internal:edgecore内置mqtt\n- external:外置开源mqtt","type":"string"},"name":{"description":"边缘节点名称,只允许中文字符、英文字母、数字、下划线、中划线,最大长度64\nName为必填字段,且本帐号中唯一。","example":"string","type":"string"},"nics":{"description":"节点网卡和对应IP地址信息","items":{"$ref":"#/definitions/Nics"},"type":"array"},"node_type":{"description":"节点类型,默认为空,非空时为小站节点","type":"string"},"npu_info":{"description":"NPU型号和NPU Memory大小","items":{"$ref":"#/definitions/NpuInfo"},"type":"array"},"npu_num":{"description":"NPU数量","format":"int32","type":"integer"},"npu_type":{"description":"NPU类型,支持D310类型和D910类型。\n- D310表示D310类型。\n- D910表示D910类型。\n- 不填表示为D310类型。","example":"string","type":"string"},"ntp_configs":{"$ref":"#/definitions/NtpConfigs"},"os_name":{"description":"边缘节点操作系统名称","type":"string"},"os_type":{"description":"边缘节点操作系统类型","type":"string"},"os_version":{"description":"边缘节点操作系统版本","type":"string"},"package":{"description":"将证书文件certificate/ca/private_key打成.tar.gz包后用base64编码的字符串。\n使用时请使用base64解码成.tar.gz包。","type":"string"},"pause_docker_image":{"description":"pause容器镜像URL","type":"string"},"private_key":{"description":"私钥","type":"string"},"product_id":{"description":"产品ID(通过产品证书方式纳管)","type":"string"},"project_id":{"description":"项目ID","type":"string"},"purchase_id":{"description":"IEC/IES节点id","type":"string"},"relation":{"description":"与device绑定关系名称(通过device id查询node时有值)","type":"string"},"state":{"description":"边缘节点状态\n- UNCONNECTED(未注册)\n- RUNNING(运行中)\n- FAIL(故障)\n- STOPPED(停用)\n- UPGRADING(升级中)\n- FREEZE(冻结)","type":"string"},"state_details":{"$ref":"#/definitions/StateDetails","description":"IEC/IES节点状态详情"},"tags":{"description":"边缘节点标签,标签个数最多为20个","items":{"$ref":"#/definitions/ResourceTag"},"type":"array"},"updated_at":{"description":"更新时间","type":"string"},"upgrade_flag":{"description":"是否能升级的标志\n- true:需要升级\n- false:不需要升级","type":"boolean"},"upgrade_history":{"description":"节点安装或升级记录","items":{"$ref":"#/definitions/UpgradeHistory"},"type":"array"}},"required":["id","name","description","created_at","updated_at","project_id","private_key","certificate","ca","state","package","master_addr","cpu","memory","os_name","os_version","pause_docker_image","arch","os_type","deployment_num","enable_gpu","log_configs","device_infos","edged_version","gpu_num","host_ips","relation","comment","gpu_info","device_num","enable_npu","npu_type","nics","host_name","ief_node_version","upgrade_flag","product_id","group_ids","upgrade_history","attributes","docker_enable","mqtt_mode","mqtt_external","mqtt_internal","node_type","ntp_configs","error_reason","tags","npu_num","npu_info","container_runtime_version"],"type":"object"},"GpuInfo":{"properties":{"capacity":{"description":"GPU memory大小,单位MB","type":"string"},"name":{"description":"GPU名称","type":"string"},"type":{"description":"GPU类型","type":"string"}}},"LogConfigs":{"description":"边缘节点日志配置","properties":{"component":{"description":"- app:部署到边缘节点上的应用的日志\n- system:边缘节点上系统的日志","type":"string"},"id":{"description":"数据库保存的主键,不需要关注此字段。","type":"string"},"level":{"description":"- 当type为LTS时,应用级日志可配置为On或Off;系统级日志可配置为Off/Error/Warning/Info/Debug;\n- 当type为local时,无需配置level。","type":"string"},"rotate_num":{"description":"应用日志rotate个数,默认5,取值范围1-10。","format":"int32","type":"integer"},"rotate_period":{"description":"应用日志rotate周期,可选项:\n- daily\n- monthly\n- weekly\n- yearly","type":"string"},"size":{"description":"应用日志文件大小限制,单位MB,默认50,取值范围10-1000。","format":"int32","type":"integer"},"type":{"description":"- LTS:将日志发送到AOM\n- local:本地日志","type":"string"}},"required":["type","component"]},"Mqtt":{"description":"MQTT配置。\n当enable_mqtt取值为false时,mqtts需要为空数组。","properties":{"bind_addr":{"description":"MQTT监听地址,根据type取值确定。","type":"string"},"port":{"description":"端口号。","format":"int32","type":"integer"},"type":{"description":"类型。枚举值:\n- nic:网卡类型\n- ip:IP类型","type":"string"}},"required":["bind_addr","port","type"]},"MqttConfigs":{"description":"MQTT配置","properties":{"enable_mqtt":{"description":"是否启用MQTT","example":"boolean","type":"boolean"},"mqtts":{"description":"MQTT配置 当enable_mqtt取值为false时,mqtts需要为空数组","items":{"$ref":"#/definitions/Mqtt"},"type":"array"}},"required":["enable_mqtt","mqtts"]},"Nics":{"properties":{"interface":{"description":"边缘节点网卡名称","type":"string"},"ip":{"description":"上述网卡对应的IPv4地址","type":"string"}}},"Node":{"description":"边缘节点参数","properties":{"node":{"$ref":"#/definitions/EdgeNode"}},"required":["node"]},"NodeResTag":{"description":"标签属性","properties":{"key":{"description":"键。最大长度36个unicode字符。\n不能为空,只能包含大小写字母,数字,中划线“-”,下划线“_”。","type":"string"},"value":{"description":"值。每个值最大长度43个unicode字符,删除时如果value有值按照key/value删除,如果value没值,则按照key删除。\n不能为空,只能包含大小写字母,数字,中划线“-”,下划线“_”。","type":"string"}}},"NodeResp":{"description":"边缘节点参数","properties":{"node":{"$ref":"#/definitions/EdgeNodeResp"}},"required":["node"]},"NpuInfo":{"properties":{"capacity":{"description":"NPU memory大小","type":"string"},"driver_version":{"description":"NPU驱动版本","type":"string"},"name":{"description":"NPU名称","type":"string"},"type":{"description":"NPU类型","type":"string"}}},"NtpConfigs":{"description":"ntp配置","properties":{"ntp_enabled":{"description":"ntp服务是否开启","type":"boolean"},"ntp_servers":{"description":"ntp server地址","items":{"type":"string"},"type":"array"}},"type":"object"},"ResourceTag":{"description":"标签属性","properties":{"key":{"description":"键。最大长度36个unicode字符。\n不能为空,只能包含大小写字母,数字,中划线“-”,下划线“_”。","type":"string"},"value":{"description":"值。每个值最大长度43个unicode字符,删除时如果value有值按照key/value删除,如果value没值,则按照key删除。\n不能为空,只能包含大小写字母,数字,中划线“-”,下划线“_”。","type":"string"}},"type":"object"},"StateDetails":{"description":"IEC/IES节点状态详情","properties":{"purchase_error":{"description":"IEC/IES节点错误信息","type":"string"},"purchase_stat":{"description":"IEC/IES节点状态","type":"string"},"register_stat":{"description":"IEC/IES节点注册状态","type":"string"}},"type":"object"},"UpgradeHistory":{"description":"节点安装或升级记录","properties":{"dur_time":{"description":"节点升级所消耗的时间","format":"int32","type":"integer"},"from_version":{"description":"节点升级前节点上edgecore版本号,形式如2.1.0,其中每一位都是整数","type":"string"},"id":{"description":"节点升级或安装历史版本id","format":"int32","type":"integer"},"result":{"description":"节点升级或安装状态,包含\n- install_success:边缘节点安装成功\n- upgrade_success:边缘节点升级成功\n- install_failed:边缘节点安装失败\n- upgrade_failed:边缘节点升级失败\n- upgrade_failed_rollback_success:边缘节点升级失败回滚成功\n- upgrade_failed_rollback_failed:边缘节点升级失败回滚失败","type":"string"},"to_version":{"description":"节点升级或安装后节点行edgecore版本号,形式如2.1.0,其中每一位都是整数","type":"string"},"upgrade_time":{"description":"节点升级或安装的十位时间戳","format":"int32","type":"integer"}}}},"description":null,"group_id":"cdaa2d3f4fbb4dc38b6a6c55f9222ed9","host":"ief.cn-north-4.myhuaweicloud.com","id":"32dfa743755a428cbfd737f5d722c659","info_version":"v1","method":"post","name":"CreateEdgeNode","parameters":{"Content-Type":{"description":"消息体的类型(格式),默认取值为“application/json”","in":"header","name":"Content-Type","required":true,"type":"string"},"IEF-Instance-Id":{"description":"铂金版实例ID,专业版实例为空值","in":"header","name":"ief-instance-id","required":false,"type":"string"},"X-Auth-Token":{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."}},"paths":{"/v2/{project_id}/edgemgr/nodes":{"post":{"consumes":["application/json"],"description":"该API用于注册一个边缘节点。接口调用成功后,您可以将响应消息体中node.package字段使用base64解码成tar.gz文件,并在控制台下载边缘核心软件,然后纳管边缘节点。","operationId":"CreateEdgeNode","parameters":[{"$ref":"#/parameters/Content-Type"},{"$ref":"#/parameters/X-Auth-Token"},{"description":"项目ID","in":"path","name":"project_id","required":true,"type":"string"},{"description":"边缘节点参数","in":"body","name":"CreateEdgeNodeRequestBody","required":true,"schema":{"$ref":"#/definitions/Node"}},{"$ref":"#/parameters/IEF-Instance-Id"}],"produces":["application/json"],"responses":{"201":{"description":"边缘节点详细信息","examples":{"application/json":{"node":{"arch":"","attributes":[],"ca":"","certificate":"","comment":"","container_runtime_version":"","cpu":0,"created_at":"2020-08-11T01:23:55.527805447Z","deployment_num":0,"description":"This is a test node","device_infos":[],"device_num":0,"docker_enable":true,"edged_version":"","enable_gpu":false,"enable_npu":false,"error_reason":"","gpu_info":[],"gpu_num":0,"host_ips":[],"host_name":"","id":"86715318-a5a7-4507-a289-7238d53d5fed","ief_node_version":"","log_configs":[{"component":"app","id":"9b795f5e-01b7-47e8-b1ae-6dc59b9c0005","level":"","rotate_num":5,"rotate_period":"daily","size":100,"type":"local"},{"component":"app","id":"e419ab7f-17ea-4757-b62e-311fc777af69","level":"false","rotate_num":5,"rotate_period":"daily","size":50,"type":"LTS"},{"component":"system","id":"56dabbb7-4fb1-46cc-85df-dc80a2bd24f8","level":"","rotate_num":5,"rotate_period":"daily","size":50,"type":"local"},{"component":"system","id":"0f6935c1-e59d-4b0d-a0db-1ba07b2ac8d1","level":"false","rotate_num":5,"rotate_period":"daily","size":50,"type":"LTS"}],"master_addr":"https://ief2-placement.cn-north-4.myhuaweicloud.com:443","memory":0,"mqtt_external":"","mqtt_internal":"tls://docker0:8883,tls://127.0.0.1:8883","mqtt_mode":"internal","name":"node_test","nics":[],"node_type":"","npu_info":[],"npu_num":0,"ntp_configs":null,"os_name":"","os_type":"","os_version":"","package":"","pause_docker_image":"swr.cn-north-4.myhuaweicloud.com/huawei-ief-internal-app/pause","private_key":"","product_id":"","project_id":"05041fffa40025702f6dc009cc6f8f33","relation":"","state":"UNCONNECTED","tags":null,"updated_at":"","upgrade_history":[]}}},"schema":{"$ref":"#/definitions/NodeResp"}}},"summary":"注册边缘节点","tags":["边缘节点管理"],"x-is-registered":"Y","x-publishpath":"ief_02_0018","x-request-examples-1":{"node":{"description":"This is a test node","enable_gpu":false,"log_configs":[{"component":"app","level":"debug","rotate_num":5,"rotate_period":"daily","size":100,"type":"local"}],"name":"node_test"}},"x-request-examples-description-1":"注册边缘节点,不开启GPU,将部署到边缘节点上的应用,生成的日志发送到本地。","x-request-examples-text-1":{"node":{"description":"This is a test node","enable_gpu":false,"log_configs":[{"component":"app","level":"debug","rotate_num":5,"rotate_period":"daily","size":100,"type":"local"}],"name":"node_test"}},"x-support-sdk":"Y"}}},"product_short":"IEF","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"注册边缘节点","tags":"边缘节点管理","uri":null,"version":"2.0"}