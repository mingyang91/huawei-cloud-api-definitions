{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"BackupStrategy":{"description":"高级备份策略。","properties":{"keep_days":{"description":"指定已生成的备份文件可以保存的天数。\n取值范围:0~732。\n  - 取0值,表示不设置自动备份策略。\n  - 不传该参数,默认开启自动备份策略,备份文件默认保存7天。","maximum":732,"minimum":0,"type":"string"},"start_time":{"description":"备份时间段。自动备份将在该时间段内触发。\n取值范围:非空,格式必须为hh:mm-HH:MM且有效,当前时间指UTC时间。\n  - HH取值必须比hh大1。\n  - mm和MM取值必须相同,且取值必须为00、15、30或45。","example":"23:00-00:00","type":"string"}},"required":["start_time"]},"ChargeInfoOption":{"description":"计费类型信息,支持包年包月和按需计费,默认为按需计费。","properties":{"charge_mode":{"description":"计费模式。\n取值范围:\n  - prePaid:预付费,即包年/包月。\n  - postPaid:后付费,即按需付费。","example":"prePaid","type":"string"},"is_auto_pay":{"description":"创建包周期实例时可指定,表示是否自动从账户中支付,该字段不影响自动续订的支付方式。\n取值范围:\n  - true,表示自动从账户中支付\n  - false,表示手动从账户中支付,默认为该支付方式。","example":false,"type":"boolean"},"is_auto_renew":{"description":"创建包周期实例时可指定,表示是否自动续订,续订的周期和原周期相同,且续订时会自动支付。\n取值范围:\n  - true,表示自动续订。\n  - false,表示不自动续订,默认为该方式。","example":true,"type":"boolean"},"period_num":{"description":"“charge_mode”为“prePaid”时生效,且为必选值,指定订购的时间。\n取值范围:\n  - 当“period_type”为“month”时,取值为1~9。\n  - 当“period_type”为“year”时,取值为1~3","example":1,"type":"integer"},"period_type":{"description":"订购周期类型。\n“charge_mode”为“prePaid”时生效,且为必选值。\n取值范围:\n  - month:包月。\n  - year:包年。","example":"month","type":"string"}},"required":["charge_mode"]},"ChargeInfoResult":{"description":"付费方式信息,与请求参数相同。","properties":{"charge_mode":{"description":"计费模式。\n取值范围:\n  - prePaid:预付费,即包年/包月。\n  - postPaid:后付费,即按需付费。","example":"prePaid","type":"string"},"is_auto_pay":{"description":"创建包周期实例时可指定,表示是否自动从账户中支付,该字段不影响自动续订的支付方式。\n取值范围:\n  - true,表示自动从账户中支付\n  - false,表示手动从账户中支付,默认为该支付方式。","example":false,"type":"boolean"},"is_auto_renew":{"description":"创建包周期实例时可指定,表示是否自动续订,续订的周期和原周期相同,且续订时会自动支付。\n取值范围:\n  - true,表示自动续订。\n  - false,表示不自动续订,默认为该方式。","example":true,"type":"boolean"},"period_num":{"description":"“charge_mode”为“prePaid”时生效,且为必选值,指定订购的时间。\n取值范围:\n  - 当“period_type”为“month”时,取值为1~9。\n  - 当“period_type”为“year”时,取值为1~3","example":1,"type":"integer"},"period_type":{"description":"订购周期类型。\n“charge_mode”为“prePaid”时生效,且为必选值。\n取值范围:\n  - month:包月。\n  - year:包年。","example":"month","type":"string"}}},"Datastore":{"description":"数据库信息。","properties":{"storage_engine":{"description":"存储引擎。支持WiredTiger存储引擎。取值为“wiredTiger”。","enum":["wiredTiger","rocksDB"],"type":"string"},"type":{"description":"数据库版本类型。取值“DDS-Community”。","enum":["DDS-Community"],"type":"string"},"version":{"description":"数据库版本。支持3.4及以上版本。取值为“3.4”、“4.0”、“4.2”、“4.4”、“5.0”。","type":"string"}},"required":["type","version","storage_engine"]},"ErrorResponse":{"properties":{"error_code":{"description":"错误码。","example":"DBS.200001","type":"string"},"error_msg":{"description":"错误消息。","example":"参数错误。","type":"string"}},"required":["error_code","error_msg"]},"RestoreNewInstanceConfigurationsOption":{"description":"参数组配置信息。","properties":{"configuration_id":{"description":"参数组id。","type":"string"},"type":{"description":"节点类型。\n取值:\n  - 集群实例包含mongos、shard和config节点,各节点下该参数取值分别为“mongos”、“shard”和“config”。\n  - 副本集实例下该参数取值为“replica”。\n  - 单节点实例下该参数取值为“single”。","enum":["mongos","shard","config","replica","single"],"type":"string"}},"required":["type","configuration_id"]},"RestoreNewInstanceFlavorOption":{"description":"实例规格详情。","properties":{"num":{"description":"节点数量。\n取值:\n  - 集群实例下“mongos”类型的节点数量可取2~16。\n  - 集群实例下“shard”类型的组数量可取2~16。\n  - “shard”类型的组数量可取2~16。\n  - “config”类型的组数量只能取1。\n  - “replica”类型的组数量只能取1。\n  - “single”类型的节点数量只能取1。","type":"string"},"size":{"description":"磁盘大小。\n取值:必须为10的整数倍。单位为GB。\n  - 对于集群实例,shard组可取10GB~2000GB,config组仅可取20GB。mongos节点不涉及选择磁盘,该参数无意义。\n  - 对于副本集实例,可取10GB~2000GB。\n  - 对于单节点实例,可取10GB~1000GB。","type":"string"},"spec_code":{"description":"资源规格编码","type":"string"},"type":{"description":"节点类型。\n取值:\n  - 集群实例包含mongos、shard和config节点,各节点下该参数取值分别为“mongos”、“shard”和“config”。\n  - 副本集实例下该参数取值为“replica”。\n  - 单节点实例下该参数取值为“single”。","enum":["mongos","shard","config","replica","single"],"type":"string"}},"required":["type","num","spec_code"]},"RestoreNewInstanceRequestBody":{"description":"实例信息。","properties":{"availability_zone":{"description":"可用区ID,请参见[地区和终端节点](https://developer.huaweicloud.com/endpoint)。","example":"az1","type":"string"},"backup_strategy":{"$ref":"#/definitions/BackupStrategy"},"charge_info":{"$ref":"#/definitions/ChargeInfoOption"},"configurations":{"description":"参数组配置信息。","items":{"$ref":"#/definitions/RestoreNewInstanceConfigurationsOption"},"type":"array"},"disk_encryption_id":{"description":"磁盘加密时的密钥ID,严格UUID正则校验。\n不传该参数时,表示不进行磁盘加密。","type":"string"},"dss_pool_id":{"description":"创建新实例所在专属存储池ID,仅专属云创建实例时有效。","example":"f5f84ed7-6f19-4bd4-99d7-b450ad6cc4df","type":"string"},"enterprise_project_id":{"description":"企业项目ID。","type":"string"},"flavor":{"description":"实例规格详情。","items":{"$ref":"#/definitions/RestoreNewInstanceFlavorOption"},"type":"array"},"name":{"description":"实例名称。用于表示实例的名称,用于表示实例的名称,允许和已有名称重复。\n取值范围:长度为4~64位,必须以字母开头(A~Z或a~z),区分大小写,可以包含字母、数字(0~9)、中划线(-)或者下划线(_),不能包含其他特殊字符。","type":"string"},"password":{"description":"数据库密码。\n取值范围:长度为8~32位,必须是大写字母(A~Z)、小写字母(a~z)、数字(0~9)、特殊字符~!@#%^*-_=+?的组合。\n建议您输入高强度密码,以提高安全性,防止出现密码被暴力破解等安全风险。","type":"string"},"restore_point":{"$ref":"#/definitions/RestorePoint","description":"恢复数据源对象。"},"security_group_id":{"description":"指定实例所属的安全组ID。\n获取方法请参见《虚拟私有云API参考》中“安全组”的内容。","type":"string"},"server_group_policies":{"description":"创建新实例设置云服务器组关联的策略名称列表,仅专属云创建实例时有效。\n取值\n   - 取“anti-affinity”,表示DDS实例开启反亲和部署,反亲和部署是出于高可用性考虑,将您的Primary、Secondary和Hidden节点分别创建在不同的物理机上。当前仅支持该值,不传该值默认不开启反亲和部署。","example":["anti-affinity"],"items":{"type":"string"},"type":"array"},"ssl_option":{"description":"SSL开关选项。\n取值:\n- 取“0”,表示DDS实例默认不启用SSL连接。\n- 取“1”,表示DDS实例默认启用SSL连接。\n- 不传该参数时,默认启用SSL连接。","type":"string"},"subnet_id":{"description":"子网ID。获取方法请参见《虚拟私有云API参考》中“子网”的内容。","type":"string"},"vpc_id":{"description":"虚拟私有云ID。获取方法请参见《虚拟私有云API参考》中“VPC”的内容。\n取值:非空,字符长度校验,严格UUID正则校验。","type":"string"}},"required":["name","region","availability_zone","vpc_id","subnet_id","security_group_id","flavor","restore_point"]},"RestoreNewInstanceResponseBody":{"properties":{"availability_zone":{"description":"可用区ID,与请求参数相同。","example":"az1","type":"string"},"backup_strategy":{"$ref":"#/definitions/BackupStrategy","description":"高级备份策略,与请求参数相同。"},"charge_info":{"$ref":"#/definitions/ChargeInfoResult"},"configurations":{"description":"参数组配置信息。","items":{"$ref":"#/definitions/RestoreNewInstanceConfigurationsOption"},"type":"array"},"created":{"description":"创建时间为本地时间,格式为“yyyy-mm-dd hh:mm:ss”。","type":"string"},"datastore":{"$ref":"#/definitions/Datastore","description":"数据库信息,与请求参数相同。"},"disk_encryption_id":{"description":"磁盘加密的密钥ID,与请求参数相同。","type":"string"},"dss_pool_id":{"description":"专属存储池ID。","type":"string"},"enterprise_project_id":{"description":"企业项目ID。取值为“0”,表示为default企业项目。","type":"string"},"flavor":{"description":"实例规格详情,与请求参数相同。","items":{"$ref":"#/definitions/RestoreNewInstanceFlavorOption"},"type":"array"},"id":{"description":"实例ID。","type":"string"},"job_id":{"description":"创建实例的工作流ID。","type":"string"},"mode":{"description":"实例类型,与请求参数相同。","type":"string"},"name":{"description":"实例名称,与请求参数相同。","type":"string"},"order_id":{"description":"创建实例的订单ID,仅创建包年包月实例时返回该参数。","type":"string"},"region":{"description":"区域ID,与请求参数相同。","type":"string"},"security_group_id":{"description":"实例所属的安全组ID,与请求参数相同。","type":"string"},"ssl_option":{"description":"SSL开关选项,与请求参数相同。","type":"string"},"status":{"description":"实例状态,取值为“creating”。","type":"string"},"subnet_id":{"description":"子网ID,与请求参数相同。","type":"string"},"vpc_id":{"description":"虚拟私有云ID,与请求参数相同。","type":"string"}}},"RestorePoint":{"properties":{"backup_id":{"description":"用于恢复的备份ID。当使用备份文件恢复时需要指定该参数。当“type”字段为非必选时,“backup_id”必选。","type":"string"},"instance_id":{"description":"实例ID,可以调用“查询实例列表和详情”接口获取。如果未申请实例,可以调用“创建实例”接口创建。当type为“backup”,为非必选。当type为“timestamp”,为必选。","type":"string"},"restore_time":{"description":"恢复数据的时间点,格式为UNIX时间戳,单位是毫秒,时区为UTC。须知:当“type”字段必选时,“restore_time”必选。","type":"string"},"type":{"description":"恢复方式,枚举值:\n- “backup”,表示使用备份文件恢复,按照此方式恢复时,当“type”字段为非必选时,“backup_id”必选。\n- “timestamp”,表示按时间点恢复,按照此方式恢复时,当“type”字段必选时,“restore_time”必选。","type":"string"}}}},"description":null,"group_id":"a2654930c2d440c78366c9c164a23e86","host":"dds.cn-north-4.myhuaweicloud.com","id":"fc3044ce8f194a149cb38d3705d85bf5","info_version":"v3","method":"post","name":"RestoreNewInstance","parameters":{},"paths":{"/v3/{project_id}/instances":{"post":{"description":"根据备份恢复新实例。","operationId":"RestoreNewInstance","parameters":[{"description":"用户Token。","in":"header","name":"x-auth-token","required":true,"type":"string","x-example":"******"},{"description":"租户在某一region下的project ID。","in":"path","name":"project_id","required":true,"type":"string","x-example":"619d3e78f61b4be68bc5aa0b59edcf7b"},{"description":"请求体。","in":"body","name":"RestoreNewInstanceRequestBody","required":true,"schema":{"$ref":"#/definitions/RestoreNewInstanceRequestBody"}}],"responses":{"202":{"description":"Success.","examples":{"application/json":{"availability_zone":"az1xahz","backup_strategy":{"keep_days":"8","start_time":"08:15-09:15"},"configurations":[{"configuration_id":"acb288dbd1174f26a8960b45591bd98apr02","type":"mongos"},{"configuration_id":"5bca546f0be64b038124ef9cedd1bfa1pr02","type":"shard"},{"configuration_id":"4d123b3ba8294921802b11bf4d8c5735pr02","type":"config"}],"created":"2019-01-16 09:34:36","datastore":{"storage_engine":"wiredTiger","type":"DDS-Community","version":"3.2"},"disk_encryption_id":"2gfdsh-844a-4023-a776-fc5c5fb71fb4","dss_pool_id":"f5f84ed7-6f19-4bd4-99d7-b450ad6cc4dd","enterprise_project_id":"","flavor":[{"num":"2","spec_code":"dds.mongodb.c6.medium.4.mongos","type":"mongos"},{"num":"2","size":"20","spec_code":"dds.mongodb.c6.medium.4.shard","type":"shard"},{"num":"1","size":"20","spec_code":"dds.mongodb.c6.large.2.config","type":"config"}],"id":"39b6a1a278844ac48119d86512e0000bin02","job_id":"c010abd0-48cf-4fa8-8cbc-090f093eaa2f","mode":"Sharding","name":"test-cluster-01","region":"cn-xianhz-1","security_group_id":"2a1f7fc8-3307-42a7-aa6f-42c8b9b8f8c5","ssl_option":"1","status":"creating","subnet_id":"0e2eda62-1d42-4d64-a9d1-4e9aa9cd994f","vpc_id":"490a4a08-ef4b-44c5-94be-3051ef9e4fce"}},"schema":{"$ref":"#/definitions/RestoreNewInstanceResponseBody"}},"default":{"description":"Client or server error.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"summary":"恢复到新实例","tags":["备份与恢复"],"x-constraint":"- 该接口既支持恢复到包年包月实例,也支持按需实例\n- 目标实例与源实例的数据库类型必须一致。\n- 根据时间点恢复到新实例只有副本集支持该功能。","x-is-registered":"N","x-request-examples-1":{"availability_zone":"az1xahz","backup_strategy":{"keep_days":"8","start_time":"08:15-09:15"},"configurations":[{"configuration_id":"acb288dbd1174f26a8960b45591bd98apr02","type":"mongos"},{"configuration_id":"5bca546f0be64b038124ef9cedd1bfa1pr02","type":"shard"},{"configuration_id":"4d123b3ba8294921802b11bf4d8c5735pr02","type":"config"}],"dss_pool_id":"f5f84ed7-6f19-4bd4-99d7-b450ad6cc4dd","flavor":[{"num":"2","spec_code":"dds.mongodb.c6.medium.4.mongos","type":"mongos"},{"size":"20","spec_code":"dds.mongodb.c6.medium.4.shard","type":"shard"},{"num":"1","size":"20","spec_code":"dds.mongodb.c6.large.2.config","type":"config"}],"name":"test-cluster-01","password":"******","restore_point":{"backup_id":"8f643d252d834a4c916b2db4322f99552734"},"security_group_id":"7aa51dbf-5b63-40db-9724-dad3c4828b58","server_group_policies":["anti-affinity"],"ssl_option":"1","subnet_id":"f1df08c5-71d1-406a-aff0-de435a51007","vpc_id":"674e9b42-cd8d-4d25-a2e6-5abcc565b961"},"x-request-examples-2":{"availability_zone":"az1xahz","backup_strategy":{"keep_days":"8","start_time":"08:15-09:15"},"configurations":[{"configuration_id":"f17e3aad778440fbb68603c8c9032003pr02","type":"replica"}],"flavor":[{"num":"1","size":"30","spec_code":"dds.mongodb.s2.medium.4.shard","storage":"ULTRAHIGH","type":"replica"}],"name":"test-replicaset","password":"******","restore_point":{"backup_id":"8f643d252d834a4c916b2db4322f99552734"},"security_group_id":"7aa51dbf-5b63-40db-9724-dad3c4828b58","ssl_option":"1","subnet_id":"f1df08c5-71d1-406a-aff0-de435a51007","vpc_id":"674e9b42-cd8d-4d25-a2e6-5abcc565b961"},"x-request-examples-3":{"availability_zone":"az1xahz","backup_strategy":{"keep_days":"8","start_time":"08:15-09:15"},"configurations":[{"configuration_id":"b8e962e66ede47609a94cba591735b49pr02","type":"single"}],"flavor":[{"num":"1","size":"30","spec_code":"dds.mongodb.c6.medium.4.single","storage":"ULTRAHIGH","type":"single"}],"name":"test-singlenode","password":"******","restore_point":{"backup_id":"8f643d252d834a4c916b2db4322f99552734"},"security_group_id":"7aa51dbf-5b63-40db-9724-dad3c4828b58","ssl_option":"1","subnet_id":"f1df08c5-71d1-406a-aff0-de435a51007","vpc_id":"674e9b42-cd8d-4d25-a2e6-5abcc565b961"},"x-request-examples-4":{"availability_zone":"az1xahz","backup_strategy":{"keep_days":"8","start_time":"08:15-09:15"},"configurations":[{"configuration_id":"f17e3aad778440fbb68603c8c9032003pr02","type":"replica"}],"flavor":[{"num":"1","size":"30","spec_code":"dds.mongodb.s2.medium.4.shard","storage":"ULTRAHIGH","type":"replica"}],"name":"test-replicaset","password":"******","restore_point":{"instance_id":"8f643d252d834a4c916b2db4322f9955in02","restore_time":1607689584000,"type":"timestamp"},"security_group_id":"7aa51dbf-5b63-40db-9724-dad3c4828b58","ssl_option":"1","subnet_id":"f1df08c5-71d1-406a-aff0-de435a51007","vpc_id":"674e9b42-cd8d-4d25-a2e6-5abcc565b961"},"x-request-examples-description-1":"集群根据备份文件恢复到新实例:","x-request-examples-description-2":"副本集根据备份文件恢复到新实例:","x-request-examples-description-3":"单节点根据备份文件恢复到新实例:","x-request-examples-description-4":"副本集根据时间点恢复到新实例:","x-request-examples-url-1":"POST https://{endpoint}/v3/054e292c9880d4992f02c0196d3ea468/instances","x-request-examples-url-2":"POST https://{endpoint}/v3/054e292c9880d4992f02c0196d3ea468/instances","x-request-examples-url-3":"POST https://{endpoint}/v3/054e292c9880d4992f02c0196d3ea468/instances","x-request-examples-url-4":"POST https://{endpoint}/v3/054e292c9880d4992f02c0196d3ea468/instances","x-support-sdk":"Y"}}},"product_short":"DDS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"恢复到新实例","tags":"备份与恢复","uri":null,"version":"2.0"}