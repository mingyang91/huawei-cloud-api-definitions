{"base_path":null,"components":null,"consumes":"","definitions":{"CollectorConfigModel":{"description":"采集器配置。","properties":{"detail_view_config":{"$ref":"#/definitions/DetailViewConfigModel","description":"详情视图配置。"},"line_view_config":{"$ref":"#/definitions/LineViewConfigModel","description":"指向线视图配置。"}},"type":"object"},"DetailViewConfigModel":{"description":"详情视图配置。","properties":{"detail_view_item_list":{"description":"视图函数集合。","items":{"$ref":"#/definitions/DetailViewItem"},"type":"array"},"filter_prefix":{"description":"过滤参数。","type":"string"},"metric_set":{"description":"视图对应的指标集的名称。","type":"string"}},"type":"object"},"DetailViewItem":{"description":"节点详情视图函数信息。","properties":{"as":{"description":"作为。","type":"string"},"function":{"description":"表达式。","type":"string"}},"type":"object"},"EnvTopoRequest":{"description":"获取组件环境拓扑数据的请求参数。","properties":{"direction":{"description":"方向,可为空。","type":"string"},"end_time":{"description":"结束时间。","type":"string"},"filter_user":{"description":"过滤。","type":"boolean"},"start_time":{"description":"开始时间。","type":"string"},"target_env_id":{"description":"环境id。","format":"int64","type":"integer"}},"required":["target_env_id","end_time","start_time"],"type":"object"},"LineViewConfigModel":{"description":"指向线视图配置。","properties":{"filter_prefix":{"description":"过滤参数。","type":"string"},"line_view_item_list":{"description":"视图函数集合。","items":{"$ref":"#/definitions/LineViewItem"},"type":"array"},"metric_set":{"description":"视图对应的指标集的名称。","type":"string"}},"type":"object"},"LineViewItem":{"description":"连接线视图函数详情。","properties":{"as":{"description":"作为。","type":"string"},"function":{"description":"表达式。","type":"string"}},"type":"object"},"TopoLine":{"description":"组件之间调用指向线。","properties":{"collector":{"description":"采集器名称。","type":"string"},"direction":{"description":"指向。","type":"string"},"filter_value":{"description":"过滤值。","type":"string"},"from_node":{"description":"开始节点。","type":"string"},"hints":{"additionalProperties":{"type":"string"},"description":"线条上的提示信息。","type":"object"},"target_env_id":{"description":"环境id。","format":"int64","type":"integer"},"to_node":{"description":"结束节点。","type":"string"}},"type":"object"},"TopoNode":{"description":"组件节点。","properties":{"env_id":{"description":"环境id。","format":"int64","type":"integer"},"node_id":{"description":"节点id。","type":"string"},"node_name":{"description":"节点名称。","type":"string"},"node_type":{"description":"节点类型。","type":"string"}},"type":"object"},"TopoResult":{"description":"拓扑图返回结果。","properties":{"collector_config":{"additionalProperties":{"$ref":"#/definitions/CollectorConfigModel"},"description":"采集器配置。","type":"object"},"line_list":{"description":"组件之间调用指向线列表。","items":{"$ref":"#/definitions/TopoLine"},"type":"array"},"node_list":{"description":"组件节点列表。","items":{"$ref":"#/definitions/TopoNode"},"type":"array"},"real_end_time":{"description":"结束时间。","format":"int64","type":"integer"},"real_start_time":{"description":"开始时间。","format":"int64","type":"integer"}},"type":"object"}},"description":null,"group_id":"948fcecbff6f450fbe29bcc3e90c3eca","host":"apm2.cn-north-4.myhuaweicloud.com","id":"011ebcff081540b88c976e2b048a921b","info_version":"v1","method":"post","name":"SearchEnvTopology","parameters":{},"paths":{"/v1/apm2/openapi/topology/env-search":{"post":{"description":"查询组件环境级别全局拓扑图信息。","operationId":"SearchEnvTopology","parameters":[{"description":"从IAM服务获取的用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"应用id。","format":"int64","in":"header","name":"x-business-id","required":true,"type":"integer"},{"description":"获取组件环境拓扑数据的请求参数","in":"body","name":"envTopoRequest","required":true,"schema":{"$ref":"#/definitions/EnvTopoRequest"}}],"produces":["application/json"],"responses":{"200":{"description":"OK,请求响应成功。","examples":{"application/json":{"collector_config":{"HttpClient":{"detail_view_config":null,"line_view_config":{"filter_prefix":"envId=","line_view_item_list":[{"as":"count","function":"SUM(invokeCount)"},{"as":"rt","function":"SUM(totalTime)/SUM(invokeCount)"},{"as":"errorCount","function":"SUM(errorCount)"}],"metric_set":"hostInvocation"}},"KafkaConsumer":{"detail_view_config":{"detail_view_item_list":[{"as":"count","function":"SUM(recordConsumedTotal)"},{"as":"bytes","function":"SUM(bytesConsumedTotal)"}],"group_by":"topic","metric_set":"topic"},"line_view_config":{"filter_prefix":null,"line_view_item_list":[{"as":"count","function":"SUM(recordConsumedTotal)"},{"as":"bytes","function":"SUM(bytesConsumedTotal)"}],"metric_set":"total"}},"KafkaProducer":{"detail_view_config":{"detail_view_item_list":[{"as":"count","function":"SUM(recordSendTotal)"},{"as":"bytes","function":"SUM(byteTotal)"}],"group_by":"topic","metric_set":"topic"},"line_view_config":{"filter_prefix":null,"line_view_item_list":[{"as":"count","function":"SUM(recordSendTotal)"},{"as":"bytes","function":"SUM(byteTotal)"}],"metric_set":"total"}},"Url":{"detail_view_config":null,"line_view_config":{"filter_prefix":"clusterId=","line_view_item_list":[{"as":"count","function":"SUM(invokeCount)"},{"as":"rt","function":"SUM(totalTime)/SUM(invokeCount)"},{"as":"errorCount","function":"SUM(errorCount)"}],"metric_set":"user"}}},"line_list":[{"collector":"Url","direction":"in","filter_value":"user","from_node":"user","hints":{"count":"680","error":"0","rt":"0.09"},"target_env_id":4394,"to_node":"4394"},{"collector":"HttpClient","direction":"out","filter_value":"51","from_node":"4394","hints":{"count":"668","error":"0","rt":"33.27"},"target_env_id":4394,"to_node":"51"},{"collector":"KafkaConsumer","direction":"in","filter_value":"Kafka","from_node":"Kafka","hints":{"bytes":"-1448635860","count":"4163226"},"target_env_id":4394,"to_node":"4394"},{"collector":"KafkaProducer","direction":"out","filter_value":"Kafka","from_node":"4394","hints":{"bytes":"0","count":"0"},"target_env_id":4394,"to_node":"Kafka"},{"collector":"HttpClient","direction":"out","filter_value":"1927","from_node":"4394","hints":{"count":"170","error":"0","rt":"41.64"},"target_env_id":4394,"to_node":"1927"}],"node_list":[{"env_id":4394,"node_id":"4394","node_name":"apm-archive:cn-east-204","node_type":"Env"},{"env_id":null,"node_id":"Kafka","node_name":"Kafka","node_type":"Kafka"},{"env_id":1927,"node_id":"1927","node_name":"config-web:cn-southwest-204","node_type":"Env"},{"env_id":51,"node_id":"51","node_name":"config-web:cn-east-204","node_type":"Env"},{"env_id":null,"node_id":"user","node_name":"user","node_type":"Env"}],"real_end_time":1667466458000,"real_start_time":1667465258000}},"schema":{"$ref":"#/definitions/TopoResult"}},"401":{"description":"Unauthorized,没有权限。","schema":{"type":"string"}},"403":{"description":"Forbidden,禁止访问。","schema":{"type":"string"}},"404":{"description":"Not Found,没有找到要请求的资源。","schema":{"type":"string"}}},"summary":"查询组件环境拓扑图","tags":["TOPOLOGY"],"x-hybridcloud":true,"x-is-registered":"Y","x-request-examples-1":{"direction":"","end_time":1667466458000,"filter_user":false,"start_time":1667465258000,"target_env_id":4394},"x-request-examples-description-1":"入参为环境id,起止时间。","x-request-examples-text-1":{"direction":"","end_time":1667466458000,"filter_user":false,"start_time":1667465258000,"target_env_id":4394},"x-request-examples-url-1":"/v1/apm2/openapi/topology/env-search","x-support-sdk":"Y"}}},"product_short":"APM","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":{"apig-auth-app":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-type":"AppSigv1"},"apig-auth-app-optional":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-opt":{"access-auth-type":"optional"},"x-apigateway-auth-type":"AppSigv1"},"apig-auth-iam":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM"},"apig-auth-iam-none":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM_NONE"}},"summary":"查询组件环境拓扑图","tags":"TOPOLOGY","uri":null,"version":"2.0"}