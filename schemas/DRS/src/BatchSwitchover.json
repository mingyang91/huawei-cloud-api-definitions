{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"BatchSwitchoverReq":{"description":"批量主备倒换请求体","properties":{"jobs":{"description":"批量主备调换的任务详情ID请求列表","items":{"description":"","type":"string"},"type":"array"}},"required":["jobs"]},"BatchSwitchoverResp":{"description":"批量主备倒换响应体","properties":{"count":{"description":"总数","format":"int32","type":"integer"},"results":{"description":"批量主备倒换任务返回列表","items":{"$ref":"#/definitions/SwitchoverResp","description":""},"type":"array"}}},"EndpointVO":{"description":"数据库信息","properties":{"az_code":{"description":"可用区azCode。","type":"string"},"cluster_mode":{"description":"集群模式。\n- Single:单节点RDS\n- Ha:主备RDS\n- GR:金融版RDS\n- Sharding:mongodb 集群或DDM的模式,均默认为分片\n- Sharding4.0+:mongodb 集群版本4.0+,默认为不分片\n- ReplicaSet:mongodb 副本集,Replica RDS只读副本\n- ReplicaSingle:mongodb 单节点\n- Cluster:集群\n- Independent:gaussdbv5 independent模式\n- Combined:gaussdbv5 Combined模式\n- Distributed :分布式taurus\n- NoSharding:非集群模式","enum":["Single","Ha","GR","Sharding","Sharding4.0+","ReplicaSet","Replica","ReplicaSingle","Cluster","Independent","Combined","Distributed","NoSharding"],"type":"string"},"created_at":{"description":"创建日期,格式yyyy-MM-dd'T'HH:mm:ss'Z'","type":"string"},"db_name":{"description":"Oracle服务名serviceName。","type":"string"},"db_password":{"description":"数据库密码。","type":"string"},"db_port":{"description":"数据库端口。","format":"int32","type":"integer"},"db_type":{"description":"数据库类型","enum":["mysql","mongodb"],"type":"string"},"db_user":{"description":"数据库用户。","type":"string"},"db_version":{"description":"数据库版本。","type":"string"},"full_trans_user_pwd":{"description":"全量迁移用户密码,密文。","type":"string"},"id":{"description":"数据库id。","type":"string"},"increment_trans_user_pwd":{"description":"增量迁移用户密码,密文。","type":"string"},"instance_id":{"description":"RDS实例id。","type":"string"},"instance_name":{"description":"RDS实例名称。","type":"string"},"ip":{"description":"迁移实例所在的私有IP。","type":"string"},"kerberos_vo":{"$ref":"#/definitions/KerberosVO","description":"kerberos认证需要的信息。"},"manage_ip":{"description":"管理IP。","type":"string"},"mongo_ha_mode":{"description":"mongoHa模式。\n- Sharding 集群\n- ReplicaSet 副本集\n- ReplicaSingle 单节点","enum":["Sharding","ReplicaSet","ReplicaSingle"],"type":"string"},"multi_write_db_id":{"description":"多写数据库Id。","type":"string"},"obj_id":{"description":"对象id。","type":"string"},"project_id":{"description":"RDS实例projectId。","type":"string"},"public_ip":{"description":"迁移实例所在的公网IP。","type":"string"},"region":{"description":"RDS实例所在region。","type":"string"},"safe_mode":{"description":"MRSkafka是否开启kerberos认证\n- 0非安全认证\n- 1安全认证","format":"int32","type":"integer"},"security_group_id":{"description":"源库所在的安全组id。","type":"string"},"ssl_cert_check_sum":{"description":"SSL证书内容checksum值。","type":"string"},"ssl_cert_key":{"description":"SSL证书内容。","type":"string"},"ssl_cert_name":{"description":"SSL证书名字。","type":"string"},"ssl_cert_password":{"description":"SSL证书密码,密文。","type":"string"},"ssl_link":{"description":"是否SSL安全连接。","type":"boolean"},"subnet_id":{"description":"源库所在的子网id。","type":"string"},"topic":{"description":"mrskafka topic名称。","type":"string"},"traffic_ip":{"description":"流量IP。","type":"string"},"updated_at":{"description":"修改日期,格式yyyy-MM-dd'T'HH:mm:ss'Z'","type":"string"},"volume_size":{"description":"迁移实例的磁盘大小。","format":"int64","type":"integer"},"vpc_id":{"description":"源库所在的虚拟私有云id。","type":"string"}},"type":"object"},"KerberosVO":{"description":"kerberos认证需要的信息","properties":{"domain_name":{"description":"域名","type":"string"},"key_tab_file":{"description":"key文件","type":"string"},"krb5_conf_file":{"description":"krb5配置文件","type":"string"},"user_principal":{"description":"Kerberos用户对象","type":"string"}}},"SwitchoverResp":{"description":"主备倒换响应体","properties":{"error_code":{"description":"错误码。","type":"string"},"error_msg":{"description":"错误信息。","type":"string"},"is_target_readonly":{"description":"目标库是否只读。","type":"boolean"},"job_direction":{"description":"任务方向。\n- up 入云 灾备场景时对应本云为备\n- down 出云 灾备场景时对应本云为主\n- non-dbs 自建","enum":["up","down","non-dbs"],"type":"string"},"job_id":{"description":"任务ID","type":"string"},"source_db":{"$ref":"#/definitions/EndpointVO","description":"源数据库。"},"target_db":{"$ref":"#/definitions/EndpointVO","description":"目标数据库。"},"updated_at":{"description":"更新时间,格式yyyy-MM-dd'T'HH:mm:ss'Z'","type":"string"}},"type":"object"}},"description":null,"group_id":"506538835790436b8e209e5a6684d485","host":"drs.cn-north-4.myhuaweicloud.com","id":"7787dd6a360043dfb146d2933413af55","info_version":"v3","method":"post","name":"BatchSwitchover","parameters":{},"paths":{"/v3/{project_id}/jobs/batch-switchover":{"post":{"description":"批量主备倒换。","operationId":"BatchSwitchover","parameters":[{"description":"租户在某一region下的project ID。","in":"path","name":"project_id","required":true,"type":"string","x-order":1},{"description":"从IAM服务获取的用户Token","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-order":2},{"default":"en-us","description":"请求语言类型","enum":["en-us","zh-cn"],"in":"header","name":"X-Language","required":false,"type":"string","x-example":"en-us","x-order":3},{"default":"application/json","description":"指定类型为application/json。","in":"header","name":"Content-Type","required":true,"type":"string","x-example":"application/json","x-order":4},{"description":"批量主备调换的请求体","in":"body","name":"requestBody","required":true,"schema":{"$ref":"#/definitions/BatchSwitchoverReq"},"x-order":5}],"responses":{"200":{"description":"OK","examples":{"application/json":{"count":1,"results":[{"is_target_readonly":false,"job_direction":"down","job_id":"8d0e8e36-a618-490d-8a46-8c61ac9jb502","source_db":{"az_code":"az3xahz","cluster_mode":"Single","created_at":"2020-12-16T12:09:54Z","db_name":null,"db_password":"******","db_port":3306,"db_type":"mysql","db_user":"root","db_version":"5.7.31","full_trans_user_pwd":"******","id":"2706a49b-6dd0-4b70-b2a8-36cf0034703d","increment_trans_user_pwd":"******","instance_id":"3efbb0f1241f429e8e1d8f99ab094c7ain01","instance_name":"rds-zw-source","ip":"192.168.1.144","kerberos_vo":null,"manage_ip":null,"mongo_ha_mode":null,"multi_write_db_id":null,"obj_id":"0b51710fd4e54d6bb90ab91bf68f86efno01","project_id":"054ba152d480d55b2f5dc0069e7ddef0","public_ip":null,"region":"cn-xianhz-1","safe_mode":null,"security_group_id":"652cbe2d-d487-407e-b666-d01948b33879","ssl_cert_check_sum":null,"ssl_cert_key":null,"ssl_cert_name":null,"ssl_cert_password":null,"ssl_link":false,"subnet_id":"c6f66ccb-be7a-499e-aa8a-1389355e67a8","topic":null,"traffic_ip":"192.168.1.144","updated_at":"2020-12-18T06:33:09Z","volume_size":null,"vpc_id":"7c73a425-885b-4e54-a0e6-ef9ee271a1db"},"target_db":{"az_code":"az3xahz","cluster_mode":"Single","created_at":"2020-12-16T12:09:55Z","db_name":null,"db_password":"******","db_port":3306,"db_type":"mysql","db_user":"root","db_version":"5.7.31","full_trans_user_pwd":"******","id":"81ca3c57-029b-4a37-8f2d-2ee5f128ef9d","increment_trans_user_pwd":"******","instance_id":"a3ab61173b1b4533b8c3dfc2bb3ec828in01","instance_name":"rds-zw-target","ip":"192.168.1.60","kerberos_vo":null,"manage_ip":null,"mongo_ha_mode":null,"multi_write_db_id":null,"obj_id":"b46e908dbbb44bb3b17f0a75c908d1d7no01","project_id":"054ba152d480d55b2f5dc0069e7ddef0","public_ip":null,"region":"cn-xianhz-1","safe_mode":null,"security_group_id":"652cbe2d-d487-407e-b666-d01948b33879","ssl_cert_check_sum":null,"ssl_cert_key":null,"ssl_cert_name":null,"ssl_cert_password":null,"ssl_link":false,"subnet_id":"c6f66ccb-be7a-499e-aa8a-1389355e67a8","topic":null,"traffic_ip":"192.168.1.60","updated_at":"2020-12-18T06:33:08Z","volume_size":40,"vpc_id":"7c73a425-885b-4e54-a0e6-ef9ee271a1db"},"updated_at":"2020-12-18T06:38:37Z"}]}},"schema":{"$ref":"#/definitions/BatchSwitchoverResp"}},"400":{"description":"Bad Request"}},"summary":"批量主备倒换","tags":["实时灾备管理"],"x-apiErrorCodes":"[]","x-constraint":"只有状态为灾备中、灾备异常的任务,且与灾备数据库连接正常时可以进行主备倒换,双主灾备不支持倒换。","x-is-registered":"Y","x-name":"批量主备倒换","x-order":25,"x-publishpath":"BatchSwitchover","x-request-examples-1":{"jobs":["8d0e8e36-a618-490d-8a46-8c61ac9jb502"]},"x-request-examples-description-1":"批量主备倒换示例","x-request-examples-text-1":{"jobs":["8d0e8e36-a618-490d-8a46-8c61ac9jb502"]},"x-request-examples-url-1":"https://{EndPoint}/v3/054ba152d480d55b2f5dc0069e7ddef0/jobs/batch-switchover","x-scope":"Commercial","x-support-sdk":"Y","x-version":"v3"}}},"product_short":"DRS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"批量主备倒换","tags":"实时灾备管理","uri":null,"version":"2.0"}