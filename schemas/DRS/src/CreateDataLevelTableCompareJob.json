{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"AddDataTransformationReq":{"description":"数据加工规则","properties":{"object_info":{"description":"对象信息。","items":{"$ref":"#/definitions/CreateDataCompareDatabaseObject"},"type":"array"},"transformation_info":{"$ref":"#/definitions/CreateDataCompareTransformationInfo","description":"数据过滤信息。"}},"required":["object_info","transformation_info"],"type":"object"},"CompareObjectInfo":{"description":"","properties":{"db_name":{"description":"库名。","type":"string"},"table_name":{"description":"该库下的表名列表。","items":{"description":"","type":"string"},"type":"array"}},"required":["db_name"]},"CompareObjectInfoWithToken":{"description":"","properties":{"db_name":{"description":"库名。","type":"string"},"table_name_with_token":{"description":"该库下的表信息列表(带token)。","example":"[{\"table_name\":\"\",\"min_token\":\"\",\"max_token\":\"\"}]","items":{"$ref":"#/definitions/CompareTableInfoWithToken","description":""},"type":"array"}},"required":["db_name"]},"CompareTableInfoWithToken":{"description":"","properties":{"max_token":{"description":"该表的max token。","type":"string"},"min_token":{"description":"该表的min token。","type":"string"},"table_name":{"description":"表名。","type":"string"}},"required":["table_name"]},"CreateDataCompareDatabaseObject":{"description":"数据加工对象信息","properties":{"id":{"description":"两层数据库场景:\n数据库名称和数据库表名称,例如格式为t_auto_db-*-*-users,其中t_auto_db为数据库名称,users为表名称。\n\n三层数据库场景:\n数据库名称、数据库schema名称、数据库表名称,例如格式为t_auto_db-*-*-schema1-*-*-users,其中t_auto_db为数据库名称,schema1为数据库schema名称,users为表名称。","type":"string"}},"type":"object"},"CreateDataCompareJobResp":{"description":"创建表对比任务结果","properties":{"id":{"description":"对比任务ID","type":"string"}},"type":"object"},"CreateDataCompareTransformationInfo":{"description":"数据加工信息。","properties":{"transformation_type":{"description":"加工规则,值为contentConditionalFilter。","type":"string"},"value":{"description":"过滤条件,值为sql条件语句,例如id>100,长度限制256。","type":"string"}},"required":["transformation_type","value"],"type":"object"},"CreateDataLevelTableCompareJobReq":{"description":"创建数据级对比任务请求","properties":{"compare_mode":{"default":"quick_comparison","description":"数据级对比模式,取值为空时需要在compare_object或者compare_object_with_token传对象信息,quick_comparison-快速对比。\n取值:quick_comparison","type":"string"},"compare_object":{"description":"数据级对比的对象。","items":{"$ref":"#/definitions/CompareObjectInfo"},"type":"array"},"compare_object_with_token":{"description":"数据级对比的对象(Cassandra灾备专用,带token信息)。","items":{"$ref":"#/definitions/CompareObjectInfoWithToken"},"type":"array"},"compare_task_num":{"description":"对比任务线程数量,当前仅cloudDataGuard-cassandra和cloudDataGuard-gausscassandra-to-gausscassandra链路支持。","format":"int32","type":"integer"},"compare_transformation_infos":{"description":"过滤数据信息。","items":{"$ref":"#/definitions/AddDataTransformationReq"},"type":"array"},"options":{"additionalProperties":{"type":"string"},"description":"对比配置项,key-value形式。\n内容对比支持以下配置项:\n-\t对比方式配置,key:contentCompareType,value:dynamic表示动态对比,static表示静态对比。\n-\tlob字段对比类型配置,key:lobCompare,value:ignore表示忽略,length表示长度对比。\n\n行数对比支持以下配置项:\n-\t对比策略配置,多表归一情况下适用,key:comparePolicy,value:normal表示正常对比,manyToOne表示多对一对比。","type":"object"},"proportion_value":{"description":"抽样比例,对比类型为抽样对比时填写。","format":"double","type":"number"},"start_time":{"description":"对比任务启动时间,时间戳格式,取值为空代表立即启动。","type":"string"},"type":{"description":"对比类型。\n- lines:行数对比\n- contents:内容对比\n- random:抽样对比,当前仅支持gaussdbv5、gaussdbv5-to-postgresql、gaussdbv5ha-to-postgresql链路。","type":"string"}},"required":["type"],"type":"object"}},"description":null,"group_id":"506538835790436b8e209e5a6684d485","host":"drs.cn-north-4.myhuaweicloud.com","id":"0cd6c543914c431a808727e7b6c25339","info_version":"v3","method":"post","name":"CreateDataLevelTableCompareJob","parameters":{},"paths":{"/v3/{project_id}/jobs/{job_id}/table/compare":{"post":{"description":"创建数据级表对比任务。","operationId":"CreateDataLevelTableCompareJob","parameters":[{"description":"租户在某一Region下的Project ID。","in":"path","name":"project_id","required":true,"type":"string"},{"default":"application/json","description":"指定类型为application/json。","in":"header","name":"Content-Type","required":true,"type":"string"},{"description":"从IAM服务获取的用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"default":"en-us","description":"请求语言类型。","enum":["en-us","zh-cn"],"in":"header","name":"X-Language","required":false,"type":"string"},{"description":"任务ID。","in":"path","name":"job_id","required":true,"type":"string"},{"description":"创建数据级表对比请求体。","in":"body","name":"CreateDataLevelTableCompareJobRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateDataLevelTableCompareJobReq"}}],"responses":{"202":{"description":"OK","examples":{"application/json":{"id":"6a0deb4a-ce39-449b-8c49-e0eed954c155"}},"schema":{"$ref":"#/definitions/CreateDataCompareJobResp"}},"400":{"description":"Bad Request","examples":{"application/json":{"error_code":"DRS.M00202","error_msg":"The value of jobId is invalid."}},"schema":{"type":"string"}}},"summary":"创建数据级表对比任务","tags":["公共接口管理"],"x-is-registered":"Y","x-order":26,"x-request-examples-1":{"compare_object":[{"db_name":"t_auto_db","table_name":[]}],"options":{},"proportion_value":20.1,"type":"random"},"x-request-examples-2":{"compare_object":[{"db_name":"t_auto_db","table_name":[]}],"options":{"contentCompareType":"dynamic"},"start_time":"1809366237000","type":"contents"},"x-request-examples-3":{"compare_object":[],"compare_transformation_infos":[{"object_info":[{"id":"t_auto_db-*-*-test-*-*-users"}],"transformation_info":{"transformationType":"contentConditionalFilter","value":"id>100"}}],"type":"lines"},"x-request-examples-description-1":"创建数据级表抽样对比任务","x-request-examples-description-2":"创建数据级表内容动态对比任务","x-request-examples-description-3":"创建带有数据过滤的行数对比任务。","x-request-examples-text-1":{"compare_object":[{"db_name":"t_auto_db","table_name":[]}],"options":{},"proportion_value":20.1,"type":"random"},"x-request-examples-text-2":{"compare_object":[{"db_name":"t_auto_db","table_name":[]}],"options":{"contentCompareType":"dynamic"},"start_time":"1809366237000","type":"contents"},"x-request-examples-text-3":{"compare_object":[],"compare_transformation_infos":[{"object_info":[{"id":"t_auto_db-*-*-test-*-*-users"}],"transformation_info":{"transformationType":"contentConditionalFilter","value":"id>100"}}],"type":"lines"},"x-request-examples-url-1":"https://{endpoint}/v3/054ba152d480d55b2f5dc0069e7ddef0/jobs/{job_id}/table/compare","x-request-examples-url-2":"https://{endpoint}/v3/054ba152d480d55b2f5dc0069e7ddef0/jobs/{job_id}/table/compare","x-request-examples-url-3":"https://{endpoint}/v3/054ba152d480d55b2f5dc0069e7ddef0/jobs/{job_id}/table/compare","x-support-sdk":"Y"}}},"product_short":"DRS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建数据级表对比任务","tags":"公共接口管理","uri":null,"version":"2.0"}