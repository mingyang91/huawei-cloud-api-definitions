{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"BaseEndpoint":{"description":"数据库基本信息体。","properties":{"db_name":{"description":"指定数据库名称。例如:\n- oracle:serviceName.orcl。","type":"string"},"db_password":{"description":"数据库密码。","example":"******","type":"string"},"db_port":{"description":"数据库端口。\n\n约束:输入范围为1-65535之间的整数。","example":"3306","type":"string"},"db_user":{"description":"数据库用户名。","example":"root","type":"string"},"endpoint_name":{"description":"数据库场景类型。取值:\n- oracle:云下自建Oracle数据库。\n- ecs_oracle:华为云ECS自建Oracle数据库。\n- cloud_gaussdbv5:华为云数据库GaussDB分布式。\n- mysql:他云/本地自建MySQL数据库。\n- ecs_mysql:华为云ECS自建MySQL数据库。\n- cloud_mysql:华为云数据库RDS for MySQL。","enum":["oracle","ecs_oracle","cloud_gaussdbv5","mysql","ecs_mysql","cloud_mysql"],"type":"string"},"id":{"description":"数据库信息ID。","type":"string"},"instance_id":{"description":"华为云数据库实例ID。","type":"string"},"instance_name":{"description":"华为云数据库实例名称。","type":"string"},"ip":{"description":"数据库IP。\n约束:\n- 数据库为自建MongoDB时,数据库IP与端口之间用“:”英文冒号拼接,多个值之间请用“,”英文逗号隔开,最多支持填写3个IP地址或域名。\n- 数据库为DDS实例时,数据库IP与端口之间用“:”英文冒号拼接,多个IP端口之间请用“,”英文逗号分隔。\n示例:\n- MySQL:192.168.0.10\n- MongoDB:192.168.0.10:8080,192.168.0.11:8080,192.168.0.12:8080\n- DDS:192.168.205.130:8635,192.168.250.64:8635","example":"MySQL:192.168.0.10;MongoDB:192.168.0.10:8080,192.168.0.11:8080,192.168.0.12:8080;DDS:192.168.205.130:8635,192.168.250.64:8635;","type":"string"},"source_sharding":{"description":"物理源库信息。","items":{"$ref":"#/definitions/BaseEndpoint"},"type":"array"}},"required":["endpoint_name","db_user","db_password"],"type":"object"},"BaseEndpointConfig":{"description":"数据库基本设置信息体,当源库或者目标库在特定场景下需要额外设置时填写。例如:\n- 实时迁移入云场景:云数据库(RDS for MySQL)、云数据库 GaussDB(for MySQL) 主备版作为目标库(target_endpoint)时,需要设置“只读”或者“读写”(is_target_readonly)。\n- 实时迁移入云场景:分布式数据库中间件DDM作为目标库,源库为MySQL分库分表时,需要设置“端数据库实例个数”。\n- 实时迁移入云场景:MongoDB作为源库时,需要设置“源数据库实例类型”为非集群、集群或者集群(MongoDB 4.0+),并且实例类型为“集群”时,还需要设置“源端分片个数”(source_shard_num)。\n- 实时灾备场景:单主灾备且本云为备时,云数据库(RDS for MySQL)、云数据库 GaussDB(for MySQL) 主备版、分布式数据库中间件DDM、文档数据库服务DDS等作为目标库(target_endpoint)时,需要设置“只读”或者“读写”(is_target_readonly)。\n- 实时灾备场景:云数据库GaussDB(for Cassandra) 灾备时,需要设置“是否迁移TTL”,如果参数为true时,还需要设置TTL列名。","properties":{"is_target_readonly":{"default":true,"description":"目标实例是否设置为为只读。\n- MySQL迁移和灾备,且job_direction为up时设置有效。(灾备场景下,单主灾备且本云为备为必填且为true,不填默认设置为true)。","type":"boolean"}},"type":"object"},"CloudBaseInfo":{"description":"数据库实例所在Region,项目等信息,当数据库实例类型为ecs(华为云ECS自建数据库),cloud(华为云数据库)时为必填项。","properties":{"az_code":{"description":"数据库所在可用分区(AZ)名称。","example":"cn-north-4a:华北-北京四-可用区1","type":"string"},"project_id":{"description":"租户在某一Region下的Project ID。 获取方法请参见获取项目ID。","example":"054ba152d480d55b2f5dc0069e7ddef0","type":"string"},"region":{"description":"区域ID,当数据库实例类型为ecs(华为云ECS自建数据库),cloud(华为云数据库)时为必填项。获取方法请参见地区和终端节点。\n注意:当该Region下存在子项目时,Region ID为区域项目ID与子项目ID,由“_”下划线拼接,例如:cn-north-4_abc。","example":"cn-north-4:华北-北京四,cn-east-3:华东-上海一,cn-south-1:华南-广州","type":"string"}},"required":["region","project_id"]},"CloudVpcInfo":{"description":"数据库实例所在VPC,子网,安全组等信息,当数据库实例类型为ecs(华为云ECS自建数据库),cloud(华为云数据库)时为必填项。","properties":{"security_group_id":{"description":"数据库实例所在的安全组ID,获取方法如下:\n方法1:登录虚拟私有云服务的控制台界面,在安全组的详情页面查找安全组ID。\n方法2:通过虚拟私有云服务的API接口查询,具体操作可参考查询安全组列表。","example":"2a1f7fc8-3307-42a7-aa6f-42c8b9b8f8c5","type":"string"},"subnet_id":{"description":"数据库实例所在子网ID,获取方法如下:\n方法1:登录虚拟私有云服务的控制台界面,单击VPC下的子网,进入子网详情页面,查找网络ID。\n方法2:通过虚拟私有云服务的API接口查询,具体操作可参考查询子网列表。","example":"54886391-4bf0-443a-8145-e2bfacfdf5ca","type":"string"},"vpc_id":{"description":"数据库实例所在的虚拟私有云ID,获取方法如下:\n方法1:登录虚拟私有云服务的控制台界面,在虚拟私有云的详情页面查找VPC ID。\n方法2:通过虚拟私有云服务的API接口查询,具体操作可参考查询VPC列表。","example":"ab155e40-35f2-4463-b22b-c67a56e2fbb9","type":"string"}},"required":["vpc_id","subnet_id"]},"CreateJobReq":{"description":"创建单个任务请求体。","properties":{"base_info":{"$ref":"#/definitions/JobBaseInfo","description":"创建任务基本信息体。"},"node_info":{"$ref":"#/definitions/JobNodeInfo","description":"创建任务实例信息体。"},"period_order":{"$ref":"#/definitions/PeriodOrderInfo","description":"包年/包月信息体。"},"source_endpoint":{"description":"创建任务数据库信息体。","items":{"$ref":"#/definitions/JobEndpointInfo"},"type":"array"},"target_endpoint":{"description":"创建任务数据库信息体。","items":{"$ref":"#/definitions/JobEndpointInfo"},"type":"array"}},"required":["base_info","source_endpoint","target_endpoint","node_info"],"type":"object"},"CreateJobResp":{"description":"创建任务响应体。","properties":{"create_time":{"description":"任务创建时间。","type":"string"},"id":{"description":"任务ID。","type":"string"},"is_clone_job":{"description":"是否为克隆任务。","type":"string"},"name":{"description":"任务名称。","type":"string"},"status":{"description":"任务状态。","type":"string"}},"required":["id","name","status","create_time"],"type":"object"},"EndpointSslConfig":{"description":"数据库SSL证书信息体。如果数据库启用了SSL安全连接,请确保相关配置正确,并输入SSL证书相关参数,否则无需填写此参数。","properties":{"ssl_cert_check_sum":{"description":"SSL证书内容checksum值,后端校验,源库安全连接必选。","type":"string"},"ssl_cert_key":{"description":"SSL证书内容,用base64加密。","type":"string"},"ssl_cert_name":{"description":"SSL证书名字。","type":"string"},"ssl_cert_password":{"description":"SSL证书密码,证书文件后缀为.p12时必填。","type":"string"},"ssl_link":{"description":"是否SSL安全连接。如果数据库启用了SSL安全连接,参数值为true。","type":"boolean"}},"type":"object"},"ErrorResp":{"description":"请求失败时返回的错误对象响应体。","properties":{"error_code":{"description":"错误码。","example":"DRS.00000000","maxLength":12,"minLength":12,"type":"string"},"error_msg":{"description":"错误描述。","example":"Success","maxLength":512,"minLength":1,"type":"string"}},"required":["error_code","error_msg"],"type":"object"},"JobBaseInfo":{"description":"创建任务基本信息体。","properties":{"charging_mode":{"description":"计费模式,默认按需。取值:\n- period:包周期。\n- on_demand:按需。","enum":["period","on_demand"],"type":"string"},"description":{"description":"任务描述。\n约束:任务描述不能超过256位,且不能包含!<>&'\"\\特殊字符。","maxLength":256,"minLength":0,"type":"string"},"engine_type":{"description":"引擎类型。取值:\n- oracle-to-gaussdbv5:Oracle同步到GaussDB分布式版,实时同步场景使用。","enum":["oracle-to-gaussdbv5"],"type":"string"},"enterprise_project_id":{"default":"0","description":"企业项目ID。\n缺省值:\"0\",表示\"default\"企业项目。","type":"string"},"expired_days":{"default":"14","description":"任务处于异常状态一段时间后,将会自动结束。单位为天。(范围14-100),不传默认为14天。","example":"14","type":"string"},"job_direction":{"description":"迁移方向。取值:\n- up:入云 ,灾备场景时对应本云为备。\n- down:出云,灾备场景时对应本云为主。\n- non-dbs:自建。","enum":["up","down","non-dbs"],"type":"string"},"job_type":{"description":"任务场景。取值:\n- migration:实时迁移。\n- sync:实时同步。\n- cloudDataGuard:实时灾备。","enum":["migration","sync","cloudDataGuard"],"type":"string"},"multi_write":{"description":"灾备类型是否双主灾备。说明:\n- job_type 是cloudDataGuard时,必填,灾备类型是双主灾备时,multi_write取值true, 否则为false。\n- job_type 是其他类型时,multi_write是非必选参数。","example":"","type":"boolean"},"name":{"description":"任务名称。\n约束:任务名称在4位到50位之间,不区分大小写,可以包含字母、数字、中划线或下划线,不能包括其他特殊字符。\n- 最小长度:4\n- 最大长度:50","example":"DRS-0001","maxLength":50,"minLength":4,"type":"string"},"net_type":{"description":"网络类型。取值:\n- eip:公网网络。\n- vpc:VPC网络,灾备场景不支持选择VPC网络。\n- vpn:VPN、专线网络。","enum":["eip","vpc","vpn"],"example":"","type":"string"},"start_time":{"description":"任务定时启动时间。","type":"string"},"tags":{"description":"标签信息,最多添加10个标签。","example":[{"key":"1","value":"a"},{"key":"2","value":"b"}],"items":{"$ref":"#/definitions/ResourceTag"},"type":"array"},"task_type":{"description":"迁移模式。取值:\n- FULL_TRANS :全量。\n- FULL_INCR_TRANS:全量+增量。\n- INCR_TRANS:增量。","enum":["FULL_TRANS","FULL_INCR_TRANS","INCR_TRANS"],"type":"string"}},"type":"object"},"JobEndpointInfo":{"description":"创建任务数据库信息体。","properties":{"cloud":{"$ref":"#/definitions/CloudBaseInfo","description":"数据库实例所在Region,项目等信息。"},"config":{"$ref":"#/definitions/BaseEndpointConfig","description":"数据库基本设置信息体。"},"db_type":{"description":"数据库类型。取值: \n- oracle:Oracle。\n- gaussdbv5:GaussDB分布式版。","enum":["oracle","gaussdbv5"],"example":"oracle","type":"string"},"endpoint":{"$ref":"#/definitions/BaseEndpoint","description":"数据库基本信息体。"},"endpoint_role":{"description":"数据库实例角色。取值:\n- so:源库。\n- ta:目标库。","enum":["so","ta"],"type":"string"},"endpoint_type":{"description":"数据库实例类型。取值: \n- offline:自建数据库。\n- ecs:华为云ECS自建数据库。\n- cloud:华为云数据库。","enum":["offline","ecs","cloud"],"type":"string"},"ssl":{"$ref":"#/definitions/EndpointSslConfig","description":"数据库SSL证书信息体。"},"vpc":{"$ref":"#/definitions/CloudVpcInfo","description":"数据库实例所在VPC,子网,安全组等信息。"}},"required":["db_type","endpoint_type","endpoint_role","endpoint"],"type":"object"},"JobNodeBaseInfo":{"description":"任务实例基本信息体。","properties":{"arch":{"description":"CPU架构。取值:\n- x86\n- arm","enum":["x86","arm"],"type":"string"},"availability_zone":{"description":"可用区ID。\n约束:对于任务实例类型不是单机的实例,需要分别为实例所有节点指定可用区,并用“,”英文逗号隔开。示例:\n- 实例类型为single:\"cn-north-4a\"\n- 实例类型为ha:\"cn-north-4a,cn-north-4b\"","type":"string"},"instance_type":{"description":"实例类型。取值:\n- single:单机。\n- ha:主备。","enum":["single","ha"],"type":"string"},"role":{"description":"任务主备角色。","type":"string"},"status":{"description":"状态。","type":"string"}},"required":["instance_type","arch","availability_zone"],"type":"object"},"JobNodeInfo":{"description":"任务实例信息体。","properties":{"base_info":{"$ref":"#/definitions/JobNodeBaseInfo","description":"任务实例基本信息。"},"spec":{"$ref":"#/definitions/JobNodeSpecInfo","description":"任务实例规格信息体。"},"vpc":{"$ref":"#/definitions/JobNodeVpcInfo","description":"任务实例VPC信息体,自建任务必填。"}},"required":["spec"],"type":"object"},"JobNodeSpecInfo":{"description":"任务实例规格信息体。","properties":{"node_type":{"description":"实例规格编码。取值:\n- micro:极小规格。\n- small:小规格。\n- medium:中规格。\n- high:大规格。","enum":["micro","small","medium","high"],"type":"string"}},"required":["node_type"],"type":"object"},"JobNodeVpcInfo":{"description":"任务实例VPC信息体。","properties":{"custom_node_ip":{"description":"指定创建任务实例IP地址,多个IP端口之间请用“,”英文逗号分隔,目前仅支持设置IPv4地址,获取方法如下:\n- 方法1:登录虚拟私有云服务的控制台界面,单击VPC下的子网,进入子网详情页面,查找子网的网段,选择未被占用的IP 。\n- 方法2:通过虚拟私有云服务的API接口查询,具体操作可参考查询私有IP列表,选择“device_owner”为空的私有IP。\n示例:\n\"192.168.0.10,192.168.0.11\"","example":"\"192.168.0.10,192.168.0.11\"","type":"string"},"security_group_id":{"description":"任务实例所在的安全组ID。","example":"2a1f7fc8-3307-42a7-aa6f-42c8b9b8f8c5","type":"string"},"subnet_id":{"description":"任务实例所在子网ID。","example":"54886391-4bf0-443a-8145-e2bfacfdf5ca","type":"string"},"vpc_id":{"description":"任务实例所在虚拟私有云ID。","example":"ab155e40-35f2-4463-b22b-c67a56e2fbb9","type":"string"}},"required":["vpc_id","subnet_id"],"type":"object"},"PeriodOrderInfo":{"description":"包年/包月信息体。","properties":{"is_auto_renew":{"default":0,"description":"是否自动续订。取值:\n- 0:否(默认值,需要客户手动去支付)。\n- 1:是(自动支付)。","enum":[0,1],"format":"int32","type":"integer"},"period_num":{"description":"订购周期数。根据period_type取值不同,代表不同周期数,例如:\n- 当period_type为2时,period_num为1代表1月。\n- 当period_type为3时,period_num为1代表1年。","format":"int32","type":"integer"},"period_type":{"default":3,"description":"订购周期类型。取值:\n- 2:月。\n- 3:年。","enum":[2,3],"format":"int32","type":"integer"}},"required":["period_type","period_num"],"type":"object"},"ResourceTag":{"description":"标签信息体。","properties":{"key":{"description":"标签键。\n约束:最大长度36,只能包含字母、数字、下划线、中划线和中文。","maxLength":36,"minLength":1,"type":"string"},"value":{"description":"标签值。\n约束:最大长度43,只能包含字母、数字、下划线、中划线和中文。","maxLength":43,"minLength":1,"type":"string"}},"type":"object"},"SingleCreateJobReq":{"description":"创建单个任务请求体。","properties":{"job":{"$ref":"#/definitions/CreateJobReq","description":"创建单个任务请求体。"}},"required":["job"],"type":"object"},"SingleCreateJobResp":{"description":"创建单个任务响应体。","properties":{"job":{"$ref":"#/definitions/CreateJobResp","description":"创建任务响应体。"}},"required":["job"],"type":"object"}},"description":null,"group_id":"506538835790436b8e209e5a6684d485","host":"drs.cn-north-4.myhuaweicloud.com","id":"a7fdf097809d41f68d0c2aa5e7683318","info_version":"v5","method":"post","name":"CreateJob","parameters":{},"paths":{"/v5/{project_id}/jobs":{"post":{"consumes":["application/json"],"description":"创建单个任务,根据请求参数不同,可以创建单个实时迁移、实时同步、实时灾备等任务。","operationId":"CreateJob","parameters":[{"description":"租户在某一Region下的Project ID。\n获取方法请参见[获取项目ID。](https://support.huaweicloud.com/api-drs/drs_api_0106.html)","in":"path","name":"project_id","required":true,"type":"string"},{"default":"application/json","description":"发送的实体的MIME类型。推荐用户默认使用application/json,如果API是对象、镜像上传等接口,媒体类型可按照流类型的不同进行确定。","in":"header","name":"Content-Type","required":true,"type":"string"},{"description":"从IAM服务获取的用户Token。\n\n用户Token也就是调用获取用户Token接口的响应值,该接口是唯一不需要认证的接口。\n\n请求响应成功后在响应消息头中包含的“X-Subject-Token”的值即为Token值。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"default":"en-us","description":"请求语言类型。","enum":["en-us","zh-cn"],"in":"header","name":"X-Language","required":false,"type":"string"},{"description":"创建单个任务请求体。","in":"body","name":"requestBody","required":true,"schema":{"$ref":"#/definitions/SingleCreateJobReq"}}],"produces":["application/json"],"responses":{"200":{"description":"OK","examples":{"application/json":{"job":{"create_time":"2022-11-07T16:15:18Z","id":"c7debc9c-8e09-4a5d-8dd6-cc44f78jb20r","name":"DRS-1234","status":"CREATING"}}},"schema":{"$ref":"#/definitions/SingleCreateJobResp"}},"400":{"description":"Bad Request","examples":{"application/json":{"error_code":"DRS.10000001","error_msg":"Failed."}},"schema":{"$ref":"#/definitions/ErrorResp"}}},"summary":"创建任务","tags":["实例管理"],"x-is-registered":"Y","x-order":1,"x-request-examples-1":{"job":{"base_info":{"charging_mode":"on_demand","description":"","engine_type":"oracle-to-gaussdbv5","enterprise_project_id":"0","expired_days":"14","job_direction":"up","job_type":"sync","name":"DRS-1234","net_type":"eip","tags":[{"key":"test","value":"test"}],"task_type":"FULL_INCR_TRANS"},"node_info":{"spec":{"node_type":"medium"},"vpc":{"subnet_id":"2cb54324-ae63-4fbb-85b7-7d59f4a88f8f","vpc_id":"2cb5d364-ae63-4fbb-85b7-7d59f4a88f8f"}},"source_endpoint":[{"db_type":"oracle","endpoint":{"db_name":"serviceName.orcl","db_password":"******","db_port":"1521","db_user":"ORACLE_USER","endpoint_name":"oracle","ip":"10.154.217.239"},"endpoint_role":"so","endpoint_type":"offline","ssl":{"ssl_link":false}}],"target_endpoint":[{"cloud":{"az_code":"cn-north-4a,cn-north-4c,cn-north-4g","project_id":"9dc8c0f3f74c4dbb23c29cf0318ee561","region":"cn-north-4"},"db_type":"gaussdbv5","endpoint":{"db_password":"******","db_user":"root","endpoint_name":"cloud_gaussdbv5","instance_id":"c2c7579bc09c490b9d8009db715aeb0ain14"},"endpoint_role":"ta","endpoint_type":"cloud","vpc":{"security_group_id":"039a3s89-665a-43e2-9b4f-bda7d9ee148d","subnet_id":"2cb54324-ae63-4fbb-85b7-7d59f4a88f8f","vpc_id":"2cb5d364-ae63-4fbb-85b7-7d59f4a88f8f"}}]}},"x-request-examples-description-1":"创建Oracle到GaussDB分布式版按需实时同步任务请求示例。","x-request-examples-text-1":{"job":{"base_info":{"charging_mode":"on_demand","description":"","engine_type":"oracle-to-gaussdbv5","enterprise_project_id":"0","expired_days":"14","job_direction":"up","job_type":"sync","name":"DRS-1234","net_type":"eip","tags":[{"key":"test","value":"test"}],"task_type":"FULL_INCR_TRANS"},"node_info":{"spec":{"node_type":"medium"},"vpc":{"subnet_id":"2cb54324-ae63-4fbb-85b7-7d59f4a88f8f","vpc_id":"2cb5d364-ae63-4fbb-85b7-7d59f4a88f8f"}},"source_endpoint":[{"db_type":"oracle","endpoint":{"db_name":"serviceName.orcl","db_password":"******","db_port":"1521","db_user":"ORACLE_USER","endpoint_name":"oracle","ip":"10.154.217.239"},"endpoint_role":"so","endpoint_type":"offline","ssl":{"ssl_link":false}}],"target_endpoint":[{"cloud":{"az_code":"cn-north-4a,cn-north-4c,cn-north-4g","project_id":"9dc8c0f3f74c4dbb23c29cf0318ee561","region":"cn-north-4"},"db_type":"gaussdbv5","endpoint":{"db_password":"******","db_user":"root","endpoint_name":"cloud_gaussdbv5","instance_id":"c2c7579bc09c490b9d8009db715aeb0ain14"},"endpoint_role":"ta","endpoint_type":"cloud","vpc":{"security_group_id":"039a3s89-665a-43e2-9b4f-bda7d9ee148d","subnet_id":"2cb54324-ae63-4fbb-85b7-7d59f4a88f8f","vpc_id":"2cb5d364-ae63-4fbb-85b7-7d59f4a88f8f"}}]}},"x-request-examples-url-1":"https://{Endpoint}/v5/054ba152d480d55b2f5dc0069e7ddef0/jobs","x-support-sdk":"Y"}}},"product_short":"DRS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建任务","tags":"实例管理","uri":null,"version":"2.0"}