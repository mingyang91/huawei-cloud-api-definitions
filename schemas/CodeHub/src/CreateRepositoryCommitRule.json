{"base_path":null,"components":{"parameters":{"X-Auth-Token":{"description":"**参数解释:**\n用户Token。 通过调用IAM服务[获取用户Token](https://support.huaweicloud.com/api-iam/iam_30_0001.html)接口获取(响应消息头中X-Subject-Token的值)。\n **约束限制:**\n必传。\n **取值范围:**\n字符串长度不少于1,不超过10万。\n**默认取值:**\n不涉及。","explode":false,"in":"header","name":"X-Auth-Token","required":true,"schema":{"maxLength":100000,"minLength":1,"type":"string"},"style":"simple"},"repository_id":{"description":"**参数解释:**\n仓库的ID,通过[查询用户所有仓库](https://support.huaweicloud.com/api-codeartsrepo/ListUserAllRepositories.html)接口查询项目列表获取。\n**约束限制:**\n不涉及。","explode":false,"in":"path","name":"repository_id","required":true,"schema":{"maximum":2147483647,"minimum":1,"type":"integer"},"style":"simple"}},"schemas":{"CommitRuleCreateBodyDto":{"properties":{"allowed_binary_file_name_regex":{"description":"**参数解释:**\n二进制文件白名单(可直接入库的文件)。\n所有被推送的二进制文件名必须进行正则表达式匹配, 例如: (\\.png|\\.xls|\\.xlsx|\\.docx|\\.doc)$ 。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":2000,"minLength":1,"type":"string"},"allowed_modify_binary":{"description":"**参数解释:**\n允许修改二进制文件(对特权用户无效)。\n**约束限制:**\n不涉及。\n**取值范围:**\n- true,允许修改二进制文件。\n- false,禁止修改二进制文件。\n**默认取值:**\n不涉及。","type":"boolean"},"author_email_regex":{"description":"**参数解释:**\n提交人邮箱地址的正则表达式。\n所有提交者邮箱地址都必须进行正则表达式匹配, 例如: @my-company.com$。如果此字段为空,则允许任何提交邮箱地址。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":200,"minLength":1,"type":"string"},"author_regex":{"description":"**参数解释:**\n提交人的正则表达式。\n提交人必须进行正则表达式匹配, 例如: /([a-zA-Z]\\d){7}/。如果此字段为空,则允许任何提交人。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":200,"minLength":1,"type":"string"},"binary_gate_enabled":{"description":"**参数解释:**\n禁止新增二进制文件(对特权用户无效)。\n**约束限制:**\n不涉及。\n**取值范围:**\n- true,禁止新增二进制文件。\n- false,允许新增二进制文件。\n**默认取值:**\n不涉及。","type":"boolean"},"branch_name":{"description":"**参数解释:**\n分支规则。\n**约束限制:**\n必填。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":500,"minLength":1,"type":"string"},"commit_message_negative_regex":{"description":"**参数解释:**\n提交信息负面匹配规则。\n所有提交消息都必须进行正则表达式匹配,例如: \\d+\\..*。 符合正则匹配,则不允许提交。若此字段为空,则允许任何提交消息。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":500,"minLength":1,"type":"string"},"commit_message_regex":{"description":"**参数解释:**\n提交信息匹配规则。\n所有提交消息都必须进行正则表达式匹配, 例如: \\d+\\..*。 若符合正则匹配,则允许提交。若此字段为空,则允许任何提交消息。 您也可以设置在提交信息中必须包含工作项单号,实现代码的E2E追溯。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":500,"minLength":1,"type":"string"},"effective_date":{"description":"**参数解释:**\n规则生效时间, 例如: 2025-8-19。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"},"max_file_size":{"description":"**参数解释:**\n单文件大小限制(MB)。\n单文件大小超过上述规格的添加或更新推送将被拒绝,Repo建议的最佳上限值为50MB。 系统支持单文件提交的最大值为300MB。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n50","format":"int32","maximum":300,"minimum":1,"type":"integer"},"name":{"description":"**参数解释:**\n规则名称。\n**约束限制:**\n必填。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":200,"minLength":1,"type":"string"},"privileged_user_ids":{"description":"**参数解释:**\n特权用户ID列表(特权用户可直接推送所有二进制文件入库。\n只有特权用户能推送二进制文件。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","items":{"maximum":2147483647,"minimum":1,"type":"integer"},"maxItems":50,"minItems":0,"type":"array"},"prohibited_file_name_regex":{"description":"**参数解释:**\n禁止提交的文件名称的正则表达式。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":2000,"minLength":1,"type":"string"},"skip_rule_check":{"description":"**参数解释:**\n跳过规则检测。\n**约束限制:**\n仅CR仓库支持此参数。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","type":"boolean"},"skip_rule_end_date":{"description":"**参数解释:**\n跳过规则检测失效时间, 例如: 2025-8-19 10:00:00。\n**约束限制:**\n仅CR仓库支持此参数。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"}},"required":["branch_name","name"],"type":"object"},"CommitRuleDto":{"properties":{"allowed_binary_file_name_regex":{"description":"**参数解释:**\n二进制文件白名单(可直接入库的文件)。","maxLength":2000,"minLength":0,"type":"string"},"allowed_max_file_size":{"description":"**参数解释:**\n允许的最大单文件大小(MB)。","format":"int32","maximum":300,"minimum":0,"type":"integer"},"allowed_modify_binary":{"description":"**参数解释:**\n是否允许修改二进制文件(对特权用户无效)。\n**约束限制:**\n不涉及。\n**取值范围:**\n- true,允许修改二进制文件。\n- false,禁止修改二进制文件。","type":"boolean"},"author_email_regex":{"description":"**参数解释:**\n提交人邮箱地址。","maxLength":255,"minLength":1,"type":"string"},"author_regex":{"description":"**参数解释:**\n提交人。"},"binary_gate_enabled":{"description":"**参数解释:**\n是否禁止新增二进制文件(对特权用户无效)。\n**约束限制:**\n不涉及。\n**取值范围:**\n- true,禁止新增二进制文件。\n- false,允许新增二进制文件。","type":"boolean"},"branch_name":{"description":"**参数解释:**\n分支规则。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"},"commit_message_negative_regex":{"description":"**参数解释:**\n提交信息负面匹配规则。","maxLength":255,"minLength":1,"type":"string"},"commit_message_regex":{"description":"**参数解释:**\n提交信息匹配规则。","maxLength":255,"minLength":1,"type":"string"},"created_at":{"description":"**参数解释:**\n创建时间。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","format":"yyyy-MM-dd'T'HH:mm:ss.SSSXXX","type":"string"},"effective_date":{"description":"**参数解释:**\n规则生效时间。","format":"yyyy-MM-dd'T'HH:mm:ss.SSSXXX","type":"string"},"id":{"description":"**参数解释:**\n主键ID。\n**取值范围:**\n不涉及。","format":"int32","maximum":2147483647,"minimum":1,"type":"integer"},"max_file_size":{"description":"**参数解释:**\n单文件大小限制(MB)。","format":"int32","maximum":300,"minimum":0,"type":"integer"},"name":{"description":"**参数解释:**\n规则名称。\n**约束限制:**\n不涉及。\n**取值范围:**\n不涉及。\n**默认取值:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"},"privileged_users":{"description":"**参数解释:**\n特权用户(特权用户可直接推送所有二进制文件入库)。","items":{"$ref":"#/components/schemas/RepositoryUserBasicDto"},"maxItems":100,"minItems":0,"type":"array"},"prohibited_file_name_regex":{"description":"**参数解释:**\n禁止提交的文件名称。","maxLength":2000,"minLength":1,"type":"string"},"repository_id":{"description":"**参数解释:**\n仓库ID。\n**取值范围:**\n不涉及。","format":"int32","maximum":2147483647,"minimum":1,"type":"integer"},"skip_rule_check":{"description":"**参数解释:**\n跳过规则检测。\n**约束限制:**\n仅CR仓库支持此参数。","type":"boolean"},"skip_rule_end_date":{"description":"**参数解释:**\n跳过规则检测失效时间, 例如: 2025-8-19。\n**约束限制:**\n仅CR仓库支持此参数。","maxLength":255,"minLength":1,"type":"string"},"updated_at":{"description":"**参数解释:**\n更新时间。","format":"yyyy-MM-dd'T'HH:mm:ss.SSSXXX","type":"string"}},"type":"object"},"RepositoryUserBasicDto":{"properties":{"id":{"description":"**参数解释:**\n 用户id\n**约束限制:**\n不涉及。","format":"int32","maximum":2147483647,"minimum":1,"type":"integer"},"name":{"description":"**参数解释:**\n 用户名称\n**约束限制:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"},"name_cn":{"description":"**参数解释:**\n 用户中文名称\n**约束限制:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"},"nick_name":{"description":"**参数解释:**\n 用户昵称\n**约束限制:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"},"service_license_status":{"description":"**参数解释:**\n 服务级权限状态 0:停用 1:启用\n**约束限制:**\n不涉及。","maximum":2147483647,"minimum":1,"type":"integer"},"state":{"description":"**参数解释:**\n用户状态。\n**取值范围:**\n- active,激活。\n- blocked,禁用。","enum":["active","blocked"],"type":"string"},"tenant_name":{"description":"**参数解释:**\n 租户名称\n**约束限制:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"},"username":{"description":"**参数解释:**\n 用户名\n**约束限制:**\n不涉及。","maxLength":255,"minLength":1,"type":"string"}},"type":"object"}}},"consumes":"","definitions":null,"description":null,"group_id":"183513bb7aa84dab9d17c9bc8a4a9fab","host":"codehub-ext.cn-north-4.myhuaweicloud.com","id":"b9089431e2bc44fca30208bf055ce6c0","info_version":"v4","method":"post","name":"CreateRepositoryCommitRule","parameters":null,"paths":{"/v4/repositories/{repository_id}/commit-rules":{"post":{"description":"创建仓库提交规则","operationId":"CreateRepositoryCommitRule","parameters":[{"$ref":"#/components/parameters/X-Auth-Token"},{"$ref":"#/components/parameters/repository_id"}],"requestBody":{"content":{"application/json":{"example":{"allowed_modify_binary":true,"binary_gate_enabled":true,"branch_name":"mas1*","deny_force_push":false,"effective_date":null,"max_file_size":50,"name":"fffffff2233","prevent_secrets":false,"privileged_user_ids":[9124],"reject_unsigned_commits":false},"schema":{"$ref":"#/components/schemas/CommitRuleCreateBodyDto"}}},"description":"仓库通用提交规则","required":true},"responses":{"200":{"content":{"application/json":{"example":{"allowed_binary_file_name_regex":"test","allowed_max_file_size":300,"allowed_modify_binary":true,"author_email_regex":"test","author_regex":"test","binary_gate_enabled":true,"branch_name":"2","commit_message_negative_regex":"test","commit_message_regex":"test","created_at":"2025-06-20T17:37:55.000+08:00","effective_date":"2025-01-14T20:13:56.000+08:00","id":169352,"max_file_size":50,"name":"2","privileged_users":[{"id":9124,"name":"test_user","name_cn":"test_user","nick_name":"beta_dv","service_license_status":null,"state":"active","tenant_name":"test_tenant","username":"test_user"}],"prohibited_file_name_regex":"test","repository_id":2112035798,"updated_at":"2025-06-20T17:37:55.000+08:00"},"schema":{"$ref":"#/components/schemas/CommitRuleDto"}}},"description":"仓库提交规则"}},"summary":"创建仓库提交规则","tags":["Repository"],"x-api-framework":"RestfulAPI","x-api-highrisk":"N","x-api-position":"Region_ZONE","x-api-type":"open-api","x-api-user":"IAM_User","x-is-registered":"Y","x-open-region-cloud":"hws,hws_hk","x-request-examples-1":{"allowed_modify_binary":true,"binary_gate_enabled":true,"branch_name":"mas1*","max_file_size":50,"name":"fffffff2233","privileged_user_ids":[9124]},"x-request-examples-description-1":"创建仓库提交规则","x-request-examples-text-1":{"allowed_modify_binary":true,"binary_gate_enabled":true,"branch_name":"mas1*","max_file_size":50,"name":"fffffff2233","privileged_user_ids":[9124]},"x-request-examples-url-1":"POST /v4/repositories/{repository_id}/commit-rules","x-sec-auditlog":"N","x-sec-upload-download":0,"x-support-sdk":"Y"}}},"product_short":"CodeHub","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建仓库提交规则","tags":"Repository","uri":null,"version":"3.0.1"}