{"base_path":"/","components":null,"consumes":"","definitions":{"ConditionInfo":{"description":"剧本触发规则详情","properties":{"conditions":{"description":"触发条件。事件触发剧本必填","items":{"$ref":"#/definitions/ConditionItem"},"maxItems":99,"minItems":0,"type":"array"},"cron":{"description":"Cron 表达式(定时任务)。定时触发剧本必填","example":"*/5 * * * * ?","maxLength":64,"minLength":0,"type":"string"},"end_time":{"description":"定时结束时间。定时触发剧本必填","example":"2021-01-30T23:00:00Z+0800","maxLength":64,"minLength":0,"type":"string"},"end_type":{"description":"剧本结束执行类型,FOREVER--一直执行, CUSTOM--自定义结束时间。定时触发剧本必填","example":"FOREVER","maxLength":64,"minLength":0,"type":"string"},"execution_type":{"description":"执行队列类型(PARALLEL-新任务与之前任务并行)。定时触发剧本必填","example":"PARALLEL","maxLength":64,"minLength":0,"type":"string"},"expression_type":{"description":"表达式类型。默认为common,事件触发剧本必填","example":"common","maxLength":64,"minLength":0,"type":"string"},"logics":{"description":"条件逻辑组合。事件触发剧本必填","example":"['logic1', 'and', ['logic2', 'or', 'logic3'], 'or', 'logic4']","items":{"description":"表达式类型。默认为common,事件触发剧本必填","example":"condition_0","maxLength":64,"minLength":0,"type":"string"},"maxItems":99,"minItems":0,"type":"array"},"only_once":{"description":"是否只执行一次。定时触发剧本必填","example":false,"type":"boolean"},"repeat_range":{"description":"执行时间段 2021-01-30T23:00:00Z+0800。定时触发剧本必填","example":"2021-01-30T23:00:00Z+0800~2021-01-30T23:00:00Z+0800","maxLength":64,"minLength":0,"type":"string"},"schedule_type":{"description":"定时重复类型(second--秒, hour--小时,day--天,week-周)。定时触发剧本必填","example":"second","maxLength":64,"minLength":0,"type":"string"},"start_type":{"description":"剧本开始执行类型,IMMEDIATELY--创建完成立即执行, CUSTOM--自定义执行时间。定时触发剧本必填","example":"IMMEDIATELY","maxLength":64,"minLength":0,"type":"string"}}},"ConditionItem":{"description":"条件定义","properties":{"data":{"description":"条件表达式数据","example":"['waf.alarm.level', '>', '3']","items":{"maxLength":2048,"minLength":0,"type":"string"},"maxItems":99,"minItems":0,"type":"array"},"detail":{"description":"条件详情","example":"Funcion : XXX","maxLength":1028,"minLength":0,"type":"string"},"name":{"description":"条件名称","example":"logic1","maxLength":64,"minLength":0,"type":"string"}}},"CreateRuleInfo":{"description":"创建剧本触发规则参数","example":{"rule":{"conditions":[{"data":["waf.alarm.level', '>', '3"],"detail":"Funcion : XXX","name":"logic1"}],"cron":"*/5 * * * * ?","expression_type":"all","logics":{"['logic1', 'and', ['logic2', 'or', 'logic3'], 'or', 'logic4']":null},"repeat_count":"1","repeat_range":"2021-01-30T23:00:00Z+0800~2021-01-30T23:00:00Z+0800","schedule_type":"second"}},"properties":{"rule":{"$ref":"#/definitions/ConditionInfo"}},"required":["rule"]},"ErrorRsp":{"description":"请求失败错误响应体","properties":{"code":{"description":"错误码","example":"SecMaster.20040001","maxLength":64,"minLength":0,"type":"string"},"message":{"description":"错误描述","example":"Parameter error.","maxLength":1024,"minLength":0,"type":"string"}}},"RuleInfo":{"description":"剧本触发规格信息","properties":{"id":{"description":"规则ID","example":"909494e3-558e-46b6-a9eb-07a8e18ca62f","maxLength":64,"minLength":32,"type":"string"},"project_id":{"description":"项目ID","example":"909494e3-558e-46b6-a9eb-07a8e18ca62f","maxLength":64,"minLength":32,"type":"string"},"rule":{"description":"触发规则","example":"{\"expression_type\":\"common\",\"conditions\":[{\"name\":\"condition_0\",\"data\":[\"ref_order_id\",\"==\",\"id23\"],\"detail\":\"id23\"}],\"logics\":[\"condition_0\"]}","maxLength":128,"minLength":0,"type":"string"}}},"RuleInfoResp":{"description":"response of rule info","example":{"code":0,"data":{"id":"909494e3-558e-46b6-a9eb-07a8e18ca62f","project_id":"909494e3-558e-46b6-a9eb-07a8e18ca62f","rule":{"cron":"0 0 0/5 * * ?","end_type":"FOREVER","execution_type":"SERIAL_WAIT","only_once":false,"schedule_type":"REPEAT:hour","start_time":"2023-07-25T15:33:29.490Z+0800","start_type":"IMMEDIATELY"}},"message":"Error message"},"properties":{"code":{"description":"错误码","example":0,"maxLength":32,"minLength":1,"readOnly":true,"type":"string"},"data":{"$ref":"#/definitions/RuleInfo"},"message":{"description":"错误信息","example":"Error message","maxLength":32,"minLength":1,"readOnly":true,"type":"string"}}}},"description":null,"group_id":"705709df764d40488141daec53da8672","host":"sa.myhuaweicloud.com","id":"eb21d1db97b44494a55145ec5419e143","info_version":"v2","method":"post","name":"CreatePlaybookRule","parameters":{},"paths":{"/v1/{project_id}/workspaces/{workspace_id}/soc/playbooks/versions/{version_id}/rules":{"post":{"description":"创建剧本规则","operationId":"CreatePlaybookRule","parameters":[{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","maxLength":2097152,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX..."},{"default":"application/json;charset=UTF-8","description":"application/json;charset=UTF-8","in":"header","maxLength":64,"minLength":1,"name":"content-type","required":true,"type":"string"},{"description":"项目ID","in":"path","maxLength":36,"minLength":32,"name":"project_id","required":true,"type":"string"},{"description":"工作空间ID","in":"path","maxLength":36,"minLength":32,"name":"workspace_id","required":true,"type":"string"},{"description":"剧本版本ID","in":"path","maxLength":64,"minLength":32,"name":"version_id","required":true,"type":"string"},{"description":"创建剧本触发规则请求参数","in":"body","name":"CreatePlaybookRuleRequestBody","required":false,"schema":{"$ref":"#/definitions/CreateRuleInfo"}}],"produces":["application/json"],"responses":{"200":{"description":"请求成功响应信息","examples":{"application/json":{"code":0,"data":{"id":"909494e3-558e-46b6-a9eb-07a8e18ca62f","project_id":"909494e3-558e-46b6-a9eb-07a8e18ca62f","rule":"{\"expression_type\":\"common\",\"conditions\":[{\"name\":\"condition_0\",\"data\":[\"ref_order_id\",\"==\",\"123\"],\"detail\":\"123\"}],\"logics\":[\"condition_0\"]}"},"message":""}},"headers":{"X-request-id":{"description":"请求ID,格式为:request_uuid-timestamp-hostname","type":"string"}},"schema":{"$ref":"#/definitions/RuleInfoResp"}},"400":{"description":"请求失败响应信息","headers":{"X-request-id":{"description":"请求ID,格式为:request_uuid-timestamp-hostname","type":"string"}},"schema":{"$ref":"#/definitions/ErrorRsp"}}},"summary":"创建剧本规则","tags":["剧本规则管理(安全云脑)"],"x-is-registered":"N","x-order":2,"x-request-examples-1":{"rule":{"conditions":[{"data":["waf.alarm.level', '>', '3"],"detail":"123","name":"condition_0"}],"expression_type":"common","logics":["condition_0"]}},"x-request-examples-description-1":"创建一条剧本规则,名称为logic1,表达式类型为所有,","x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"SecMaster","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建剧本规则","tags":"剧本规则管理(安全云脑)","uri":null,"version":"2.0"}