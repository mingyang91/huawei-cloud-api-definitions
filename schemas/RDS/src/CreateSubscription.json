{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"CreateSubscription4InstanceInfo":{"description":"直接创建订阅时需要的参数。","properties":{"publication_id":{"description":"直接创建订阅时,服务器来源为云上实例的发布id。","type":"string"},"publication_name":{"description":"直接创建订阅时,服务器来源为云上实例的发布名称。","type":"string"}},"required":["publication_id"],"type":"object"},"CreateSubscription4PublicationInfo":{"description":"给发布创建订阅时需要的参数。","properties":{"subscription_instance_id":{"description":"订阅服务器来源为云上实例时的订阅实例id。","type":"string"},"user_info":{"$ref":"#/definitions/ReplicationUserInfo","description":"订阅服务器为非云上实例时的登录信息(仅当订阅实例id为空时生效)。"}},"required":["subscription_instance_id"],"type":"object"},"CreateSubscriptionInfo":{"description":"订阅详情","properties":{"bak_bucket_name":{"description":"备份文件所在的obs桶名。\n若bak_file_name为空,该参数无效。\n若该值为空,则备份文件来源为rds的备份文件。\n若该值不为空,则备份文件来源为用户obs桶。","type":"string"},"bak_file_name":{"description":"备份文件名称。若该值不为空,则订阅初始化方式为通过备份文件初始化。","type":"string"},"independent_agent":{"default":true,"description":"独立的分发代理。\n\ntrue:使用。\nfalse:不使用。","type":"boolean"},"initialize_at":{"description":"初始化类型:不初始化(do_not)、立即初始化(immediate)、首次同步初始化(at_first_sync)。","type":"string"},"initialize_info":{"description":"初始化信息。","properties":{"backup_id":{"description":"使用备份文件初始化的备份文件ID。","type":"string"},"bucket_name":{"description":"使用OBS内备份文件恢复的bucket名称。","type":"string"},"file_name":{"description":"OBS桶内备份文件的名称。","type":"string"},"file_path":{"description":"OBS桶内备份文件的路径。","type":"string"},"file_source":{"description":"初始化使用的文件源,仅支持OBS或BACKUP。","type":"string"},"overwrite_restore":{"description":"是否使用备份文件对订阅库进行覆盖还原。","type":"boolean"}}},"job_schedule":{"$ref":"#/definitions/OperateUsedJobSchedule","description":"同步策略。"},"local_subscription":{"$ref":"#/definitions/CreateSubscription4InstanceInfo","description":"本地订阅信息。创建本地订阅时必传。"},"publication_subscription":{"$ref":"#/definitions/CreateSubscription4PublicationInfo","description":"发布的订阅信息。给发布创建订阅时必传。"},"subscription_database":{"description":"订阅数据库名。","type":"string"},"subscription_type":{"description":"订阅方式,push:推送。","type":"string"}},"required":["subscription_database","subscription_type","initialize_at","job_schedule"],"type":"object"},"CreateSubscriptionRequestBody":{"description":"创建发布详情。","properties":{"current_publication_id":{"description":"给发布创建订阅时的发布id。给发布创建订阅时必传,不传时则为创建本地订阅。","type":"string"},"subscriptions":{"description":"订阅详情。一次最多创建十个订阅。","items":{"$ref":"#/definitions/CreateSubscriptionInfo"},"type":"array"}},"required":["subscriptions"],"type":"object"},"ErrorResponse":{"properties":{"error_code":{"description":"错误码。","example":"DBS.200022","type":"string"},"error_msg":{"description":"错误消息。","example":"实例名称已存在。","type":"string"}},"required":["error_code","error_msg"]},"JobScheduleDailyFrequencyInfo":{"description":"策略每日频率。","properties":{"active_end_time":{"description":"最后一次执行时间。每日执行多次时该参数必传,每日执行一次时不生效。 HH:mm:ss","example":"23:59:59","type":"string"},"active_start_time":{"description":"每日第一次执行时间。每日频率类型为每日一次时,则只执行这一次。 HH:mm:ss","example":"01:00:59","type":"string"},"freq_interval_unit":{"description":"执行间隔的单位。每日执行多次时该参数必传,每日执行一次时不生效。 second:秒, minute:分, hour:时","example":"minute","type":"string"},"freq_subday_interval":{"description":"执行间隔。每日执行多次时该参数必传,每日执行一次时不生效。取值范围1至99","example":"10","type":"integer"},"freq_subday_type":{"description":"每日频率类型 once:每日一次, multiple:每日多次。","example":"once","type":"string"}}},"JobScheduleDurationInfo":{"description":"策略有效期。","properties":{"active_end_date":{"description":"最后一次执行日期。默认不会结束 yyyy-MM-dd","example":"2099-12-31","type":"string"},"active_start_date":{"description":"第一次执行日期 yyyy-MM-dd。取值范围1990-01-01至2099-12-31","example":"2023-01-01","type":"string"}}},"JobScheduleFrequencyInfo":{"description":"策略间隔周期。","properties":{"freq_interval":{"description":"执行间隔。取值范围1至99。","example":"5","type":"integer"},"freq_interval_day_monthly":{"description":"频率类型为按月、每月按天时该参数必传,不为按月、每月按天时时不生效。\n每月执行的日期。取值范围1-31。","example":"31","type":"integer"},"freq_interval_monthly":{"description":"频率类型为按月、每月按周时该参数必传,不为按月、每月按周时时不生效。\n每周执行哪几天。 Sunday, Monday,Tuesday ... Saturday, day, weekday, weekend","example":"weekday","type":"string"},"freq_interval_weekly":{"description":"频率类型为按周时该参数必传,不为按周时不生效。\n每周执行哪几天。参数值:Monday,Tuesday ... Sunday","items":{"example":"Monday","type":"string"},"type":"array"},"freq_relative_interval_monthly":{"description":"频率类型为按月、每月按周时该参数必传,不为按月、每月按周时时不生效。\n每月在哪周执行。 first, second, third, fourth, last","example":"fourth","type":"string"},"freq_type":{"description":"策略频率类型 daily:按天, weekly:按周, monthly_day:按月、每月按天, monthly_week:按月、每月按周。","example":"daily","type":"string"}}},"JobScheduleOneTimeOccurrenceInfo":{"description":"执行一次执行时间。","properties":{"active_start_date":{"description":"执行日期 yyyy-MM-dd。取值范围1990-01-01至2099-12-31","example":"2023-01-01","type":"string"},"active_start_time":{"description":"执行时间。HH:mm:ss","example":"01:00:59","type":"string"}}},"OperateUsedJobSchedule":{"description":"策略信息。","properties":{"daily_frequency":{"$ref":"#/definitions/JobScheduleDailyFrequencyInfo","description":"策略每日频率(仅当策略id为空时必填)。"},"duration":{"$ref":"#/definitions/JobScheduleDurationInfo","description":"策略有效期(仅当策略id为空时必填)。"},"frequency":{"$ref":"#/definitions/JobScheduleFrequencyInfo","description":"策略间隔周期(仅当策略id为空时必填)。"},"id":{"description":"策略id。","example":"7be09cc4-c269-4f3a-9539-aaf2b40d79a0","type":"string"},"job_schedule_type":{"description":"计划类型。默认值recurring。\n\nautomatically:SQL Server代理启动时自动启动。\ncpu_idle:CPU空闲时启动。\nrecurring:重复执行。\none_time:执行一次。","type":"string"},"one_time_occurrence":{"$ref":"#/definitions/JobScheduleOneTimeOccurrenceInfo","description":"执行一次执行时间。"}},"required":["job_schedule_type"]},"ReplicationJobResponse":{"properties":{"job_id":{"description":"任务id。","example":"7be09cc4-c269-4f3a-9539-aaf2b40d79a0","type":"string"}},"required":["job_id"],"type":"object"},"ReplicationUserInfo":{"description":"发布订阅用户登录信息。","properties":{"login_user_name":{"description":"登录名。","example":"rdsuser","type":"string"},"login_user_password":{"description":"登录密码。要求密码长度在5~64位之间。","example":"password","type":"string"},"server_ip":{"description":"服务器ip。","example":"192.168.0.1","type":"string"},"server_name":{"description":"服务器名称。","example":"MSSQL-DAF72D40\\MSSQL2017STD","type":"string"},"server_port":{"description":"端口号。","example":"1433","type":"integer"}},"required":["server_ip","server_port","server_name","login_user_name","login_user_password"]}},"description":null,"group_id":"b7735f867ef44182af9eb77490a46fbf","host":"rds.cn-north-4.myhuaweicloud.com","id":"4677fb1f944a491bbeb2a6bac198b50d","info_version":"v3","method":"post","name":"CreateSubscription","parameters":{},"paths":{"/v3/{project_id}/instances/{instance_id}/replication/subscriptions":{"post":{"description":"创建订阅","operationId":"CreateSubscription","parameters":[{"description":"项目ID","in":"path","name":"project_id","required":true,"type":"string"},{"description":"用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"语言。默认en-us。","in":"header","name":"X-Language","required":false,"type":"string"},{"description":"实例ID","in":"path","name":"instance_id","required":true,"type":"string"},{"description":"创建订阅请求体。","in":"body","name":"CreateSubscriptionRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateSubscriptionRequestBody"}}],"produces":["application/json"],"responses":{"200":{"description":"success","examples":{"application/json":{"job_id":"7be09cc4-c269-4f3a-9539-aaf2b40d79a0"}},"schema":{"$ref":"#/definitions/ReplicationJobResponse"}},"default":{"description":"error","schema":{"$ref":"#/definitions/ErrorResponse"}}},"summary":"创建订阅","tags":["发布订阅(SQL Server)"],"x-file":20250222,"x-is-registered":"Y","x-request-examples-text-1":{"current_publication_id":"37af1c72-af84-460c-bf93-be6913e4ad1b","subscriptions":[{"job_schedule":{"daily_frequency":{"active_start_time":"02:00:00","freq_subday_type":"once"},"duration":{"active_end_date":"2099-12-31","active_start_date":"1970-01-02"},"frequency":{"freq_interval":1,"freq_type":"daily"},"id":"8c01f1e3-3e09-4d2d-a5d9-8f754fc0277f"},"publication_subscription":{"subscription_instance_id":"d2bd5708ad624988a54e02fd5fa0c705in04"},"subscription_database":"sub_database","subscription_type":"push"},{"job_schedule":{"daily_frequency":{"active_start_time":"02:00:00","freq_subday_type":"once"},"duration":{"active_end_date":"2099-12-31","active_start_date":"1970-01-02"},"frequency":{"freq_interval":1,"freq_type":"daily"},"id":"8c01f1e3-3e09-4d2d-a5d9-8f754fc0277f"},"publication_subscription":{"user_info":{"login_user_name":"my_user","login_user_password":"my_password","server_ip":"192.168.0.1","server_name":"local-instance-0102","server_port":"1433"}},"subscription_database":"sub_local_database","subscription_type":"push"}]},"x-request-examples-text-2":{"subscriptions":[{"job_schedule":{"daily_frequency":{"active_start_time":"02:00:00","freq_subday_type":"once"},"duration":{"active_end_date":"2099-12-31","active_start_date":"1970-01-02"},"frequency":{"freq_interval":1,"freq_type":"daily"},"id":"8c01f1e3-3e09-4d2d-a5d9-8f754fc0277f"},"local_subscription":{"publication_id":"37af1c72-af84-460c-bf93-be6913e4ad1b"},"subscription_database":"sub_database","subscription_type":"push"}]},"x-request-examples-url-1":"POST https://{endpoint}/v3/0483b6b16e954cb88930a360d2c4e663/instances/1aa833000a124455a6801e83cca37e6ein04/replication/subscriptions","x-request-examples-url-2":"POST https://{endpoint}/v3/0483b6b16e954cb88930a360d2c4e663/instances/d2bd5708ad624988a54e02fd5fa0c705in04/replication/subscriptions","x-support-sdk":"Y"}}},"product_short":"RDS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建订阅","tags":"发布订阅(SQL Server)","uri":null,"version":"2.0"}