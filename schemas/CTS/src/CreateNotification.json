{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"CreateNotificationRequestBody":{"description":"创建通知规则的请求体","properties":{"filter":{"$ref":"#/definitions/Filter","description":"关键操作通知高级过滤条件。"},"notification_name":{"description":"标识关键操作名称。","maxLength":64,"minLength":1,"type":"string"},"notify_user_list":{"$ref":"#/definitions/NotificationUserList"},"operation_type":{"description":"标识操作类型。\n目前支持的操作类型有完整类型(complete)和自定义类型(customized)。\n完整类型下,CTS发送通知的对象为已对接服务的所有事件,此时不用指定operations和notify_user_list字段。\n自定义类型下,CTS发送通知的对象是在operations列表中指定的事件。","enum":["complete","customized"],"type":"string"},"operations":{"$ref":"#/definitions/OperationsList"},"topic_id":{"description":"消息通知服务的topic_urn或者函数工作流的func_urn。\n- 消息通知服务的topic_urn可以通过消息通知服务的查询主题列表API获取,示例:urn:smn:regionId:f96188c7ccaf4ffba0c9aa149ab2bd57:test_topic_v2。\n- 函数工作流的func_urn可以通过函数工作流的获取函数列表API获取,示例:urn:fss:xxxxxxxxx:7aad83af3e8d42e99ac194e8419e2c9b:function:default:test。","maxLength":400,"minLength":0,"type":"string"}},"required":["notification_name","operation_type"]},"CreateNotificationResponseBody":{"properties":{"create_time":{"description":"通知规则创建时间。","example":1587958482923,"format":"int64","maximum":4102416000000,"minimum":946656000000,"type":"integer"},"filter":{"$ref":"#/definitions/Filter","description":"关键操作通知高级筛选条件。"},"notification_id":{"description":"通知的唯一标识ID。","maxLength":40,"minLength":1,"type":"string"},"notification_name":{"description":"通知名称。","maxLength":64,"minLength":1,"type":"string"},"notification_type":{"description":"通知类型,消息通知,函数触发器。","enum":["smn","fun"],"type":"string"},"notify_user_list":{"$ref":"#/definitions/NotificationUserList"},"operation_type":{"description":"操作类型,完整和自定义。","enum":["customized","complete"],"type":"string"},"operations":{"$ref":"#/definitions/OperationsList"},"project_id":{"description":"项目ID。","maxLength":32,"minLength":32,"type":"string"},"status":{"description":"通知状态,启用和停用。","enum":["enabled","disabled"],"type":"string"},"topic_id":{"description":"消息通知服务(SMN)主题的唯一的资源标识,可通过查询主题列表获取该标识。","maxLength":400,"minLength":1,"type":"string"}},"required":["notification_name","operation_type","notification_type","project_id"]},"FailedRsp":{"description":"失败时的返回对象。","properties":{"error_code":{"description":"错误码标识,CTS.XXX。","example":"CTS.0214","maxLength":15,"minLength":15,"type":"string"},"error_msg":{"description":"错误描述。","example":"The tracker does not exist.","maxLength":2048,"minLength":0,"type":"string"}},"required":["error_code","error_msg"]},"Filter":{"description":"关键操作通知高级筛选条件。","properties":{"condition":{"description":"多条件关系。\n- AND 表示所有过滤条件满足后生效。\n- OR 表示有任意一个条件满足时生效。","enum":["AND","OR"],"type":"string"},"is_support_filter":{"description":"是否打开高级筛选开关。","type":"boolean"},"rule":{"description":"高级过滤条件规则,示例如下:\"key != value\",格式为:字段 规则 值。\n-字段取值范围:api_version,code,trace_rating,trace_type,resource_id,resource_name。\n-规则:!= 或 =。\n- 值:api_version正则约束:^(a-zA-Z0-9_-.){1,64}$;code:最小长度1,最大长度256;trace_rating枚举值:\"normal\", \"warning\", \"incident\";trace_type枚举值:\"ConsoleAction\", \"ApiCall\", \"SystemAction\";resource_id:最小长度1,最大长度350;resource_name:最小长度1,最大长度256","example":"[“trace_rating != normal\", \"resource_id = xxx\"]","items":{"type":"string"},"type":"array"}},"required":["condition","is_support_filter","rule"]},"NotificationUserList":{"description":"通知用户列表,目前最多支持对10个用户组和50个用户发起的操作进行配置。","items":{"$ref":"#/definitions/NotificationUsers"},"type":"array"},"NotificationUsers":{"description":"通知用户列表。","properties":{"user_group":{"description":"IAM用户组。","maxLength":64,"minLength":1,"type":"string"},"user_list":{"description":"IAM用户。","items":{"type":"string"},"maxItems":32,"minItems":1,"type":"array"}},"required":["user_group","user_list"]},"Operations":{"description":"操作事件列表,目前最多支持对100服务的1000个关键操作进行配置。","properties":{"resource_type":{"description":"标识资源类型。","maxLength":64,"minLength":1,"type":"string"},"service_type":{"description":"标识云服务类型。必须为已对接CTS的云服务的英文缩写,且服务类型一般为大写字母。\n已对接的云服务列表参见《云审计服务用户指南》“支持的服务”章节。","maxLength":64,"minLength":1,"type":"string"},"trace_names":{"description":"标识事件名称。","items":{"type":"string"},"maxItems":64,"minItems":1,"type":"array"}},"required":["service_type","resource_type","trace_names"]},"OperationsList":{"description":"操作事件列表。","items":{"$ref":"#/definitions/Operations"},"type":"array"}},"description":null,"group_id":"fb21f09f03c44339a10d3ee7b60da942","host":"cts.cn-north-4.myhuaweicloud.com","id":"66729596395549e8872d95a193e8019a","info_version":"v3","method":"post","name":"CreateNotification","parameters":{},"paths":{"/v3/{project_id}/notifications":{"post":{"description":"配置关键操作通知,可在发生特定操作时,使用预先创建好的SMN主题,向用户手机、邮箱发送消息,也可直接发送http/https消息。常用于实时感知高危操作、触发特定操作或对接用户自有审计分析系统。","operationId":"CreateNotification","parameters":[{"description":"项目ID,参见《云审计服务API参考》“获取账号ID和项目ID”章节。","in":"path","maxLength":32,"minLength":32,"name":"project_id","required":true,"type":"string"},{"description":"创建通知请求体","in":"body","name":"CreateNotificationRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateNotificationRequestBody"}}],"responses":{"201":{"description":"创建成功。","examples":{"application/json":{"create_time":1634001495876,"notification_id":"cda8fd83-d08c-46f0-b914-1453a6a85c00","notification_name":"keyOperate_info_cfwy","notification_type":"smn","notify_user_list":[{"user_group":"admin","user_list":["test1","test2"]},{"user_group":"CTS view","user_list":["test3","test4"]}],"operation_type":"customized","operations":[{"resource_type":"tracker","service_type":"CTS","trace_names":["createTracker","deleteTraceker"]},{"resource_type":"notification","service_type":"CTS","trace_names":["deleteNotification","updateNotification"]},{"resource_type":"pe","service_type":"AOM","trace_names":["deletePolicyGroup","updatePolicyGroup","createPolicyGroup"]}],"project_id":"24edf66e79d04187acb99a463e610764","status":"enabled","topic_id":"urn:smn:{regionid}:24edf66e79d04187acb99a463e610764:test"}},"schema":{"$ref":"#/definitions/CreateNotificationResponseBody"}},"400":{"description":"服务器未能处理请求。","schema":{"$ref":"#/definitions/FailedRsp"}},"401":{"description":"请求鉴权校验失败,访问被拒绝。"},"403":{"description":"请求权限校验失败,访问被禁止。"},"404":{"description":"服务器无法找到被请求的资源或部分关键操作通知删除失败。"},"500":{"description":"服务内部异常,请求未完成;或部分追踪器删除失败。"},"503":{"description":"被请求的服务无效。建议直接修改该请求,不要重试该请求。"}},"summary":"创建关键操作通知","tags":["关键操作通知管理"],"x-is-registered":"Y","x-open-region-cloud":"hk,hc","x-publishpath":"cts_api_0312","x-request-examples-1":{"filter":{"condition":"OR","is_support_filter":true,"rule":["code != 200","api_version = v1.0","trace_rating = normal","trace_type != ApiCall","resource_id = xxx","resource_name = xxx"]},"notification_name":"test","operation_type":"complete","topic_id":"urn:smn:{regionid}:24edf66e79d04187acb99a463e610764:test"},"x-request-examples-2":{"filter":{"condition":"OR","is_support_filter":true,"rule":["code != 200","api_version = v1.0","trace_rating = normal","trace_type != ApiCall","resource_id = xxx","resource_name = xxx"]},"notification_name":"keyOperate_info_cfwy","notify_user_list":[{"user_group":"admin","user_list":["test1","test2"]},{"user_group":"CTS view","user_list":["test3","test4"]}],"operation_type":"customized","operations":[{"resource_type":"tracker","service_type":"CTS","trace_names":["createTracker","deleteTraceker"]},{"resource_type":"notification","service_type":"CTS","trace_names":["deleteNotification","updateNotification"]},{"resource_type":"pe","service_type":"AOM","trace_names":["deletePolicyGroup","updatePolicyGroup","createPolicyGroup"]}],"topic_id":"urn:smn:{regionid}:24edf66e79d04187acb99a463e610764:test"},"x-request-examples-description-1":"创建完整类型关键操作通知请求样例。","x-request-examples-description-2":"创建自定义类型关键操作通知请求样例。","x-request-examples-text-1":{"filter":{"condition":"OR","is_support_filter":true,"rule":["code != 200","api_version = v1.0","trace_rating = normal","trace_type != ApiCall","resource_id = xxx","resource_name = xxx"]},"notification_name":"test","operation_type":"complete","topic_id":"urn:smn:{regionid}:24edf66e79d04187acb99a463e610764:test"},"x-request-examples-text-2":{"filter":{"condition":"OR","is_support_filter":true,"rule":["code != 200","api_version = v1.0","trace_rating = normal","trace_type != ApiCall","resource_id = xxx","resource_name = xxx"]},"notification_name":"keyOperate_info_cfwy","notify_user_list":[{"user_group":"admin","user_list":["test1","test2"]},{"user_group":"CTS view","user_list":["test3","test4"]}],"operation_type":"customized","operations":[{"resource_type":"tracker","service_type":"CTS","trace_names":["createTracker","deleteTraceker"]},{"resource_type":"notification","service_type":"CTS","trace_names":["deleteNotification","updateNotification"]},{"resource_type":"pe","service_type":"AOM","trace_names":["deletePolicyGroup","updatePolicyGroup","createPolicyGroup"]}],"topic_id":"urn:smn:{regionid}:24edf66e79d04187acb99a463e610764:test"},"x-request-examples-url-1":"POST  https://{endpoint}/v3/{project_id}/notifications","x-request-examples-url-2":"POST  https://{endpoint}/v3/{project_id}/notifications","x-support-sdk":"Y"}}},"product_short":"CTS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建关键操作通知","tags":"关键操作通知管理","uri":null,"version":"2.0"}