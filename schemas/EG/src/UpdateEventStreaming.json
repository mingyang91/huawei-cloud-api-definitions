{"base_path":"/","components":null,"consumes":"","definitions":{"BatchWindow":{"properties":{"count":{"description":"批量推送条数[1,10000]","example":500,"type":"integer"},"interval":{"description":"批量推送间隔[0,15],单位秒","format":"int32","type":"integer"},"time":{"description":"重试次数","example":10,"type":"integer"}},"type":"object"},"EventStreamingCreateReq":{"properties":{"description":{"description":"事件流描述","example":"this is a test eventstreaming","maxLength":255,"type":"string"},"name":{"description":"事件流名称,租户下唯一,由字母、数字、点、下划线和中划线组成,必须字母或数字开头","example":"test-eventstreaming","maxLength":128,"minLength":1,"type":"string"},"option":{"$ref":"#/definitions/RunOption"},"rule_config":{"description":"事件规则,包括过滤规则和转换规则","properties":{"filter":{"description":"过滤规则","type":"object"},"transform":{"$ref":"#/definitions/TransForm","description":"转换规则"}}},"sink":{"$ref":"#/definitions/EventStreamingSink"},"source":{"$ref":"#/definitions/EventStreamingSource"}},"required":["name","source","sink"],"type":"object"},"EventStreamingInfo":{"properties":{"eventStreamingID":{"description":"事件流ID","example":"23709d68-54d5-423b-a6be-03302e893152","type":"string"}},"type":"object"},"EventStreamingSink":{"description":"事件目标,一个事件流中只有一个事件目标,sink_fg、sink_kafka值能选择其中一个参数","properties":{"name":{"description":"事件目标类型名称","enum":["HC.FunctionGraph","HC.Kafka"],"type":"string"},"sink_fg":{"$ref":"#/definitions/SinkFGParameters"},"sink_kafka":{"$ref":"#/definitions/SinkKafkaParameters"},"sink_obs":{"$ref":"#/definitions/SinkObsParameters"}},"type":"object"},"EventStreamingSource":{"description":"事件源,一个事件流中事件源只有一个","properties":{"name":{"description":"事件源类型名称","enum":["HC.DMS_ROCKETMQ","HC.COMMUNITY_ROCKETMQ","HC.Kafka"],"type":"string"},"source_community_rocketmq":{"$ref":"#/definitions/SourceCommunityMQParameters"},"source_dms_rocketmq":{"$ref":"#/definitions/SourceDMSMQParameters"},"source_kafka":{"$ref":"#/definitions/SourceKafkaMQParameters"},"source_mobile_rocketmq":{"$ref":"#/definitions/SourceMobileMQParameters"}},"type":"object"},"EventStreamingUpdateReq":{"allOf":[{"$ref":"#/definitions/EventStreamingCreateReq"}]},"RunOption":{"properties":{"batch_window":{"$ref":"#/definitions/BatchWindow","description":"批量推送"},"thread_num":{"description":"并发数","example":"3","format":"int32","type":"integer"}},"type":"object"},"SinkFGParameters":{"properties":{"agency":{"description":"租户委托","type":"string"},"invoke_type":{"description":"函数执行方式,同步/异步","enum":["SYNC,ASYNC"],"example":"SYNC/ASYNC","type":"string"},"urn":{"description":"函数链接","example":"String","maxLength":512,"minLength":1,"type":"string"}},"type":"object"},"SinkKafkaParameters":{"properties":{"connectionId":{"description":"目标连接id","type":"string"},"keyTransform":{"description":"key的转换规则","items":{"$ref":"#/definitions/TransForm"},"type":"array"},"topic":{"description":"topic名称","type":"string"}},"required":["topic","connectionId"],"type":"object"},"SinkObsParameters":{"properties":{"access_key":{"description":"AK","maxLength":64,"minLength":1,"type":"string"},"obs_bucket":{"description":"桶","type":"string"},"obs_path":{"description":"转储目录","maxLength":256,"minLength":1,"type":"string"},"secret_key":{"description":"SK","type":"string"},"time_format":{"description":"时间目录格式","enum":["yyyy","yyyy/MM","yyyy/MM/dd","yyyy/MM/dd/HH","yyyy/MM/dd/HH/mm"],"type":"string"}},"required":["access_key","secret_key","obs_bucket","time_format"],"type":"object"},"SourceCommunityMQParameters":{"properties":{"access_key":{"description":"用户名","maxLength":128,"type":"string"},"addr":{"description":"rockectMq连接地址","example":"10.10.10.10:8100","type":"string"},"consume_timeout":{"default":30000,"description":"消费超时时间","format":"int32","maximum":900000,"minimum":1000,"type":"integer"},"consumer_batch_max_size":{"default":1,"description":"批量消费最大消息数","format":"int32","maximum":32,"minimum":1,"type":"integer"},"consumer_thread_nums":{"default":20,"description":"线程消费数","format":"int32","maximum":64,"minimum":20,"type":"integer"},"enable_acl":{"description":"ACL访问控制","type":"boolean"},"group":{"description":"消费组","example":"group-test","maxLength":64,"minLength":3,"type":"string"},"instance_id":{"description":"实例ID,仅dms的rockectMq需要该字段","example":"instance-id-test","maxLength":128,"type":"string"},"instance_name":{"description":"实例名称,仅dms的rockectMq需要该字段","example":"instance-name-test","maxLength":128,"type":"string"},"max_reconsume_times":{"default":-1,"description":"最大重试次数,-1表示一直重试","format":"int32","minimum":-1,"type":"integer"},"message_type":{"description":"消息类型","enum":["normal"],"type":"string"},"secret_key":{"description":"密码","type":"string"},"ssl_enable":{"description":"开启SSL","type":"boolean"},"subnet_id":{"description":"子网id","maxLength":256,"type":"string"},"suspend_current_queue_time_millis":{"default":1000,"description":"重试间隔,单位ms","format":"int32","maximum":30000,"minimum":20,"type":"integer"},"tag":{"description":"标签","maxLength":128,"type":"string"},"topic":{"description":"topic名称","example":"topic-test","maxLength":128,"minLength":3,"type":"string"},"vpc_id":{"description":"虚拟云id","maxLength":256,"type":"string"}},"required":["addr","group","topic","vpc_id","subnet_id"],"type":"object"},"SourceDMSMQParameters":{"properties":{"access_key":{"description":"用户名","maxLength":128,"type":"string"},"consume_timeout":{"default":30000,"description":"消费超时时间","format":"int32","maximum":900000,"minimum":1000,"type":"integer"},"consumer_batch_max_size":{"default":1,"description":"批量消费最大消息数","format":"int32","maximum":32,"minimum":1,"type":"integer"},"consumer_thread_nums":{"default":20,"description":"线程消费数","format":"int32","maximum":64,"minimum":20,"type":"integer"},"enable_acl":{"description":"ACL访问控制","type":"boolean"},"engine_version":{"description":"mq实例版本","enum":["4.x","5.x"],"type":"string"},"group":{"description":"消费组","example":"group-test","maxLength":64,"minLength":3,"type":"string"},"instance_id":{"description":"实例ID,仅dms的rockectMq需要该字段","example":"instance-id-test","maxLength":128,"type":"string"},"instance_name":{"description":"实例名称,仅dms的rockectMq需要该字段","example":"instance-name-test","maxLength":128,"type":"string"},"max_reconsume_times":{"default":-1,"description":"最大重试次数,-1表示一直重试","format":"int32","minimum":-1,"type":"integer"},"message_type":{"description":"消费方式,针对不同生产顺序消息类型,选择消费方式会导致不同结果,请严格按照需求选择消费方式。1、生产顺序为:设置消息组,保证消息顺序发送。消费方式为:顺序消费,实际消息处理结果:按照消息组粒度,严格保证消息顺序。 同一消息组内的消息的消费顺序和发送顺序完全一致。2、生产顺序为:设置消息组,保证消息顺序发送。消费方式为:并发消费,实际消息处理结果:并发消费,尽可能按时间顺序处理。3、生产顺序为:未设置消息组,消息乱序发送。消费方式为:顺序消费,实际消息处理结果:按队列存储粒度,严格顺序。 基于 Apache RocketMQ 本身队列的属性,消费顺序和队列存储的顺序一致,但不保证和发送顺序一致。4、生产顺序为:未设置消息组,消息乱序发送。消费方式为:并发消费,实际消息处理结果:并发消费,尽可能按照时间顺序处理。","enum":["NORMAL","ORDER"],"type":"string"},"secret_key":{"description":"密码","type":"string"},"ssl_enable":{"description":"开启SSL","type":"boolean"},"suspend_current_queue_time_millis":{"default":1000,"description":"重试间隔,单位ms","format":"int32","maximum":30000,"minimum":20,"type":"integer"},"tag":{"description":"标签","maxLength":128,"type":"string"},"topic":{"description":"topic名称","example":"topic-test","maxLength":128,"minLength":3,"type":"string"}},"required":["instance_id","group","topic"],"type":"object"},"SourceKafkaMQParameters":{"properties":{"addr":{"description":"kafka连接地址","example":"10.10.10.10:8100","type":"string"},"enable_sasl_ssl":{"description":"SASL_SSL是否开启","example":true,"type":"boolean"},"group":{"description":"kafka消费组","example":"group-test","maxLength":256,"minLength":1,"type":"string"},"instance_id":{"description":"kafka实例ID","example":"instance-id-test","maxLength":256,"minLength":1,"type":"string"},"instance_name":{"description":"kafka实例名称","example":"instance-name-test","maxLength":64,"minLength":4,"type":"string"},"password":{"description":"用户密码","example":"","maxLength":256,"minLength":1,"type":"string"},"sasl_mechanism":{"description":"SASL认证机制","enum":["SCRAM-SHA-512","PLAIN"],"example":"PLAIN","type":"string"},"security_protocol":{"description":"安全协议","example":"PLAINTEXT","type":"string"},"seek_to":{"description":"消费点位","enum":["latest","earliest"],"example":"earliest","type":"string"},"ssl_certificate_pwd":{"description":"SASL证书密码","example":null,"maxLength":256,"minLength":1,"type":"string"},"ssl_certificate_url":{"description":"SASL证书地址,配置的obs地址","example":"https://domain/kafka-certs.zip","maxLength":512,"minLength":1,"type":"string"},"topic":{"description":"kafka topic名称","example":"topic-test","maxLength":200,"minLength":3,"type":"string"},"user_name":{"description":"用户名","example":"","maxLength":256,"minLength":1,"type":"string"}},"required":["group","topic"],"type":"object"},"SourceMobileMQParameters":{"description":"事件流移动云rockectMq事件源参数","properties":{"access_key":{"description":"AccessKey","maxLength":128,"type":"string"},"addr":{"description":"地址","maxLength":256,"type":"string"},"addr_type":{"default":"PUBLIC","description":"接入点类型","enum":["PUBLIC","PRIVATE"],"type":"string"},"authentication_required":{"description":"鉴权认证","type":"boolean"},"consume_timeout":{"default":30000,"description":"消费超时时间","format":"int32","maximum":900000,"minimum":1000,"type":"integer"},"consumer_batch_max_size":{"default":20,"description":"批量消费最大消息数","format":"int32","maximum":1024,"minimum":1,"type":"integer"},"consumer_max_wait":{"default":5,"description":"批量消费最大等待时长,单位:秒","format":"int32","maximum":450,"minimum":0,"type":"integer"},"consumer_thread_nums":{"default":20,"description":"消费线程数","format":"int32","maximum":64,"minimum":20,"type":"integer"},"group_id":{"description":"消费组id","maxLength":128,"minLength":3,"type":"string"},"instance_id":{"description":"实例id","maxLength":128,"minLength":3,"type":"string"},"max_reconsumer_times":{"default":3,"description":"最大重试次数","format":"int32","maximum":16,"minimum":1,"type":"integer"},"message_model":{"default":"CLUSTERING","description":"订阅方式","enum":["CLUSTERING","BROADCASTING"],"type":"string"},"message_type":{"description":"消息类型","enum":["NORMAL"],"type":"string"},"msg_trace_switch":{"description":"保存消息轨迹","type":"boolean"},"sdk_url":{"description":"依赖SDK","maxLength":256,"type":"string"},"secret_key":{"description":"SecretKey","maxLength":128,"type":"string"},"subnet_id":{"description":"子网","type":"string"},"suspend_time":{"default":1800,"description":"失败重试的等待时间","format":"int32","maximum":1800,"minimum":10,"type":"integer"},"tag":{"description":"标签","maxLength":128,"type":"string"},"topic":{"description":"topic","maxLength":128,"minLength":3,"type":"string"},"vpc_id":{"description":"虚拟私有云","type":"string"}},"required":["group_id","instance_id","topic","message_model","addr_type","addr","sdk_url","consume_timeout","message_type"],"type":"object"},"TransForm":{"description":"订阅的事件目标转换规则","properties":{"template":{"description":"变量类型规则时,规则内容的模板定义,支持对已定义变量的引用。","example":"{\"contant_boolean\": ${contant_boolean},\"contant_string\": \"${contant_string!\\\"default\\\"}\",\"varaible_string\": \"${contant_boolean}\",\"varaible_json_object\": ${varaible_json_object!\"null\"}}","maxLength":2048,"type":"string"},"type":{"description":"转换规则类型","enum":["ORIGINAL","CONSTANT","VARIABLE"],"example":"VARIABLE","type":"string"},"value":{"description":"常量类型规则时,字段为常量内容定义;\n变量类型规则时,为变量定义,内容必须为JsonObject字符串。\n变量最多支持100个,且不支持嵌套结构定义;\n变量名由字母、数字、点、下划线和中划线组成,必须字母或数字开头不能以HC.开头,长度不超过64个字符;\n变量值表达式支持常量或JsonPath表达式,字符串长度不超过1024个字符。","example":"{\"contant_boolean\": true,\"contant_string\": \"constant\",\"varaible_string\": \"$.data.string\",\"varaible_json_object\": \"$.data.object\"}","maxLength":1024,"type":"string"}},"required":["type"],"type":"object"}},"description":null,"group_id":"dbc8d90200f14ed9a1cfd69008aa0f08","host":"eg.cn-north-4.myhuaweicloud.com","id":"868cf07b4b1441cb8821c4a3da5f2e44","info_version":"v1","method":"put","name":"UpdateEventStreaming","parameters":{"EventStreamingId":{"description":"事件流ID","in":"path","name":"eventstreaming_id","required":true,"type":"string","x-example":"73d69ae0cfcf460190522d06b60f05ad"},"IamToken":{"description":"用户Token。通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","maxLength":16384,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."},"ProjectId":{"description":"租户资源空间ID","in":"path","name":"project_id","required":true,"type":"string","x-example":"73d69ae0cfcf460190522d06b60f05ad"}},"paths":{"/v1/{project_id}/eventstreamings/{eventstreaming_id}":{"put":{"description":"更新事件流。","operationId":"UpdateEventStreaming","parameters":[{"$ref":"#/parameters/ProjectId"},{"$ref":"#/parameters/EventStreamingId"},{"$ref":"#/parameters/IamToken"},{"description":"update eventstreaming request","in":"body","name":"UpdateEventStreamingRequestBody","required":true,"schema":{"$ref":"#/definitions/EventStreamingUpdateReq"}}],"produces":["application/json"],"responses":{"200":{"description":"更新事件流配置成功","headers":{"X-Request-Id":{"description":"This field is the request ID number for task tracking. Format is request_uuid-timestamp-hostname.","type":"string"}},"schema":{"$ref":"#/definitions/EventStreamingInfo"}}},"summary":"更新事件流","tags":["事件流管理"],"x-api-framework":"RestfulAPI","x-api-position":"管理面","x-api-type":"open-api","x-api-user":"IAM普通租户","x-is-open-doc":"Y","x-is-registered":"Y","x-open-region-cloud":"hws,hws_hk","x-request-examples-1":{"description":"this is a test eventstreaming","name":"test-eventstreaming","option":{"batch_window":{"count":500,"interval":0,"time":10},"thread_num":"3"},"rule_config":{"filter":{},"transform":{"template":"{\"contant_boolean\": ${contant_boolean},\"contant_string\": \"${contant_string!\\\"default\\\"}\",\"varaible_string\": \"${contant_boolean}\",\"varaible_json_object\": ${varaible_json_object!\"null\"}}","type":"VARIABLE","value":"{\"contant_boolean\": true,\"contant_string\": \"constant\",\"varaible_string\": \"$.data.string\",\"varaible_json_object\": \"$.data.object\"}"}},"sink":{"name":"string","sink_fg":{"agency":"string","invoke_type":"SYNC/ASYNC","urn":"String"},"sink_kafka":{"connectionId":"string","keyTransform":[{"template":"{\"contant_boolean\": ${contant_boolean},\"contant_string\": \"${contant_string!\\\"default\\\"}\",\"varaible_string\": \"${contant_boolean}\",\"varaible_json_object\": ${varaible_json_object!\"null\"}}","type":"VARIABLE","value":"{\"contant_boolean\": true,\"contant_string\": \"constant\",\"varaible_string\": \"$.data.string\",\"varaible_json_object\": \"$.data.object\"}"}],"topic":"string"},"sink_obs":{"access_key":"string","obs_bucket":"string","obs_path":"string","secret_key":"string","time_format":"string"}},"source":{"name":"string","source_community_rocketmq":{"access_key":"string","addr":"10.10.10.10:8100","consume_timeout":30000,"consumer_batch_max_size":1,"consumer_thread_nums":20,"enable_acl":true,"group":"group-test","instance_id":"instance-id-test","instance_name":"instance-name-test","max_reconsume_times":-1,"message_type":"string","secret_key":"string","ssl_enable":true,"subnet_id":"string","suspend_current_queue_time_millis":1000,"tag":"string","topic":"topic-test","vpc_id":"string"},"source_dms_rocketmq":{"access_key":"string","consume_timeout":30000,"consumer_batch_max_size":1,"consumer_thread_nums":20,"enable_acl":true,"engine_version":"string","group":"group-test","instance_id":"instance-id-test","instance_name":"instance-name-test","max_reconsume_times":-1,"message_type":"string","secret_key":"string","ssl_enable":true,"suspend_current_queue_time_millis":1000,"tag":"string","topic":"topic-test"},"source_kafka":{"addr":"10.10.10.10:8100","enable_sasl_ssl":true,"group":"group-test","instance_id":"instance-id-test","instance_name":"instance-name-test","password":"","sasl_mechanism":"PLAIN","security_protocol":"PLAINTEXT","seek_to":"earliest","ssl_certificate_pwd":null,"ssl_certificate_url":"https://domain/kafka-certs.zip","topic":"topic-test","user_name":""},"source_mobile_rocketmq":{"access_key":"string","addr":"string","addr_type":"PUBLIC","authentication_required":true,"consume_timeout":30000,"consumer_batch_max_size":20,"consumer_max_wait":5,"consumer_thread_nums":20,"group_id":"string","instance_id":"string","max_reconsumer_times":3,"message_model":"CLUSTERING","message_type":"string","msg_trace_switch":true,"sdk_url":"string","secret_key":"string","subnet_id":"string","suspend_time":1800,"tag":"string","topic":"string","vpc_id":"string"}}},"x-request-examples-description-1":"更新eventstreaming_id事件流","x-request-examples-text-1":{"description":"this is a test eventstreaming","name":"test-eventstreaming","option":{"batch_window":{"count":500,"interval":0,"time":10},"thread_num":"3"},"rule_config":{"filter":{},"transform":{"template":"{\"contant_boolean\": ${contant_boolean},\"contant_string\": \"${contant_string!\\\"default\\\"}\",\"varaible_string\": \"${contant_boolean}\",\"varaible_json_object\": ${varaible_json_object!\"null\"}}","type":"VARIABLE","value":"{\"contant_boolean\": true,\"contant_string\": \"constant\",\"varaible_string\": \"$.data.string\",\"varaible_json_object\": \"$.data.object\"}"}},"sink":{"name":"string","sink_fg":{"agency":"string","invoke_type":"SYNC/ASYNC","urn":"String"},"sink_kafka":{"connectionId":"string","keyTransform":[{"template":"{\"contant_boolean\": ${contant_boolean},\"contant_string\": \"${contant_string!\\\"default\\\"}\",\"varaible_string\": \"${contant_boolean}\",\"varaible_json_object\": ${varaible_json_object!\"null\"}}","type":"VARIABLE","value":"{\"contant_boolean\": true,\"contant_string\": \"constant\",\"varaible_string\": \"$.data.string\",\"varaible_json_object\": \"$.data.object\"}"}],"topic":"string"},"sink_obs":{"access_key":"string","obs_bucket":"string","obs_path":"string","secret_key":"string","time_format":"string"}},"source":{"name":"string","source_community_rocketmq":{"access_key":"string","addr":"10.10.10.10:8100","consume_timeout":30000,"consumer_batch_max_size":1,"consumer_thread_nums":20,"enable_acl":true,"group":"group-test","instance_id":"instance-id-test","instance_name":"instance-name-test","max_reconsume_times":-1,"message_type":"string","secret_key":"string","ssl_enable":true,"subnet_id":"string","suspend_current_queue_time_millis":1000,"tag":"string","topic":"topic-test","vpc_id":"string"},"source_dms_rocketmq":{"access_key":"string","consume_timeout":30000,"consumer_batch_max_size":1,"consumer_thread_nums":20,"enable_acl":true,"engine_version":"string","group":"group-test","instance_id":"instance-id-test","instance_name":"instance-name-test","max_reconsume_times":-1,"message_type":"string","secret_key":"string","ssl_enable":true,"suspend_current_queue_time_millis":1000,"tag":"string","topic":"topic-test"},"source_kafka":{"addr":"10.10.10.10:8100","enable_sasl_ssl":true,"group":"group-test","instance_id":"instance-id-test","instance_name":"instance-name-test","password":"","sasl_mechanism":"PLAIN","security_protocol":"PLAINTEXT","seek_to":"earliest","ssl_certificate_pwd":null,"ssl_certificate_url":"https://domain/kafka-certs.zip","topic":"topic-test","user_name":""},"source_mobile_rocketmq":{"access_key":"string","addr":"string","addr_type":"PUBLIC","authentication_required":true,"consume_timeout":30000,"consumer_batch_max_size":20,"consumer_max_wait":5,"consumer_thread_nums":20,"group_id":"string","instance_id":"string","max_reconsumer_times":3,"message_model":"CLUSTERING","message_type":"string","msg_trace_switch":true,"sdk_url":"string","secret_key":"string","subnet_id":"string","suspend_time":1800,"tag":"string","topic":"string","vpc_id":"string"}}},"x-request-examples-url-1":"PUT https://{eg_endpoint}/v1/{project_id}/eventstreamings/{eventstreaming_id}","x-support-sdk":"Y"}}},"product_short":"EG","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"更新事件流","tags":"事件流管理","uri":null,"version":"2.0"}