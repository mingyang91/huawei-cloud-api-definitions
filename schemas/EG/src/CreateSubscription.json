{"base_path":"/","components":null,"consumes":"","definitions":{"ApigwTargetDetail":{"properties":{"invocation_http_parameters":{"$ref":"#/definitions/InvocationHttpParameters"},"url":{"description":"目标url","example":"https://dms.cn-north-4.myhuaweicloud.com/testaaa","type":"string"}},"required":["url"],"type":"object"},"DeadLetterQueue":{"description":"订阅的死信参数列表","properties":{"connection_id":{"description":"目标连接id","example":"8516d278-268a-4a8b-8766-9bf9b3302f43","maxLength":128,"minLength":1,"type":"string"},"instance_id":{"description":"实例id","example":"ff0e3f10-fcab-4c3a-84bb-cf5a8b6f7722","maxLength":128,"minLength":1,"type":"string"},"topic":{"description":"主题","example":"topic","maxLength":128,"minLength":1,"type":"string"},"type":{"description":"队列类型","enum":["KAFKA"],"example":"KAFKA","type":"string"}},"required":["connection_id","instance_id","topic","type"],"type":"object"},"EgTargetDetail":{"properties":{"agency_name":{"description":"委托名称","example":"EG_TARGET_AGENCY","type":"string"},"cross_account":{"default":false,"description":"跨账号开关","type":"boolean"},"cross_region":{"default":false,"description":"跨region开关","type":"boolean"},"target_channel_id":{"description":"目标通道id","example":"10a79a30-bd4a-4955-a3ec-d62dc799347b","type":"string"},"target_project_id":{"description":"目标项目id","example":"c5be311886934b7c8afb4f8970376130","type":"string"},"target_region":{"description":"目标region","example":"cn-north-test","type":"string"}},"required":["agency_name","target_channel_id","target_project_id","target_region"],"type":"object"},"HeaderParameter":{"properties":{"is_value_secret":{"description":"是否加密","example":false,"type":"boolean"},"key":{"description":"header的key值","example":"test-key","maxLength":256,"minLength":1,"type":"string"},"value":{"description":"deader的value值","example":"test-value","maxLength":1024,"minLength":1,"type":"string"}},"type":"object"},"InvocationHttpParameters":{"properties":{"header_parameters":{"description":"对象列表","items":{"$ref":"#/definitions/HeaderParameter"},"maxItems":5,"minItems":0,"type":"array"}},"type":"object"},"KafkaTargetDetail":{"description":"订阅的kafka事件目标参数列表,该字段序列化后总长度不超过1024字节","properties":{"keyTransform":{"description":"键值规则","properties":{"template":{"description":"键值规则模板,键值规则为VARIABLE时必填","type":"string"},"type":{"description":"键值规则类型","enum":["NONE","VARIABLE","CONSTANT"],"type":"string"},"value":{"description":"键值规则,键值规则为VARIABLE,CONSTANT时必填","type":"string"}},"type":"object"},"topic":{"description":"主题","example":"8516d278-268a-4a8b-8766-9bf9b3302f43","type":"string"}},"required":["topic"],"type":"object"},"ServerErrorMsg":{"example":{"error_code":"EG.xxxxxxxx","error_details":"some error details here","error_msg":"error summary","request_id":"13760c1fe8655e61209b75665e9bef43"},"properties":{"error_code":{"description":"错误码","maxLength":128,"minLength":1,"type":"string"},"error_details":{"description":"具体错误消息","maxLength":1024,"minLength":1,"type":"string"},"error_msg":{"description":"错误消息","maxLength":512,"minLength":1,"type":"string"},"request_id":{"description":"请求处理ID","maxLength":128,"minLength":1,"type":"string"}},"type":"object"},"SmnTargetDetail":{"description":"订阅的SMN事件目标参数列表,该字段序列化后总长度不超过1024字节","properties":{"agency_name":{"description":"委托名称","example":"EG_SMN_PUBLISHER_AGENCY","type":"string"},"subject_transform":{"description":"标题规则","properties":{"template":{"description":"标题规则模板,键值规则为VARIABLE时必填","type":"string"},"type":{"description":"标题规则类型","enum":["VARIABLE","CONSTANT"],"type":"string"},"value":{"description":"标题规则","type":"string"}},"required":["type","value"],"type":"object"},"urn":{"description":"主题urn","example":"urn:smn:cn-north-7:bac852160cc743158936edaab6dda813:122","type":"string"}},"required":["agency_name","urn"],"type":"object"},"SubscriptionCreateReq":{"properties":{"channel_id":{"description":"所属事件通道ID","example":"05649f9a-b324-4920-9c49-156d4cd2e546","type":"string"},"description":{"description":"订阅描述","example":"this is a test subscription","maxLength":255,"type":"string"},"name":{"description":"订阅名称,租户下唯一,由字母、数字、点、下划线和中划线组成,必须字母或数字开头","example":"test-subscription","maxLength":128,"minLength":1,"type":"string"},"sources":{"description":"订阅的事件源列表, 当前仅支持订阅一个事件源","items":{"$ref":"#/definitions/SubscriptionSource"},"maxItems":1,"minItems":1,"type":"array"},"targets":{"description":"事件目标列表,至少订阅一个事件目标","items":{"$ref":"#/definitions/SubscriptionTarget"},"minItems":1,"type":"array"}},"required":["channel_id","name","sources","targets"],"type":"object"},"SubscriptionInfo":{"properties":{"channel_id":{"description":"通道ID","example":"05649f9a-b324-4920-9c49-156d4cd2e546","type":"string"},"channel_name":{"description":"通道名称","example":"channel006","type":"string"},"created_time":{"description":"创建时间","example":"2021-12-09 09:00:00","type":"string"},"description":{"description":"订阅描述","example":"this is a test subscription","type":"string"},"id":{"description":"订阅ID","example":"23709d68-54d5-423b-a6be-03302e893152","type":"string"},"name":{"description":"订阅名称","example":"test-subscription","type":"string"},"sources":{"description":"订阅源列表","items":{"$ref":"#/definitions/SubscriptionSourceInfo"},"type":"array"},"status":{"description":"状态","enum":["CREATED","ENABLED","DISABLED","FROZEN","ERROR"],"example":"CREATED","type":"string"},"targets":{"description":"订阅目标列表","items":{"$ref":"#/definitions/SubscriptionTargetInfo"},"type":"array"},"type":{"description":"类型","enum":["EVENT","SCHEDULED"],"example":"EVENT","type":"string"},"updated_time":{"description":"更新时间","example":"2021-12-09 09:00:00","type":"string"},"used":{"description":"标签信息","items":{"$ref":"#/definitions/SubscriptionUsedInfo"},"type":"array"}},"type":"object"},"SubscriptionSource":{"properties":{"detail":{"description":"订阅的事件源参数列表, 该字段序列化后总长度不超过1024字节","example":{"name":"name"},"properties":{},"type":"object"},"filter":{"description":"订阅事件源的匹配过滤规则, 该字段序列化后总长度不超过2048字节","example":{"data":{"count":[{"op":"NumberIn","values":[1,2]}]}},"properties":{},"type":"object"},"id":{"description":"订阅源ID,需保证全局唯一。指定ID的订阅源存在时则进行更新,否则进行创建;未指定时由系统自动生成。由小写字母、数字、中划线组成,必须字母或数字开头。","example":"3a0eeff2-78a4-4122-dfge-7ty5e37f64er","maxLength":64,"minLength":32,"type":"string"},"name":{"description":"订阅的事件源名称","example":"HC.OBS","maxLength":128,"type":"string"},"provider_type":{"description":"订阅的事件源的提供方类型","enum":["CUSTOM","OFFICIAL","PARTNER"],"example":"OFFICIAL","type":"string"}},"required":["filter","name","provider_type"],"type":"object"},"SubscriptionSourceInfo":{"properties":{"created_time":{"description":"创建时间","example":"2021-12-09 09:00:00","type":"string"},"detail":{"description":"订阅的事件源参数列表","example":{"name":"name"},"properties":{},"type":"object"},"filter":{"description":"订阅事件源的匹配过滤规则","example":{"data":{"count":[{"op":"NumberIn","values":[1,2]}]}},"properties":{},"type":"object"},"id":{"description":"订阅源ID","example":"3a0eeff2-78a4-4122-dfge-7ty5e37f64er","type":"string"},"name":{"description":"订阅的事件源名称","example":"HC.OBS","type":"string"},"provider_type":{"description":"订阅的事件源的提供方类型","example":"OFFICIAL","type":"string"},"updated_time":{"description":"更新时间","example":"2021-12-09 09:00:00","type":"string"}},"type":"object"},"SubscriptionTarget":{"properties":{"apigw_detail":{"$ref":"#/definitions/ApigwTargetDetail","description":"订阅的事件APIGWurl目标参数列表,该字段序列化后总长度不超过1024字节,APIGW目标必填"},"connection_id":{"description":"订阅的事件目标使用的目标链接ID","example":"456eekj3-778u-4tyu-dfrt-er55e37f667t","maxLength":64,"type":"string"},"dead_letter_queue":{"$ref":"#/definitions/DeadLetterQueue"},"detail":{"description":"订阅的事件目标参数列表,该字段序列化后总长度不超过1024字节,函数(urn、invoke_type、agency_name)、函数流(workflow_id、agency_name)、webhook(url)订阅目标必填,其中函数、函数流委托名称必填","example":{"agency_name":"EG_TARGET_AGENCY","invoke_type":"ASYNC","url":"http://10.213.96.90:8080/t/nodeapp/trigger-hello-nodejs","urn":"urn:fss:cn-north-7:bac852160cc743158936edaab6dda813:function:default:gxtestjava:latest","workflow_id":"86afc904-0019-46c8-baed-0225967c1b98"},"properties":{},"type":"object"},"eg_detail":{"$ref":"#/definitions/EgTargetDetail","description":"订阅的事件eg通道目标参数列表,该字段序列化后总长度不超过1024字节,eg通道目标必填"},"id":{"description":"订阅目标ID,需保证全局唯一,由小写字母、数字、中划线组成,必须字母或数字开头。 更新订阅场景时,指定ID的订阅目标存在时则进行更新,否则进行创建; 创建订阅目标场景时,指定ID作为待创建的订阅目标对象ID,未指定时由系统自动生成。 更新订阅目标时,此字段忽略;","example":"3a0eeff2-78a4-4122-dfge-7ty5e37f64er","maxLength":64,"minLength":32,"type":"string"},"kafka_detail":{"$ref":"#/definitions/KafkaTargetDetail","description":"订阅的事件kafka目标参数列表,该字段序列化后总长度不超过1024字节,kafka订阅目标必填"},"name":{"description":"订阅的事件目标名称","example":"WEBHOOK","maxLength":128,"type":"string"},"provider_type":{"description":"订阅的事件目标的提供方类型","enum":["CUSTOM","OFFICIAL","APIGW"],"example":"CUSTOM","type":"string"},"retry_times":{"description":"重试次数","example":16,"type":"integer"},"smn_detail":{"$ref":"#/definitions/SmnTargetDetail","description":"订阅的事件smn目标参数列表,该字段序列化后总长度不超过1024字节,smn订阅目标必填"},"transform":{"$ref":"#/definitions/TransForm"}},"required":["name","provider_type","transform"],"type":"object"},"SubscriptionTargetInfo":{"properties":{"apigw_detail":{"$ref":"#/definitions/ApigwTargetDetail","description":"订阅的事件APIGWurl目标参数列表,该字段序列化后总长度不超过1024字节,APIGW目标必填"},"connection_id":{"description":"订阅的事件目标使用的目标链接ID","example":"456eekj3-778u-4tyu-dfrt-er55e37f667t","maxLength":64,"type":"string"},"created_time":{"description":"创建时间","example":"2021-12-09 09:00:00","type":"string"},"dead_letter_queue":{"$ref":"#/definitions/DeadLetterQueue"},"detail":{"description":"订阅的事件目标参数列表","example":{"url":"http://10.213.96.90:8080/t/nodeapp/trigger-hello-nodejs"},"properties":{},"type":"object"},"eg_detail":{"$ref":"#/definitions/EgTargetDetail","description":"订阅的事件eg通道目标参数列表,该字段序列化后总长度不超过1024字节,eg通道目标必填"},"id":{"description":"订阅目标ID","example":"3a0eeff2-78a4-4122-dfge-7ty5e37f64er","type":"string"},"kafka_detail":{"$ref":"#/definitions/KafkaTargetDetail","description":"订阅的事件kafka目标参数列表,该字段序列化后总长度不超过1024字节,kafka订阅目标必填"},"name":{"description":"订阅的事件目标名称","example":"WEBHOOK","type":"string"},"provider_type":{"description":"订阅的事件目标的提供方类型","example":"CUSTOM","type":"string"},"retry_times":{"description":"重试次数","example":16,"type":"integer"},"smn_detail":{"$ref":"#/definitions/SmnTargetDetail","description":"订阅的事件smn目标参数列表,该字段序列化后总长度不超过1024字节,smn订阅目标必填"},"transform":{"$ref":"#/definitions/TransForm"},"updated_time":{"description":"更新时间","example":"2021-12-09 09:00:00","type":"string"}},"type":"object"},"SubscriptionUsedInfo":{"properties":{"description":{"description":"描述","type":"string"},"owner":{"description":"管理租户账号","example":"op_svc_obs","type":"string"},"resource_id":{"description":"关联资源ID","example":"23709d68-54d5-423b-a6be-03302e893152","type":"string"}},"type":"object"},"TransForm":{"description":"订阅的事件目标转换规则","properties":{"template":{"description":"变量类型规则时,规则内容的模板定义,支持对已定义变量的引用。","example":"{\"contant_boolean\": ${contant_boolean},\"contant_string\": \"${contant_string!\\\"default\\\"}\",\"varaible_string\": \"${contant_boolean}\",\"varaible_json_object\": ${varaible_json_object!\"null\"}}","maxLength":2048,"type":"string"},"type":{"description":"转换规则类型","enum":["ORIGINAL","CONSTANT","VARIABLE"],"example":"VARIABLE","type":"string"},"value":{"description":"常量类型规则时,字段为常量内容定义;\n变量类型规则时,为变量定义,内容必须为JsonObject字符串。\n变量最多支持100个,且不支持嵌套结构定义;\n变量名由字母、数字、点、下划线和中划线组成,必须字母或数字开头不能以HC.开头,长度不超过64个字符;\n变量值表达式支持常量或JsonPath表达式,字符串长度不超过1024个字符。","example":"{\"contant_boolean\": true,\"contant_string\": \"constant\",\"varaible_string\": \"$.data.string\",\"varaible_json_object\": \"$.data.object\"}","maxLength":1024,"type":"string"}},"required":["type"],"type":"object"}},"description":null,"group_id":"dbc8d90200f14ed9a1cfd69008aa0f08","host":"eg.cn-north-4.myhuaweicloud.com","id":"7b335544cc6a4c43961e712a38e3c94f","info_version":"v1","method":"post","name":"CreateSubscription","parameters":{},"paths":{"/v1/{project_id}/subscriptions":{"post":{"description":"创建事件订阅。","operationId":"CreateSubscription","parameters":[{"description":"用户Token。通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","maxLength":16384,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."},{"description":"租户资源空间ID","in":"path","name":"project_id","required":true,"type":"string","x-example":"73d69ae0cfcf460190522d06b60f05ad"},{"description":"创建订阅时所使用的企业项目id","in":"query","name":"enterprise_project_id","required":false,"type":"string","x-example":"092e1243e88146768798b0e8c9933192"},{"description":"create subscription request","in":"body","name":"CreateSubscriptionRequestBody","required":true,"schema":{"$ref":"#/definitions/SubscriptionCreateReq"}}],"produces":["application/json"],"responses":{"200":{"description":"Demo Information","headers":{"X-Request-Id":{"description":"This field is the request ID number for task tracking. Format is request_uuid-timestamp-hostname.","type":"string"}},"schema":{"$ref":"#/definitions/SubscriptionInfo"}},"400":{"description":"非法请求","examples":{"application/json":{"error_code":"EG.00014000","error_msg":"Bad request"}},"schema":{"$ref":"#/definitions/ServerErrorMsg"}},"401":{"description":"未授权","examples":{"application/json":{"error_code":"EG.00014010","error_msg":"Incorrect token or token resolution failed"}},"schema":{"$ref":"#/definitions/ServerErrorMsg"}},"403":{"description":"禁止访问","examples":{"application/json":{"error_code":"EG.00014030","error_msg":"No permissions to request this method"}},"schema":{"$ref":"#/definitions/ServerErrorMsg"}},"404":{"description":"未找到资源","examples":{"application/json":{"error_code":"EG.00014040","error_msg":"Not request resource found"}},"schema":{"$ref":"#/definitions/ServerErrorMsg"}},"500":{"description":"内部服务错误","examples":{"application/json":{"error_code":"EG.00015000","error_msg":"Internal Server Error"}},"schema":{"$ref":"#/definitions/ServerErrorMsg"}}},"summary":"创建事件订阅","tags":["事件订阅管理"],"x-api-framework":"RestfulAPI","x-api-position":"管理面","x-api-type":"open-api","x-api-user":"IAM普通租户","x-is-open-doc":"Y","x-is-registered":"Y","x-open-region-cloud":"hws","x-support-sdk":"Y"}}},"product_short":"EG","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建事件订阅","tags":"事件订阅管理","uri":null,"version":"2.0"}