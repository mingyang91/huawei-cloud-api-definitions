{"base_path":null,"components":{"schemas":{"ErrorResp":{"description":"异常错误","properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误消息内容","type":"string"}},"type":"object"},"Match":{"properties":{"key":{"description":"键。第一期限定为resource_name,后续扩展。","enum":["resource_name"],"type":"string"},"value":{"description":"值。每个值最大长度255个unicode字符 。不校验字符集范。","maxLength":255,"pattern":"^[\\w.-]+$","type":"string"}},"required":["key","value"],"type":"object"},"ResourceInstancesCountResp":{"properties":{"total_count":{"description":"总记录数","format":"int32","type":"integer"}},"required":["total_count"],"type":"object"},"ResourceInstancesReq":{"properties":{"matches":{"description":"搜索字段,key为要匹配的字段,如resource_name等。value为匹配的值。key为固定字典值,不能包含重复的key或不支持的key。根据key的值确认是否需要模糊匹配,如resource_name默认为精确搜索(推荐实现前缀搜索),如果value为空字符串精确匹配(多数服务不存在资源名称为空的情况,因此此类情况返回空列表)。resource_id为精确匹配。第一期只做resource_name,后续再扩展。","items":{"$ref":"#/components/schemas/Match"},"maxItems":1,"type":"array"},"tags":{"description":"包含标签,最多包含20个key,每个key下面的value最多20个,每个key对应的value可以为空数组但结构体不能缺失。key不能重复,同一个key中values不能重复。结果返回包含所有标签的资源列表,key之间是与的关系,key-value结构中value是或的关系。无tag过滤条件时返回全量数据。","items":{"$ref":"#/components/schemas/Tag"},"maxItems":20,"nullable":false,"type":"array"},"without_any_tag":{"default":false,"description":"不包含任意一个标签,该字段为true时查询所有不带标签的资源,此时忽略 “tags”字段。该字段为false或者未提供该参数时,该条件不生效,即返回所有资源或按\"tags\",\"matches\"等条件过滤。","type":"boolean"}},"type":"object"},"Tag":{"nullable":false,"properties":{"key":{"description":"键。最大长度128个unicode字符。 key不能为空。(搜索时不对此参数做字符集校验),key不能为空或者空字符串,不能为空格,校验和使用之前先trim 前后半角空格。","maxLength":128,"minLength":1,"nullable":false,"pattern":"^((?!\\s)(?!_sys_)[\\p{L}\\p{Z}\\p{N}_.:=+\\-@]*)(?<!\\s)$","type":"string"},"values":{"description":"值列表。每个值最大长度255个unicode字符,校验和使用之前先trim 前后半角空格。value可为空数组但不可缺省。如果values为空列表,则表示any_value(查询任意value)。value之间为或的关系。(搜索时不对此参数做字符集校验,只做长度校验)","items":{"maxLength":255,"nullable":false,"pattern":"^([\\p{L}\\p{Z}\\p{N}_.:\\/=+\\-@]*)$","type":"string"},"maxItems":20,"minItems":0,"nullable":false,"type":"array"}},"required":["key","values"],"type":"object"}}},"consumes":"","definitions":null,"description":null,"group_id":"cad6b80b035b41d09866cb93e54bff47","host":"rms.myhuaweicloud.com","id":"7143473cf2044c81b63ddb778bcf0ec0","info_version":"v1","method":"post","name":"CountResourcesByTag","parameters":null,"paths":{"/v1/resource-manager/{resource_type}/resource-instances/count":{"post":{"description":"使用标签过滤实例,标签管理服务需要提供按标签过滤各服务实例并汇总显示在列表中,需要各服务提供查询能力。注意:tags, tags_any, not_tags, not_tags_any等字段支持的tag的数量。","operationId":"CountResourcesByTag","parameters":[{"description":"资源类型","in":"path","name":"resource_type","required":true,"schema":{"enum":["config:policyAssignments","config:aggregators","config:aggregationAuthorizations"],"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResourceInstancesReq"}}},"required":true},"responses":{"200":{"content":{"application/json":{"example":{"total_count":1000},"schema":{"$ref":"#/components/schemas/ResourceInstancesCountResp"}}},"description":"操作成功。"},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"输入参数不合法。"},"401":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"鉴权失败。"},"403":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"用户身份认证失败。"},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"资源未找到"},"500":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"服务器内部错误。"}},"summary":"查询资源实例数量","tags":["Tag"],"x-is-registered":"Y","x-open-region-cloud":"hc,hk","x-order":1,"x-request-examples-1":{"matches":[{"key":"resource_name","value":"resource1"}],"tags":[{"key":"key1","values":["value1","value2"]},{"key":"key2","values":["value1","value2"]}]},"x-request-examples-description-1":"根据标签查询实例数量","x-request-examples-url-1":"POST https://{endpoint}/v1/resource-manager/{resource_type}/resource-instances/count","x-support-sdk":"Y"}}},"product_short":"Config","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询资源实例数量","tags":"资源标签","uri":null,"version":"3.0.0"}