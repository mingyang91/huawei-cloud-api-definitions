{"base_path":"/","components":null,"consumes":"","definitions":{"AddScriptModel":{"description":"**约束:**\n- 1. 同poject_id下不允许同名脚本\n- 2. 修改脚本时,不允许修改:脚本名称、project_id\n- 3. 字段长度和范围限制\n\n- 脚本内容长度,创建时为做校验","properties":{"content":{"description":"脚本内容","example":"echo ${value}","maxLength":4096,"minLength":1,"type":"string"},"description":{"description":"脚本描述","example":"示例脚本","maxLength":256,"minLength":1,"type":"string"},"enterprise_project_id":{"default":"0","description":"企业项目ID,默认为:0","type":"string"},"name":{"description":"脚本名称:只能包含中文、英文、数字、下划线","example":"exampleScript","maxLength":64,"minLength":1,"pattern":"^[\\u4E00-\\u9FA5A-Za-z0-9_]+$","type":"string"},"properties":{"$ref":"#/definitions/ScriptPropertiesModel","description":"脚本标签:\n- 风险等级risk_level(取值范围:LOW/MEDIUM/HIGH)、审批人reviewer、脚本解释器interpreter等"},"script_params":{"description":"脚本入参","items":{"$ref":"#/definitions/ScriptParamDefine"},"maxItems":20,"minItems":0,"type":"array"},"type":{"description":"脚本类型:\n对于脚本后缀:\nSHELL:.sh\nPYTHON:.py\nBAT:.bat","enum":["SHELL","PYTHON","BAT"],"example":"SHELL","type":"string"}},"required":["content","description","name","properties","type"],"type":"object"},"CreateScriptsResponse":{"description":"创建脚本的返回体:script_uuid","properties":{"data":{"description":"script_uuid","example":"SC2023102521413701c4a8a62","type":"string"}},"required":["data"],"type":"object"},"ErrorRsp":{"description":"失败时返回的错误对象","properties":{"error_code":{"description":"错误码","maxLength":36,"minLength":8,"type":"string"},"error_msg":{"description":"错误描述","maxLength":512,"minLength":2,"type":"string"}},"required":["error_code","error_msg"]},"ReviewerInfo":{"description":"审批人信息","properties":{"reviewer_id":{"description":"审批人ID(IAM用户Id)","example":"e99a6f27cfe7497084ac9c07bfa573d7","maxLength":32,"minLength":0,"type":"string"},"reviewer_name":{"description":"审批人名称(IAM用户名)","example":"test","maxLength":64,"minLength":1,"type":"string"}},"required":["reviewer_id","reviewer_name"],"type":"object"},"ScriptParamDefine":{"description":"顺序参数,没有参数名字段\n参数顺序,从1开始,不连续会报错\n\napi层用不同的vo对象接收,管理面没有order字段。service层统一处理差异\n\n拼接:sh xxx.sh  'aaa' 'a' 'b'\n执行时值为空:sh xxx.sh  '' 'a' 'b'","properties":{"param_description":{"description":"参数描述","example":"测试参数","maxLength":256,"minLength":0,"type":"string"},"param_name":{"description":"参数名称:只支持英文、数字、下划线","example":"value","maxLength":64,"minLength":1,"type":"string"},"param_order":{"description":"该参数已废弃,传入该参数不会生效。","format":"int32","type":"integer"},"param_value":{"description":"参数默认值,默认必填,如果有参数引用,可为空","example":"aaaaa","maxLength":1024,"minLength":0,"type":"string"},"sensitive":{"description":"是否是敏感参数","example":false,"type":"boolean"}},"required":["param_description","param_name","sensitive"],"type":"object"},"ScriptPropertiesModel":{"description":"脚本标签:风险等级risk_level(取值范围:LOW/MEDIUM/HIGH)、审批人reviewer、脚本解释器interpreter等","properties":{"risk_level":{"description":"风险等级\nLOW:低风险\nMEDIUM:中风险\nHIGH:高风险","enum":["LOW","MEDIUM","HIGH"],"example":"LOW","type":"string"},"version":{"description":"脚本版本号","example":"v1.0.0","maxLength":10,"minLength":1,"type":"string"}},"required":["risk_level","version"],"type":"object"}},"description":null,"group_id":"82af75d8fb894fc2b06ca4175859ba53","host":"coc.myhuaweicloud.com","id":"54366497cedc476fb5e82bb38af168ea","info_version":"v1","method":"post","name":"CreateScript","parameters":{},"paths":{"/v1/job/scripts":{"post":{"description":"创建作业脚本:自定义脚本\n- 脚本有标签属性,表示是高危脚本。创建时候不需要对脚本进行是否是高危的二次校验。\n- 进行租户隔离;北向接口创建的脚本,审批人字段不填写,默认不需要审批\n- 约束条件:\n- 脚本名称:同一租户下,脚本名称不能重复,最大字符64个字符,支持中文+字母+数字+下划线。\n- 脚本内容最大100kb。\n- 脚本参数个数最多20个。\n- 脚本描述:最大256个字符。\n- 单个参数的参数名称 64个字符,只支持字母+数字+下划线。\n- 单个参数的值最大1024个字符,正则表达式如下:^((?!\\.{2,})[a-zA-Z0-9_\\-\\/\\.\\*\\x20\\?:\",=+@\\\\\\[\\{\\]\\}])*$。\n- 审批人最多支持5人。\n- 脚本输出的日志总量只支持1MB。","operationId":"CreateScript","parameters":[{"description":"添加脚本的请求体","in":"body","name":"CreateScriptsRequestBody","required":true,"schema":{"$ref":"#/definitions/AddScriptModel"}},{"description":"租户token","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"项目ID,一个项目对应一个region","in":"header","name":"x-project-id","required":false,"type":"string"},{"description":"IAM5.0用户信息","in":"header","name":"x-user-profile","required":false,"type":"string"},{"description":"国际化标记,zh-cn表示中文,en-us或不传表示英文","in":"header","name":"X-Language","required":false,"type":"string"}],"responses":{"200":{"description":"脚本uuid","examples":{"application/json":{"data":"SC2023102521413701c4a8a62"}},"schema":{"$ref":"#/definitions/CreateScriptsResponse"}},"400":{"description":"包含错误信息","examples":{"application/json":{"error_code":"COC.00040701","error_msg":"script_params size must be between 0 and 50"}},"schema":{"$ref":"#/definitions/ErrorRsp"}}},"summary":"创建脚本","tags":["ScriptManagement"],"x-api-type":"open-api","x-apiexplorer-hide":false,"x-is-registered":"Y","x-order":0,"x-request-examples-1":{"content":"echo ${value}","description":"实例脚本","name":"09101112","properties":{"protocol":"WECHAT","reviewers":[{"reviewer_id":"7a8513cd87b7448283a1d5190eb91234","reviewer_name":"test"}],"risk_level":"HIGH","version":"1.0.0"},"script_params":[{"param_description":"string","param_name":"a","param_order":1,"param_value":"string","sensitive":true}],"type":"SHELL"},"x-request-examples-description-1":"实例请求体","x-request-examples-text-1":{"content":"echo ${value}","description":"实例脚本","name":"09101112","properties":{"protocol":"WECHAT","reviewers":[{"reviewer_id":"7a8513cd87b7448283a1d5190eb91234","reviewer_name":"test"}],"risk_level":"HIGH","version":"1.0.0"},"script_params":[{"param_description":"string","param_name":"a","param_order":1,"param_value":"string","sensitive":true}],"type":"SHELL"},"x-request-examples-url-1":"https://coc.myhuaweicloud.com/v1/job/scripts","x-support-sdk":"N"}}},"product_short":"COC","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建脚本","tags":"ScriptManagement","uri":null,"version":"2.0"}