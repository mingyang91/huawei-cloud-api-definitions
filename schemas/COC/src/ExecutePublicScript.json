{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"Customttribute":{"description":"当前执行脚本的自定义属性,仅用于表示本次执行的产生工单的信息","properties":{"key":{"description":"自定义属性key","example":"1kkkkkk","maxLength":10,"minLength":0,"type":"string"},"value":{"description":"自定义属性的value","example":"1lhkjh","maxLength":20,"minLength":0,"type":"string"}},"required":["key","value"],"type":"object"},"ExecuteInstancesBatchInfo":{"properties":{"batch_index":{"description":"批次索引,从1开始,未校验:最大值","example":1,"format":"int32","maximum":20,"minimum":1,"type":"integer"},"rotation_strategy":{"description":"暂停继续策略","enum":["CONTINUE","PAUSE"],"example":"PAUSE","type":"string"},"target_instances":{"description":"目标节点列表","items":{"$ref":"#/definitions/ExecuteResourceInstance"},"maxItems":10,"minItems":1,"type":"array"}},"required":["batch_index","rotation_strategy","target_instances"],"type":"object"},"ExecutePublicScriptRes":{"description":"执行公共脚本返回体","properties":{"data":{"description":"执行公共脚本返回体:execute_uuid","example":"SCT2023083109562601af694bf","type":"string"}},"required":["data"],"type":"object"},"ExecuteResourceInstance":{"description":"执行脚本时需要传的机器信息","properties":{"agent_sn":{"description":"该参数已废弃,传入该参数不会生效。","example":"7aec98ca0edd45bc8145005c1892cb3a","maxLength":32,"minLength":1,"type":"string"},"custom_attributes":{"description":"支持用户自定义5个key_value形式的属性。 \n约束条件:\n- key值长度为10 \n- value长度为20 \n- map长度最大为5\n- 禁止填写敏感数据","items":{"$ref":"#/definitions/Customttribute"},"type":"array"},"project_id":{"description":"该参数已废弃,传入该参数不会生效。","example":"1076d5e8a93f4fd383ad8b40498fcf7d","maxLength":32,"minLength":1,"type":"string"},"provider":{"description":"资源提供者:ECS,不传默认为:ECS。请保证一次执行, 每个实例的provider是一致的。后续扩展CCE等","type":"string"},"region_id":{"description":"服务器所属region","example":"cn-north-a","maxLength":32,"minLength":1,"type":"string"},"resource_id":{"description":"ecs云服务器ID","example":"66006c8e-dc6b-45bb-a65b-6f8a3700392f","maxLength":64,"minLength":1,"type":"string"},"type":{"description":"资源提供者下资源类型,不传默认为CLOUDSERVER\nCLOUDSERVER:CLOUDSERVER类型\n约束: \n-不允许跨type支持","enum":["CLOUDSERVER"],"type":"string"}},"required":["region_id","resource_id"],"type":"object"},"ScriptExecuteInputParam":{"properties":{"param_name":{"description":"脚本入参的名称,同一个脚本,参数名不能重复","example":"value","maxLength":64,"minLength":1,"pattern":"[A-Za-z0-9_]+$","type":"string"},"param_order":{"description":"该参数已废弃,传入该参数不会生效。","format":"int32","type":"integer"},"param_refer":{"$ref":"#/definitions/ScriptExecuteParamReference","description":"参数引用"},"param_value":{"description":"脚本入参的值,默认必填。有引用参数(param_refer不为空)时,允许为空\n1.参数长度为1-4096位\n2.可以包含大写字母、小写字母、数字及特殊字符(_-/.* ?:\",=+@#\\[{]})\n3.禁止出现连续'.'","example":"test","maxLength":4096,"minLength":0,"type":"string"}},"required":["param_name","param_value"],"type":"object"},"ScriptExecuteModel":{"properties":{"execute_batches":{"description":"目标实例分批信息","items":{"$ref":"#/definitions/ExecuteInstancesBatchInfo"},"type":"array"},"execute_param":{"$ref":"#/definitions/ScriptExecuteParam","description":"脚本执行参数"}},"required":["execute_batches","execute_param"],"type":"object"},"ScriptExecuteParam":{"description":"脚本执行相关参数","properties":{"execute_user":{"description":"脚本执行用户,如:root","example":"root","maxLength":32,"minLength":1,"type":"string"},"resourceful":{"description":"该参数已废弃,传入该参数不会生效。","example":true,"type":"boolean"},"script_params":{"description":"脚本入参列表","items":{"$ref":"#/definitions/ScriptExecuteInputParam"},"type":"array"},"success_rate":{"description":"成功率,支持小数点后一位","example":100.0,"format":"double","maximum":100,"minimum":1,"type":"number"},"timeout":{"description":"超时时间,单位:秒,取值范围待定,5 < timeout < 1800","example":30,"exclusiveMaximum":true,"exclusiveMinimum":true,"format":"int32","maximum":1800,"minimum":5,"type":"integer"}},"required":["execute_user","success_rate","timeout"],"type":"object"},"ScriptExecuteParamReference":{"description":"脚本执行入参引用定义","properties":{"param_id":{"description":"引用参数的唯一主键id","enum":["LOW","MEDIUM","HIGH"],"example":"LOW","type":"string"},"param_version":{"description":"引用参数的版本号","example":"v1.0.0","maxLength":10,"minLength":1,"type":"string"},"refer_type":{"description":"参数引用类型:PARAM_STORE","type":"string"}},"required":["param_id","refer_type"],"type":"object"}},"description":null,"group_id":"82af75d8fb894fc2b06ca4175859ba53","host":"coc.myhuaweicloud.com","id":"14f85d4a5b8843e3b2e5fdfc363307c9","info_version":"v1","method":"post","name":"ExecutePublicScript","parameters":{},"paths":{"/v1/job/public-scripts/{script_uuid}":{"post":{"description":"执行公共脚本\n脚本入参、超时时间、执行用户、资源受限\n脚本入参支持20个。\n单次下发的机器支持200个。\n单次批次内机器数量最大10个。\n最大批次数量为20批。","operationId":"ExecutePublicScript","parameters":[{"description":"公共脚本Uuid","in":"path","maxLength":25,"minLength":1,"name":"script_uuid","required":true,"type":"string"},{"description":"执行公共脚本请求体","in":"body","name":"ExecuteJobPublicScriptRequestBody","required":true,"schema":{"$ref":"#/definitions/ScriptExecuteModel"}},{"description":"租户token","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"国际化标记,zh-cn表示中文,en-us或不传表示英文","in":"header","name":"X-Language","required":false,"type":"string"},{"description":"项目ID,一个项目对应一个region","in":"header","name":"x-project-id","required":false,"type":"string"},{"description":"IAM5.0用户信息","in":"header","name":"x-user-profile","required":false,"type":"string"}],"responses":{"200":{"description":"工单execute_uuid","examples":{"application/json":{"data":"SCT2023083109562601af694bf"}},"schema":{"$ref":"#/definitions/ExecutePublicScriptRes"}}},"summary":"执行公共脚本","tags":["ScriptPublicManagement"],"x-api-type":"open-api","x-apiexplorer-hide":false,"x-is-registered":"Y","x-support-sdk":"Y"}}},"product_short":"COC","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"执行公共脚本","tags":"ScriptPublicManagement","uri":null,"version":"2.0"}