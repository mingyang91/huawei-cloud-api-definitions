{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"CreateRuleCondition":{"description":"","properties":{"key":{"description":"参数解释:匹配项的名称。\n\n约束限制:同一个rule内的conditions列表中所有key必须相同。\n\n取值范围:\n- 当转发规则类别type为HOST_NAME、PATH、METHOD、SOURCE_IP时,该字段固定为空字符串。\n- 当转发规则类别type为HEADER时,key表示请求头参数的名称,value表示请求头参数的值。\nkey的长度限制1-40字符,只允许包含字母、数字和-_。\n- 当转发规则类别type为QUERY_STRING时,key表示查询参数的名称,value表示查询参数的值。\nkey的长度限制为1-128字符,不支持空格,中括号,大括号,尖括号,反斜杠,双引号,'#','&','|',‘%’,‘~’,字母区分大小写。","maxLength":128,"minLength":1,"type":"string"},"value":{"description":"参数解释:匹配项的值。\n\n约束限制:\n- 同一个rule内的conditions列表中所有key必须相同。\n- 同一个rule内的conditions列表中所有value不允许重复。\n\n取值范围:\n- 当转发规则类别type为HOST_NAME时,key固定为空字符串,value表示域名的值。\nvalue长度1-128字符,字符串只能包含英文字母、数字、-、.或\\*,\n必须以字母、数字或\\*开头,\\*只能出现在开头且必须以\\*.开始。\n\n- 当转发规则类别type为PATH时,key固定为空字符串,value表示请求路径的值。\nvalue长度1-128字符。当转发规则的compare_type为STARTS_WITH、EQUAL_TO时,\n字符串只能包含英文字母、数字、_~';@^-%#&$.*+?,=!:|\\\\/()\\[\\]{},且必须以/开头。\n\n- 当转发规则类别type为HEADER时,key表示请求头参数的名称,value表示请求头参数的值。\nvalue长度限制1-128字符,不支持空格,\n双引号,支持以下通配符:*(匹配0个或更多字符)和?(正好匹配1个字符)。\n\n- 当转发规则类别type为QUERY_STRING时,key表示查询参数的名称,value表示查询参数的值。\nvalue长度限制为1-128字符,不支持空格,中括号,大括号,尖括号,反斜杠,双引号,\n'#','&','|',‘%’,‘~’,字母区分大小写,支持通配符:*(匹配0个或更多字符)和?(正好匹配1个字符)\n\n- 当转发规则类别type为METHOD时,key固定为空字符串,value表示请求方式。value取值范围为:GET, PUT,\nPOST,DELETE, PATCH, HEAD, OPTIONS。\n\n- 当转发规则类别type为SOURCE_IP时,key固定为空字符串,value表示请求源地址。\nvalue为CIDR格式,支持ipv4,ipv6。例如192.168.0.2/32,2049::49/64。","maxLength":128,"minLength":1,"type":"string"}},"required":["value"]},"CreateRuleOption":{"description":"创建L7转发规则器请求","properties":{"admin_state_up":{"description":"参数解释:转发规则的管理状态。\n\n约束限制:只支持设置为true。","type":"boolean"},"compare_type":{"description":"参数解释:转发匹配方式。\n\n约束限制:\n- type为HOST_NAME时仅支持EQUAL_TO,支持通配符*。\n- type为PATH时可以为REGEX,STARTS_WITH,EQUAL_TO。\n- type为METHOD、SOURCE_IP时,仅支持EQUAL_TO。\n- type为HEADER、QUERY_STRING,仅支持EQUAL_TO,支持通配符*、?。\n\n取值范围:\n- EQUAL_TO 表示精确匹配。\n- REGEX 表示正则匹配。\n- STARTS_WITH 表示前缀匹配。","type":"string"},"conditions":{"description":"参数解释:转发规则的匹配条件。\n\n约束限制:\n- 当监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效。\n- 若转发规则配置了conditions,字段key、字段value的值无意义。\n- 同一个rule内的conditions列表中所有key必须相同,value不允许重复。","items":{"$ref":"#/definitions/CreateRuleCondition"},"type":"array"},"invert":{"description":"参数解释:是否反向匹配。\n\n取值范围:true、false,默认false。\n\n不支持该字段,请勿使用。","type":"boolean"},"key":{"description":"参数解释:匹配项的名称,比如转发规则匹配类型是请求头匹配,则key表示请求头参数的名称。\n\n不支持该字段,请勿使用。","maxLength":255,"minLength":0,"type":"string"},"project_id":{"description":"参数解释:转发规则所在的项目ID。","maxLength":32,"minLength":1,"pattern":"[0-9a-fA-F]{32}","type":"string"},"type":{"description":"参数解释:转发规则类别。\n\n约束限制:\n- 一个l7policy下创建的l7rule的HOST_NAME,PATH,METHOD,SOURCE_IP不能重复。\nHEADER、QUERY_STRING支持重复的rule配置。\n\n取值范围:\n- HOST_NAME:匹配域名。\n- PATH:匹配请求路径。\n- METHOD:匹配请求方法。\n- HEADER:匹配请求头。\n- QUERY_STRING:匹配请求查询参数。\n- SOURCE_IP:匹配请求源IP地址。\n- COOKIE: 匹配cookie信息。","type":"string"},"value":{"description":"参数解释:匹配项的值。比如转发规则匹配类型是域名匹配,则value表示域名的值。\n\n约束限制:仅当conditions空时该字段生效。\n\n取值范围:\n- 当转发规则类别type为HOST_NAME时,字符串只能包含英文字母、数字、-、.或*,必须以字母、数字或*开头。\n若域名中包含\\*,则\\*只能出现在开头且必须以\\*.开始。\n当\\*开头时表示通配0~任一个字符。\n\n- 当转发规则类别type为PATH时,当转发规则的compare_type为STARTS_WITH、EQUAL_TO时,\n字符串只能包含英文字母、数字、_~';@^-%#&$.*+?,=!:|\\\\/()\\[\\]{},且必须以/开头。\n\n- 当转发规则类别type为METHOD、SOURCE_IP、HEADER,QUERY_STRING时,\n该字段无意义,使用conditions来指定key/value。","maxLength":128,"minLength":1,"type":"string"}},"required":["compare_type","value","type"]},"FixtedResponseConfig":{"description":"参数解释:固定返回页面的配置。\n\n约束限制:\n- 当监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效,未开启传入该字段会报错。\n- 当action为FIXED_RESPONSE时生效,且为必选字段。其他action不可指定,否则报错。\n- 共享型负载均衡器下的转发策略不支持该字段,传入会报错。","properties":{"content_type":{"description":"参数解释:返回body的格式。\n\n取值范围:\n- text/plain\n- text/css\n- text/html\n- application/javascript\n- application/json","enum":["text/plain","text/css","text/html","application/javascript","application/json"],"type":"string"},"insert_headers_config":{"$ref":"#/definitions/InsertHeadersConfig","x-open-region-cloud":"hc,hk"},"message_body":{"description":"参数解释:返回消息内容。","maxLength":1024,"minLength":0,"type":"string"},"remove_headers_config":{"$ref":"#/definitions/RemoveHeadersConfig","x-open-region-cloud":"hc,hk"},"status_code":{"description":"参数解释:返回码。支持200~299,400~499,500~599。","maxLength":16,"minLength":1,"type":"string"},"traffic_limit_config":{"$ref":"#/definitions/TrafficLimitConfig","x-open-region-cloud":"hc,hk"}},"required":["status_code","content_type","message_body"],"type":"object"},"InsertHeaderConfig":{"description":"要添加请求头参数。","properties":{"key":{"description":"参数解释:请求头参数名。\n\n约束限制:不能是以下字符:\nconnection、upgrade、content-length、transfer-encoding、keep-alive、te、host、cookie、remoteip、authority、x-forwarded-host、x-forwarded-for、x-forwarded-for-port、x-forwarded-tls-certificate-id、x-forwarded-tls-protocol、x-forwarded-tls-cipher、x-forwarded-elb-ip、x-forwarded-port、x-forwarded-elb-id、x-forwarded-elb-vip、x-real-ip、x-forwarded-proto、x-nuwa-trace-ne-in、x-nuwa-trace-ne-out。\n\n取值范围:1-40个字符,字母a-z(不区分大小写)、数字,短划线-和下划线_。","type":"string"},"value":{"description":"参数解释:请求头参数的值。\n\n约束限制:当value_type为SYSTEM_DEFINED时,value只可从CLIENT-PORT,CLIENT-IP, ELB-PROTOCOL, ELB-ID, ELB-PORT, ELB-EIP, ELB-VIP中取值。\n\n取值范围:1-128个字符,支持ascii码值32<=ch<=127范围内可打印字符,*和英文问号?。不能以空格开头或结尾。","type":"string"},"value_type":{"description":"参数解释:请求头参数类别。\n\n取值范围:USER_DEFINED,REFERENCE_HEADER,SYSTEM_DEFINED。","type":"string"}},"required":["key","value_type","value"],"type":"object"},"InsertHeadersConfig":{"description":"参数解释:要添加的请求头参数列表。","properties":{"configs":{"description":"参数解释:要添加请求头参数列表。","items":{"$ref":"#/definitions/InsertHeaderConfig"},"type":"array"}},"required":["configs"],"type":"object"},"L7Policy":{"description":"policy对象。","properties":{"action":{"description":"参数解释:转发策略的转发动作。\n\n约束限制:\n- REDIRECT_TO_LISTENER的优先级最高,配置了以后,该监听器下的其他policy会失效。\n- 当action为REDIRECT_TO_POOL时,\n只支持创建在PROTOCOL为HTTP、HTTPS、TERMINATED_HTTPS的listener上。\n- 当action为REDIRECT_TO_LISTENER时,只支持创建在PROTOCOL为HTTP的listener上。\n\n取值范围:\n- REDIRECT_TO_POOL:转发到后端服务器组;\n- REDIRECT_TO_LISTENER:重定向到监听器;\n- REDIRECT_TO_URL:重定向到URL;\n- FIXED_RESPONSE:返回固定响应体。","type":"string"},"admin_state_up":{"description":"参数解释:转发策略的管理状态。\n\n约束限制:只支持设置为true。","type":"boolean"},"created_at":{"description":"参数解释:创建时间。\n\n取值范围:格式:yyyy-MM-dd'T'HH:mm:ss'Z',UTC时区。\n\n注意:独享型实例的历史数据以及共享型实例下的资源,不返回该字段。","type":"string"},"description":{"description":"参数解释:转发策略描述信息。","type":"string"},"fixed_response_config":{"$ref":"#/definitions/FixtedResponseConfig"},"id":{"description":"参数解释:转发策略ID。","type":"string"},"listener_id":{"description":"参数解释:转发策略所属的监听器ID。","type":"string"},"name":{"description":"参数解释:转发策略名称","maxLength":255,"minLength":1,"type":"string"},"position":{"description":"参数解释:转发策略的优先级,不支持更新。\n\n不支持该字段,请勿使用。","format":"int32","maximum":100,"minimum":1,"type":"integer"},"priority":{"description":"参数解释:转发策略的优先级。数字越小表示优先级越高。\n\n约束限制:\n- 同一个监听器下不同转发策略之间不允许重复的优先级数值。\n- 当关联的监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效,未开启传入该字段会报错。\n- 当关联的监听器的高级转发策略功能(enhance_l7policy_enable)未开启,按原有policy的排序逻辑,自动排序。\n不同域名优先级独立。相同域名下,按path的compare_type排序,\n精确>前缀>正则,匹配类型相同时,path的长度越长优先级越高。\n若policy下只有域名rule,没有路径rule,默认path为前缀匹配/。\n- 共享型负载均衡器下的转发策略不支持该字段。\n\n取值范围:\n- 当action为REDIRECT_TO_LISTENER时,支持指定为0-10000。\n- 其它action取值,支持指定为1-10000。\n\n默认取值:\n- 若关联的监听器的高级转发策略功能(enhance_l7policy_enable)未开启,且不传入该字段,则新创建的转发策略的优先级的值为1。\n- 当action为REDIRECT_TO_LISTENER时,则新创建的转发策略的优先级的值为0。\n- 其它action取值,新创建的转发策略的优先级的值为同一监听器下已有转发策略的优先级的最大值+1。\n  + 若监听器下没有转发策略,则新建的转发策略的优先级为1。\n  + 若当前已有转发策略的优先级的最大值是10000,则新创建的转发策略会因超出取值范围10000而失败。此时可通过传入指定priority,或调整原有policy的优先级来避免错误。","format":"int32","type":"integer"},"project_id":{"description":"参数解释:转发策略所在的项目ID。","type":"string"},"provisioning_status":{"description":"参数解释:转发策略的配置状态。\n\n取值范围:\n- ACTIVE: 默认值,表示正常。\n- ERROR: 表示当前策略与同一监听器下的其他策略存在相同的规则配置。","type":"string"},"redirect_listener_id":{"description":"参数解释:转发到的listener的ID。\n\n约束限制:\n- 当action为REDIRECT_TO_LISTENER时必选。\n- 只支持protocol为HTTPS/TERMINATED_HTTPS的listener。\n- 不能指定为其他loadbalancer下的listener。\n- 当action为REDIRECT_TO_POOL时,创建或更新时不能传入该参数。","type":"string"},"redirect_pool_id":{"description":"参数解释:转发到pool的ID。\n\n约束限制:当action为REDIRECT_TO_POOL时生效。","type":"string"},"redirect_pools_config":{"description":"参数解释:转发到多个主机组列表。\n\n约束限制:一个policy最多配置5个pool。","items":{"$ref":"#/definitions/RedirectPoolsConfig"},"type":"array","x-open-region-cloud":"hc,hk"},"redirect_pools_extend_config":{"$ref":"#/definitions/RedirectPoolsExtendConfig"},"redirect_pools_sticky_session_config":{"$ref":"#/definitions/RedirectPoolsStickySessionConfig","x-open-region-cloud":"hc,hk"},"redirect_url":{"description":"参数解释:转发到的url。\n\n取值范围:必须满足格式: protocol://host:port/path?query。\n\n不支持该字段,请勿使用。","pattern":"(https?|ftp|file)://[-A-Za-z0-9+&amp;@#/%?=~_|!:,.;]+[-A-Za-z0-9+&amp;@#/%=~_|]","type":"string"},"redirect_url_config":{"$ref":"#/definitions/RedirectUrlConfig"},"rules":{"description":"参数解释:转发策略关联的转发规则列表。","items":{"$ref":"#/definitions/RuleRef"},"type":"array"},"updated_at":{"description":"参数解释:更新时间。\n\n取值范围:格式:yyyy-MM-dd'T'HH:mm:ss'Z',UTC时区。\n\n注意:独享型实例的历史数据以及共享型实例下的资源,不返回该字段。","type":"string"}},"required":["action","admin_state_up","description","id","listener_id","name","position","project_id","provisioning_status","redirect_pool_id","redirect_listener_id","redirect_url","rules","redirect_url_config","fixed_response_config"],"type":"object"},"RedirectPoolsConfig":{"description":"转发策略主机组的权重配置。当监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效,未开启传入该字段会报错。\n\n使用说明:\n- 当action为REDIRECT_TO_POOL时,redirect_pool_id和redirect_pools_config必须指定一个,两个都指定时按redirect_pools_config生效。\n- 当action是REDIRECT_TO_LISTENER和REzDIRECT_TO_URL时,传入该字段会报错。\n- 一个policy最多支持配置5个pool。Pool不允许重复。\n\n共享型负载均衡器下的转发策略不支持该字段,传入会报错。","properties":{"pool_id":{"description":"参数解释:所在后端服务器组ID。","type":"string"},"weight":{"description":"参数解释:转发策略主机组的权重。请求将根据该权重进行负载分发到不同的主机组。权重值越大,分发的请求越多。权重为0的后端不再接受新的请求。\n\n取值范围:0-100","format":"int32","maximum":100,"minimum":0,"type":"integer"}},"type":"object"},"RedirectPoolsExtendConfig":{"description":"参数解释:转发到的后端主机组的配置。\n\n约束限制:当action为REDIRECT_TO_POOL时生效。","properties":{"insert_headers_config":{"$ref":"#/definitions/InsertHeadersConfig","x-open-region-cloud":"hc,hk"},"remove_headers_config":{"$ref":"#/definitions/RemoveHeadersConfig","x-open-region-cloud":"hc,hk"},"rewrite_url_config":{"$ref":"#/definitions/RewriteUrlConfig"},"rewrite_url_enable":{"description":"参数解释:是否开启url重定向。","type":"boolean"},"traffic_limit_config":{"$ref":"#/definitions/TrafficLimitConfig","x-open-region-cloud":"hc,hk"}},"type":"object"},"RedirectPoolsStickySessionConfig":{"description":"参数解释:配置转发策略关联的服务器组之间会话保持。负载均衡器会根据客户端第一个请求生成一个cookie,后续所有包含这个cookie值的请求都会由同一个pool处理。\n\n约束限制:共享型负载均衡器下的转发策略不支持该字段,传入会报错。","properties":{"enable":{"default":false,"description":"参数解释:转发策略主机组会话保持开启的开关。\n\n默认取值:false,表示关闭主机组会话保持。","type":"boolean"},"timeout":{"description":"参数解释:会话保持的时间。\n\n取值范围:1-1440(分钟)\n\n默认取值:1440","format":"int32","type":"integer"}},"type":"object"},"RedirectUrlConfig":{"description":"参数解释:转发到的url配置。\n\n约束限制:\n- 当监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效,未开启传入该字段会报错。\n- 当转发策略的action为REDIRECT_TO_URL时生效,且为必选字段,其他action不可指定,否则报错。\n- 共享型负载均衡器下的转发策略不支持该字段,传入会报错。\n\n取值范围:格式:protocol://host:port/path?query\n\nprotocol、host、port、path不允许同时不传或同时传${xxx}\n(${xxx}表示原值,如${host}表示被转发的请求URL的host部分)。\nprotocol和port传入的值不能与l7policy关联的监听器一致且host、path同时不传或同时传${xxx}。","properties":{"host":{"default":"${host}","description":"参数解释:重定向的主机名。\n\n取值范围:只能包含英文字母、数字、“-”、“.”。且必须以字母、数字开头。\n\n默认取值:${host} 表示继承原值(即与被转发请求保持一致)。","maxLength":128,"minLength":1,"type":"string"},"insert_headers_config":{"$ref":"#/definitions/InsertHeadersConfig","x-open-region-cloud":"hc,hk"},"path":{"default":"${path}","description":"参数解释:重定向的路径。\n\n取值范围:支持英文字母、数字、_~';@^-%#&$.*+?,=!:|\\\\/()\\[\\]{},且必须以\"/\"开头。\n\n默认取值:${path} 表示继承原值(即与被转发请求保持一致)。","maxLength":128,"minLength":1,"type":"string"},"port":{"default":"${port}","description":"参数解释:重定向到的端口。\n\n默认取值:默认值${port}表示继承原值(即与被转发请求保持一致)。","maxLength":16,"minLength":1,"type":"string"},"protocol":{"description":"参数解释:重定向的协议。\n\n取值范围:\n- HTTP\n- HTTPS\n- ${protocol},表示继承原值(即与被转发请求保持一致)。","enum":["HTTP","HTTPS","${protocol}"],"type":"string"},"query":{"default":"${query}","description":"参数解释:重定向的查询字符串。举例如下:\n\n将query设置为:${query}&name=my_name,则在转发符合条件的URL\n(如https://www.example.com:8080/elb?type=loadbalancer)时,将会重定向到\nhttps://www.example.com:8080/elb?type=loadbalancer&name=my_name。在例子中${query}表示type=loadbalancer。\n\n取值范围:只能包含英文字母、数字和特殊字符:!$&'()\\*+,-./:;=?@^_`。字母区分大小写。其中$1,$2会匹配请求url通配符星号(\\*)\n\n默认取值:${query}表示继承原值(即与被转发请求保持一致)","example":"author=xxx","maxLength":128,"minLength":0,"type":"string"},"remove_headers_config":{"$ref":"#/definitions/RemoveHeadersConfig","x-open-region-cloud":"hc,hk"},"status_code":{"description":"参数解释:重定向后的返回码。\n\n取值范围:\n- 301\n- 302\n- 303\n- 307\n- 308","enum":["301","302","303","307","308"],"maxLength":16,"minLength":1,"type":"string"}},"type":"object"},"RemoveHeaderConfig":{"description":"要移除的请求头参数。","properties":{"key":{"description":"参数解释:被移除的请求头的参数名。\n\n约束限制:不能移除以下请求头参数:\nconnection、upgrade、content-length、transfer-encoding、keep-alive、te、host、cookie、remoteip、authority、x-forwarded-host、x-forwarded-for、x-forwarded-for-port、x-forwarded-tls-certificate-id、x-forwarded-tls-protocol、x-forwarded-tls-cipher、x-forwarded-elb-ip、x-forwarded-port、x-forwarded-elb-id、x-forwarded-elb-vip、x-real-ip、x-forwarded-proto、x-nuwa-trace-ne-in、x-nuwa-trace-ne-out\n\n取值范围:1-40个字符,字母a-z(不区分大小写)、数字,短划线-和下划线_。","type":"string"}},"required":["key"],"type":"object"},"RemoveHeadersConfig":{"description":"参数解释:要移除的请求头参数列表。","properties":{"configs":{"description":"参数解释:要移除的请求头参数列表。","items":{"$ref":"#/definitions/RemoveHeaderConfig"},"type":"array"}},"required":["configs"],"type":"object"},"RewriteUrlConfig":{"description":"参数解释:URL重定向配置。\n\n约束限制:当action为REDIRECT_TO_POOL的时候生效。","properties":{"host":{"description":"参数解释:重定向的域名。\n\n取值范围:英文字母、数字、“-”、“.”,必须以字母、数字开头。\n\n默认取值:${host},表示继承原值(即与被重写请求host保持一致)。","type":"string"},"path":{"description":"参数解释:重定向的请求路径。其中$1-$9会匹配请求url通配符星号(*),当正则匹配分组小于指定数字,则$指定数字结果为空。$后面跟字母,匹配结果均为空,直到下一个特殊字符出现,例如$abc#123,则匹配结果为#123;$后面跟特殊字符则直接输出特殊字符,例如$#匹配结果为$#。\n\n取值范围:英文字母、数字、_~';@^-%#&$.+?,=!:|\\/(),且必须以\"/\"开头。\n\n默认取值:${path},表示继承原值(即与被重写请求保持一致)。","type":"string"},"query":{"description":"参数解释:重定向的查询字符串。其中$1-$9会匹配请求url通配符星号(*),当正则匹配分组小于指定数字,则$指定数字结果为空。$后面跟字母,匹配结果均为空,直到下一个特殊字符出现,例如$abc#123,则匹配结果为#123;$后面跟特殊字符则直接输出特殊字符,例如$#匹配结果为$#。\n\n取值范围:英文字母、数字和特殊字符:!$&'()+,-./:;=?@^_`。字母区分大小写。\n\n默认取值:${query},表示继承原值(即与被重写请求保持一致)。","type":"string"}},"type":"object"},"RuleRef":{"description":"","properties":{"id":{"description":"参数解释:规则ID。","type":"string"}},"required":["id"]},"TrafficLimitConfig":{"description":"参数解释:转发策略限速的配置。","properties":{"burst":{"description":"参数解释:设置当单源qps超限时,允许的局部突增请求数量。超出该限制的请求将返回503。\n\n取值范围:0-100000,单位:个/秒。","format":"int32","maximum":100000,"minimum":0,"type":"integer"},"per_source_ip_qps":{"description":"参数解释:对转发策略单源(单个客户端IP)进行限速。\n\n约束限制:\n- quic监听器下转发策略不支持配置单源限速。\n- 指定该字段时,赋值可以为0或者为null。\n- 如果qps不为0,per_source_ip_qps需要小于qps。\n\n取值范围:0-100000,单位:个/秒。0表示不限速。","format":"int32","maximum":100000,"minimum":0,"type":"integer"},"qps":{"description":"参数解释:转发策略qps限速。\n\n取值范围:0-100000,单位:个/秒。0表示不限速。","format":"int32","maximum":100000,"minimum":0,"type":"integer"}},"type":"object"},"UpdateFixtedResponseConfig":{"description":"参数解释:固定返回页面的配置。\n\n约束限制:\n- 当监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效,未开启传入该字段会报错。\n- 当action为FIXED_RESPONSE时生效。其他action不可指定,否则报错。\n- 共享型负载均衡器下的转发策略不支持该字段,传入会报错。","properties":{"content_type":{"description":"参数解释:返回body的格式。\n\n取值范围:\n- text/plain\n- text/css\n- text/html\n- application/javascript\n- application/json\napplication/json","enum":["text/plain","text/css","text/html","application/javascript","application/json"],"type":"string"},"insert_headers_config":{"$ref":"#/definitions/UpdateInsertHeadersConfig","description":"参数解释:要添加的请求头参数的配置。"},"message_body":{"description":"参数解释:返回消息内容。","maxLength":1024,"minLength":0,"type":"string"},"remove_headers_config":{"$ref":"#/definitions/UpdateRemoveHeadersConfig","description":"参数解释:要移除的请求头参数的配置。"},"status_code":{"description":"参数解释:返回码。\n\n取值范围:200-299,400-499,500-599。","maxLength":16,"minLength":1,"type":"string"},"traffic_limit_config":{"$ref":"#/definitions/UpdateTrafficLimitConfig","description":"参数解释:转发策略限速的配置。"}},"type":"object"},"UpdateInsertHeaderConfig":{"description":"要添加请求头参数。","properties":{"key":{"description":"参数解释:请求头参数名。\n\n约束限制:不能是以下字符:\nconnection、upgrade、content-length、transfer-encoding、keep-alive、te、host、cookie、remoteip、authority、x-forwarded-host、x-forwarded-for、x-forwarded-for-port、x-forwarded-tls-certificate-id、x-forwarded-tls-protocol、x-forwarded-tls-cipher、x-forwarded-elb-ip、x-forwarded-port、x-forwarded-elb-id、x-forwarded-elb-vip、x-real-ip、x-forwarded-proto、x-nuwa-trace-ne-in、x-nuwa-trace-ne-out。\n\n取值范围:1-40个字符,字母a-z(不区分大小写)、数字,短划线-和下划线_。","type":"string"},"value":{"description":"参数解释:请求头参数的值。\n\n约束限制:当value_type为SYSTEM_DEFINED时,value只可从CLIENT-PORT,CLIENT-IP, ELB-PROTOCOL, ELB-ID, ELB-PORT, ELB-EIP, ELB-VIP中取值。\n\n取值范围:1-128个字符,支持ascii码值32<=ch<=127范围内可打印字符,*和英文问号?。不能以空格开头或结尾。","type":"string"},"value_type":{"description":"参数解释:请求头参数类别。\n\n取值范围:USER_DEFINED,REFERENCE_HEADER,SYSTEM_DEFINED。","type":"string"}},"required":["key","value_type","value"],"type":"object"},"UpdateInsertHeadersConfig":{"description":"参数解释:要添加的请求头参数列表。","properties":{"configs":{"description":"参数解释:要添加请求头参数列表。","items":{"$ref":"#/definitions/UpdateInsertHeaderConfig"},"type":"array"}},"required":["configs"],"type":"object"},"UpdateL7PolicyOption":{"description":"更新七层转发策略的请求参数。","properties":{"admin_state_up":{"description":"参数解释:转发策略的管理状态。\n\n约束限制:只支持设置为true。","type":"boolean"},"description":{"description":"参数解释:转发策略描述信息。","maxLength":255,"minLength":0,"type":"string"},"fixed_response_config":{"$ref":"#/definitions/UpdateFixtedResponseConfig"},"name":{"description":"参数解释:转发策略名称。","maxLength":255,"minLength":0,"type":"string"},"priority":{"description":"参数解释:转发策略的优先级。数字越小表示优先级越高。\n\n约束限制:\n- 同一个监听器下不同转发策略之间不允许重复的优先级数值。\n- 当关联的监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效,未开启传入该字段会报错。\n- 当关联的监听器的高级转发策略功能(enhance_l7policy_enable)未开启,按原有policy的排序逻辑,自动排序。\n不同域名优先级独立。相同域名下,按path的compare_type排序,\n精确>前缀>正则,匹配类型相同时,path的长度越长优先级越高。\n若policy下只有域名rule,没有路径rule,默认path为前缀匹配/。\n- 共享型负载均衡器下的转发策略不支持该字段。\n\n取值范围:\n- 当action为REDIRECT_TO_LISTENER时,支持指定为0-10000。\n- 其它action取值,支持指定为1-10000。\n\n默认取值:\n- 若关联的监听器的高级转发策略功能(enhance_l7policy_enable)未开启,且不传入该字段,则新创建的转发策略的优先级的值为1。\n- 当action为REDIRECT_TO_LISTENER时,则新创建的转发策略的优先级的值为0。\n- 其它action取值,新创建的转发策略的优先级的值为同一监听器下已有转发策略的优先级的最大值+1。\n  + 若监听器下没有转发策略,则新建的转发策略的优先级为1。\n  + 若当前已有转发策略的优先级的最大值是10000,则新创建的转发策略会因超出取值范围10000而失败。此时可通过传入指定priority,或调整原有policy的优先级来避免错误。","format":"int32","maximum":10000,"minimum":0,"type":"integer"},"redirect_listener_id":{"description":"参数解释:转发到的listener的ID。\n\n约束限制:\n- 当action为REDIRECT_TO_LISTENER时不能更新为空或null。\n- 只支持protocol为HTTPS/TERMINATED_HTTPS的listener。\n- 不能指定为其他loadbalancer下的listener。\n- 当action为REDIRECT_TO_POOL时,创建或更新时不能传入该参数。","type":"string"},"redirect_pool_id":{"description":"参数解释:转发到pool的ID。\n\n约束限制:\n- 指定的pool不能是任何listener的default_pool。不能是其他listener的l7policy使用的pool。\n- 当action为REDIRECT_TO_POOL时生效,但不能更新为空或null。\n- 当action为REDIRECT_TO_LISTENER时,传入会报错。","type":"string"},"redirect_pools_config":{"description":"参数解释:转发到多个主机组列表。一个policy最多配置5个pool。","items":{"$ref":"#/definitions/UpdateRedirectPoolsConfig"},"type":"array","x-open-region-cloud":"hc,hk"},"redirect_pools_extend_config":{"$ref":"#/definitions/UpdateRedirectPoolsExtendConfig"},"redirect_pools_sticky_session_config":{"$ref":"#/definitions/UpdateRedirectPoolsStickySessionConfig","x-open-region-cloud":"hc,hk"},"redirect_url_config":{"$ref":"#/definitions/UpdateRedirectUrlConfig"},"rules":{"description":"参数解释:转发策略关联的转发规则对象。\n\n约束限制:\n- rules列表中最多含有10个rule规则\n(若rule中包含conditions字段,一条condition算一个规则),\n且列表中type为HOST_NAME,PATH,METHOD,SOURCE_IP的rule不能重复,至多指定一条。\n- 仅支持全量替换。","items":{"$ref":"#/definitions/CreateRuleOption"},"type":"array"}}},"UpdateL7PolicyRequestBody":{"description":"This is a auto create Body Object","properties":{"l7policy":{"$ref":"#/definitions/UpdateL7PolicyOption","description":"参数解释:l7policy对象。"}},"required":["l7policy"]},"UpdateL7PolicyResponseBody":{"description":"This is a auto create Response Object","properties":{"l7policy":{"$ref":"#/definitions/L7Policy","description":"参数解释:l7policy对象。"},"request_id":{"description":"参数解释:请求ID。\n\n注:自动生成 。","type":"string"}},"required":["l7policy","request_id"]},"UpdateRedirectPoolsConfig":{"description":"转发策略主机组的权重配置。当监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效,未开启传入该字段会报错。\n\n使用说明:\n- 当action为REDIRECT_TO_POOL时,redirect_pool_id和redirect_pools_config必须指定一个,两个都指定时按redirect_pools_config生效。\n- 当action是REDIRECT_TO_LISTENER和REzDIRECT_TO_URL时,传入该字段会报错。\n- 一个policy最多支持配置5个pool。Pool不允许重复。\n- 仅支持全量覆盖。\n\n共享型负载均衡器下的转发策略不支持该字段,传入会报错。","properties":{"pool_id":{"description":"参数解释:所在后端服务器组ID。","type":"string"},"weight":{"default":1,"description":"参数解释:转发策略主机组的权重。请求将根据该权重进行负载分发到不同的主机组。权重值越大,分发的请求越多。权重为0的后端不再接受新的请求。\n\n取值范围:0-100","type":"string"}},"required":["pool_id"],"type":"object"},"UpdateRedirectPoolsExtendConfig":{"description":"参数解释:转发到的后端主机组的URL配置。","properties":{"insert_headers_config":{"$ref":"#/definitions/UpdateInsertHeadersConfig"},"remove_headers_config":{"$ref":"#/definitions/UpdateRemoveHeadersConfig"},"rewrite_url_config":{"$ref":"#/definitions/UpdateRewriteUrlConfig"},"rewrite_url_enable":{"description":"参数解释:是否开启url重定向","type":"boolean"},"traffic_limit_config":{"$ref":"#/definitions/UpdateTrafficLimitConfig"}},"type":"object"},"UpdateRedirectPoolsStickySessionConfig":{"description":"参数解释:配置转发策略关联的服务器组之间会话保持。负载均衡器会根据客户端第一个请求生成一个cookie,后续所有包含这个cookie值的请求都会由同一个pool处理。\n\n约束限制:共享型负载均衡器下的转发策略不支持该字段,传入会报错。","properties":{"enable":{"description":"参数解释:转发策略主机组会话保持开启的开关。\n\n默认取值:false,表示关闭主机组会话保持。","type":"boolean"},"timeout":{"description":"参数解释:会话保持的时间。\n\n取值范围:1-1440(分钟)\n\n默认取值:1440","format":"int32","type":"integer"}},"type":"object"},"UpdateRedirectUrlConfig":{"description":"参数解释:转发到的url配置。\n\n约束限制:\n- 当监听器的高级转发策略功能(enhance_l7policy_enable)开启后才会生效,未开启传入该字段会报错。\n- 当转发策略的action为REDIRECT_TO_URL时生效,且为必选字段,其他action不可指定,否则报错。\n- 共享型负载均衡器下的转发策略不支持该字段,传入会报错。\n\n取值范围:格式:protocol://host:port/path?query\n\nprotocol、host、port、path不允许同时不传或同时传${xxx}\n(${xxx}表示原值,如${host}表示被转发的请求URL的host部分)。\nprotocol和port传入的值不能与l7policy关联的监听器一致且host、path同时不传或同时传${xxx}。","properties":{"host":{"default":"${host}","description":"参数解释:重定向的主机名。\n\n取值范围:字符串只能包含英文字母、数字、“-”、“.”,必须以字母、数字开头。\n\n默认取值:${host},表示继承原值(即与被转发请求保持一致)。","maxLength":128,"minLength":1,"type":"string"},"insert_headers_config":{"$ref":"#/definitions/UpdateInsertHeadersConfig","description":"参数解释:要添加的请求头参数的配置。"},"path":{"default":"${path}","description":"参数解释:重定向的路径。\n\n取值范围:只能包含英文字母、数字、_~';@^-%#&$.\\*+?,=!:|\\\\/()\\[\\]{},且必须以\"/\"开头。\n\n默认取值:${path},表示继承原值(即与被转发请求保持一致)。","maxLength":128,"minLength":1,"type":"string"},"port":{"default":"${port}","description":"参数解释:重定向到的端口。\n\n默认取值:${port}表示继承原值(即与被转发请求保持一致)。","maxLength":16,"minLength":1,"type":"string"},"protocol":{"description":"参数解释:重定向的协议。\n\n取值范围:\n- HTTP\n- HTTPS\n- ${protocol},表示继承原值(即与被转发请求保持一致)。","enum":["HTTP","HTTPS","${protocol}"],"type":"string"},"query":{"default":"${query}","description":"参数解释:重定向的查询字符串。举例如下:\n\n将query设置为:${query}&name=my_name,则在转发符合条件的URL\n(如https://www.example.com:8080/elb?type=loadbalancer)时,将会重定向到\nhttps://www.example.com:8080/elb?type=loadbalancer&name=my_name。在例子中${query}表示type=loadbalancer。\n\n取值范围:只能包含英文字母、数字和特殊字符:!$&'()\\*+,-./:;=?@^_`。字母区分大小写。其中$1,$2会匹配请求url通配符星号(\\*)\n\n默认取值:${query}表示继承原值(即与被转发请求保持一致)","example":"author=xxx","maxLength":128,"minLength":0,"type":"string"},"remove_headers_config":{"$ref":"#/definitions/UpdateRemoveHeadersConfig","description":"参数解释:要移除的请求头参数的配置。"},"status_code":{"description":"参数解释:重定向后的返回码。\n\n取值范围:\n- 301\n- 302\n- 303\n- 307\n- 308","enum":["301","302","303","307","308"],"type":"string"}}},"UpdateRemoveHeaderConfig":{"description":"要移除的请求头参数。","properties":{"key":{"description":"参数解释:被移除的请求头的参数名。\n\n约束限制:不能移除以下请求头参数:\nconnection、upgrade、content-length、transfer-encoding、keep-alive、te、host、cookie、remoteip、authority、x-forwarded-host、x-forwarded-for、x-forwarded-for-port、x-forwarded-tls-certificate-id、x-forwarded-tls-protocol、x-forwarded-tls-cipher、x-forwarded-elb-ip、x-forwarded-port、x-forwarded-elb-id、x-forwarded-elb-vip、x-real-ip、x-forwarded-proto、x-nuwa-trace-ne-in、x-nuwa-trace-ne-out\n\n取值范围:1-40个字符,字母a-z(不区分大小写)、数字,短划线-和下划线_。","type":"string"}},"required":["key"],"type":"object"},"UpdateRemoveHeadersConfig":{"description":"参数解释:要移除的请求头参数列表。","properties":{"configs":{"description":"参数解释:要移除的请求头参数列表。","items":{"$ref":"#/definitions/UpdateRemoveHeaderConfig"},"type":"array"}},"required":["configs"],"type":"object"},"UpdateRewriteUrlConfig":{"description":"参数解释:URL重定向配置。\n\n约束限制:当action为REDIRECT_TO_POOL的时候生效。","properties":{"host":{"description":"参数解释:重定向的域名。\n\n取值范围:英文字母、数字、“-”、“.”,必须以字母、数字开头。","type":"string"},"path":{"description":"参数解释:重定向的请求路径。其中$1-$9会匹配请求url通配符星号(*),当正则匹配分组小于指定数字,则$指定数字结果为空。$后面跟字母,匹配结果均为空,直到下一个特殊字符出现,例如$abc#123,则匹配结果为#123;$后面跟特殊字符则直接输出特殊字符,例如$#匹配结果为$#。\n\n取值范围:英文字母、数字、_~';@^-%#&$.+?,=!:|\\/(),且必须以\"/\"开头。","type":"string"},"query":{"description":"参数解释:重定向的查询字符串。其中$1-$9会匹配请求url通配符星号(*),当正则匹配分组小于指定数字,则$指定数字结果为空。$后面跟字母,匹配结果均为空,直到下一个特殊字符出现,例如$abc#123,则匹配结果为#123;$后面跟特殊字符则直接输出特殊字符,例如$#匹配结果为$#。\n\n取值范围:英文字母、数字和特殊字符:!$&'()+,-./:;=?@^_`。字母区分大小写。","type":"string"}},"type":"object"},"UpdateTrafficLimitConfig":{"description":"参数解释:转发策略限速的配置。","properties":{"burst":{"description":"参数解释:设置当单源qps超限时,允许的局部突增请求数量。超出该限制的请求将返回503。\n\n取值范围:0-100000,单位:个/秒。","format":"int32","maximum":100000,"minimum":0,"type":"integer"},"per_source_ip_qps":{"description":"参数解释:对转发策略单源(单个客户端IP)进行限速。\n\n约束限制:\n- quic监听器下转发策略不支持配置单源限速。\n- 指定该字段时,赋值可以为0或者为null。\n- 如果qps不为0,per_source_ip_qps需要小于qps。\n\n取值范围:0-100000,单位:个/秒。0表示不限速。","format":"int32","maximum":100000,"minimum":0,"type":"integer"},"qps":{"description":"参数解释:转发策略qps限速。\n\n取值范围:0-100000,单位:个/秒。0表示不限速。","format":"int32","maximum":100000,"minimum":0,"type":"integer"}},"type":"object"}},"description":null,"group_id":"dbd0be272eaa427280cd04f618f990db","host":"elb.cn-north-4.myhuaweicloud.com","id":"4572af90e80946369e1e5504a73b6079","info_version":"v3","method":"put","name":"UpdateL7Policy","parameters":{},"paths":{"/v3/{project_id}/elb/l7policies/{l7policy_id}":{"put":{"deprecated":false,"description":"更新七层转发策略。","operationId":"UpdateL7Policy","parameters":[{"description":"This is a auto create Body Object","in":"body","name":"UpdateL7PolicyRequestBody","required":true,"schema":{"$ref":"#/definitions/UpdateL7PolicyRequestBody"}},{"description":"参数解释:IAM鉴权Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-order":1},{"description":"参数解释:转发策略ID。","in":"path","name":"l7policy_id","required":true,"type":"string","x-order":3},{"description":"参数解释:项目ID。","in":"path","name":"project_id","required":true,"type":"string","x-order":2}],"responses":{"200":{"description":"操作正常返回。","examples":{"application/json":{"l7policy":{"action":"REDIRECT_TO_POOL","admin_state_up":true,"description":"","fixed_response_config":null,"id":"01832d99-bbd8-4340-9d0c-6ff8f7a37307","listener_id":"cdb03a19-16b7-4e6b-bfec-047aeec74f56","name":"l7policy-67","position":100,"priority":null,"project_id":"7a9941d34fc1497d8d0797429ecfd354","provisioning_status":"ACTIVE","redirect_listener_id":null,"redirect_pool_id":"768e9e8c-e7cb-4fef-b24b-af9399dbb240","redirect_pools_config":{"pool_id":"722e9e8c-e7cb-4fef-b24b-af9399dbb240","weight":12},"redirect_pools_sticky_session_config":{"enable":false,"timeout":23},"redirect_url":null,"redirect_url_config":null,"rules":[{"id":"c5c2d625-676b-431e-a4c7-c59cc2664881"}]},"request_id":"e5c07525-1470-47b6-9b0c-567527a036aa"}},"schema":{"$ref":"#/definitions/UpdateL7PolicyResponseBody"}}},"summary":"更新转发策略","tags":["转发策略"],"x-apiexplorer-hide":"false","x-constraint":"","x-first-open-time":"2019-04-30","x-hybridcloud":"","x-is-registered":"Y","x-name":"更新转发策略","x-open-region-cloud":"hc,hk,hws_eu,otc,ocb,tlf,ctc,hcso,sbc,g42,tm,cmcc,hk_g42,dt_test,hcso_dt,mix,hk_sbc,hws_ocb,hk_vdf,fcs,fcs_dt,dt","x-order":4,"x-publishpath":"","x-request-examples-1":{"l7policy":{"description":"Update policy.","name":"My policy.","redirect_listener_id":"48a97732-449e-4aab-b561-828d29e45050"}},"x-request-examples-description-1":"更新转发策略","x-request-examples-text-1":{"l7policy":{"description":"Update policy.","name":"My policy.","redirect_listener_id":"48a97732-449e-4aab-b561-828d29e45050"}},"x-request-examples-url-1":"PUT https://{ELB_Endpoint}/v3/99a3fff0d03c428eac3678da6a7d0f24/elb/l7policies/cf4360fd-8631-41ff-a6f5-b72c35da74be","x-scope":"Commercial","x-source":"SelfDeveloped","x-support-sdk":"Y","x-version":"v3"}}},"product_short":"ELB","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"更新转发策略","tags":"转发策略","uri":null,"version":"2.0"}