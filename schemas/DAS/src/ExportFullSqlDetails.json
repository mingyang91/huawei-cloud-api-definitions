{"base_path":"/","components":null,"consumes":"","definitions":{"ErrorResp":{"description":"失败时返回的错误对象","properties":{"error_code":{"description":"错误码","maxLength":36,"minLength":8,"type":"string"},"error_msg":{"description":"错误描述","maxLength":512,"minLength":2,"type":"string"}},"required":["error_code","error_msg"]},"ExportFullSqlDetailsResp":{"properties":{"full_sql_details":{"description":"全量SQL明细列表。","items":{"$ref":"#/definitions/FullSqlDetail"},"type":"array"},"total":{"description":"总数。","format":"int32","type":"integer"}},"required":["full_sql_details","total"]},"FullSqlDetail":{"properties":{"client":{"description":"客户端。","type":"string"},"cpu_time":{"description":"CPU耗时(微秒)。","format":"double","type":"number"},"database":{"description":"数据库。","type":"string"},"error_no":{"description":"错误码。","type":"string"},"execute_at":{"description":"执行开始时间(Unix timestamp),单位:毫秒。","format":"int64","type":"integer"},"innodb_io_read":{"description":"物理I/O读次数。","format":"int32","type":"integer"},"innodb_io_read_bytes":{"description":"物理I/O读字节数。","format":"int64","type":"integer"},"innodb_io_read_wait":{"description":"物理I/O读取等待耗时(毫秒)。","format":"double","type":"number"},"innodb_lock_wait":{"description":"行锁等待耗时(毫秒)。","format":"double","type":"number"},"innodb_queue_wait":{"description":"进入innodb的等待耗时(毫秒)。","format":"double","type":"number"},"kernel_version":{"description":"内核版本号,DDM实例使用。","type":"string"},"lock_time":{"description":"锁等待耗时(毫秒)。","format":"double","type":"number"},"node_id":{"description":"节点ID。","type":"string"},"operate_type":{"description":"操作类型。","type":"string"},"query_tables":{"description":"查询中所有的表名(格式:库名.表名|库名.表名)。","type":"string"},"query_time":{"description":"执行耗时(毫秒)。","format":"double","type":"number"},"query_time_detail":{"description":"SQL执行各阶段细分耗时,DDM实例使用。","type":"string"},"rows_affected":{"description":"更新行数。","format":"int64","type":"integer"},"rows_examined":{"description":"扫描行数。","format":"int64","type":"integer"},"rows_sent":{"description":"返回行数。","format":"int64","type":"integer"},"send_bytes":{"description":"网络发送字节数。","format":"int64","type":"integer"},"session_id":{"description":"会话ID。","type":"string"},"sql":{"description":"SQL语句。","type":"string"},"sql_template_id":{"description":"SQL模板ID。","type":"string"},"status":{"description":"状态。","type":"string"},"thread_id":{"description":"线程ID。","type":"string"},"trx_id":{"description":"事务ID。","format":"int64","type":"integer"},"user":{"description":"用户。","type":"string"}},"required":["sql","sql_template_id","operate_type","status","error_no","database","thread_id","client","user","execute_at","query_time","lock_time","rows_examined","rows_sent","rows_affected","trx_id","cpu_time","send_bytes","query_tables","innodb_io_read_bytes","innodb_io_read","innodb_io_read_wait","innodb_lock_wait","innodb_queue_wait","kernel_version","query_time_detail","session_id","node_id"]}},"description":null,"group_id":"7f831fc0dd494cfe86eff0b79e4f207d","host":"das.cn-north-4.myhuaweicloud.com","id":"30e80defefd24a4e8d2398e8e4c0d8d9","info_version":"v3","method":"get","name":"ExportFullSqlDetails","parameters":{},"paths":{"/v3/{project_id}/instances/{instance_id}/full-sql-search":{"get":{"description":"全量SQL开关打开后,创建SQL洞察任务,支持按节点、用户名、数据库、操作类型等导出全量SQL明细数据。该功能仅支持付费实例。","operationId":"ExportFullSqlDetails","parameters":[{"description":"项目ID。","in":"path","name":"project_id","required":true,"type":"string"},{"description":"实例ID。","in":"path","name":"instance_id","required":true,"type":"string"},{"description":"开始时间(Unix timestamp),单位:毫秒。","format":"int64","in":"query","name":"start_at","required":true,"type":"integer"},{"description":"结束时间(Unix timestamp),单位:毫秒。","format":"int64","in":"query","name":"end_at","required":true,"type":"integer"},{"description":"SQL洞察任务ID列表,时间范围大于1天的SQL洞察任务后台将拆分为多个任务解析,该场景支持多任务过滤导出。","in":"query","items":{"format":"int64","type":"integer"},"name":"task_ids","required":false,"type":"array"},{"description":"节点ID。","in":"query","name":"node_id","required":false,"type":"string"},{"description":"关键字(可组合,用逗号分隔)。","in":"query","name":"keyword","required":false,"type":"string"},{"description":"是否模糊匹配。","in":"query","name":"fuzzy","required":false,"type":"string"},{"description":"用户名(可组合,用空格分隔)。","in":"query","name":"user_list","required":false,"type":"string"},{"description":"数据库(可组合,用空格分隔)。","in":"query","name":"db_list","required":false,"type":"string"},{"description":"操作类型(可组合,用空格分隔)。","in":"query","name":"operation_list","required":false,"type":"string"},{"description":"客户端IP(可组合,用空格分隔)。","in":"query","name":"client_ip_list","required":false,"type":"string"},{"description":"线程ID(可组合,用空格分隔)。","in":"query","name":"thread_id_list","required":false,"type":"string"},{"description":"事务ID(可组合,用空格分隔)。","in":"query","name":"trx_id_list","required":false,"type":"string"},{"description":"会话ID(可组合,用空格分隔)。","in":"query","name":"session_id_list","required":false,"type":"string"},{"description":"执行状态(0:成功,1:失败,可组合,用空格分隔)。","in":"query","name":"status_list","required":false,"type":"string"},{"description":"SQL模板ID(可组合,用空格分隔)。","in":"query","name":"sql_template_ids","required":false,"type":"string"},{"description":"最小执行耗时(毫秒)。","format":"double","in":"query","name":"cost_min","required":false,"type":"number"},{"description":"最大执行耗时(毫秒)。","format":"double","in":"query","name":"cost_max","required":false,"type":"number"},{"description":"最小扫描行数。","format":"int64","in":"query","name":"scan_min","required":false,"type":"integer"},{"description":"最大扫描行数。","format":"int64","in":"query","name":"scan_max","required":false,"type":"integer"},{"description":"最小影响行数。","format":"int64","in":"query","name":"affect_min","required":false,"type":"integer"},{"description":"最大影响行数。","format":"int64","in":"query","name":"affect_max","required":false,"type":"integer"},{"description":"最小返回行数。","format":"int64","in":"query","name":"return_min","required":false,"type":"integer"},{"description":"最大返回行数。","format":"int64","in":"query","name":"return_max","required":false,"type":"integer"},{"default":"execute_at","description":"排序字段(execute_at:执行时间, execute_cost:执行耗时, lock_wait_time:锁等待时间, rows_examined:扫描行数, rows_returned:返回行数)。","in":"query","name":"sort_field","required":false,"type":"string"},{"default":false,"description":"排序顺序(true:正序, false:逆序)。","in":"query","name":"asc","required":false,"type":"boolean"},{"default":1,"description":"页码。","format":"int32","in":"query","minimum":1,"name":"page","required":false,"type":"integer"},{"default":20,"description":"每页记录数。最大为100。","format":"int32","in":"query","maximum":100,"minimum":1,"name":"limit","required":false,"type":"integer"},{"description":"用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"请求语言类型。","enum":["en-us","zh-cn"],"in":"header","name":"X-Language","required":false,"type":"string"}],"responses":{"200":{"description":"Success.","examples":{"application/json":{"full_sql_details":[{"client":"100.79.3.154","cpu_time":0.0,"database":"test_db","error_no":"","execute_at":1738808280958,"lock_time":0.0,"node_id":"fec05693c76c4f389561051db430324cno01","operate_type":"select","query_time":90000.0,"rows_affected":0,"rows_examined":0,"rows_sent":1,"sql":"select sleep(90)","sql_template_id":"AAD913807ECE9C66","status":"success","thread_id":"5866666","trx_id":0,"user":"root"}],"total":1036}},"schema":{"$ref":"#/definitions/ExportFullSqlDetailsResp"}},"400":{"description":"Client error.","schema":{"$ref":"#/definitions/ErrorResp"}},"500":{"description":"Server error.","schema":{"$ref":"#/definitions/ErrorResp"}}},"summary":"导出全量SQL明细","tags":["云DBA"],"x-das-is-publish":"#ExportFullSqlDetails_Placeholder#","x-is-registered":"Y","x-request-examples-url-1":"GET https://das.cn-north-1.myhuaweicloud.com/v3/054e292c9880d4992f02c0196d3ea468/instances/da304cd5bbb944de828759bc7be3d3fein01/full-sql-search?start_at=1738733117000&end_at=1738808281000&task_ids=1128","x-support-sdk":"Y"}}},"product_short":"DAS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"导出全量SQL明细","tags":"云DBA","uri":null,"version":"2.0"}