{"base_path":"/","components":null,"consumes":"","definitions":{"ErrorResp":{"description":"失败时返回的错误对象","properties":{"error_code":{"description":"错误码","maxLength":36,"minLength":8,"type":"string"},"error_msg":{"description":"错误描述","maxLength":512,"minLength":2,"type":"string"}},"required":["error_code","error_msg"]},"InnodbLock":{"properties":{"lock_data":{"description":"事务锁住的主键值,若是表锁,则该值为null","type":"string"},"lock_id":{"description":"锁ID","type":"string"},"lock_index":{"description":"如果是lock_type='RECORD' 行级锁 ,为锁住的索引,如果是表锁为null","type":"string"},"lock_mode":{"description":"锁模式,取值为S[,GAP], X[,GAP], IS[,GAP], IX[,GAP], AUTO_INC, and UNKNOWN。","type":"string"},"lock_page":{"description":"如果是lock_type='RECORD' 行级锁 ,为锁住的页号,如果是表锁为null","type":"string"},"lock_rec":{"description":"如果是lock_type='RECORD' 行级锁 ,为锁住的堆号,如果是表锁为null","type":"string"},"lock_space":{"description":"如果是lock_type='RECORD' 行级锁 ,为锁住的索引,如果是表锁为null","type":"string"},"lock_table":{"description":"加锁的表","type":"string"},"lock_trx_id":{"description":"事务ID","type":"string"},"lock_type":{"description":"锁类型,取值为RECORD或TABLE。RECORD为行锁, TABLE为表锁","type":"string"}},"required":["lock_id","lock_trx_id","lock_mode","lock_type","lock_table","lock_index","lock_space","lock_page","lock_rec","lock_data"]},"InnodbLockWaits":{"properties":{"blocking_lock_id":{"description":"阻塞的锁的ID","type":"string"},"blocking_trx_id":{"description":"阻塞的事务ID","type":"string"},"requested_lock_id":{"description":"申请的锁的ID","type":"string"},"requesting_trx_id":{"description":"申请锁资源的事务ID","type":"string"}},"required":["requesting_trx_id","requested_lock_id","blocking_trx_id","blocking_lock_id"]},"InnodbTrx":{"properties":{"innodb_hold_locks":{"description":"持有锁信息","items":{"$ref":"#/definitions/InnodbLock"},"type":"array"},"innodb_wait_locks":{"description":"等待锁信息","items":{"$ref":"#/definitions/InnodbLock"},"type":"array"},"trx_id":{"description":"事务ID","type":"string"},"trx_isolation_level":{"description":"隔离级别","type":"string"},"trx_mysql_thread_id":{"description":"会话ID,同ListProcesses接口返回的id。","type":"string"},"trx_query":{"description":"事务运行的SQL语句","type":"string"},"trx_rows_locked":{"description":"锁定的行数量(近似值)","type":"string"},"trx_rows_modified":{"description":"事务插入或者修改的行数","type":"string"},"trx_started":{"description":"事务开始时间","type":"string"},"trx_state":{"description":"事务状态","type":"string"},"trx_tables_locked":{"description":"加行锁的表数量","type":"string"},"trx_wait_started":{"description":"事务等待开始时间","type":"string"}},"required":["trx_id","trx_state","trx_started","trx_wait_started","trx_mysql_thread_id","trx_query","trx_tables_locked","trx_rows_locked","trx_rows_modified","trx_isolation_level","innodb_wait_locks","innodb_hold_locks"]},"QueryInnoDBLockResp":{"properties":{"count":{"description":"当前持有或等待锁的事务数量","format":"int32","type":"integer"},"innodb_lock_waits":{"description":"每个事务请求的锁以及阻塞该请求的锁的对应关系","items":{"$ref":"#/definitions/InnodbLockWaits"},"type":"array"},"innodb_trx":{"description":"当前持有或等待锁的事务信息","items":{"$ref":"#/definitions/InnodbTrx"},"type":"array"}},"required":["innodb_trx","innodb_lock_waits","count"]}},"description":null,"group_id":"7f831fc0dd494cfe86eff0b79e4f207d","host":"das.cn-north-4.myhuaweicloud.com","id":"cc2bd2ea2dc1414396732db6c891f656","info_version":"v3","method":"get","name":"ListInnodbLocks","parameters":{},"paths":{"/v3/{project_id}/instances/{instance_id}/innodb-locks":{"get":{"description":"查询InnoDB锁等待列表。\n目前仅支持MySQL实例。","operationId":"ListInnodbLocks","parameters":[{"description":"项目ID","in":"path","name":"project_id","required":true,"type":"string"},{"description":"实例ID","in":"path","name":"instance_id","required":true,"type":"string"},{"description":"数据库用户ID。每个用户需绑定一个数据库账号(数据库用户由“注册数据库用户”接口创建)。","in":"query","name":"db_user_id","required":true,"type":"string"},{"description":"用户token","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"语言","enum":["zh-cn","en-us"],"in":"header","name":"X-Language","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"Success.","examples":{"application/json":{"count":2,"innodb_lock_waits":[{"blocking_lock_id":"1080882971:27750:3:2","blocking_trx_id":"1080882971","requested_lock_id":"1080883393:27750:3:2","requesting_trx_id":"1080883393"}],"innodb_trx":[{"innodb_hold_locks":[],"innodb_wait_locks":[{"lock_data":"0x0000005528EC","lock_id":"1080883393:27750:3:2","lock_index":"GEN_CLUST_INDEX","lock_mode":"X","lock_page":"3","lock_rec":"2","lock_space":"27750","lock_table":"`abc`.`adfasdf`","lock_trx_id":"1080883393","lock_type":"RECORD"}],"trx_id":"1080883393","trx_isolation_level":"REPEATABLE READ","trx_mysql_thread_id":"115602","trx_query":"DELETE FROM adfasdf WHERE  id =1","trx_rows_locked":"1","trx_rows_modified":"0","trx_started":"2021-01-14 18:49:26","trx_state":"LOCK WAIT","trx_tables_locked":"1","trx_wait_started":"2021-01-14 18:49:26"},{"innodb_hold_locks":[{"lock_data":"0x0000005528EC","lock_id":"1080882971:27750:3:2","lock_index":"GEN_CLUST_INDEX","lock_mode":"X","lock_page":"3","lock_rec":"2","lock_space":"27750","lock_table":"`abc`.`adfasdf`","lock_trx_id":"1080882971","lock_type":"RECORD"}],"innodb_wait_locks":[],"trx_id":"1080882971","trx_isolation_level":"REPEATABLE READ","trx_mysql_thread_id":"115598","trx_query":"DELETE FROM adfasdf WHERE  id =1","trx_rows_locked":"1","trx_rows_modified":"0","trx_started":"2021-01-14 18:49:25","trx_state":"LOCK WAIT","trx_tables_locked":"1","trx_wait_started":"2021-01-14 18:49:25"}]}},"schema":{"$ref":"#/definitions/QueryInnoDBLockResp"}},"400":{"description":"BadRequest.","schema":{"$ref":"#/definitions/ErrorResp"}},"500":{"description":"InternalServerError.","schema":{"$ref":"#/definitions/ErrorResp"}}},"summary":"查询InnoDB锁等待列表","tags":["云DBA"],"x-das-is-publish":"#ListInnodbLocks_Placeholder#","x-is-registered":"Y","x-order":4,"x-request-examples-url-1":"GET https://das.cn-north-1.myhuaweicloud.com/v3/054e292c9880d4992f02c0196d3ea468/instances/da304cd5bbb944de828759bc7be3d3fein01/innodb-locks?db_user_id=2c250598-1e3c-4d31-bc19-be1d866247e6","x-support-sdk":"Y"}}},"product_short":"DAS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询InnoDB锁等待列表","tags":"云DBA","uri":null,"version":"2.0"}