{"base_path":"/","components":null,"consumes":"","definitions":{"ErrorResp":{"description":"失败时返回的错误对象","properties":{"error_code":{"description":"错误码","maxLength":36,"minLength":8,"type":"string"},"error_msg":{"description":"错误描述","maxLength":512,"minLength":2,"type":"string"}},"required":["error_code","error_msg"]},"TopSqlTemplate":{"properties":{"avg_cost":{"description":"平均耗时(ms)。","format":"double","type":"number"},"avg_lock_time":{"description":"平均锁等待耗时(ms)。","format":"double","type":"number"},"avg_rows_affected":{"description":"平均影响行数。","format":"double","type":"number"},"avg_rows_examined":{"description":"平均扫描行数。","format":"double","type":"number"},"avg_rows_sent":{"description":"平均返回行数。","format":"double","type":"number"},"db_name":{"description":"数据库名称。","type":"string"},"execute_num":{"description":"总执行次数。","format":"int64","type":"integer"},"execute_num_ratio":{"description":"执行次数占比。","type":"string"},"sql_sample_string":{"description":"SQL样本。","type":"string"},"sql_template":{"description":"SQL模板。","type":"string"},"sql_type":{"description":"SQL操作类型。","type":"string"},"total_cost":{"description":"总耗时(ms)。","format":"double","type":"number"},"total_cost_ratio":{"description":"总耗时占比。","type":"string"},"total_examined_ratio":{"description":"扫描行数占比。","type":"string"},"total_rows_examined":{"description":"总扫描行数。","format":"double","type":"number"}},"required":["sql_template","sql_sample_string","sql_type","db_name","execute_num","total_cost","avg_cost","avg_rows_sent","avg_rows_affected","avg_lock_time","total_rows_examined","avg_rows_examined","total_cost_ratio","total_examined_ratio","execute_num_ratio"],"type":"object"},"TopSqlTemplatesDetailsResp":{"properties":{"top_sql_templates":{"description":"SQL模板列表。","items":{"$ref":"#/definitions/TopSqlTemplate"},"type":"array"},"total_count":{"description":"SQL模板总数。","format":"int32","type":"integer"}},"required":["top_sql_templates","total_count"],"type":"object"}},"description":null,"group_id":"7f831fc0dd494cfe86eff0b79e4f207d","host":"das.cn-north-4.myhuaweicloud.com","id":"70b3c26584f14cef849421d2f14588a4","info_version":"v3","method":"get","name":"ExportTopSqlTemplatesDetails","parameters":{},"paths":{"/v3/{project_id}/instances/{instance_id}/top-sql-templates":{"get":{"description":"TopSQL开关打开后,导出TopSQL模板列表。该功能仅支持付费实例。查询时间间隔最长一小时。","operationId":"ExportTopSqlTemplatesDetails","parameters":[{"description":"项目ID。","in":"path","name":"project_id","required":true,"type":"string"},{"description":"实例ID。","in":"path","name":"instance_id","required":true,"type":"string"},{"description":"开始时间(Unix timestamp),单位:毫秒。","format":"int64","in":"query","name":"start_at","required":true,"type":"integer"},{"description":"结束时间(Unix timestamp),单位:毫秒。","format":"int64","in":"query","name":"end_at","required":true,"type":"integer"},{"description":"数据库类型。支持MySQL和GaussDB(for MySQL)。","in":"query","name":"datastore_type","required":true,"type":"string"},{"description":"节点ID。","in":"query","name":"node_id","required":false,"type":"string"},{"default":"avgCost","description":"排序字段(executeNum:执行次数, totalCost:总耗时, avgCost:平均耗时, totalScan: 总扫描行数, avgScan:平均扫描行数)。","enum":["executeNum","totalCost","avgCost","totalScan","avgScan"],"in":"query","name":"sort","required":false,"type":"string"},{"default":false,"description":"排序顺序(true:正序, false:逆序)。","in":"query","name":"asc","required":false,"type":"boolean"},{"description":"偏移量。从第一条数据偏移offset条数据后开始查询,默认为0(偏移0条数据,表示从第一条数据开始查询),必须为数字,不能为负数。","format":"int32","in":"query","name":"offset","required":false,"type":"integer"},{"description":"每页记录数,默认为20,最大取值100。","format":"int32","in":"query","name":"limit","required":false,"type":"integer"},{"description":"用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"请求语言类型。","enum":["en-us","zh-cn"],"in":"header","name":"X-Language","required":false,"type":"string"}],"responses":{"200":{"description":"Success.","examples":{"application/json":{"top_sql_templates":[{"avg_cost":5000.266666666666,"avg_lock_time":0,"avg_rows_affected":0,"avg_rows_examined":0,"avg_rows_sent":1,"db_name":"db_01","execute_num":30,"execute_num_ratio":"23.81%","sql_sample_string":"select sleep(5)","sql_template":"SELECT sleep(?)","sql_type":"select","total_cost":150008,"total_cost_ratio":"100.00%","total_examined_ratio":"-","total_rows_examined":0}],"total_count":1}},"schema":{"$ref":"#/definitions/TopSqlTemplatesDetailsResp"}},"400":{"description":"Client error.","schema":{"$ref":"#/definitions/ErrorResp"}},"500":{"description":"Server error.","schema":{"$ref":"#/definitions/ErrorResp"}}},"summary":"导出TopSQL模板列表。","tags":["云DBA"],"x-das-is-publish":"#ExportTopSqlTemplatesDetails_Placeholder#","x-is-registered":"Y","x-order":24,"x-request-examples-description-1":"导出TopSQL模板列表","x-request-examples-url-1":"GET https://das.cn-north-1.myhuaweicloud.com/v3/054c630ff780d4cc2f40c00d7f6fb21d/instances/6243b3fcf2f948578d46ed4c52fb54eein01/top-sql-templates?start_at=1611975464337&end_at=1611979064337&node_id=fec05693c76c4f389561051db430324cno01&sort=avgCost&asc=true&datastore_type=MySQL&offset=0&limit=10","x-support-sdk":"Y"}}},"product_short":"DAS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"导出TopSQL模板列表。","tags":"云DBA","uri":null,"version":"2.0"}