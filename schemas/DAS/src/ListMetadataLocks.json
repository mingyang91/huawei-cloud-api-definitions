{"base_path":"/","components":null,"consumes":"","definitions":{"ErrorResp":{"description":"失败时返回的错误对象","properties":{"error_code":{"description":"错误码","maxLength":36,"minLength":8,"type":"string"},"error_msg":{"description":"错误描述","maxLength":512,"minLength":2,"type":"string"}},"required":["error_code","error_msg"]},"MetadataLock":{"description":"元数据锁","properties":{"block_process":{"description":"阻塞会话列表","items":{"$ref":"#/definitions/Process"},"type":"array"},"command":{"description":"命令","type":"string"},"database":{"description":"会话所在的数据库","type":"string"},"host":{"description":"主机","type":"string"},"lock_duration":{"description":"锁范围,取值为MDL_STATEMENT、MDL_TRANSACTION、MDL_EXPLICIT,分别表示语句级别、事务级别、global级别","type":"string"},"lock_mode":{"description":"加锁模式,取值为MDL_SHARED 、MDL_EXCLUSIVE 、MDL_SHARED_READ、MDL_SHARED_WRITE等。","type":"string"},"lock_status":{"description":"锁状态,取值为PENDING和GRANTED,分别表示等待锁和持有锁。","type":"string"},"lock_type":{"description":"锁类型,取值为Table metadata lock、Schema metadata lock、Tablespace lock、Global read lock,分别表示表元数据锁、库元数据锁、表空间锁、全局读锁。","type":"string"},"sql":{"description":"SQL语句","type":"string"},"state":{"description":"状态","type":"string"},"table_name":{"description":"表名","type":"string"},"table_schema":{"description":"锁所在的数据库,对于部分Global read lock级别的元数据锁,该值为空。","type":"string"},"thread_id":{"description":"会话ID","type":"string"},"time":{"description":"时间","type":"string"},"trx_exec_time":{"description":"事务执行时间","type":"string"},"user":{"description":"用户","type":"string"},"wait_process":{"description":"等待会话列表","items":{"$ref":"#/definitions/Process"},"type":"array"}},"required":["thread_id","lock_status","lock_mode","lock_type","lock_duration","table_schema","table_name","user","time","host","database","command","state","sql","trx_exec_time","block_process","wait_process"]},"Process":{"properties":{"command":{"description":"命令","type":"string"},"database":{"description":"数据库","type":"string"},"host":{"description":"主机","type":"string"},"id":{"description":"会话ID","type":"string"},"sql":{"description":"SQL语句","type":"string"},"state":{"description":"状态","type":"string"},"time":{"description":"会话持续时间","type":"string"},"trx_executed_time":{"description":"事务持续时间","type":"string"},"user":{"description":"用户","type":"string"}},"required":["id","user","host","database","command","time","state","sql","trx_executed_time"]},"QueryMetadataLockResp":{"properties":{"count":{"description":"元数据锁数量","format":"int32","type":"integer"},"metadata_locks":{"description":"元数据锁列表","items":{"$ref":"#/definitions/MetadataLock"},"type":"array"}},"required":["metadata_locks","count"]}},"description":null,"group_id":"7f831fc0dd494cfe86eff0b79e4f207d","host":"das.cn-north-4.myhuaweicloud.com","id":"d9fe82a58bf7447da0fd8024c80d05ef","info_version":"v3","method":"get","name":"ListMetadataLocks","parameters":{},"paths":{"/v3/{project_id}/instances/{instance_id}/metadata-locks":{"get":{"description":"查询元数据锁列表。\n目前仅支持MySQL实例。","operationId":"ListMetadataLocks","parameters":[{"description":"项目ID","in":"path","name":"project_id","required":true,"type":"string"},{"description":"实例ID","in":"path","name":"instance_id","required":true,"type":"string"},{"description":"数据库用户ID。每个用户需绑定一个数据库账号(数据库用户由“注册数据库用户”接口创建)。","in":"query","name":"db_user_id","required":true,"type":"string"},{"description":"会话ID","in":"query","name":"thread_id","required":false,"type":"string"},{"description":"数据库名称","in":"query","name":"database","required":false,"type":"string"},{"description":"表名","in":"query","name":"table","required":false,"type":"string"},{"description":"用户token","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"语言","enum":["zh-cn","en-us"],"in":"header","name":"X-Language","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"Success.","examples":{"application/json":{"count":1,"metadata_locks":[{"block_process":[],"command":"Sleep","database":"test_zyr","host":"das server","lock_duration":"MDL_TRANSACTION","lock_mode":"MDL_SHARED_READ","lock_status":"GRANTED","lock_type":"Table metadata lock","sql":null,"state":"","table_name":"test2","table_schema":"test_zyr","thread_id":"4096619","time":"40","trx_exec_time":"341","user":"root","wait_process":[]}]}},"schema":{"$ref":"#/definitions/QueryMetadataLockResp"}},"400":{"description":"BadRequest.","schema":{"$ref":"#/definitions/ErrorResp"}},"500":{"description":"InternalServerError.","schema":{"$ref":"#/definitions/ErrorResp"}}},"summary":"查询元数据锁列表","tags":["云DBA"],"x-das-is-publish":"#ListMetadataLocks_Placeholder#","x-is-registered":"Y","x-order":3,"x-request-examples-url-1":"GET https://das.cn-north-1.myhuaweicloud.com/v3/054e292c9880d4992f02c0196d3ea468/instances/da304cd5bbb944de828759bc7be3d3fein01/metadata-locks?db_user_id=2c250598-1e3c-4d31-bc19-be1d866247e6&thread_id=12121&database=example&table=example","x-support-sdk":"Y"}}},"product_short":"DAS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询元数据锁列表","tags":"云DBA","uri":null,"version":"2.0"}