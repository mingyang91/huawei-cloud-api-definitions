{"base_path":"/","components":null,"consumes":"","definitions":{"AgentId":{"description":"Agent ID","example":"bdcb6303b37c61342792f186e38d580b4b073e0024864019eaf982f30c9384db","pattern":"^.*$","type":"string"},"AttackPhase":{"description":"攻击阶段,包含如下:\n  - reconnaissance : 侦查跟踪\n  - weaponization : 武器构建\n  - delivery : 载荷投递\n  - exploit : 漏洞利用\n  - installation : 安装植入\n  - command_and_control : 命令与控制\n  - actions : 目标达成","example":"actions","type":"string"},"AttackTag":{"description":"攻击标识,包含如下:\n  - attack_success : 攻击成功\n  - attack_attempt : 攻击尝试\n  - attack_blocked : 攻击被阻断\n  - abnormal_behavior : 异常行为\n  - collapsible_host : 主机失陷\n  - system_vulnerability : 系统脆弱性","example":"collapsible_host","type":"string"},"ContainerName":{"description":"容器实例名称,只有容器类型的告警有","example":"container name","pattern":"^.*$","type":"string"},"EventClassId":{"description":"事件分类,包含如下:\n  - container_1001 : 容器命名空间\n  - container_1002 : 容器开放端口\n  - container_1003 : 容器安全选项\n  - container_1004 : 容器挂载目录\n  - containerescape_0001 : 容器高危系统调用\n  - containerescape_0002 : Shocker攻击\n  - containerescape_0003 : DirtCow攻击\n  - containerescape_0004 : 容器文件逃逸攻击\n  - dockerfile_001 : 用户自定义容器保护文件被修改\n  - dockerfile_002 : 容器文件系统可执行文件被修改\n  - dockerproc_001 : 容器进程异常事件上报\n  - fileprotect_0001 : 文件提权\n  - fileprotect_0002 : 关键文件变更\n  - fileprotect_0003 : 关键文件路径变更\n  - fileprotect_0004 : 文件/目录变更\n  - av_1002 : 病毒\n  - av_1003 : 蠕虫\n  - av_1004 : 木马\n  - av_1005 : 僵尸网络\n  - av_1006 : 后门\n  - av_1007 : 间谍软件\n  - av_1008 : 恶意广告软件\n  - av_1009 : 钓鱼\n  - av_1010 : Rootkit\n  - av_1011 : 勒索软件\n  - av_1012 : 黑客工具\n  - av_1013 : 灰色软件\n  - av_1015 : Webshell\n  - av_1016 : 挖矿软件\n  - login_0001 : 尝试暴力破解\n  - login_0002 : 爆破成功\n  - login_1001 : 登录成功\n  - login_1002 : 异地登录\n  - login_1003 : 弱口令\n  - malware_0001 : shell变更事件上报\n  - malware_0002 : 反弹shell事件上报\n  - malware_1001 : 恶意程序\n  - procdet_0001 : 进程异常行为检测\n  - procdet_0002 : 进程提权\n  - procreport_0001 : 危险命令\n  - user_1001 : 账号变更\n  - user_1002 : 风险账号\n  - vmescape_0001 : 虚拟机敏感命令执行\n  - vmescape_0002 : 虚拟化进程访问敏感文件\n  - vmescape_0003 : 虚拟机异常端口访问\n  - webshell_0001 : 网站后门\n  - network_1001 : 恶意挖矿\n  - network_1002 : 对外DDoS攻击\n  - network_1003 : 恶意扫描\n  - network_1004 : 敏感区域攻击\n  - ransomware_0001 : 勒索攻击\n  - ransomware_0002 : 勒索攻击\n  - ransomware_0003 : 勒索攻击\n  - fileless_0001 : 进程注入\n  - fileless_0002 : 动态库注入进程\n  - fileless_0003 : 关键配置变更\n  - fileless_0004 : 环境变量变更\n  - fileless_0005 : 内存文件进程\n  - fileless_0006 : vdso劫持\n  - crontab_1001 : Crontab可疑任务\n  - vul_exploit_0001 : Redis漏洞利用攻击\n  - vul_exploit_0002 : Hadoop漏洞利用攻击\n  - vul_exploit_0003 : MySQL漏洞利用攻击\n  - rootkit_0001 : 可疑rootkit文件\n  - rootkit_0002 : 可疑内核模块\n  - RASP_0004 : 上传Webshell\n  - RASP_0018 : 无文件Webshell\n  - blockexec_001 : 已知勒索攻击\n  - hips_0001 : Windows Defender防护被禁用\n  - hips_0002 : 可疑的黑客工具\n  - hips_0003 : 可疑的勒索加密行为\n  - hips_0004 : 隐藏账号创建\n  - hips_0005 : 读取用户密码凭据\n  - hips_0006 : 可疑的SAM文件导出\n  - hips_0007 : 可疑shadow copy删除操作\n  - hips_0008 : 备份文件删除\n  - hips_0009 : 可疑勒索病毒操作注册表\n  - hips_0010 : 可疑的异常进程行为\n  - hips_0011 : 可疑的扫描探测\n  - hips_0012 : 可疑的勒索病毒脚本运行\n  - hips_0013 : 可疑的挖矿命令执行\n  - hips_0014 : 可疑的禁用windows安全中心\n  - hips_0015 : 可疑的停止防火墙服务行为\n  - hips_0016 : 可疑的系统自动恢复禁用\n  - hips_0017 : Offies 创建可执行文件\n  - hips_0018 : 带宏Offies文件异常创建\n  - hips_0019 : 可疑的注册表操作\n  - hips_0020 : Confluence远程代码执行\n  - hips_0021 : MSDT远程代码执行\n  - portscan_0001 : 通用端口扫描\n  - portscan_0002 : 秘密端口扫描\n  - k8s_1001 : Kubernetes事件删除\n  - k8s_1002 : 创建特权Pod\n  - k8s_1003 : Pod中使用交互式shell\n  - k8s_1004 : 创建敏感目录Pod\n  - k8s_1005 : 创建主机网络的Pod\n  - k8s_1006 : 创建主机Pid空间的Pod\n  - k8s_1007 : 普通pod访问APIserver认证失败\n  - k8s_1008 : 普通Pod通过Curl访问APIServer\n  - k8s_1009 : 系统管理空间执行exec\n  - k8s_1010 : 系统管理空间创建Pod\n  - k8s_1011 : 创建静态Pod\n  - k8s_1012 : 创建DaemonSet\n  - k8s_1013 : 创建集群计划任务\n  - k8s_1014 : Secrets操作\n  - k8s_1015 : 枚举用户可执行的操作\n  - k8s_1016 : 高权限RoleBinding或ClusterRoleBinding\n  - k8s_1017 : ServiceAccount创建\n  - k8s_1018 : 创建Cronjob\n  - k8s_1019 : Pod中exec使用交互式shell\n  - k8s_1020 : 无权限访问Apiserver\n  - k8s_1021 : 使用curl访问APIServer\n  - k8s_1022 : Ingress漏洞\n  - k8s_1023 : 中间人攻击\n  - k8s_1024 : 蠕虫挖矿木马\n  - k8s_1025 : K8s事件删除\n  - k8s_1026 : SelfSubjectRulesReview场景\n  - imgblock_0001 : 镜像白名单阻断\n  - imgblock_0002 : 镜像黑名单阻断\n  - imgblock_0003 : 镜像标签白名单阻断\n  - imgblock_0004 : 镜像标签黑名单阻断\n  - imgblock_0005 : 创建容器白名单阻断\n  - imgblock_0006 : 创建容器黑名单阻断\n  - imgblock_0007 : 容器mount proc阻断\n  - imgblock_0008 : 容器seccomp unconfined阻断\n  - imgblock_0009 : 容器特权阻断\n  - imgblock_0010 : 容器capabilities阻断","example":"malware_1001","type":"string"},"EventDetailResponseInfo":{"description":"操作详情信息","properties":{"agent_id":{"$ref":"#/definitions/AgentId"},"file_attr":{"$ref":"#/definitions/FileAttr"},"file_hash":{"$ref":"#/definitions/FileHash"},"file_path":{"$ref":"#/definitions/FilePath"},"hash":{"description":"告警事件hash,仅用于告警白名单","example":"7e2368dcab39184f55203a3d6a901016633f7a43e5d36d0e116083d9a37c3557","pattern":"^.*$","type":"string"},"is_parent":{"$ref":"#/definitions/IsParent"},"keyword":{"description":"告警事件关键字,仅用于告警白名单","example":"/root/test","pattern":"^.*$","type":"string"},"login_ip":{"$ref":"#/definitions/LoginIp"},"login_user_name":{"$ref":"#/definitions/LoginUserName"},"private_ip":{"$ref":"#/definitions/PrivateIp"},"process_pid":{"$ref":"#/definitions/ProcessPid"}},"type":"object"},"EventFileResponseInfo":{"description":"文件信息","properties":{"fd_count":{"description":"文件句柄数量","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"fd_info":{"description":"文件句柄信息","pattern":"^.*$","type":"string"},"file_action":{"description":"文件动作","pattern":"^.*$","type":"string"},"file_alias":{"description":"文件别名","pattern":"^.*$","type":"string"},"file_atime":{"description":"文件最后一次访问时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"file_attr":{"description":"文件属性","pattern":"^.*$","type":"string"},"file_change_attr":{"description":"变更前后的属性","pattern":"^.*$","type":"string"},"file_content":{"description":"文件内容","pattern":"^.*$","type":"string"},"file_ctime":{"description":"文件最后一次状态改变时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"file_desc":{"description":"文件描述","pattern":"^.*$","type":"string"},"file_hash":{"description":"文件hash,当前为sha256","pattern":"^.*$","type":"string"},"file_key_word":{"description":"文件关键字","pattern":"^.*$","type":"string"},"file_md5":{"description":"文件md5","pattern":"^.*$","type":"string"},"file_mtime":{"description":"文件最后一次修改时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"file_new_path":{"description":"新文件路径","pattern":"^.*$","type":"string"},"file_operation":{"description":"文件操作类型","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"file_path":{"description":"文件路径","pattern":"^.*$","type":"string"},"file_sha256":{"description":"文件sha256","pattern":"^.*$","type":"string"},"file_size":{"description":"文件大小","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"file_type":{"description":"文件类型","pattern":"^.*$","type":"string"},"is_dir":{"description":"是否目录","type":"boolean"}},"type":"object"},"EventId":{"description":"事件编号","example":"0009bae0-8700-11eb-bb3f-fa163e01e338","pattern":"^.*$","type":"string"},"EventManagementResponseInfo":{"description":"事件详情统计","properties":{"agent_status":{"description":"Agent状态,包含如下5种。\n  - installed :已安装。\n  - not_installed :未安装。\n  - online :在线。\n  - offline :离线。\n  - install_failed :安装失败。\n  - installing :安装中。","maxLength":32,"minLength":1,"type":"string"},"app_info":{"description":"应用信息,json格式","properties":{},"type":"object"},"asset_value":{"description":"资产重要性,包含如下4种\n  - important :重要资产\n  - common :一般资产\n  - test :测试资产","maxLength":128,"minLength":0,"type":"string"},"attack_phase":{"$ref":"#/definitions/AttackPhase"},"attack_tag":{"$ref":"#/definitions/AttackTag"},"container_name":{"$ref":"#/definitions/ContainerName"},"description":{"description":"告警说明","maxLength":1024,"minLength":0,"type":"string"},"event_abstract":{"description":"告警摘要","maxLength":512,"minLength":0,"type":"string"},"event_class_id":{"$ref":"#/definitions/EventClassId"},"event_count":{"description":"事件发生次数","example":10,"maximum":2147483647,"minimum":0,"type":"integer"},"event_details":{"description":"事件信息的简述","example":"event_details","maxLength":204800,"minLength":0,"pattern":"^.*$","type":"string"},"event_id":{"$ref":"#/definitions/EventId"},"event_name":{"$ref":"#/definitions/EventName"},"event_type":{"$ref":"#/definitions/EventType"},"extend_info":{"description":"事件扩展信息,json格式","properties":{},"type":"object"},"file_info_list":{"description":"文件信息列表","items":{"$ref":"#/definitions/EventFileResponseInfo"},"maxItems":100,"minItems":0,"type":"array"},"forensic_info":{"description":"取证信息,json格式","properties":{},"type":"object"},"geo_info":{"description":"地理位置信息,json格式","properties":{},"type":"object"},"handle_method":{"$ref":"#/definitions/HandleMethod"},"handle_status":{"$ref":"#/definitions/HandleStatus"},"handle_time":{"$ref":"#/definitions/HandleTime"},"handler":{"$ref":"#/definitions/Handler"},"host_id":{"$ref":"#/definitions/HostId"},"host_name":{"$ref":"#/definitions/HostName"},"host_status":{"description":"服务器状态,包含如下4种。\n  - ACTIVE :运行中。\n  - SHUTOFF :关机。\n  - BUILDING :创建中。\n  - ERROR :故障。","maxLength":32,"minLength":1,"type":"string"},"image_name":{"$ref":"#/definitions/ImageName"},"malware_info":{"description":"恶意软件信息,json格式","properties":{},"type":"object"},"network_info":{"description":"网络信息,json格式","properties":{},"type":"object"},"occur_time":{"$ref":"#/definitions/OccurTime"},"operate_accept_list":{"$ref":"#/definitions/OperateAcceptList"},"operate_detail_list":{"description":"操作详情信息列表(页面不展示)","items":{"$ref":"#/definitions/EventDetailResponseInfo"},"maxItems":100,"minItems":0,"type":"array"},"os_type":{"$ref":"#/definitions/OsType"},"private_ip":{"$ref":"#/definitions/PrivateIp"},"process_info_list":{"description":"进程信息列表","items":{"$ref":"#/definitions/EventProcessResponseInfo"},"maxItems":100,"minItems":0,"type":"array"},"protect_status":{"description":"防护状态,包含如下2种。\n- closed :未防护。\n- opened :防护中。","maxLength":32,"minLength":1,"type":"string"},"public_ip":{"$ref":"#/definitions/PublicIp"},"recommendation":{"description":"处置建议","pattern":"^.*$","type":"string"},"resource_info":{"$ref":"#/definitions/EventResourceResponseInfo"},"severity":{"$ref":"#/definitions/Severity"},"system_info":{"description":"系统信息,json格式","properties":{},"type":"object"},"tag_list":{"description":"标签列表","items":{"maxLength":10,"minLength":0,"type":"string"},"maxItems":20,"minItems":0,"type":"array"},"user_info_list":{"description":"用户信息列表","items":{"$ref":"#/definitions/EventUserResponseInfo"},"maxItems":100,"minItems":0,"type":"array"}},"type":"object"},"EventManagementsResponseInfo":{"description":"事件列表详情","properties":{"data_list":{"description":"事件列表详情","items":{"$ref":"#/definitions/EventManagementResponseInfo"},"maxItems":1000,"minItems":0,"type":"array"},"total_num":{"description":"告警事件总数","example":10,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"}},"type":"object"},"EventName":{"description":"事件名称","example":"event name","pattern":"^.*$","type":"string"},"EventProcessResponseInfo":{"description":"进程信息","properties":{"ancestor_process_cmdline":{"description":"祖父进程文件命令行","pattern":"^.*$","type":"string"},"ancestor_process_path":{"description":"祖父进程文件路径","pattern":"^.*$","type":"string"},"ancestor_process_pid":{"description":"祖父进程id","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"block":{"description":"是否阻断成功,1阻断成功 0阻断失败","format":"int32","maximum":1,"minimum":0,"type":"integer"},"child_process_cmdline":{"description":"子进程文件命令行","pattern":"^.*$","type":"string"},"child_process_egid":{"description":"子进程有效组ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"child_process_euid":{"description":"子进程有效用户ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"child_process_filename":{"description":"子进程文件名","pattern":"^.*$","type":"string"},"child_process_gid":{"description":"子进程组ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"child_process_name":{"description":"子进程名称","pattern":"^.*$","type":"string"},"child_process_path":{"description":"子进程文件路径","pattern":"^.*$","type":"string"},"child_process_pid":{"description":"子进程id","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"child_process_start_time":{"description":"子进程启动时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"child_process_uid":{"description":"子进程用户id","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"escape_cmd":{"description":"逃逸后后执行的命令","pattern":"^.*$","type":"string"},"escape_mode":{"description":"逃逸方式","pattern":"^.*$","type":"string"},"parent_process_cmdline":{"description":"父进程文件命令行","pattern":"^.*$","type":"string"},"parent_process_egid":{"description":"父进程有效组ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"parent_process_euid":{"description":"父进程有效用户ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"parent_process_file_hash":{"description":"父进程文件hash","pattern":"^.*$","type":"string"},"parent_process_filename":{"description":"父进程文件名","pattern":"^.*$","type":"string"},"parent_process_gid":{"description":"父进程组ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"parent_process_name":{"description":"父进程名称","pattern":"^.*$","type":"string"},"parent_process_path":{"description":"父进程文件路径","pattern":"^.*$","type":"string"},"parent_process_pid":{"description":"父进程id","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"parent_process_start_time":{"description":"父进程启动时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"parent_process_uid":{"description":"父进程用户id","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"process_cmdline":{"description":"进程文件命令行","pattern":"^.*$","type":"string"},"process_egid":{"description":"进程有效组ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"process_euid":{"description":"进程有效用户ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"process_file_hash":{"description":"进程文件hash","pattern":"^.*$","type":"string"},"process_filename":{"description":"进程文件名","pattern":"^.*$","type":"string"},"process_gid":{"description":"进程组ID","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"process_hash":{"description":"进程启动文件hash","pattern":"^.*$","type":"string"},"process_name":{"description":"进程名称","pattern":"^.*$","type":"string"},"process_path":{"description":"进程文件路径","pattern":"^.*$","type":"string"},"process_pid":{"description":"进程id","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"process_start_time":{"description":"进程启动时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"process_uid":{"description":"进程用户id","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"process_username":{"description":"运行进程的用户名","pattern":"^.*$","type":"string"},"virt_cmd":{"description":"虚拟化命令","pattern":"^.*$","type":"string"},"virt_process_name":{"description":"虚拟化进程名称","pattern":"^.*$","type":"string"}},"type":"object"},"EventResourceResponseInfo":{"description":"资源信息","properties":{"cloud_id":{"description":"云主机ID","pattern":"^.*$","type":"string"},"cluster_id":{"description":"集群id","pattern":"^.*$","type":"string"},"cluster_name":{"description":"集群名称","pattern":"^.*$","type":"string"},"container_id":{"description":"容器ID","pattern":"^.*$","type":"string"},"container_status":{"description":"容器状态","pattern":"^.*$","type":"string"},"domain_id":{"description":"租户账号ID","pattern":"^.*$","type":"string"},"enterprise_project_id":{"description":"企业项目ID","pattern":"^.*$","type":"string"},"host_attr":{"description":"主机属性","pattern":"^.*$","type":"string"},"image_id":{"description":"镜像ID","pattern":"^.*$","type":"string"},"image_name":{"description":"镜像名称","pattern":"^.*$","type":"string"},"micro_service":{"description":"微服务","pattern":"^.*$","type":"string"},"namespace":{"description":"namespace","pattern":"^.*$","type":"string"},"os_bit":{"description":"操作系统位数","pattern":"^.*$","type":"string"},"os_name":{"description":"操作系统名称","pattern":"^.*$","type":"string"},"os_type":{"description":"操作系统类型","pattern":"^.*$","type":"string"},"os_version":{"description":"操作系统版本","pattern":"^.*$","type":"string"},"pod_name":{"description":"pod name","pattern":"^.*$","type":"string"},"pod_uid":{"description":"pod uid","pattern":"^.*$","type":"string"},"project_id":{"description":"项目ID","pattern":"^.*$","type":"string"},"region_name":{"description":"Region名称","pattern":"^.*$","type":"string"},"service":{"description":"业务服务","pattern":"^.*$","type":"string"},"sys_arch":{"description":"系统CPU架构","pattern":"^.*$","type":"string"},"vm_name":{"description":"虚拟机名称","pattern":"^.*$","type":"string"},"vm_uuid":{"description":"虚拟机UUID,即主机ID","pattern":"^.*$","type":"string"},"vpc_id":{"description":"VPC ID","pattern":"^.*$","type":"string"}},"type":"object"},"EventType":{"description":"事件类型,包含如下:\n  - 1001 : 通用恶意软件\n  - 1002 : 病毒\n  - 1003 : 蠕虫\n  - 1004 : 木马\n  - 1005 : 僵尸网络\n  - 1006 : 后门\n  - 1010 : Rootkit\n  - 1011 : 勒索软件\n  - 1012 :黑客工具\n  - 1015 : Webshell\n  - 1016 : 挖矿\n  - 1017 : 反弹Shell\n  - 2001 : 一般漏洞利用\n  - 2012 : 远程代码执行\n  - 2047 : Redis漏洞利用\n  - 2048 : Hadoop漏洞利用\n  - 2049 : MySQL漏洞利用\n  - 3002 : 文件提权\n  - 3003 : 进程提权\n  - 3004 : 关键文件变更\n  - 3005 : 文件/目录变更\n  - 3007 : 进程异常行为\n  - 3015 : 高危命令执行\n  - 3018 : 异常Shell\n  - 3027 : Crontab可疑任务\n  - 3029 :系统安全防护被禁用\n  - 3030 :备份删除\n  - 3031 :异常注册表操作\n  - 3036 : 容器镜像阻断\n  - 4002 : 暴力破解\n  - 4004 : 异常登录\n  - 4006 : 非法系统账号\n  - 4014 : 用户账号添加\n  - 4020 : 用户密码窃取\n  - 6002 : 端口扫描\n  - 6003 : 主机扫描\n  - 13001 : Kubernetes事件删除\n  - 13002 : Pod异常行为\n  - 13003 : 枚举用户信息\n  - 13004 : 绑定集群用户角色","example":1001,"format":"int32","maximum":30000,"minimum":1000,"type":"integer"},"EventUserResponseInfo":{"description":"用户信息","properties":{"login_fail_count":{"description":"用户登录失败次数","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"login_ip":{"description":"用户登录ip","pattern":"^.*$","type":"string"},"login_last_time":{"description":"用户最后一次登录时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"login_mode":{"description":"登录方式","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"pwd_hash":{"description":"口令hash","pattern":"^.*$","type":"string"},"pwd_max_days":{"description":"口令的最长有效期限","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"pwd_min_days":{"description":"口令的最短有效期限","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"pwd_used_days":{"description":"密码使用的天数","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"pwd_warn_left_days":{"description":"口令无效时提前告警天数","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"pwd_with_fuzzing":{"description":"匿名化处理后的口令","pattern":"^.*$","type":"string"},"service_port":{"description":"登录服务端口","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"service_type":{"description":"服务类型,包含如下:\n  - system\n  - mysql\n  - redis","pattern":"^.*$","type":"string"},"user_gid":{"description":"用户gid","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"user_group_name":{"description":"用户组名称","pattern":"^.*$","type":"string"},"user_home_dir":{"description":"用户home目录","pattern":"^.*$","type":"string"},"user_id":{"description":"用户uid","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"user_name":{"description":"用户名称","pattern":"^.*$","type":"string"}},"type":"object"},"FileAttr":{"description":"文件属性","example":"33261","pattern":"^.*$","type":"string"},"FileHash":{"description":"文件哈希","example":"4845dbb7c2e3e064d88d844cd23883703b02c31dbc7be8cfee84e291eca5cb7e","pattern":"^.*$","type":"string"},"FilePath":{"description":"文件路径","example":"/root","pattern":"^.*$","type":"string"},"HandleMethod":{"description":"处理方式,已处理的告警才有,包含如下:\n  - mark_as_handled : 手动处理\n  - ignore : 忽略\n  - add_to_alarm_whitelist : 加入告警白名单\n  - add_to_login_whitelist : 加入登录白名单\n  - isolate_and_kill : 隔离查杀","example":"ignore","type":"string"},"HandleStatus":{"description":"处理状态,包含如下:\n  - unhandled :未处理\n  - handled : 已处理","example":"unhandled","type":"string"},"HandleTime":{"description":"处理时间,毫秒,已处理的告警才有","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"Handler":{"description":"备注信息,已处理的告警才有","example":"handler","pattern":"^.*$","type":"string"},"HostId":{"description":"主机ID","example":"71a15ecc-049f-4cca-bd28-5e90aca1817f","maxLength":64,"minLength":0,"pattern":"^.*$","type":"string"},"HostName":{"description":"服务器名称","example":"HostName","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"ImageName":{"description":"镜像名称,只有容器类型的告警有","example":"image name","pattern":"^.*$","type":"string"},"IsParent":{"description":"是否是父进程","example":false,"type":"boolean"},"LoginIp":{"description":"登录源IP","example":"127.0.0.1","pattern":"^.*$","type":"string"},"LoginUserName":{"description":"登录用户名","example":"root","pattern":"^.*$","type":"string"},"OccurTime":{"description":"发生时间,毫秒","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"OperateAcceptList":{"description":"支持的处理操作","items":{"$ref":"#/definitions/OperateType"},"maxItems":10,"minItems":0,"type":"array"},"OperateType":{"description":"处理方式,包含如下:\n  - mark_as_handled : 手动处理\n  - ignore : 忽略\n  - add_to_alarm_whitelist : 加入告警白名单\n  - add_to_login_whitelist : 加入登录白名单\n  - isolate_and_kill : 隔离查杀\n  - unhandle : 取消手动处理\n  - do_not_ignore : 取消忽略\n  - remove_from_alarm_whitelist : 删除告警白名单\n  - remove_from_login_whitelist : 删除登录白名单\n  - do_not_isolate_or_kill : 取消隔离查杀","example":"ignore","type":"string"},"OsType":{"description":"操作系统类型,包含如下2种。\n  - Linux :Linux。\n  - Windows :Windows。","maxLength":64,"minLength":0,"type":"string","x-example":"Linux"},"PrivateIp":{"description":"服务器私有IP","example":"192.168.1.1","maxLength":256,"minLength":1,"pattern":"^.*$","type":"string"},"ProcessPid":{"description":"进程id","example":313,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"PublicIp":{"description":"弹性公网IP地址","example":"127.0.0.1","pattern":"^.*$","type":"string"},"Severity":{"description":"威胁等级,包含如下:\n  - Security : 安全\n  - Low : 低危\n  - Medium : 中危\n  - High : 高危\n  - Critical : 危急","example":"Critical","type":"string"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"5e8b61cb95804676a8e214369c504d8d","info_version":"v5","method":"get","name":"ListSecurityEvents","parameters":{},"paths":{"/v5/{project_id}/event/events":{"get":{"description":"查入侵事件列表","operationId":"ListSecurityEvents","parameters":[{"description":"事件类别,包含如下:\n  - host : 主机安全事件\n  - container : 容器安全事件","in":"query","maxLength":32,"minLength":0,"name":"category","required":true,"type":"string"},{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)","in":"header","maxLength":32768,"minLength":1,"name":"X-Auth-Token","pattern":"^.*$","required":true,"type":"string","x-example":"$${X-Auth-Token}"},{"description":"Region ID","in":"header","maxLength":128,"minLength":0,"name":"region","pattern":"^.*$","required":true,"type":"string","x-example":"cn-north-5"},{"description":"项目ID","in":"path","maxLength":64,"minLength":20,"name":"project_id","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"企业项目ID,查询所有企业项目时填写:all_granted_eps","in":"query","maxLength":64,"minLength":0,"name":"enterprise_project_id","pattern":"^.*$","required":false,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"查询时间范围天数,与自定义查询时间begin_time,end_time互斥","format":"int32","in":"query","maximum":30,"minimum":1,"name":"last_days","required":false,"type":"integer"},{"description":"服务器名称","in":"query","maxLength":64,"minLength":1,"name":"host_name","pattern":"^.*$","required":false,"type":"string","x-example":"HostName"},{"description":"主机ID","in":"query","maxLength":64,"minLength":0,"name":"host_id","pattern":"^.*$","required":false,"type":"string","x-example":"71a15ecc-049f-4cca-bd28-5e90aca1817f"},{"description":"服务器私有IP","in":"query","maxLength":256,"minLength":1,"name":"private_ip","pattern":"^.*$","required":false,"type":"string","x-example":"192.168.1.1"},{"description":"服务器公网IP","in":"query","maxLength":256,"minLength":1,"name":"public_ip","pattern":"^.*$","required":false,"type":"string","x-example":"192.168.1.1"},{"description":"容器实例名称","in":"query","name":"container_name","pattern":"^.*$","required":false,"type":"string"},{"default":0,"description":"偏移量:指定返回记录的开始位置,必须为数字","format":"int32","in":"query","maximum":2000000,"minimum":0,"name":"offset","required":false,"type":"integer"},{"default":10,"description":"每页显示个数","format":"int32","in":"query","maximum":1000,"minimum":10,"name":"limit","required":false,"type":"integer"},{"description":"事件类型,包含如下:\n  - 1001 : 通用恶意软件\n  - 1002 : 病毒\n  - 1003 : 蠕虫\n  - 1004 : 木马\n  - 1005 : 僵尸网络\n  - 1006 : 后门\n  - 1010 : Rootkit\n  - 1011 : 勒索软件\n  - 1012 :黑客工具\n  - 1015 : Webshell\n  - 1016 : 挖矿\n  - 1017 : 反弹Shell\n  - 2001 : 一般漏洞利用\n  - 2012 : 远程代码执行\n  - 2047 : Redis漏洞利用\n  - 2048 : Hadoop漏洞利用\n  - 2049 : MySQL漏洞利用\n  - 3002 : 文件提权\n  - 3003 : 进程提权\n  - 3004 : 关键文件变更\n  - 3005 : 文件/目录变更\n  - 3007 : 进程异常行为\n  - 3015 : 高危命令执行\n  - 3018 : 异常Shell\n  - 3026 : crontab提权\n  - 3027 : Crontab可疑任务\n  - 3029 :系统安全防护被禁用\n  - 3030 :备份删除\n  - 3031 :异常注册表操作\n  - 3036 : 容器镜像阻断\n  - 4002 : 暴力破解\n  - 4004 : 异常登录\n  - 4006 : 非法系统账号\n  - 4014 : 用户账号添加\n  - 4020 : 用户密码窃取\n  - 6002 : 端口扫描\n  - 6003 : 主机扫描\n  - 13001 : Kubernetes事件删除\n  - 13002 : Pod异常行为\n  - 13003 : 枚举用户信息\n  - 13004 : 绑定集群用户角色","in":"query","items":{"format":"int32","maximum":30000,"minimum":1000,"type":"integer"},"maxItems":500,"minItems":1,"name":"event_types","required":false,"type":"array","x-example":[1001,1002]},{"description":"处置状态,包含如下:\n  - unhandled :未处理\n  - handled : 已处理","in":"query","maxLength":32,"minLength":1,"name":"handle_status","required":false,"type":"string"},{"description":"威胁等级,包含如下:\n  - Security :安全\n  - Low : 低危\n  - Medium : 中危\n  - High : 高危\n  - Critical : 危急","in":"query","maxLength":32,"minLength":1,"name":"severity","required":false,"type":"string"},{"description":"自定义查询时间,与查询时间范围天数互斥,查询时间段的起始时间,毫秒级时间戳,end_time减去begin_time小于等于2天,与查询时间范围天数互斥","in":"query","maxLength":13,"minLength":13,"name":"begin_time","required":false,"type":"string"},{"description":"自定义时间,查询时间段的终止时间,毫秒级时间戳,end_time减去begin_time小于等于2天,与查询时间范围天数互斥","in":"query","maxLength":13,"minLength":13,"name":"end_time","required":false,"type":"string"},{"description":"事件标识,包含如下:\n- container_1001 : 容器命名空间\n- container_1002 : 容器开放端口\n- container_1003 : 容器安全选项\n- container_1004 : 容器挂载目录\n- containerescape_0001 : 容器高危系统调用\n- containerescape_0002 : Shocker攻击\n- containerescape_0003 : DirtCow攻击\n- containerescape_0004 : 容器文件逃逸攻击\n- dockerfile_001 : 用户自定义容器保护文件被修改\n- dockerfile_002 : 容器文件系统可执行文件被修改\n- dockerproc_001 : 容器进程异常事件上报\n- fileprotect_0001 : 文件提权\n- fileprotect_0002 : 关键文件变更\n- fileprotect_0003 : 关键文件路径变更\n- fileprotect_0004 : 文件/目录变更\n- av_1002 : 病毒\n- av_1003 : 蠕虫\n- av_1004 : 木马\n- av_1005 : 僵尸网络\n- av_1006 : 后门\n- av_1007 : 间谍软件\n- av_1008 : 恶意广告软件\n- av_1009 : 钓鱼\n- av_1010 : Rootkit\n- av_1011 : 勒索软件\n- av_1012 : 黑客工具\n- av_1013 : 灰色软件\n- av_1015 : Webshell\n- av_1016 : 挖矿软件\n- login_0001 : 尝试暴力破解\n- login_0002 : 爆破成功\n- login_1001 : 登录成功\n- login_1002 : 异地登录\n- login_1003 : 弱口令\n- malware_0001 : shell变更事件上报\n- malware_0002 : 反弹shell事件上报\n- malware_1001 : 恶意程序\n- procdet_0001 : 进程异常行为检测\n- procdet_0002 : 进程提权\n- crontab_0001 : crontab脚本提权\n- crontab_0002 : 恶意路径提权\n- procreport_0001 : 危险命令\n- user_1001 : 账号变更\n- user_1002 : 风险账号\n- vmescape_0001 : 虚拟机敏感命令执行\n- vmescape_0002 : 虚拟化进程访问敏感文件\n- vmescape_0003 : 虚拟机异常端口访问\n- webshell_0001 : 网站后门\n- network_1001 : 恶意挖矿\n- network_1002 : 对外DDoS攻击\n- network_1003 : 恶意扫描\n- network_1004 : 敏感区域攻击\n- ransomware_0001 : 勒索攻击\n- ransomware_0002 : 勒索攻击\n- ransomware_0003 : 勒索攻击\n- fileless_0001 : 进程注入\n- fileless_0002 : 动态库注入进程\n- fileless_0003 : 关键配置变更\n- fileless_0004 : 环境变量变更\n- fileless_0005 : 内存文件进程\n- fileless_0006 : vdso劫持\n- crontab_1001 : Crontab可疑任务\n- vul_exploit_0001 : Redis漏洞利用攻击\n- vul_exploit_0002 : Hadoop漏洞利用攻击\n- vul_exploit_0003 : MySQL漏洞利用攻击\n- rootkit_0001 : 可疑rootkit文件\n- rootkit_0002 : 可疑内核模块\n- RASP_0004 : 上传Webshell\n- RASP_0018 : 无文件Webshell\n- blockexec_001 : 已知勒索攻击\n- hips_0001 : Windows Defender防护被禁用\n- hips_0002 : 可疑的黑客工具\n- hips_0003 : 可疑的勒索加密行为\n- hips_0004 : 隐藏账号创建\n- hips_0005 : 读取用户密码凭据\n- hips_0006 : 可疑的SAM文件导出\n- hips_0007 : 可疑shadow copy删除操作\n- hips_0008 : 备份文件删除\n- hips_0009 : 可疑勒索病毒操作注册表\n- hips_0010 : 可疑的异常进程行为\n- hips_0011 : 可疑的扫描探测\n- hips_0012 : 可疑的勒索病毒脚本运行\n- hips_0013 : 可疑的挖矿命令执行\n- hips_0014 : 可疑的禁用windows安全中心\n- hips_0015 : 可疑的停止防火墙服务行为\n- hips_0016 : 可疑的系统自动恢复禁用\n- hips_0017 : Offies 创建可执行文件\n- hips_0018 : 带宏Offies文件异常创建\n- hips_0019 : 可疑的注册表操作\n- hips_0020 : Confluence远程代码执行\n- hips_0021 : MSDT远程代码执行\n- portscan_0001 : 通用端口扫描\n- portscan_0002 : 秘密端口扫描\n- k8s_1001 : Kubernetes事件删除\n- k8s_1002 : 创建特权Pod\n- k8s_1003 : Pod中使用交互式shell\n- k8s_1004 : 创建敏感目录Pod\n- k8s_1005 : 创建主机网络的Pod\n- k8s_1006 : 创建主机Pid空间的Pod\n- k8s_1007 : 普通pod访问APIserver认证失败\n- k8s_1008 : 普通Pod通过Curl访问APIServer\n- k8s_1009 : 系统管理空间执行exec\n- k8s_1010 : 系统管理空间创建Pod\n- k8s_1011 : 创建静态Pod\n- k8s_1012 : 创建DaemonSet\n- k8s_1013 : 创建集群计划任务\n- k8s_1014 : Secrets操作\n- k8s_1015 : 枚举用户可执行的操作\n- k8s_1016 : 高权限RoleBinding或ClusterRoleBinding\n- k8s_1017 : ServiceAccount创建\n- k8s_1018 : 创建Cronjob\n- k8s_1019 : Pod中exec使用交互式shell\n- k8s_1020 : 无权限访问Apiserver\n- k8s_1021 : 使用curl访问APIServer\n- k8s_1022 : Ingress漏洞\n- k8s_1023 : 中间人攻击\n- k8s_1024 : 蠕虫挖矿木马\n- k8s_1025 : K8s事件删除\n- k8s_1026 : SelfSubjectRulesReview场景\n- imgblock_0001 : 镜像白名单阻断\n- imgblock_0002 : 镜像黑名单阻断\n- imgblock_0003 : 镜像标签白名单阻断\n- imgblock_0004 : 镜像标签黑名单阻断\n- imgblock_0005 : 创建容器白名单阻断\n- imgblock_0006 : 创建容器黑名单阻断\n- imgblock_0007 : 容器mount proc阻断\n- imgblock_0008 : 容器seccomp unconfined阻断\n- imgblock_0009 : 容器特权阻断\n- imgblock_0010 : 容器capabilities阻断","in":"query","items":{"type":"string"},"maxItems":200,"minItems":1,"name":"event_class_ids","required":false,"type":"array","x-example":["rootkit_0001","portscan_0002","fileprotect_0004"]},{"description":"威胁等级,包含如下:\n  - Security :安全\n  - Low : 低危\n  - Medium : 中危\n  - High : 高危\n  - Critical : 危急","in":"query","items":{"maxLength":32,"minLength":0,"type":"string"},"maxItems":5,"minItems":0,"name":"severity_list","required":false,"type":"array"},{"description":"攻击标识,包含如下:\n  - attack_success : 攻击成功\n  - attack_attempt : 攻击尝试\n  - attack_blocked : 攻击被阻断\n  - abnormal_behavior : 异常行为\n  - collapsible_host : 主机失陷\n  - system_vulnerability : 系统脆弱性","in":"query","maxLength":32,"minLength":0,"name":"attack_tag","required":false,"type":"string"},{"description":"资产重要性,包含如下3种\n  - important :重要资产\n  - common :一般资产\n  - test :测试资产","in":"query","maxLength":128,"minLength":0,"name":"asset_value","required":false,"type":"string"},{"description":"事件标签列表,例如:[\"热点事件\"]","in":"query","items":{"maxLength":10,"minLength":0,"type":"string"},"maxItems":20,"minItems":0,"name":"tag_list","required":false,"type":"array"},{"description":"ATT&CK攻击阶,包含如下:\n  - Reconnaissance : 侦察\n  - Initial Access : 初始访问\n  - Execution : 执行\n  - Persistence : 持久化\n  - Privilege Escalation : 权限提升\n  - Defense Evasion : 防御绕过\n  - Credential Access : 凭据访问\n  - Command and Control : 命令与控制\n  - Impact : 影响破坏","in":"query","maxLength":32,"minLength":0,"name":"att_ck","required":false,"type":"string"},{"description":"告警名称","in":"query","maxLength":128,"minLength":1,"name":"event_name","pattern":"^.*$","required":false,"type":"string","x-example":"EventName"}],"produces":["application/json"],"responses":{"200":{"description":"入侵事件列表","examples":{"application/json":{"data_list":[{"agent_status":"online","asset_value":"common","attack_phase":"exploit","attack_tag":"abnormal_behavior","description":"","event_abstract":"","event_class_id":"lgin_1002","event_details":"file_path:/root/test","event_id":"d8a12cf7-6a43-4cd6-92b4-aabf1e917","event_name":"different locations","event_type":4004,"extend_info":"","forensic_info":{"city":"兰州市","city_id":3110,"country":"中国","ip":"127.0.0.1","sub_division":"甘肃省","user":"zhangsan"},"handle_status":"unhandled","host_name":"xxx","host_status":"ACTIVE","occur_time":1661593036627,"operate_accept_list":["ignore"],"operate_detail_list":[{"agent_id":"c9bed5397db449ebdfba15e85fcfc36accee125c68954daf5cab0528bab59bd8","file_attr":33261,"file_hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","file_path":"/usr/test","hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","is_parent":false,"keyword":"file_path=/usr/test","login_ip":"127.0.0.1","login_user_name":"root","private_ip":"127.0.0.2","process_pid":3123}],"os_type":"Linux","private_ip":"127.0.0.1","process_info_list":[{"ancestor_process_cmdline":"/bin/bash","ancestor_process_path":"/usr/bin/bash","ancestor_process_pid":372612,"block":0,"child_process_cmdline":"/bin/bash","child_process_egid":10000,"child_process_euid":10000,"child_process_filename":"test","child_process_gid":10000,"child_process_name":"test","child_process_path":"/usr/bin/bash","child_process_pid":372612,"child_process_start_time":1661593024,"child_process_uid":10000,"escape_cmd":"/bin/bash","escape_mode":"0","parent_process_cmdline":"/bin/bash","parent_process_egid":10000,"parent_process_euid":10000,"parent_process_file_hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","parent_process_filename":"test","parent_process_gid":10000,"parent_process_name":"test","parent_process_path":"/usr/bin/bash","parent_process_pid":372612,"parent_process_start_time":1661593024,"parent_process_uid":10000,"process_cmdline":"/bin/bash","process_egid":10000,"process_euid":10000,"process_file_hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","process_filename":"test","process_gid":10000,"process_hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","process_name":"test","process_path":"/root/test","process_pid":372612,"process_start_time":1661593024,"process_uid":10000,"process_username":"root","virt_cmd":"/bin/bash","virt_process_name":"test"}],"protect_status":"opened","resource_info":{"cloud_id":"","cluster_id":"","cluster_name":"","container_id":"","container_status":"running / terminated","enterprise_project_id":"0","image_id":"","namespace":"","os_type":"Linux","os_version":"2.5","pod_name":"","pod_uid":"","project_id":"","region_name":"","vm_name":"","vm_uuid":"71a15ecc"},"severity":"Medium","tag_list":["热点事件"],"user_info_list":[{"login_fail_count":0,"login_ip":"","login_last_time":1661593024,"login_mode":0,"service_port":22,"service_type":"ssh","user_name":"zhangsan"}]}],"total_num":1}},"schema":{"$ref":"#/definitions/EventManagementsResponseInfo"}}},"summary":"查入侵事件列表","tags":["入侵检测"],"x-is-registered":"Y","x-order":2,"x-request-examples-description-1":"查询前50条企业项目为xxx下未处理的主机事件信息","x-request-examples-url-1":"GET https://{endpoint}/v5/{project_id}/event/events?offset=0&limit=50&handle_status=unhandled&category=host&enterprise_project_id=xxx","x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查入侵事件列表","tags":"入侵检测","uri":null,"version":"2.0"}