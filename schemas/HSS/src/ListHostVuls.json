{"base_path":"/","components":null,"consumes":"","definitions":{"HostVulInfo":{"properties":{"app_list":{"description":"服务器上受该漏洞影响的软件列表","items":{"properties":{"app_name":{"description":"软件名称","example":"vim","maxLength":256,"minLength":0,"type":"string"},"app_path":{"description":"应用软件的路径(只有应用漏洞有该字段)","example":"/usr/sbin/agetty","maxLength":512,"minLength":1,"type":"string"},"app_version":{"description":"软件版本","example":"1.0.2","maxLength":256,"minLength":0,"type":"string"},"upgrade_version":{"description":"修复漏洞软件需要升级到的版本","example":"1.0.1","maxLength":256,"minLength":0,"type":"string"}},"type":"object"},"maxItems":2147483647,"minItems":0,"type":"array"},"app_name":{"description":"软件名称","maxLength":256,"minLength":0,"type":"string"},"app_path":{"description":"软件路径","maxLength":512,"minLength":0,"type":"string"},"app_version":{"description":"软件版本","maxLength":256,"minLength":0,"type":"string"},"cve_list":{"description":"CVE列表","items":{"properties":{"cve_id":{"description":"CVE ID","example":"CVE-2022-1664","maxLength":32,"minLength":1,"type":"string"},"cvss":{"description":"CVSS分值","example":7.8,"format":"float","maximum":10,"minimum":0,"type":"number"}},"type":"object"},"maxItems":10000,"minItems":1,"type":"array"},"description":{"description":"漏洞描述","example":"Some description about the vulnerabilities","maxLength":65534,"minLength":0,"type":"string"},"disabled_operate_types":{"description":"该漏洞不可进行的操作类型列表","items":{"properties":{"operate_type":{"description":"操作类型\n- ignore : 忽略\n- not_ignore : 取消忽略\n- immediate_repair : 修复\n- manual_repair: 人工修复\n- verify : 验证\n- add_to_whitelist : 加入白名单","example":"immediate_repair","maxLength":64,"minLength":1,"type":"string"},"reason":{"description":"不可进行操作的原因","example":"cce机器的内核漏洞不支持自动修复","maxLength":512,"minLength":0,"type":"string"}},"type":"object"},"maxItems":10000,"minItems":1,"type":"array"},"first_scan_time":{"description":"首次扫描时间","example":1661752185836,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"is_affect_business":{"description":"是否影响业务","example":true,"type":"boolean"},"label_list":{"description":"漏洞标签列表","items":{"example":"label-1","maxLength":65534,"minLength":0,"type":"string"},"maxItems":2147483647,"minItems":0,"type":"array"},"repair_cmd":{"description":"修复命令行","example":"yum update vim","maxLength":256,"minLength":1,"type":"string"},"repair_necessity":{"description":"修复紧急度,包括如下:\n  - immediate_repair : 尽快修复\n  - delay_repair : 延后修复\n  - not_needed_repair : 暂可不修复","example":"immediate_repair","maxLength":64,"minLength":0,"type":"string"},"repair_priority":{"description":"修复优先级,包含如下\n- Critical 紧急 \n- High 高 \n- Medium 中 \n- Low 低","maxLength":10,"minLength":1,"type":"string"},"repair_success_num":{"description":"HSS全网修复该漏洞的次数","example":13,"format":"int32","maximum":1000000,"minimum":0,"type":"integer"},"scan_time":{"description":"最近扫描时间","example":1661752185836,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"severity_level":{"description":"危险程度\n  - Critical : 漏洞cvss评分大于等于9;对应控制台页面的高危\n  - High : 漏洞cvss评分大于等于7,小于9;对应控制台页面的中危\n  - Medium : 漏洞cvss评分大于等于4,小于7;对应控制台页面的中危\n  - Low : 漏洞cvss评分小于4;对应控制台页面的低危","example":"Medium","maxLength":128,"minLength":1,"type":"string"},"solution_detail":{"description":"解决方案","example":"To upgrade the affected software","maxLength":65534,"minLength":0,"type":"string"},"status":{"description":"漏洞状态\n  - vul_status_unfix : 未处理\n  - vul_status_ignored : 已忽略\n  - vul_status_verified : 验证中\n  - vul_status_fixing : 修复中\n  - vul_status_fixed : 修复成功\n  - vul_status_reboot : 修复成功待重启\n  - vul_status_failed : 修复失败\n  - vul_status_fix_after_reboot : 请重启主机再次修复","example":"vul_status_unfix","maxLength":128,"minLength":1,"type":"string"},"support_restore":{"description":"是否可以回滚到修复漏洞时创建的备份","type":"boolean"},"type":{"description":"漏洞类型,包含如下:\n  -linux_vul : linux漏洞\n  -windows_vul : windows漏洞\n  -web_cms : Web-CMS漏洞\n  -app_vul : 应用漏洞","example":"linux_vul","maxLength":128,"minLength":0,"type":"string"},"url":{"description":"URL链接","example":"https://ubuntu.com/security/CVE-2022-27405","maxLength":2083,"minLength":0,"type":"string"},"version":{"description":"主机配额","maxLength":128,"minLength":0,"type":"string"},"vul_id":{"description":"漏洞ID","example":"USN-5528-1","maxLength":64,"minLength":0,"type":"string"},"vul_name":{"description":"漏洞名称","example":"USN-5528-1: FreeType vulnerabilities","maxLength":256,"minLength":0,"type":"string"}},"type":"object"},"HostVulsResponseInfo":{"description":"漏洞","properties":{"data_list":{"description":"服务器上的漏洞列表","items":{"$ref":"#/definitions/HostVulInfo"},"maxItems":2147483647,"minItems":0,"type":"array"},"total_num":{"description":"总数","example":1,"format":"int64","maximum":2147483647,"minimum":0,"type":"integer"}},"type":"object"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"06a07d555f8047ea86e654d897e09be1","info_version":"v5","method":"get","name":"ListHostVuls","parameters":{},"paths":{"/v5/{project_id}/vulnerability/host/{host_id}":{"get":{"description":"查询单台服务器漏洞信息","operationId":"ListHostVuls","parameters":[{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)","in":"header","maxLength":32768,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX..."},{"description":"项目ID","in":"path","maxLength":256,"minLength":1,"name":"project_id","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"default":"0","description":"企业租户ID,“0”表示默认企业项目,查询所有企业项目时填写:all_granted_eps","in":"query","maxLength":256,"minLength":0,"name":"enterprise_project_id","required":false,"type":"string"},{"description":"服务器id","in":"path","maxLength":128,"minLength":1,"name":"host_id","required":true,"type":"string"},{"description":"漏洞类型,默认为linux_vul,包括如下:\n  - linux_vul : 漏洞类型-linux漏洞\n  - windows_vul : 漏洞类型-windows漏洞\n  - web_cms : Web-CMS漏洞\n  - app_vul : 应用漏洞\n  - urgent_vul : 应急漏洞","in":"query","maxLength":64,"minLength":0,"name":"type","required":false,"type":"string","x-example":"linux_vul"},{"description":"漏洞名称","in":"query","maxLength":256,"minLength":0,"name":"vul_name","required":false,"type":"string"},{"default":10,"description":"每页显示个数","format":"int32","in":"query","maximum":200,"minimum":0,"name":"limit","required":false,"type":"integer"},{"default":0,"description":"偏移量:指定返回记录的开始位置","format":"int32","in":"query","maximum":2000000,"minimum":0,"name":"offset","required":false,"type":"integer"},{"description":"处置状态,包含如下:\n  - unhandled :未处理\n  - handled : 已处理","in":"query","maxLength":32,"minLength":1,"name":"handle_status","required":false,"type":"string"},{"description":"漏洞状态,包含如下:\n  - vul_status_unfix : 未处理\n  - vul_status_ignored : 已忽略\n  - vul_status_verified : 验证中\n  - vul_status_fixing : 修复中\n  - vul_status_fixed : 修复成功\n  - vul_status_reboot : 修复成功待重启\n  - vul_status_failed : 修复失败\n  - vul_status_fix_after_reboot : 请重启主机再次修复","in":"query","maxLength":32,"minLength":1,"name":"status","required":false,"type":"string"},{"description":"修复优先级,包含如下\n- Critical 紧急 \n- High 高 \n- Medium 中 \n- Low 低","in":"query","maxLength":10,"minLength":1,"name":"repair_priority","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"服务器上的漏洞列表","examples":{"application/json":{"data_list":[{"app_list":[{"app_name":"Apache Log4j API(Apache Log4j API)","app_path":"/CloudResetPwdUpdateAgent/lib/log4j-api-2.8.2.jar","app_version":"2.8.2","upgrade_version":"2.8.3"},{"app_name":"Apache Log4j Core(Apache Log4j Core)","app_path":"/CloudResetPwdUpdateAgent/lib/log4j-api-2.8.2.jar","app_version":"2.8.2","upgrade_version":"2.8.3"}],"app_name":"Apache Log4j API(Apache Log4j API)","app_path":"/CloudResetPwdUpdateAgent/lib/log4j-api-2.8.2.jar","app_version":"2.8.2","cve_list":[{"cve_id":"CVE-2021-45046","cvss":9}],"description":"发现在某些非默认配置中, Apache Log4j 2.15.0中针对CVE-2021-44228的修复不完整。当日志记录配置使用具有上下文查找(例如$${ctx:loginId})或线程上下文映射模式(%X, %mdc或%MDC)使用JNDI查找模式构建恶意输入数据,从而在某些环境中导致信息泄漏和远程代码执行。Log4j 2.16.0 (Java 8)和2.12.2 (Java 7)通过删除对消息查找模式的支持并在默认情况下禁用JNDI功能来修复此问题。","disabled_operate_types":[{"operate_type":"immediate_repair","reason":"cce机器的内核漏洞不支持自动修复"}],"first_scan_time":1688956612533,"is_affect_business":true,"label_list":[],"repair_cmd":"yum update tcpdump","repair_necessity":"Critical","repair_success_num":3,"scan_time":1690469489713,"severity_level":"Critical","solution_detail":"针对该漏洞的官方修复建议已发布,您可单击链接按照建议进行修复:\nhttps://logging.apache.org/log4j/2.x/security.html\n针对该漏洞的补丁可参考:\nhttps://www.oracle.com/security-alerts/cpujan2022.html\n针对该漏洞的非官方修复建议可参考:\nhttp://www.openwall.com/lists/oss-security/2021/12/14/4\nhttps://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00646.html\nhttps://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-log4j-qRuKNEbd\nhttp://www.openwall.com/lists/oss-security/2021/12/15/3\nhttps://cert-portal.siemens.com/productcert/pdf/ssa-661247.pdf\nhttps://www.kb.cert.org/vuls/id/930724\nhttps://cert-portal.siemens.com/productcert/pdf/ssa-714170.pdf\nhttps://www.debian.org/security/2021/dsa-5022\nhttps://www.oracle.com/security-alerts/alert-cve-2021-44228.html\nhttps://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0032\nhttp://www.openwall.com/lists/oss-security/2021/12/18/1\nhttps://cert-portal.siemens.com/productcert/pdf/ssa-397453.pdf\nhttps://cert-portal.siemens.com/productcert/pdf/ssa-479842.pdf\nhttps://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EOKPQGV24RRBBI4TBZUDQMM4MEH7MXCY/\nhttps://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SIG7FZULMNK2XF6FZRU4VWYDQXNMUGAJ/\n针对该漏洞的漏洞利用/POC已曝光,可参考下方链接进行验证:\nhttps://github.com/X1pe0/Log4J-Scan-Win\nhttps://github.com/cckuailong/Log4j_CVE-2021-45046\nhttps://github.com/BobTheShoplifter/CVE-2021-45046-Info\nhttps://github.com/tejas-nagchandi/CVE-2021-45046\nhttps://github.com/pravin-pp/log4j2-CVE-2021-45046\nhttps://github.com/mergebase/log4j-samples\nhttps://github.com/lukepasek/log4jjndilookupremove\nhttps://github.com/ludy-dev/cve-2021-45046\nhttps://github.com/lijiejie/log4j2_vul_local_scanner\nhttps://github.com/CaptanMoss/Log4Shell-Sandbox-Signature\nhttps://github.com/taise-hub/log4j-poc","status":"vul_status_unfix","support_restore":true,"type":"app_vul","url":"[\"https://www.oracle.com/security-alerts/cpujan2022.html\"]","version":"hss.version.wtp","vul_id":"HCVD-APP-CVE-2021-45046","vul_name":"CVE-2021-45046"}],"total_num":31}},"schema":{"$ref":"#/definitions/HostVulsResponseInfo"}}},"summary":"查询单台服务器漏洞信息","tags":["漏洞管理"],"x-is-registered":"Y","x-order":12,"x-request-examples-description-1":"查询id为xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx的服务器上的漏洞列表前10条数据","x-request-examples-url-1":"GET https://{endpoint}/v5/2b31ed520xxxxxxebedb6e57xxxxxxxx/vulnerability/host/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx?offset=0&limit=10","x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询单台服务器漏洞信息","tags":"漏洞管理","uri":null,"version":"2.0"}