{"base_path":"/","components":null,"consumes":"","definitions":{"AgentId":{"description":"**参数解释**:\nAgent ID\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-64位\n**默认取值**:\n不涉及","example":"bdcb6303b37c61342792f186e38d580b4b073e0024864019eaf982f30c9384db","pattern":"^.*$","type":"string"},"AgentStatus":{"description":"Agent状态,包含如下6种。\n  - installed :已安装。\n  - not_installed :未安装。\n  - online :在线。\n  - offline :离线。\n  - install_failed :安装失败。\n  - installing :安装中。\n  - not_online :不在线的(除了在线以外的所有状态,仅作为查询条件)。","maxLength":64,"minLength":1,"type":"string"},"AgentVersion":{"description":"agent版本","example":"3.2.10","pattern":"^.*$","type":"string"},"AppWhitelistEventDetailResInfo":{"description":"操作详情信息","properties":{"agent_id":{"$ref":"#/definitions/AgentId"},"file_attr":{"$ref":"#/definitions/FileAttr"},"file_hash":{"$ref":"#/definitions/FileHash"},"file_path":{"$ref":"#/definitions/FilePath"},"login_ip":{"$ref":"#/definitions/LoginIp"},"login_user_name":{"$ref":"#/definitions/LoginUserName"},"private_ip":{"$ref":"#/definitions/PrivateIp"},"process_pid":{"$ref":"#/definitions/ProcessPid"}},"type":"object"},"AppWhitelistEventResponseInfo":{"description":"事件详情","properties":{"agent_status":{"$ref":"#/definitions/AgentStatus"},"asset_value":{"$ref":"#/definitions/AssetValue"},"attack_phase":{"$ref":"#/definitions/AttackPhase"},"attack_tag":{"$ref":"#/definitions/AttackTag"},"event_class_id":{"$ref":"#/definitions/EventClassId"},"event_id":{"$ref":"#/definitions/EventId"},"event_name":{"$ref":"#/definitions/ProcessEventName"},"event_type":{"description":"事件类型,包含如下:\n  - 1001 : 通用恶意软件\n  - 1002 : 病毒\n  - 1003 : 蠕虫\n  - 1004 : 木马\n  - 1005 : 僵尸网络\n  - 1006 : 后门\n  - 1010 : Rootkit\n  - 1011 : 勒索软件\n  - 1012 :黑客工具\n  - 1015 : Webshell\n  - 1016 : 挖矿\n  - 1017 : 反弹Shell\n  - 2001 : 一般漏洞利用\n  - 2012 : 远程代码执行\n  - 2047 : Redis漏洞利用\n  - 2048 : Hadoop漏洞利用\n  - 2049 : MySQL漏洞利用\n  - 3002 : 文件提权\n  - 3003 : 进程提权\n  - 3004 : 关键文件变更\n  - 3005 : 文件/目录变更\n  - 3007 : 进程异常行为\n  - 3015 : 高危命令执行\n  - 3018 : 异常Shell\n  - 3027 : Crontab可疑任务\n  - 3029 :系统安全防护被禁用\n  - 3030 :备份删除\n  - 3031 :异常注册表操作\n  - 3036 : 容器镜像阻断\n  - 4002 : 暴力破解\n  - 4004 : 异常登录\n  - 4006 : 非法系统账号\n  - 4014 : 用户账号添加\n  - 4020 : 用户密码窃取\n  - 6002 : 端口扫描\n  - 6003 : 主机扫描\n  - 13001 : Kubernetes事件删除\n  - 13002 : Pod异常行为\n  - 13003 : 枚举用户信息\n  - 13004 : 绑定集群用户角色","example":1001,"format":"int32","maximum":30000,"minimum":1000,"type":"integer"},"handle_method":{"$ref":"#/definitions/ProcessHandleMethod2"},"handle_status":{"$ref":"#/definitions/HandleStatus"},"handle_time":{"$ref":"#/definitions/HandleTime"},"host_id":{"$ref":"#/definitions/HostId"},"host_name":{"$ref":"#/definitions/HostName"},"host_status":{"$ref":"#/definitions/HostStatus"},"occur_time":{"$ref":"#/definitions/OccurTime"},"operate_accept_list":{"description":"**参数解释**:\n支持的处理操作\n**约束限制**:\n不涉及","items":{"description":"处理方式,包含如下2种。\n  - isolate_and_kill:隔离查杀。\n  - do_not_isolate_or_kill:取消隔离查杀。\n  - mark_as_trust:标记可信。\n  - mark_as_suspicious:标记可疑。\n  - unmark:取消标记。","maxLength":30,"minLength":0,"type":"string","x-example":"isolate_and_kill"},"maxItems":10,"minItems":0,"type":"array"},"operate_detail_list":{"description":"操作详情信息列表(页面不展示)","items":{"$ref":"#/definitions/AppWhitelistEventDetailResInfo"},"maxItems":100,"minItems":0,"type":"array"},"os_type":{"$ref":"#/definitions/OsType"},"policy_id":{"$ref":"#/definitions/PolicyId"},"policy_name":{"$ref":"#/definitions/PolicyName"},"private_ip":{"$ref":"#/definitions/PrivateIp"},"process_info":{"description":"**参数解释**:\n偏移量:进程信息列表\n**约束限制**:\n不涉及","items":{"$ref":"#/definitions/EventProcessResInfo"},"maxItems":100,"minItems":0,"type":"array"},"protect_status":{"$ref":"#/definitions/ProtectStatus"},"public_ip":{"$ref":"#/definitions/PublicIp"},"recommendation":{"description":"**参数解释**:\n处置建议\n**约束限制**:\n不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n不涉及","pattern":"^.*$","type":"string"},"resource_info":{"$ref":"#/definitions/ProcessEventResourceResponseInfo"},"severity":{"$ref":"#/definitions/Severity"}},"type":"object"},"AssetValue":{"description":"资产重要性,包含如下3种\n  - important :重要资产\n  - common :一般资产\n  - test :测试资产","example":"common","maxLength":128,"minLength":0,"pattern":"^important|common|test$","type":"string"},"AttackPhase":{"description":"攻击阶段,包含如下:\n  - reconnaissance : 侦查跟踪\n  - weaponization : 武器构建\n  - delivery : 载荷投递\n  - exploit : 漏洞利用\n  - installation : 安装植入\n  - command_and_control : 命令与控制\n  - actions : 目标达成","example":"actions","type":"string"},"AttackTag":{"description":"攻击标识,包含如下:\n  - attack_success : 攻击成功\n  - attack_attempt : 攻击尝试\n  - attack_blocked : 攻击被阻断\n  - abnormal_behavior : 异常行为\n  - collapsible_host : 主机失陷\n  - system_vulnerability : 系统脆弱性","example":"collapsible_host","type":"string"},"ChildProcessPid":{"description":"**参数解释**:\n子进程id\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ChildProcessUid":{"description":"**参数解释**:\n子进程用户id\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ClusterId":{"description":"集群ID","example":"cce6666","type":"string"},"ClusterName":{"description":"集群名称","example":"cce6666","type":"string"},"CmdLine":{"description":"**参数解释**:\n进程命令行\n**约束限制**:\n不涉及","example":33271,"pattern":"^.*$","type":"string"},"ContainerId":{"description":"**参数解释**:\n容器ID\n**取值范围**:\n字符长度1-128位","maxLength":128,"minLength":1,"type":"string"},"ContainerStatus":{"description":"容器状态","example":"running, terminated, isolated","maxLength":16,"minLength":0,"type":"string"},"EnterpriseProjectId":{"default":"0","description":"主机所属的企业项目ID。\n开通企业项目功能后才需要配置企业项目。\n企业项目ID默认取值为“0”,表示默认企业项目。如果需要查询所有企业项目下的主机,请传参“all_granted_eps”。如果您只有某个企业项目的权限,则需要传递该企业项目ID,查询该企业项目下的主机,否则会因权限不足而报错。","maxLength":256,"minLength":1,"pattern":"^.*$","type":"string"},"EventClassId":{"description":"事件分类,包含如下:\n  - container_1001 : 容器命名空间\n  - container_1002 : 容器开放端口\n  - container_1003 : 容器安全选项\n  - container_1004 : 容器挂载目录\n  - containerescape_0001 : 容器高危系统调用\n  - containerescape_0002 : Shocker攻击\n  - containerescape_0003 : DirtCow攻击\n  - containerescape_0004 : 容器文件逃逸攻击\n  - dockerfile_001 : 用户自定义容器保护文件被修改\n  - dockerfile_002 : 容器文件系统可执行文件被修改\n  - dockerproc_001 : 容器进程异常事件上报\n  - fileprotect_0001 : 文件提权\n  - fileprotect_0002 : 关键文件变更\n  - fileprotect_0003 : 关键文件路径变更\n  - fileprotect_0004 : 文件/目录变更\n  - av_1002 : 病毒\n  - av_1003 : 蠕虫\n  - av_1004 : 木马\n  - av_1005 : 僵尸网络\n  - av_1006 : 后门\n  - av_1007 : 间谍软件\n  - av_1008 : 恶意广告软件\n  - av_1009 : 钓鱼\n  - av_1010 : Rootkit\n  - av_1011 : 勒索软件\n  - av_1012 : 黑客工具\n  - av_1013 : 灰色软件\n  - av_1015 : Webshell\n  - av_1016 : 挖矿软件\n  - login_0001 : 尝试暴力破解\n  - login_0002 : 爆破成功\n  - login_1001 : 登录成功\n  - login_1002 : 异地登录\n  - login_1003 : 弱口令\n  - malware_0001 : shell变更事件上报\n  - malware_0002 : 反弹shell事件上报\n  - malware_1001 : 恶意程序\n  - procdet_0001 : 进程异常行为检测\n  - procdet_0002 : 进程提权\n  - procreport_0001 : 危险命令\n  - user_1001 : 账号变更\n  - user_1002 : 风险账号\n  - vmescape_0001 : 虚拟机敏感命令执行\n  - vmescape_0002 : 虚拟化进程访问敏感文件\n  - vmescape_0003 : 虚拟机异常端口访问\n  - webshell_0001 : 网站后门\n  - network_1001 : 恶意挖矿\n  - network_1002 : 对外DDoS攻击\n  - network_1003 : 恶意扫描\n  - network_1004 : 敏感区域攻击\n  - ransomware_0001 : 勒索攻击\n  - ransomware_0002 : 勒索攻击\n  - ransomware_0003 : 勒索攻击\n  - fileless_0001 : 进程注入\n  - fileless_0002 : 动态库注入进程\n  - fileless_0003 : 关键配置变更\n  - fileless_0004 : 环境变量变更\n  - fileless_0005 : 内存文件进程\n  - fileless_0006 : vdso劫持\n  - crontab_1001 : Crontab可疑任务\n  - vul_exploit_0001 : Redis漏洞利用攻击\n  - vul_exploit_0002 : Hadoop漏洞利用攻击\n  - vul_exploit_0003 : MySQL漏洞利用攻击\n  - rootkit_0001 : 可疑rootkit文件\n  - rootkit_0002 : 可疑内核模块\n  - RASP_0004 : 上传Webshell\n  - RASP_0018 : 无文件Webshell\n  - blockexec_001 : 已知勒索攻击\n  - hips_0001 : Windows Defender防护被禁用\n  - hips_0002 : 可疑的黑客工具\n  - hips_0003 : 可疑的勒索加密行为\n  - hips_0004 : 隐藏账号创建\n  - hips_0005 : 读取用户密码凭据\n  - hips_0006 : 可疑的SAM文件导出\n  - hips_0007 : 可疑shadow copy删除操作\n  - hips_0008 : 备份文件删除\n  - hips_0009 : 可疑勒索病毒操作注册表\n  - hips_0010 : 可疑的异常进程行为\n  - hips_0011 : 可疑的扫描探测\n  - hips_0012 : 可疑的勒索病毒脚本运行\n  - hips_0013 : 可疑的挖矿命令执行\n  - hips_0014 : 可疑的禁用windows安全中心\n  - hips_0015 : 可疑的停止防火墙服务行为\n  - hips_0016 : 可疑的系统自动恢复禁用\n  - hips_0017 : Offies 创建可执行文件\n  - hips_0018 : 带宏Offies文件异常创建\n  - hips_0019 : 可疑的注册表操作\n  - hips_0020 : Confluence远程代码执行\n  - hips_0021 : MSDT远程代码执行\n  - portscan_0001 : 通用端口扫描\n  - portscan_0002 : 秘密端口扫描\n  - k8s_1001 : Kubernetes事件删除\n  - k8s_1002 : 创建特权Pod\n  - k8s_1003 : Pod中使用交互式shell\n  - k8s_1004 : 创建敏感目录Pod\n  - k8s_1005 : 创建主机网络的Pod\n  - k8s_1006 : 创建主机Pid空间的Pod\n  - k8s_1007 : 普通pod访问APIserver认证失败\n  - k8s_1008 : 普通Pod通过Curl访问APIServer\n  - k8s_1009 : 系统管理空间执行exec\n  - k8s_1010 : 系统管理空间创建Pod\n  - k8s_1011 : 创建静态Pod\n  - k8s_1012 : 创建DaemonSet\n  - k8s_1013 : 创建集群计划任务\n  - k8s_1014 : Secrets操作\n  - k8s_1015 : 枚举用户可执行的操作\n  - k8s_1016 : 高权限RoleBinding或ClusterRoleBinding\n  - k8s_1017 : ServiceAccount创建\n  - k8s_1018 : 创建Cronjob\n  - k8s_1019 : Pod中exec使用交互式shell\n  - k8s_1020 : 无权限访问Apiserver\n  - k8s_1021 : 使用curl访问APIServer\n  - k8s_1022 : Ingress漏洞\n  - k8s_1023 : 中间人攻击\n  - k8s_1024 : 蠕虫挖矿木马\n  - k8s_1025 : K8s事件删除\n  - k8s_1026 : SelfSubjectRulesReview场景\n  - imgblock_0001 : 镜像白名单阻断\n  - imgblock_0002 : 镜像黑名单阻断\n  - imgblock_0003 : 镜像标签白名单阻断\n  - imgblock_0004 : 镜像标签黑名单阻断\n  - imgblock_0005 : 创建容器白名单阻断\n  - imgblock_0006 : 创建容器黑名单阻断\n  - imgblock_0007 : 容器mount proc阻断\n  - imgblock_0008 : 容器seccomp unconfined阻断\n  - imgblock_0009 : 容器特权阻断\n  - imgblock_0010 : 容器capabilities阻断","example":"malware_1001","type":"string"},"EventId":{"description":"事件ID","example":"0009bae0-8700-11eb-bb3f-fa163e01e338","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"EventProcessResInfo":{"description":"进程信息","properties":{"ancestor_process_cmdline":{"description":"**参数解释**:\n祖父进程命令行\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"ancestor_process_path":{"description":"**参数解释**:\n祖父进程路径\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"ancestor_process_pid":{"description":"**参数解释**:\n祖父进程id\n**取值范围**:\n最小值1,最大值2147483647","format":"int32","pattern":"^.*$","type":"integer"},"child_process_cmdline":{"description":"**参数解释**:\n子进程文件命令行\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"child_process_egid":{"description":"**参数解释**:\n子进程有效组ID\n**取值范围**:\n最小值0,最大值2147483647","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"child_process_euid":{"description":"**参数解释**:\n子进程有效用户ID\n**取值范围**:\n最小值0,最大值2147483647","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"child_process_filename":{"description":"**参数解释**:\n子进程文件名\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"child_process_gid":{"description":"**参数解释**:\n子进程组ID\n**取值范围**:\n最小值0,最大值2147483647","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"child_process_name":{"description":"**参数解释**:\n子进程名称\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"child_process_path":{"description":"**参数解释**:\n子进程文件路径\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"child_process_pid":{"$ref":"#/definitions/ChildProcessPid"},"child_process_start_time":{"description":"**参数解释**:\n子进程启动时间\n**取值范围**:\n最小值0,最大值9223372036854775807","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"child_process_uid":{"$ref":"#/definitions/ChildProcessUid"},"escape_cmd":{"description":"**参数解释**:\n逃逸后后执行的命令\n**取值范围**:\n字符长度1-128位","pattern":"^.*$","type":"string"},"escape_mode":{"description":"**参数解释**:\n逃逸方式\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"mode":{"description":"**参数解释**:\n文件属性\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"operate_type":{"description":"**参数解释**:\n操作类型\n**取值范围**:\n最小值1,最大值2147483647","format":"int32","pattern":"^.*$","type":"integer"},"parent_process_cmdline":{"description":"**参数解释**:\n父进程文件命令行\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"parent_process_egid":{"$ref":"#/definitions/ParentProcessEgid"},"parent_process_euid":{"$ref":"#/definitions/ParentProcessEuid"},"parent_process_file_hash":{"description":"**参数解释**:\n父进程文件hash\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"parent_process_filename":{"description":"**参数解释**:\n父进程文件名\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"parent_process_gid":{"$ref":"#/definitions/ParentProcessGid"},"parent_process_name":{"description":"**参数解释**:\n父进程名称\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"parent_process_path":{"description":"**参数解释**:\n父进程文件路径\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"parent_process_pid":{"$ref":"#/definitions/ParentProcessPid"},"parent_process_start_time":{"$ref":"#/definitions/ParentProcessStartTime"},"parent_process_uid":{"$ref":"#/definitions/ParentProcessUid"},"process_cmdline":{"$ref":"#/definitions/CmdLine"},"process_egid":{"$ref":"#/definitions/ProcessEgid"},"process_euid":{"$ref":"#/definitions/ProcessEuid"},"process_file_hash":{"description":"**参数解释**:\n进程文件hash\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"process_filename":{"$ref":"#/definitions/ProcessFilename"},"process_gid":{"$ref":"#/definitions/ProcessGid"},"process_hash":{"description":"**参数解释**:\n进程启动文件hash\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"process_name":{"$ref":"#/definitions/ProcessName"},"process_path":{"$ref":"#/definitions/ProcessPath"},"process_pid":{"$ref":"#/definitions/ProcessPid"},"process_start_time":{"$ref":"#/definitions/ProcessStartTime"},"process_uid":{"$ref":"#/definitions/ProcessUid"},"process_username":{"$ref":"#/definitions/ProcessUsername"},"rule":{"description":"**参数解释**:\n规则\n**取值范围**:\n字符长度1-64位","format":"int32","pattern":"^.*$","type":"integer"},"score":{"description":"**参数解释**:\n分数\n**取值范围**:\n字符长度1-64位","format":"int32","pattern":"^.*$","type":"integer"},"session_id":{"description":"**参数解释**:\n会话id\n**取值范围**:\n最小值1,最大值2147483647","format":"int32","pattern":"^.*$","type":"integer"},"virt_cmd":{"description":"**参数解释**:\n虚拟化命令\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"virt_process_name":{"description":"**参数解释**:\n虚拟化进程名称\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"}},"type":"object"},"FileAttr":{"description":"文件属性","example":"33261","pattern":"^.*$","type":"string"},"FileHash":{"description":"文件哈希","example":"4845dbb7c2e3e064d88d844cd23883703b02c31dbc7be8cfee84e291eca5cb7e","pattern":"^.*$","type":"string"},"FilePath":{"description":"文件路径","example":"/root","pattern":"^.*$","type":"string"},"HandleStatus":{"description":"处置状态,包含如下:\n  - unhandled:未处理\n  - handled: 已处理","type":"string"},"HandleTime":{"description":"处置时间,毫秒,已处理的告警才有","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"HostAttr":{"description":"**参数解释**:\n主机属性\n**取值范围**:\n字符长度1-64位","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"HostId":{"description":"**参数解释**:\n服务器ID\n**取值范围**:\n字符长度1-64位","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string","x-example":"71a15ecc-049f-4cca-bd28-5e90aca1817f"},"HostIp":{"description":"**参数解释**:\n主机IP\n**取值范围**:\n字符长度1-128位","maxLength":128,"minLength":1,"type":"string"},"HostName":{"description":"**参数解释**:\n服务器名称\n**取值范围**:\n字符长度1-256位","maxLength":256,"minLength":1,"pattern":"^.*$","type":"string","x-example":"HostName"},"HostStatus":{"description":"服务器状态","maxLength":64,"minLength":1,"type":"string"},"ImageId":{"description":"**参数解释**:\n镜像ID\n**取值范围**:\n字符长度1-64位","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"ImageName":{"description":"镜像名称,只有容器类型的告警有","example":"image name","pattern":"^.*$","type":"string"},"ListAppWhitelistEventResponseInfo":{"description":"事件列表","properties":{"data_list":{"description":"data list","items":{"$ref":"#/definitions/AppWhitelistEventResponseInfo"},"maxItems":100,"minItems":0,"type":"array"},"total_num":{"$ref":"#/definitions/TotalNum"}},"type":"object"},"LoginIp":{"description":"登录源IP","example":"127.0.0.1","pattern":"^.*$","type":"string"},"LoginUserName":{"description":"登录用户名","example":"root","pattern":"^.*$","type":"string"},"OccurTime":{"description":"发生时间,毫秒","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"OsBit":{"description":"**参数解释**:\n操作系统位数\n**取值范围**:\n字符长度1-64位","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"OsName":{"description":"操作系统名称","maxLength":64,"minLength":0,"type":"string","x-example":"Linux"},"OsType":{"description":"操作系统类型,包含如下2种。\n  - Linux :Linux。\n  - Windows :Windows。","example":"Linux","maxLength":64,"minLength":0,"type":"string"},"OsVersion1":{"description":"系统版本","type":"string"},"ParentProcessEgid":{"description":"**参数解释**:\n父进程有效组ID\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ParentProcessEuid":{"description":"**参数解释**:\n父进程有效用户ID\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ParentProcessGid":{"description":"**参数解释**:\n父进程组ID\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ParentProcessPid":{"description":"**参数解释**:\n父进程id\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ParentProcessStartTime":{"description":"**参数解释**:\n父进程启动时间\n**取值范围**:\n最小值0,最大值9223372036854775807","example":111,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"ParentProcessUid":{"description":"**参数解释**:\n父进程用户id\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"PolicyId":{"description":"策略ID","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"PolicyName":{"description":"策略名称","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"PrivateIp":{"description":"服务器私有IP","maxLength":128,"minLength":1,"pattern":"^.*$","type":"string","x-example":"192.168.1.1"},"ProcessEgid":{"description":"**参数解释**:\n进程有效组ID\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ProcessEuid":{"description":"**参数解释**:\n进程有效用户ID\n**取值范围**:\n最小值0,最大值9223372036854775807","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"ProcessEventName":{"description":"事件名称\n  - \"white list alert malicious process\"\n  - \"white list alert suspicious process\"","example":"white list alert malicious process","type":"string"},"ProcessEventResourceResponseInfo":{"description":"资源信息(当前不展示)","properties":{"agent_version":{"$ref":"#/definitions/AgentVersion"},"asset_value":{"$ref":"#/definitions/AssetValue"},"cloud_id":{"description":"**参数解释**:\n云主机ID\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"cluster_id":{"$ref":"#/definitions/ClusterId"},"cluster_name":{"$ref":"#/definitions/ClusterName"},"container_id":{"$ref":"#/definitions/ContainerId"},"container_status":{"$ref":"#/definitions/ContainerStatus"},"domain_id":{"description":"**参数解释**:\n租户账号ID\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"enterprise_project_id":{"$ref":"#/definitions/EnterpriseProjectId"},"host_attr":{"$ref":"#/definitions/HostAttr"},"host_id":{"$ref":"#/definitions/HostId"},"host_ip":{"$ref":"#/definitions/HostIp"},"host_name":{"$ref":"#/definitions/HostName"},"image_id":{"$ref":"#/definitions/ImageId"},"image_name":{"$ref":"#/definitions/ImageName"},"micro_service":{"description":"**参数解释**:\n微服务\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"namespace":{"description":"**参数解释**:\n名称空间\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"os_bit":{"$ref":"#/definitions/OsBit"},"os_name":{"$ref":"#/definitions/OsName"},"os_type":{"$ref":"#/definitions/OsType"},"os_version":{"$ref":"#/definitions/OsVersion1"},"pod_name":{"description":"**参数解释**:\npod name\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"pod_uid":{"description":"**参数解释**:\npod uid\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"project_id":{"$ref":"#/definitions/ProjectId"},"public_ip":{"$ref":"#/definitions/PublicIp"},"region_name":{"$ref":"#/definitions/Region"},"service":{"description":"**参数解释**:\n业务服务\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"sys_arch":{"$ref":"#/definitions/SysArch"},"vm_name":{"description":"**参数解释**:\n虚拟机名称\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"vm_uuid":{"description":"**参数解释**:\n虚拟机UUID\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"},"vpc_id":{"description":"**参数解释**:\nVPC ID\n**取值范围**:\n字符长度1-64位","pattern":"^.*$","type":"string"}},"type":"object"},"ProcessFilename":{"description":"**参数解释**:\n进程文件名\n**取值范围**:\n字符长度1-64位","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"ProcessGid":{"description":"**参数解释**:\n进程组ID\n**取值范围**:\n最小值0,最大值2147483647","example":111,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ProcessHandleMethod2":{"description":"**参数解释**:\n处理状态\n**约束限制**:\n不涉及\n**取值范围**:\n- mark_as_trust:标记为可信\n- mark_as_suspicious:标记为可疑\n- isolate_and_kill:隔离查杀\n\n**默认取值**:\n不涉及","example":"mark_as_trust","type":"string"},"ProcessName":{"description":"**参数解释**:\n进程名称\n**取值范围**:\n字符长度1-128位","maxLength":128,"minLength":1,"pattern":"^.*$","type":"string"},"ProcessPath":{"default":"","description":"**参数解释**:\n进程路径\n**取值范围**:\n字符长度1-256位","maxLength":256,"minLength":1,"type":"string"},"ProcessPid":{"description":"进程ID","example":313,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"ProcessStartTime":{"description":"**参数解释**:\n进程启动时间\n**取值范围**:\n最小值0,最大值9223372036854775807","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"ProcessUid":{"description":"**参数解释**:\n进程名称\n**取值范围**:\n最小值0,最大值2147483647","format":"int32","maximum":2147483647,"minimum":0,"pattern":"^.*$","type":"integer"},"ProcessUsername":{"description":"**参数解释**:\n运行进程的用户名\n**取值范围**:\n字符长度1-128位","maxLength":128,"minLength":1,"pattern":"^.*$","type":"string"},"ProjectId":{"description":"项目ID","maxLength":256,"minLength":1,"pattern":"^.*$","type":"string","x-example":"9d4f774865034d119917acc61b1b806e"},"ProtectStatus":{"description":"防护状态,包含如下2种。\n  - closed :关闭。\n  - opened :开启。","maxLength":64,"minLength":1,"type":"string"},"PublicIp":{"description":"弹性公网IP地址","maxLength":128,"minLength":1,"pattern":"^.*$","type":"string","x-example":"192.168.1.1"},"Region":{"description":"Region ID","maxLength":128,"minLength":0,"pattern":"^.*$","type":"string"},"Severity":{"description":"威胁等级,包含如下:\n  - Security:安全\n  - Low: 低危\n  - Medium: 中危\n  - High: 高危\n  - Critical: 危急","maxLength":20,"minLength":1,"type":"string"},"SysArch":{"description":"**参数解释**:\n系统CPU架构\n**取值范围**:\n字符长度1-64位","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"TotalNum":{"description":"**参数解释**:\n总数\n**取值范围**:\n最小值0,最大值2147483647","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"e41544bea32b4c8c984e8c9e1ebb3b8e","info_version":"v5","method":"get","name":"ListAppWhitelistEvent","parameters":{"BeginTime1_m":{"description":"自定义查询时间,与查询时间范围天数互斥,查询时间段的起始时间,毫秒级时间戳,end_time减去begin_time小于等于2天,与查询时间范围天数互斥","format":"int64","in":"query","name":"begin_time","required":true,"type":"integer"},"EndTime1_m":{"description":"自定义查询时间,与查询时间范围天数互斥,查询时间段的起始时间,毫秒级时间戳,end_time减去begin_time小于等于2天,与查询时间范围天数互斥","format":"int64","in":"query","name":"end_time","required":true,"type":"integer"},"EnterpriseProjectId":{"default":"0","description":"**参数解释**:\n企业项目ID,用于过滤不同企业项目下的资产。获取方式请参见[获取企业项目ID](hss_02_0027.xml)。\n如需查询所有企业项目下的资产请传参“all_granted_eps”。\n**约束限制**:\n开通企业项目功能后才需要配置企业项目ID参数。\n**取值范围**:\n字符长度1-256位\n**默认取值**:\n0,表示默认企业项目(default)。","in":"query","maxLength":256,"minLength":1,"name":"enterprise_project_id","pattern":"^.*$","required":false,"type":"string"},"HostIp":{"description":"**参数解释**:\n主机IP\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-256位\n**默认取值**:\n不涉及","in":"query","maxLength":256,"minLength":1,"name":"host_ip","pattern":"^.*$","required":false,"type":"string","x-example":"192.168.1.1"},"HostName":{"description":"**参数解释**:\n服务器名称\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-256位\n**默认取值**:\n不涉及","in":"query","maxLength":256,"minLength":1,"name":"host_name","pattern":"^.*$","required":false,"type":"string","x-example":"HostName"},"Limit_m":{"default":10,"description":"**参数解释**:\n每页显示个数\n**约束限制**:\n不涉及\n**取值范围**:\n取值10-200\n**默认取值**:\n10","format":"int32","in":"query","maximum":200,"minimum":10,"name":"limit","required":true,"type":"integer"},"Offset_m":{"default":0,"description":"**参数解释**:\n偏移量:指定返回记录的开始位置\n**约束限制**:\n不涉及\n**取值范围**:\n最小值0,最大值2000000\n**默认取值**:\n不涉及","format":"int32","in":"query","maximum":2000000,"minimum":0,"name":"offset","required":true,"type":"integer"},"PrivateIp":{"description":"**参数解释**:\n服务器私有IP\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-128位\n**默认取值**:\n不涉及","in":"query","maxLength":128,"minLength":1,"name":"private_ip","pattern":"^.*$","required":false,"type":"string","x-example":"192.168.1.1"},"ProjectId":{"description":"**参数解释**:\n项目ID,用于明确项目归属,配置后可通过该ID查询项目下资产。获取方式请参见[获取项目ID](hss_02_0024.xml)。\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-256位\n**默认取值**:\n不涉及","in":"path","maxLength":256,"minLength":1,"name":"project_id","pattern":"^.*$","required":true,"type":"string","x-example":"9d4f774865034d119917acc61b1b806e"},"XAuthToken":{"description":"**参数解释**:\n用户Token,包含了用户的身份、权限等信息,在调用API接口时,可通过Token进行身份认证。获取方式请参见[获取用户Token](hss_02_0009.xml)。\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-32768位\n**默认取值**:\n不涉及","in":"header","maxLength":32768,"minLength":1,"name":"X-Auth-Token","pattern":"^.*$","required":true,"type":"string","x-example":"$${X-Auth-Token}"}},"paths":{"/v5/{project_id}/app/event":{"get":{"description":"查询进程白名单可疑进程","operationId":"ListAppWhitelistEvent","parameters":[{"$ref":"#/parameters/XAuthToken"},{"$ref":"#/parameters/ProjectId"},{"$ref":"#/parameters/EnterpriseProjectId"},{"description":"**参数解释**:\n查询时间范围天数,与自定义查询时间begin_time,end_time互斥\n**约束限制**:\n不涉及\n**取值范围**:\n最小值1,最大值30\n**默认取值**:\n不涉及","format":"int32","in":"query","maximum":30,"minimum":1,"name":"last_days","required":false,"type":"integer"},{"$ref":"#/parameters/BeginTime1_m"},{"$ref":"#/parameters/EndTime1_m"},{"$ref":"#/parameters/HostName"},{"$ref":"#/parameters/HostIp"},{"$ref":"#/parameters/PrivateIp"},{"description":"**参数解释**:\n是否已处理\n**约束限制**:\n不涉及\n**取值范围**:\n- true:是\n- false:否\n\n**默认取值**:\n不涉及","in":"query","maxLength":5,"minLength":1,"name":"handle_status","required":false,"type":"string"},{"$ref":"#/parameters/Offset_m"},{"$ref":"#/parameters/Limit_m"}],"produces":["application/json"],"responses":{"200":{"description":"请求已成功","examples":{"application/json":{"data_list":[{"attack_phase":"installation","attack_tag":"abnormal_behavior","event_class_id":"appwl_1001","event_id":"4517fc****-a0ad-11ef-9ac9-********","event_name":"Untrusted process running","event_type":3040,"handle_status":"unhandled","host_id":"4517fc**-be4f-4cbe-9467-******","occur_time":1731385152000,"operate_accept_list":["add_to_app_whitelist"],"operate_detail_list":[{"agent_id":"3ed2e2aa24b******1231324********8c28f59cae2780e7bf6adf4e","file_path":"/usr/bin/login","process_pid":1549}],"process_info_list":[{"parent_process_cmdline":"/usr/lib/systemd/systemd --switched-root --system --deserialize 16","parent_process_name":"systemd","parent_process_path":"/usr/lib/systemd/systemd","parent_process_pid":1,"process_cmdline":"login -- root","process_file_hash":"d0364db3f6****d969c4475705d57154df518d0560****21abd34ca","process_filename":"login","process_name":"login","process_path":"/usr/bin/login","process_pid":1549,"process_start_time":1719820957,"process_uid":0}],"resource_info":{"asset_value":"common","cloud_id":"","enterprise_project_id":"0","host_id":"2c9****09-be4f-4cbe-9467-73b****8e48f","host_ip":"192.168.0.178","host_name":"ecs-hce","os_name":"HCE","os_type":"Linux","os_version":"2.0","project_id":"84b52****e489fa6549888832dc62","public_ip":"100.93.9.43","region_name":"cn-north-7","vm_name":"ecs-hce","vm_uuid":"2c****e09-be4f-4cbe-9467-73b80****e48f"},"severity":"High"}],"total_num":4715}},"schema":{"$ref":"#/definitions/ListAppWhitelistEventResponseInfo"}}},"summary":"查询进程白名单可疑进程","tags":["APP"],"x-api-type":"open-api","x-apigateway-request-type":"public","x-iam-auth-meta-anno":{"abacAction":"hss:ars:listAppWhitelistEvent","abacActionAlias":"hss:ars:list","authLevel":"PROJECT","rbac":["op_service","te_admin","hss_adm","te_admin+op_restricted","te_admin+op_suspended","hss_adm+op_restricted","hss_adm+op_suspended","readonly"]},"x-is-registered":"Y","x-method-annotations":["@CtsInfo(userOperationType = \"listAppWhitelistEvent\", operationId = \"ListAppWhitelistEvent\")"],"x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询进程白名单可疑进程","tags":"应用进程控制","uri":null,"version":"2.0"}