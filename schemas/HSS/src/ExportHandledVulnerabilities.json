{"base_path":"/","components":null,"consumes":"","definitions":{"ExportHandledVulnerabilitiesRequestBody":{"properties":{"asset_value":{"description":"资产重要性\nimportant:重要\ncommon:一般\ntest:测试","enum":["important","common","test"],"example":"important","type":"string"},"export_headers":{"description":"导出漏洞数据的表头信息列表","items":{"description":"表头信息,列表包含两个元素:第一个元素为该列数据的key,第二个元素为该列的表头名称;合法的key值及其对应的表头(表头名称可自定义):\n  - enterprise_project_name:企业项目\n  - vul_name:漏洞名称\n  - vul_id:漏洞ID\n  - label_info:漏洞标签\n  - description:漏洞描述\n  - host_name:服务器名称\n  - host_id:服务器ID\n  - app_info:受影响的软件信息\n  - repair_priority:修复优先级\n  - url:参考链接\n  - solution_detail:修复建议\n  - scan_time:最近扫描时间\n  - repair_cmd:修复命令\n  - intranet_ip:服务器IP\n  - cve_info:漏洞的cve信息\n  - status:漏洞状态\n  - handle_user_name:处置人用户名\n  - app_path:应用漏洞路径","example":["vul_name","漏洞名称"],"items":{"maxLength":512,"minLength":1,"type":"string"},"maxItems":2,"minItems":2,"type":"array"},"maxItems":10000,"minItems":1,"type":"array"},"export_size":{"default":10000,"description":"导出数据条数","format":"int32","maximum":200000,"minimum":1,"type":"integer"},"group_name":{"description":"服务器组名称","example":"group1","maxLength":128,"minLength":1,"type":"string"},"handle_cycle":{"description":"需要查询的漏洞处置周期:\n  - today:查询今日处理的数据\n  - all:查询所有已处理数据","enum":["today","all"],"example":"all","type":"string"},"host_ip":{"description":"主机ip","example":"1.1.1.1","maxLength":128,"minLength":0,"type":"string"},"host_name":{"description":"主机名称","example":"myhost","maxLength":128,"minLength":0,"type":"string"},"is_affect_business":{"description":"是否影响业务","type":"boolean"},"label":{"description":"漏洞标签","example":"需要重启","maxLength":128,"minLength":0,"type":"string"},"repair_priority":{"description":"漏洞修复优先级,包含如下\n- Critical 紧急\n- High 高\n- Medium 中\n- Low 低","enum":["Critical","High","Medium","Low"],"example":"Critical","type":"string"},"specific_vuls":{"description":"指定要导出的漏洞数据","items":{"properties":{"host_id":{"description":"主机id","example":"29fbd337-xxxx-xxxx-97b9-xxxxxxxxxxxxx","maxLength":512,"minLength":1,"type":"string"},"vul_id":{"description":"漏洞id","example":"EulerOS-SA-2024-1351","maxLength":512,"minLength":1,"type":"string"}},"type":"object"},"maxItems":10000,"minItems":0,"type":"array"},"status":{"description":"漏洞状态\n  - vul_status_unfix : 未处理\n  - vul_status_ignored : 已忽略\n  - vul_status_verified : 验证中\n  - vul_status_fixing : 修复中\n  - vul_status_fixed : 修复成功\n  - vul_status_reboot : 修复成功待重启\n  - vul_status_failed : 修复失败\n  - vul_status_fix_after_reboot : 请重启主机再次修复","enum":["vul_status_unfix","vul_status_ignored","vul_status_verified","vul_status_fixing","vul_status_fixed","vul_status_reboot","vul_status_failed","vul_status_fix_after_reboot"],"example":"vul_status_ignored","type":"string"},"type":{"description":"漏洞类型,包含如下:\n  -linux_vul : linux漏洞\n  -windows_vul : windows漏洞\n  -web_cms : Web-CMS漏洞\n  -app_vul : 应用漏洞\n  -urgent_vul : 应急漏洞","enum":["linux_vul","windows_vul","web_cms","app_vul","urgent_vul"],"example":"linux_vul","type":"string"},"vul_name":{"description":"漏洞名称","example":"EulerOS-SA-2024-1351","maxLength":256,"minLength":0,"type":"string"}},"required":["export_headers"],"type":"object"},"ExportVulResponseInfo":{"properties":{"task_id":{"description":"任务ID","maxLength":64,"minLength":1,"type":"string"}},"required":["task_id"],"type":"object"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"2e7101c535af4047814e6ba1266699f2","info_version":"v5","method":"post","name":"ExportHandledVulnerabilities","parameters":{"EnterpriseProjectId":{"default":"0","description":"**参数解释**:\n企业项目ID,用于过滤不同企业项目下的资产。获取方式请参见[获取企业项目ID](hss_02_0027.xml)。\n如需查询所有企业项目下的资产请传参“all_granted_eps”。\n**约束限制**:\n开通企业项目功能后才需要配置企业项目ID参数。\n**取值范围**:\n字符长度1-256位\n**默认取值**:\n0,表示默认企业项目(default)。","in":"query","maxLength":256,"minLength":1,"name":"enterprise_project_id","pattern":"^.*$","required":false,"type":"string"},"ProjectId":{"description":"**参数解释**:\n项目ID,用于明确项目归属,配置后可通过该ID查询项目下资产。获取方式请参见[获取项目ID](hss_02_0024.xml)。\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-256位\n**默认取值**:\n不涉及","in":"path","maxLength":256,"minLength":1,"name":"project_id","pattern":"^.*$","required":true,"type":"string","x-example":"9d4f774865034d119917acc61b1b806e"},"XAuthToken":{"description":"**参数解释**:\n用户Token,包含了用户的身份、权限等信息,在调用API接口时,可通过Token进行身份认证。获取方式请参见[获取用户Token](hss_02_0009.xml)。\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-32768位\n**默认取值**:\n不涉及","in":"header","maxLength":32768,"minLength":1,"name":"X-Auth-Token","pattern":"^.*$","required":true,"type":"string","x-example":"$${X-Auth-Token}"}},"paths":{"/v5/{project_id}/vulnerability/history/export-task":{"post":{"consumes":["application/json"],"description":"创建历史处理的漏洞导出任务","operationId":"ExportHandledVulnerabilities","parameters":[{"$ref":"#/parameters/ProjectId"},{"$ref":"#/parameters/XAuthToken"},{"$ref":"#/parameters/EnterpriseProjectId"},{"description":"导出数据的表头字段列表","in":"body","name":"ExportHandledVulnerabilitiesRequestBody","required":true,"schema":{"$ref":"#/definitions/ExportHandledVulnerabilitiesRequestBody"}}],"produces":["application/json"],"responses":{"200":{"description":"请求已成功","schema":{"$ref":"#/definitions/ExportVulResponseInfo"}}},"summary":"创建历史处理的漏洞导出任务","tags":["vul"],"x-api-type":"open-api","x-iam-auth-meta-anno":{"abacAction":"hss:vulnerability:ExportHandledVulnerabilities","abacActionAlias":"hss:vuls:list","authLevel":"PROJECT","rbac":["op_service","te_admin","hss_adm","te_admin+op_restricted","te_admin+op_suspended","hss_adm+op_restricted","hss_adm+op_suspended","readonly"]},"x-is-registered":"Y","x-method-annotations":["@CtsInfo(userOperationType = \"exportHandledVulnerabilities\", operationId = \"ExportHandledVulnerabilities\", readOnly = false)"],"x-request-examples-1":{"export_headers":[["vul_name","漏洞名称"]],"handle_cycle":"all","type":"linux_vul"},"x-request-examples-description-1":"导出project_id为2b31ed520xxxxxxebedb6e57xxxxxxxx的所有历史已处理Linux漏洞,导出的excel数据有“漏洞名称”一列","x-request-examples-url-1":"POST https://{endpoint}/v5/2b31ed520xxxxxxebedb6e57xxxxxxxx/vulnerability/history/export-task?enterprise_project_id=all_granted_eps","x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建历史处理的漏洞导出任务","tags":"漏洞管理","uri":null,"version":"2.0"}