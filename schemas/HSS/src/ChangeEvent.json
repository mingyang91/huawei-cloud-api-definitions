{"base_path":"/","components":null,"consumes":"","definitions":{"AgentId":{"description":"**参数解释**:\nAgent ID\n**约束限制**:\n不涉及\n**取值范围**:\n字符长度1-64位\n**默认取值**:\n不涉及","example":"bdcb6303b37c61342792f186e38d580b4b073e0024864019eaf982f30c9384db","pattern":"^.*$","type":"string"},"ChangeEventRequestInfo":{"description":"操作事件详情","properties":{"event_white_rule_list":{"description":"用户自定义告警白名单规则列表","items":{"$ref":"#/definitions/EventWhiteRuleListRequestInfo"},"maxItems":100,"minItems":0,"type":"array"},"handler":{"$ref":"#/definitions/Handler"},"operate_event_list":{"description":"操作的事件列表","items":{"$ref":"#/definitions/OperateEventRequestInfo"},"maxItems":100,"minItems":0,"type":"array"},"operate_type":{"$ref":"#/definitions/OperateType"}},"required":["operate_event_list","operate_type"],"type":"object"},"EventClassId":{"description":"事件分类,包含如下:\n  - container_1001 : 容器命名空间\n  - container_1002 : 容器开放端口\n  - container_1003 : 容器安全选项\n  - container_1004 : 容器挂载目录\n  - containerescape_0001 : 容器高危系统调用\n  - containerescape_0002 : Shocker攻击\n  - containerescape_0003 : DirtCow攻击\n  - containerescape_0004 : 容器文件逃逸攻击\n  - dockerfile_001 : 用户自定义容器保护文件被修改\n  - dockerfile_002 : 容器文件系统可执行文件被修改\n  - dockerproc_001 : 容器进程异常事件上报\n  - fileprotect_0001 : 文件提权\n  - fileprotect_0002 : 关键文件变更\n  - fileprotect_0003 : 关键文件路径变更\n  - fileprotect_0004 : 文件/目录变更\n  - av_1002 : 病毒\n  - av_1003 : 蠕虫\n  - av_1004 : 木马\n  - av_1005 : 僵尸网络\n  - av_1006 : 后门\n  - av_1007 : 间谍软件\n  - av_1008 : 恶意广告软件\n  - av_1009 : 钓鱼\n  - av_1010 : Rootkit\n  - av_1011 : 勒索软件\n  - av_1012 : 黑客工具\n  - av_1013 : 灰色软件\n  - av_1015 : Webshell\n  - av_1016 : 挖矿软件\n  - login_0001 : 尝试暴力破解\n  - login_0002 : 爆破成功\n  - login_1001 : 登录成功\n  - login_1002 : 异地登录\n  - login_1003 : 弱口令\n  - malware_0001 : shell变更事件上报\n  - malware_0002 : 反弹shell事件上报\n  - malware_1001 : 恶意程序\n  - procdet_0001 : 进程异常行为检测\n  - procdet_0002 : 进程提权\n  - procreport_0001 : 危险命令\n  - user_1001 : 账号变更\n  - user_1002 : 风险账号\n  - vmescape_0001 : 虚拟机敏感命令执行\n  - vmescape_0002 : 虚拟化进程访问敏感文件\n  - vmescape_0003 : 虚拟机异常端口访问\n  - webshell_0001 : 网站后门\n  - network_1001 : 恶意挖矿\n  - network_1002 : 对外DDoS攻击\n  - network_1003 : 恶意扫描\n  - network_1004 : 敏感区域攻击\n  - ransomware_0001 : 勒索攻击\n  - ransomware_0002 : 勒索攻击\n  - ransomware_0003 : 勒索攻击\n  - fileless_0001 : 进程注入\n  - fileless_0002 : 动态库注入进程\n  - fileless_0003 : 关键配置变更\n  - fileless_0004 : 环境变量变更\n  - fileless_0005 : 内存文件进程\n  - fileless_0006 : vdso劫持\n  - crontab_1001 : Crontab可疑任务\n  - vul_exploit_0001 : Redis漏洞利用攻击\n  - vul_exploit_0002 : Hadoop漏洞利用攻击\n  - vul_exploit_0003 : MySQL漏洞利用攻击\n  - rootkit_0001 : 可疑rootkit文件\n  - rootkit_0002 : 可疑内核模块\n  - RASP_0004 : 上传Webshell\n  - RASP_0018 : 无文件Webshell\n  - blockexec_001 : 已知勒索攻击\n  - hips_0001 : Windows Defender防护被禁用\n  - hips_0002 : 可疑的黑客工具\n  - hips_0003 : 可疑的勒索加密行为\n  - hips_0004 : 隐藏账号创建\n  - hips_0005 : 读取用户密码凭据\n  - hips_0006 : 可疑的SAM文件导出\n  - hips_0007 : 可疑shadow copy删除操作\n  - hips_0008 : 备份文件删除\n  - hips_0009 : 可疑勒索病毒操作注册表\n  - hips_0010 : 可疑的异常进程行为\n  - hips_0011 : 可疑的扫描探测\n  - hips_0012 : 可疑的勒索病毒脚本运行\n  - hips_0013 : 可疑的挖矿命令执行\n  - hips_0014 : 可疑的禁用windows安全中心\n  - hips_0015 : 可疑的停止防火墙服务行为\n  - hips_0016 : 可疑的系统自动恢复禁用\n  - hips_0017 : Offies 创建可执行文件\n  - hips_0018 : 带宏Offies文件异常创建\n  - hips_0019 : 可疑的注册表操作\n  - hips_0020 : Confluence远程代码执行\n  - hips_0021 : MSDT远程代码执行\n  - portscan_0001 : 通用端口扫描\n  - portscan_0002 : 秘密端口扫描\n  - k8s_1001 : Kubernetes事件删除\n  - k8s_1002 : 创建特权Pod\n  - k8s_1003 : Pod中使用交互式shell\n  - k8s_1004 : 创建敏感目录Pod\n  - k8s_1005 : 创建主机网络的Pod\n  - k8s_1006 : 创建主机Pid空间的Pod\n  - k8s_1007 : 普通pod访问APIserver认证失败\n  - k8s_1008 : 普通Pod通过Curl访问APIServer\n  - k8s_1009 : 系统管理空间执行exec\n  - k8s_1010 : 系统管理空间创建Pod\n  - k8s_1011 : 创建静态Pod\n  - k8s_1012 : 创建DaemonSet\n  - k8s_1013 : 创建集群计划任务\n  - k8s_1014 : Secrets操作\n  - k8s_1015 : 枚举用户可执行的操作\n  - k8s_1016 : 高权限RoleBinding或ClusterRoleBinding\n  - k8s_1017 : ServiceAccount创建\n  - k8s_1018 : 创建Cronjob\n  - k8s_1019 : Pod中exec使用交互式shell\n  - k8s_1020 : 无权限访问Apiserver\n  - k8s_1021 : 使用curl访问APIServer\n  - k8s_1022 : Ingress漏洞\n  - k8s_1023 : 中间人攻击\n  - k8s_1024 : 蠕虫挖矿木马\n  - k8s_1025 : K8s事件删除\n  - k8s_1026 : SelfSubjectRulesReview场景\n  - imgblock_0001 : 镜像白名单阻断\n  - imgblock_0002 : 镜像黑名单阻断\n  - imgblock_0003 : 镜像标签白名单阻断\n  - imgblock_0004 : 镜像标签黑名单阻断\n  - imgblock_0005 : 创建容器白名单阻断\n  - imgblock_0006 : 创建容器黑名单阻断\n  - imgblock_0007 : 容器mount proc阻断\n  - imgblock_0008 : 容器seccomp unconfined阻断\n  - imgblock_0009 : 容器特权阻断\n  - imgblock_0010 : 容器capabilities阻断","example":"malware_1001","type":"string"},"EventDetailRequestInfo":{"description":"操作详情信息","properties":{"agent_id":{"$ref":"#/definitions/AgentId"},"container_id":{"description":"容器ID","maxLength":64,"minLength":1,"type":"string"},"container_name":{"description":"容器名称","maxLength":128,"minLength":1,"type":"string"},"file_attr":{"$ref":"#/definitions/FileAttr"},"file_hash":{"$ref":"#/definitions/FileHash"},"file_path":{"$ref":"#/definitions/FilePath"},"hash":{"description":"告警事件hash,仅用于告警白名单","example":"7e2368dcab39184f55203a3d6a901016633f7a43e5d36d0e116083d9a37c3557","pattern":"^.*$","type":"string"},"keyword":{"description":"告警事件关键字,仅用于告警白名单","example":"/root/test","pattern":"^.*$","type":"string"},"login_ip":{"$ref":"#/definitions/LoginIp"},"login_user_name":{"$ref":"#/definitions/LoginUserName"},"private_ip":{"$ref":"#/definitions/PrivateIp"},"process_pid":{"$ref":"#/definitions/ProcessPid"}},"type":"object"},"EventId":{"description":"事件ID","example":"0009bae0-8700-11eb-bb3f-fa163e01e338","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"EventType":{"description":"事件类型,包含如下:\n  - 1001 : 通用恶意软件\n  - 1002 : 病毒\n  - 1003 : 蠕虫\n  - 1004 : 木马\n  - 1005 : 僵尸网络\n  - 1006 : 后门\n  - 1010 : Rootkit\n  - 1011 : 勒索软件\n  - 1012 :黑客工具\n  - 1015 : Webshell\n  - 1016 : 挖矿\n  - 1017 : 反弹Shell\n  - 2001 : 一般漏洞利用\n  - 2012 : 远程代码执行\n  - 2047 : Redis漏洞利用\n  - 2048 : Hadoop漏洞利用\n  - 2049 : MySQL漏洞利用\n  - 3002 : 文件提权\n  - 3003 : 进程提权\n  - 3004 : 关键文件变更\n  - 3005 : 文件/目录变更\n  - 3007 : 进程异常行为\n  - 3015 : 高危命令执行\n  - 3018 : 异常Shell\n  - 3027 : Crontab可疑任务\n  - 3029 :系统安全防护被禁用\n  - 3030 :备份删除\n  - 3031 :异常注册表操作\n  - 3036 : 容器镜像阻断\n  - 4002 : 暴力破解\n  - 4004 : 异常登录\n  - 4006 : 非法系统账号\n  - 4014 : 用户账号添加\n  - 4020 : 用户密码窃取\n  - 6002 : 端口扫描\n  - 6003 : 主机扫描\n  - 13001 : Kubernetes事件删除\n  - 13002 : Pod异常行为\n  - 13003 : 枚举用户信息\n  - 13004 : 绑定集群用户角色","example":1001,"format":"int32","maximum":30000,"minimum":1000,"type":"integer"},"EventWhiteRuleListRequestInfo":{"description":"用户自定义告警白名单规则","properties":{"event_type":{"$ref":"#/definitions/EventType"},"field_key":{"description":"加白字段,包含如下:\n- \"file/process hash\" # 进程/文件hash\n- \"file_path\" # 文件路径\n- \"process_path\" # 进程路径\n- \"login_ip\" # 登录ip\n- \"reg_key\" #注册表key\n- \"process_cmdline\" # 进程命令行\n- \"username\" # 用户名","maxLength":20,"minLength":1,"type":"string"},"field_value":{"description":"加白字段值","maxLength":128,"minLength":1,"type":"string"},"judge_type":{"description":"通配符,包含如下:\n- \"equal\" # 相等\n- \"contain\" # 包含","maxLength":10,"minLength":1,"type":"string"}},"required":["event_type","field_key","field_value","judge_type"],"type":"object"},"FileAttr":{"description":"文件属性","example":"33261","pattern":"^.*$","type":"string"},"FileHash":{"description":"文件哈希","example":"4845dbb7c2e3e064d88d844cd23883703b02c31dbc7be8cfee84e291eca5cb7e","pattern":"^.*$","type":"string"},"FilePath":{"description":"文件路径","example":"/root","pattern":"^.*$","type":"string"},"Handler":{"description":"备注信息,已处理的告警才有","example":"handler","pattern":"^.*$","type":"string"},"LoginIp":{"description":"登录源IP","example":"127.0.0.1","pattern":"^.*$","type":"string"},"LoginUserName":{"description":"登录用户名","example":"root","pattern":"^.*$","type":"string"},"OccurTime":{"description":"发生时间,毫秒","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"OperateEventRequestInfo":{"description":"操作的事件","properties":{"event_class_id":{"$ref":"#/definitions/EventClassId"},"event_id":{"$ref":"#/definitions/EventId"},"event_type":{"$ref":"#/definitions/EventType"},"occur_time":{"$ref":"#/definitions/OccurTime"},"operate_detail_list":{"description":"操作详情信息列表,当 operate_type 为 add_to_alarm_whitelist 或 remove_from_alarm_whitelist 时,必传 keyword 和 hash;当 operate_type 为 add_to_login_whitelist 或 remove_from_login_whitelist 时,必传 login_ip, private_ip 和 login_user_name;当 operate_type 为 isolate_and_kill 或 do_not_isolate_or_kill 时,必传 agent_id,file_hash,file_path,process_pid;其余情况可不填写内容。","items":{"$ref":"#/definitions/EventDetailRequestInfo"},"maxItems":100,"minItems":0,"type":"array"}},"required":["event_class_id","event_id","event_type","occur_time","operate_detail_list"],"type":"object"},"OperateType":{"description":"处理方式,包含如下:\n  - mark_as_handled : 手动处理\n  - ignore : 忽略\n  - add_to_alarm_whitelist : 加入告警白名单\n  - add_to_login_whitelist : 加入登录白名单\n  - isolate_and_kill : 隔离查杀\n  - unhandle : 取消手动处理\n  - do_not_ignore : 取消忽略\n  - remove_from_alarm_whitelist : 删除告警白名单\n  - remove_from_login_whitelist : 删除登录白名单\n  - do_not_isolate_or_kill : 取消隔离查杀","example":"ignore","type":"string"},"PrivateIp":{"description":"服务器私有IP","maxLength":128,"minLength":1,"pattern":"^.*$","type":"string","x-example":"192.168.1.1"},"ProcessPid":{"description":"进程ID","example":313,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"e757e9683c4c4a24bb7d37feffc3608c","info_version":"v5","method":"post","name":"ChangeEvent","parameters":{},"paths":{"/v5/{project_id}/event/operate":{"post":{"description":"处理告警事件","operationId":"ChangeEvent","parameters":[{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)","in":"header","maxLength":32768,"minLength":1,"name":"X-Auth-Token","pattern":"^.*$","required":true,"type":"string","x-example":"$${X-Auth-Token}"},{"description":"Region ID","in":"header","maxLength":128,"minLength":0,"name":"region","pattern":"^.*$","required":false,"type":"string","x-example":"cn-north-5"},{"description":"项目ID","in":"path","maxLength":64,"minLength":20,"name":"project_id","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"主机所属的企业项目ID。\n开通企业项目功能后才需要配置企业项目。\n企业项目ID默认取值为“0”,表示默认企业项目。如果需要查询所有企业项目下的主机,请传参“all_granted_eps”。如果您只有某个企业项目的权限,则需要传递该企业项目ID,查询该企业项目下的主机,否则会因权限不足而报错。","in":"query","maxLength":64,"minLength":0,"name":"enterprise_project_id","pattern":"^.*$","required":false,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"容器实例名称","in":"query","name":"container_name","pattern":"^.*$","required":false,"type":"string"},{"description":"容器Id","in":"query","name":"container_id","pattern":"^.*$","required":false,"type":"string"},{"description":"处理告警事件列表","in":"body","name":"ChangeEventRequestBody","required":true,"schema":{"$ref":"#/definitions/ChangeEventRequestInfo"}}],"produces":["application/json"],"responses":{"200":{"description":"请求已成功"},"400":{"description":"参数非法"},"401":{"description":"鉴权失败"},"403":{"description":"权限不足"},"404":{"description":"资源未找到"},"500":{"description":"系统异常"}},"summary":"处理告警事件","tags":["入侵检测"],"x-is-registered":"Y","x-order":1,"x-request-examples-1":{"handler":"test","operate_event_list":[{"event_class_id":"rootkit_0001","event_id":"2a71e1e2-60f4-4d56-b314-2038fdc39de6","event_type":1010,"occur_time":1672046760353,"operate_detail_list":[{"agent_id":"c9bed5397db449ebdfba15e85fcfc36accee125c68954daf5cab0528bab59bd8","container_id":"containerid","container_name":"/test","file_attr":33261,"file_hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","file_path":"/usr/test","hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","keyword":"file_path=/usr/test","login_ip":"127.0.0.1","login_user_name":"root","private_ip":"127.0.0.2","process_pid":3123}]}],"operate_type":"mark_as_handled"},"x-request-examples-description-1":"手动处理告警事件类型为Rootkit、告警事件编号为2a71e1e2-60f4-4d56-b314-2038fdc39de6的入侵告警事件。","x-request-examples-text-1":{"handler":"test","operate_event_list":[{"event_class_id":"rootkit_0001","event_id":"2a71e1e2-60f4-4d56-b314-2038fdc39de6","event_type":1010,"occur_time":1672046760353,"operate_detail_list":[{"agent_id":"c9bed5397db449ebdfba15e85fcfc36accee125c68954daf5cab0528bab59bd8","container_id":"containerid","container_name":"/test","file_attr":33261,"file_hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","file_path":"/usr/test","hash":"e8b50f0b91e3dce0885ccc5902846b139d28108a0a7976c9b8d43154c5dbc44d","keyword":"file_path=/usr/test","login_ip":"127.0.0.1","login_user_name":"root","private_ip":"127.0.0.2","process_pid":3123}]}],"operate_type":"mark_as_handled"},"x-request-examples-url-1":"POST https://{endpoint}/v5/{project_id}/event/operate?enterprise_project_id=xxx","x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"处理告警事件","tags":"入侵检测","uri":null,"version":"2.0"}