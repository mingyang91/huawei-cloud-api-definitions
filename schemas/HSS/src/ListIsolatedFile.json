{"base_path":"/","components":null,"consumes":"","definitions":{"AgentId":{"description":"Agent ID","example":"bdcb6303b37c61342792f186e38d580b4b073e0024864019eaf982f30c9384db","pattern":"^.*$","type":"string"},"AgentVersion":{"description":"agent版本","example":"3.2.10","pattern":"^.*$","type":"string"},"AntivirusResultDetailInfo":{"description":"病毒查杀结果详情","properties":{"agent_id":{"$ref":"#/definitions/AgentId"},"file_attr":{"$ref":"#/definitions/FileAttr"},"file_ctime":{"$ref":"#/definitions/FileCtime"},"file_hash":{"$ref":"#/definitions/FileHash"},"file_mtime":{"$ref":"#/definitions/FileMtime"},"file_owner":{"$ref":"#/definitions/FileOwner"},"file_path":{"$ref":"#/definitions/FilePath"},"file_size":{"$ref":"#/definitions/FileSize"},"malware_name":{"$ref":"#/definitions/MalwareName"},"result_id":{"$ref":"#/definitions/ResultId"},"update_time":{"$ref":"#/definitions/UpdateTime"}},"type":"object"},"AssetValue":{"description":"资产重要性","example":"common","pattern":"^.*$","type":"string"},"AttackPhase":{"description":"攻击阶段,包含如下:\n  - reconnaissance : 侦查跟踪\n  - weaponization : 武器构建\n  - delivery : 载荷投递\n  - exploit : 漏洞利用\n  - installation : 安装植入\n  - command_and_control : 命令与控制\n  - actions : 目标达成","example":"actions","type":"string"},"AttackTag":{"description":"攻击标识,包含如下:\n  - attack_success : 攻击成功\n  - attack_attempt : 攻击尝试\n  - attack_blocked : 攻击被阻断\n  - abnormal_behavior : 异常行为\n  - collapsible_host : 主机失陷\n  - system_vulnerability : 系统脆弱性","example":"collapsible_host","type":"string"},"ContainerName":{"description":"容器实例名称,只有容器类型的告警有","example":"container name","pattern":"^.*$","type":"string"},"EventClassId":{"description":"事件分类,包含如下:\n  - container_1001 : 容器命名空间\n  - container_1002 : 容器开放端口\n  - container_1003 : 容器安全选项\n  - container_1004 : 容器挂载目录\n  - containerescape_0001 : 容器高危系统调用\n  - containerescape_0002 : Shocker攻击\n  - containerescape_0003 : DirtCow攻击\n  - containerescape_0004 : 容器文件逃逸攻击\n  - dockerfile_001 : 用户自定义容器保护文件被修改\n  - dockerfile_002 : 容器文件系统可执行文件被修改\n  - dockerproc_001 : 容器进程异常事件上报\n  - fileprotect_0001 : 文件提权\n  - fileprotect_0002 : 关键文件变更\n  - fileprotect_0003 : 关键文件路径变更\n  - fileprotect_0004 : 文件/目录变更\n  - av_1002 : 病毒\n  - av_1003 : 蠕虫\n  - av_1004 : 木马\n  - av_1005 : 僵尸网络\n  - av_1006 : 后门\n  - av_1007 : 间谍软件\n  - av_1008 : 恶意广告软件\n  - av_1009 : 钓鱼\n  - av_1010 : Rootkit\n  - av_1011 : 勒索软件\n  - av_1012 : 黑客工具\n  - av_1013 : 灰色软件\n  - av_1015 : Webshell\n  - av_1016 : 挖矿软件\n  - login_0001 : 尝试暴力破解\n  - login_0002 : 爆破成功\n  - login_1001 : 登录成功\n  - login_1002 : 异地登录\n  - login_1003 : 弱口令\n  - malware_0001 : shell变更事件上报\n  - malware_0002 : 反弹shell事件上报\n  - malware_1001 : 恶意程序\n  - procdet_0001 : 进程异常行为检测\n  - procdet_0002 : 进程提权\n  - procreport_0001 : 危险命令\n  - user_1001 : 账号变更\n  - user_1002 : 风险账号\n  - vmescape_0001 : 虚拟机敏感命令执行\n  - vmescape_0002 : 虚拟化进程访问敏感文件\n  - vmescape_0003 : 虚拟机异常端口访问\n  - webshell_0001 : 网站后门\n  - network_1001 : 恶意挖矿\n  - network_1002 : 对外DDoS攻击\n  - network_1003 : 恶意扫描\n  - network_1004 : 敏感区域攻击\n  - ransomware_0001 : 勒索攻击\n  - ransomware_0002 : 勒索攻击\n  - ransomware_0003 : 勒索攻击\n  - fileless_0001 : 进程注入\n  - fileless_0002 : 动态库注入进程\n  - fileless_0003 : 关键配置变更\n  - fileless_0004 : 环境变量变更\n  - fileless_0005 : 内存文件进程\n  - fileless_0006 : vdso劫持\n  - crontab_1001 : Crontab可疑任务\n  - vul_exploit_0001 : Redis漏洞利用攻击\n  - vul_exploit_0002 : Hadoop漏洞利用攻击\n  - vul_exploit_0003 : MySQL漏洞利用攻击\n  - rootkit_0001 : 可疑rootkit文件\n  - rootkit_0002 : 可疑内核模块\n  - RASP_0004 : 上传Webshell\n  - RASP_0018 : 无文件Webshell\n  - blockexec_001 : 已知勒索攻击\n  - hips_0001 : Windows Defender防护被禁用\n  - hips_0002 : 可疑的黑客工具\n  - hips_0003 : 可疑的勒索加密行为\n  - hips_0004 : 隐藏账号创建\n  - hips_0005 : 读取用户密码凭据\n  - hips_0006 : 可疑的SAM文件导出\n  - hips_0007 : 可疑shadow copy删除操作\n  - hips_0008 : 备份文件删除\n  - hips_0009 : 可疑勒索病毒操作注册表\n  - hips_0010 : 可疑的异常进程行为\n  - hips_0011 : 可疑的扫描探测\n  - hips_0012 : 可疑的勒索病毒脚本运行\n  - hips_0013 : 可疑的挖矿命令执行\n  - hips_0014 : 可疑的禁用windows安全中心\n  - hips_0015 : 可疑的停止防火墙服务行为\n  - hips_0016 : 可疑的系统自动恢复禁用\n  - hips_0017 : Offies 创建可执行文件\n  - hips_0018 : 带宏Offies文件异常创建\n  - hips_0019 : 可疑的注册表操作\n  - hips_0020 : Confluence远程代码执行\n  - hips_0021 : MSDT远程代码执行\n  - portscan_0001 : 通用端口扫描\n  - portscan_0002 : 秘密端口扫描\n  - k8s_1001 : Kubernetes事件删除\n  - k8s_1002 : 创建特权Pod\n  - k8s_1003 : Pod中使用交互式shell\n  - k8s_1004 : 创建敏感目录Pod\n  - k8s_1005 : 创建主机网络的Pod\n  - k8s_1006 : 创建主机Pid空间的Pod\n  - k8s_1007 : 普通pod访问APIserver认证失败\n  - k8s_1008 : 普通Pod通过Curl访问APIServer\n  - k8s_1009 : 系统管理空间执行exec\n  - k8s_1010 : 系统管理空间创建Pod\n  - k8s_1011 : 创建静态Pod\n  - k8s_1012 : 创建DaemonSet\n  - k8s_1013 : 创建集群计划任务\n  - k8s_1014 : Secrets操作\n  - k8s_1015 : 枚举用户可执行的操作\n  - k8s_1016 : 高权限RoleBinding或ClusterRoleBinding\n  - k8s_1017 : ServiceAccount创建\n  - k8s_1018 : 创建Cronjob\n  - k8s_1019 : Pod中exec使用交互式shell\n  - k8s_1020 : 无权限访问Apiserver\n  - k8s_1021 : 使用curl访问APIServer\n  - k8s_1022 : Ingress漏洞\n  - k8s_1023 : 中间人攻击\n  - k8s_1024 : 蠕虫挖矿木马\n  - k8s_1025 : K8s事件删除\n  - k8s_1026 : SelfSubjectRulesReview场景\n  - imgblock_0001 : 镜像白名单阻断\n  - imgblock_0002 : 镜像黑名单阻断\n  - imgblock_0003 : 镜像标签白名单阻断\n  - imgblock_0004 : 镜像标签黑名单阻断\n  - imgblock_0005 : 创建容器白名单阻断\n  - imgblock_0006 : 创建容器黑名单阻断\n  - imgblock_0007 : 容器mount proc阻断\n  - imgblock_0008 : 容器seccomp unconfined阻断\n  - imgblock_0009 : 容器特权阻断\n  - imgblock_0010 : 容器capabilities阻断","example":"malware_1001","type":"string"},"EventId":{"description":"事件编号","example":"0009bae0-8700-11eb-bb3f-fa163e01e338","pattern":"^.*$","type":"string"},"EventName":{"description":"事件名称","example":"event name","pattern":"^.*$","type":"string"},"EventType":{"description":"事件类型,包含如下:\n  - 1001 : 通用恶意软件\n  - 1002 : 病毒\n  - 1003 : 蠕虫\n  - 1004 : 木马\n  - 1005 : 僵尸网络\n  - 1006 : 后门\n  - 1010 : Rootkit\n  - 1011 : 勒索软件\n  - 1012 :黑客工具\n  - 1015 : Webshell\n  - 1016 : 挖矿\n  - 1017 : 反弹Shell\n  - 2001 : 一般漏洞利用\n  - 2012 : 远程代码执行\n  - 2047 : Redis漏洞利用\n  - 2048 : Hadoop漏洞利用\n  - 2049 : MySQL漏洞利用\n  - 3002 : 文件提权\n  - 3003 : 进程提权\n  - 3004 : 关键文件变更\n  - 3005 : 文件/目录变更\n  - 3007 : 进程异常行为\n  - 3015 : 高危命令执行\n  - 3018 : 异常Shell\n  - 3027 : Crontab可疑任务\n  - 3029 :系统安全防护被禁用\n  - 3030 :备份删除\n  - 3031 :异常注册表操作\n  - 3036 : 容器镜像阻断\n  - 4002 : 暴力破解\n  - 4004 : 异常登录\n  - 4006 : 非法系统账号\n  - 4014 : 用户账号添加\n  - 4020 : 用户密码窃取\n  - 6002 : 端口扫描\n  - 6003 : 主机扫描\n  - 13001 : Kubernetes事件删除\n  - 13002 : Pod异常行为\n  - 13003 : 枚举用户信息\n  - 13004 : 绑定集群用户角色","example":1001,"format":"int32","maximum":30000,"minimum":1000,"type":"integer"},"FileAttr":{"description":"文件属性","example":"33261","pattern":"^.*$","type":"string"},"FileCtime":{"description":"文件创建时间","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"FileHash":{"description":"文件哈希","example":"4845dbb7c2e3e064d88d844cd23883703b02c31dbc7be8cfee84e291eca5cb7e","pattern":"^.*$","type":"string"},"FileMtime":{"description":"文件更新时间","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"FileOwner":{"description":"文件属主","example":33271,"pattern":"^.*$","type":"string"},"FilePath":{"description":"文件路径","example":"/root","pattern":"^.*$","type":"string"},"FileSize":{"description":"文件大小","example":16155648,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"HandleMethod":{"description":"处理方式,已处理的告警才有,包含如下:\n  - mark_as_handled : 手动处理\n  - ignore : 忽略\n  - add_to_alarm_whitelist : 加入告警白名单\n  - add_to_login_whitelist : 加入登录白名单\n  - isolate_and_kill : 隔离查杀","example":"ignore","type":"string"},"HandleStatus":{"description":"处理状态,包含如下:\n  - unhandled :未处理\n  - handled : 已处理","example":"unhandled","type":"string"},"HandleTime":{"description":"处理时间,毫秒,已处理的告警才有","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"Handler":{"description":"备注信息,已处理的告警才有","example":"handler","pattern":"^.*$","type":"string"},"HostId":{"description":"主机ID","example":"71a15ecc-049f-4cca-bd28-5e90aca1817f","maxLength":64,"minLength":0,"pattern":"^.*$","type":"string"},"HostName":{"description":"服务器名称","example":"HostName","maxLength":64,"minLength":1,"pattern":"^.*$","type":"string"},"ImageName":{"description":"镜像名称,只有容器类型的告警有","example":"image name","pattern":"^.*$","type":"string"},"IsolateEventResponseInfo":{"description":"隔离事件详情","properties":{"agent_status":{"description":"Agent状态,包含如下5种。\n  - installed :已安装。\n  - not_installed :未安装。\n  - online :在线。\n  - offline :离线。\n  - install_failed :安装失败。\n  - installing :安装中。","maxLength":32,"minLength":1,"type":"string"},"asset_value":{"description":"资产重要性,包含如下4种\n  - important :重要资产\n  - common :一般资产\n  - test :测试资产","maxLength":128,"minLength":0,"type":"string"},"attack_phase":{"$ref":"#/definitions/AttackPhase"},"attack_tag":{"$ref":"#/definitions/AttackTag"},"container_name":{"$ref":"#/definitions/ContainerName"},"description":{"description":"告警说明","maxLength":1024,"minLength":0,"type":"string"},"event_abstract":{"description":"告警摘要","maxLength":512,"minLength":0,"type":"string"},"event_class_id":{"$ref":"#/definitions/EventClassId"},"event_count":{"description":"事件发生次数","example":10,"maximum":2147483647,"minimum":0,"type":"integer"},"event_id":{"$ref":"#/definitions/EventId"},"event_name":{"$ref":"#/definitions/EventName"},"event_type":{"$ref":"#/definitions/EventType"},"handle_method":{"$ref":"#/definitions/HandleMethod"},"handle_status":{"$ref":"#/definitions/HandleStatus"},"handle_time":{"$ref":"#/definitions/HandleTime"},"handler":{"$ref":"#/definitions/Handler"},"host_id":{"$ref":"#/definitions/HostId"},"host_name":{"$ref":"#/definitions/HostName"},"host_status":{"description":"服务器状态,包含如下4种。\n  - ACTIVE :运行中。\n  - SHUTOFF :关机。\n  - BUILDING :创建中。\n  - ERROR :故障。","maxLength":32,"minLength":1,"type":"string"},"image_name":{"$ref":"#/definitions/ImageName"},"occur_time":{"$ref":"#/definitions/OccurTime"},"os_type":{"$ref":"#/definitions/OsType"},"private_ip":{"$ref":"#/definitions/PrivateIp"},"protect_status":{"description":"防护状态,包含如下2种。\n- closed :未防护。\n- opened :防护中。","maxLength":32,"minLength":1,"type":"string"},"public_ip":{"$ref":"#/definitions/PublicIp"},"recommendation":{"description":"处置建议","pattern":"^.*$","type":"string"},"severity":{"$ref":"#/definitions/Severity"}},"type":"object"},"IsolateSource":{"description":"隔离来源,包含如下:\n  - event : 安全告警事件\n  - antivirus : 病毒查杀","example":"antivirus","type":"string"},"IsolatedFileResponseInfo":{"description":"已隔离文件详情","properties":{"agent_event_info":{"$ref":"#/definitions/IsolateEventResponseInfo"},"agent_version":{"$ref":"#/definitions/AgentVersion"},"antivirus_result_info":{"$ref":"#/definitions/AntivirusResultDetailInfo"},"asset_value":{"$ref":"#/definitions/AssetValue"},"event_name":{"$ref":"#/definitions/EventName"},"file_attr":{"$ref":"#/definitions/FileAttr"},"file_hash":{"$ref":"#/definitions/FileHash"},"file_path":{"$ref":"#/definitions/FilePath"},"host_id":{"$ref":"#/definitions/HostId"},"host_name":{"$ref":"#/definitions/HostName"},"isolate_source":{"$ref":"#/definitions/IsolateSource"},"isolation_status":{"$ref":"#/definitions/IsolationStatus"},"os_type":{"$ref":"#/definitions/OsType"},"private_ip":{"$ref":"#/definitions/PrivateIp"},"public_ip":{"$ref":"#/definitions/PublicIp"},"update_time":{"$ref":"#/definitions/UpdateTime"}},"required":["agent_event_info","agent_version","antivirus_result_info","asset_value","event_name","file_attr","file_hash","file_path","host_id","host_name","isolate_source","isolation_status","os_type","private_ip","public_ip","update_time"],"type":"object"},"IsolatedFilesResponseInfo":{"description":"已隔离文件列表","properties":{"data_list":{"description":"已隔离文件详情","items":{"$ref":"#/definitions/IsolatedFileResponseInfo"},"maxItems":100,"minItems":0,"type":"array"},"total_num":{"$ref":"#/definitions/TotalNum"}},"required":["data_list","total_num"],"type":"object"},"IsolationStatus":{"description":"隔离状态,包含如下:\n  - isolated : 已隔离\n  - restored : 已恢复\n  - isolating : 已下发隔离任务\n  - restoring : 已下发恢复任务","example":"isolated","type":"string"},"MalwareName":{"description":"病毒名称","example":"HTML.WebShell.Agent","pattern":"^.*$","type":"string"},"OccurTime":{"description":"发生时间,毫秒","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"OsType":{"description":"操作系统类型,包含如下2种。\n  - Linux :Linux。\n  - Windows :Windows。","maxLength":64,"minLength":0,"type":"string","x-example":"Linux"},"PrivateIp":{"description":"服务器私有IP","example":"192.168.1.1","maxLength":256,"minLength":1,"pattern":"^.*$","type":"string"},"PublicIp":{"description":"弹性公网IP地址","example":"127.0.0.1","pattern":"^.*$","type":"string"},"ResultId":{"description":"病毒查杀结果ID","example":"0009bae0-8700-11eb-bb3f-fa163e01e338","pattern":"^.*$","type":"string"},"Severity":{"description":"威胁等级,包含如下:\n  - Security : 安全\n  - Low : 低危\n  - Medium : 中危\n  - High : 高危\n  - Critical : 危急","example":"Critical","type":"string"},"TotalNum":{"description":"总数","example":10,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"UpdateTime":{"description":"更新时间,毫秒","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"f185d45114fb43a6a86fb2f9b896248e","info_version":"v5","method":"get","name":"ListIsolatedFile","parameters":{},"paths":{"/v5/{project_id}/event/isolated-file":{"get":{"description":"查询已隔离文件列表","operationId":"ListIsolatedFile","parameters":[{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)","in":"header","maxLength":32768,"minLength":1,"name":"X-Auth-Token","pattern":"^.*$","required":true,"type":"string","x-example":"$${X-Auth-Token}"},{"description":"Region ID","in":"header","maxLength":128,"minLength":0,"name":"region","pattern":"^.*$","required":true,"type":"string","x-example":"cn-north-5"},{"description":"项目ID","in":"path","maxLength":64,"minLength":20,"name":"project_id","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"企业项目ID,查询所有企业项目时填写:all_granted_eps","in":"query","maxLength":64,"minLength":0,"name":"enterprise_project_id","pattern":"^.*$","required":false,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"文件路径","in":"query","name":"file_path","pattern":"^.*$","required":false,"type":"string"},{"description":"服务器名称","in":"query","maxLength":64,"minLength":1,"name":"host_name","pattern":"^.*$","required":false,"type":"string","x-example":"HostName"},{"description":"服务器私有IP","in":"query","maxLength":256,"minLength":1,"name":"private_ip","pattern":"^.*$","required":false,"type":"string","x-example":"192.168.1.1"},{"description":"服务器公网IP","in":"query","maxLength":256,"minLength":1,"name":"public_ip","pattern":"^.*$","required":false,"type":"string","x-example":"192.168.1.1"},{"description":"文件hash,当前为sha256","in":"query","name":"file_hash","pattern":"^.*$","required":false,"type":"string"},{"description":"资产重要性,包含如下3种\n  - important :重要资产\n  - common :一般资产\n  - test :测试资产","in":"query","maxLength":128,"minLength":0,"name":"asset_value","required":false,"type":"string"},{"default":0,"description":"偏移量:指定返回记录的开始位置","format":"int32","in":"query","maximum":2000000,"minimum":0,"name":"offset","required":false,"type":"integer"},{"default":10,"description":"每页显示个数","format":"int32","in":"query","maximum":1000,"minimum":10,"name":"limit","required":false,"type":"integer"}],"produces":["application/json"],"responses":{"200":{"description":"已隔离文件列表","examples":{"application/json":{"data_list":[{"agent_event_info":{"agent_status":"online","asset_value":"common","attack_phase":"exploit","attack_tag":"abnormal_behavior","container_name":"test","description":"","event_abstract":"","event_class_id":"lgin_1002","event_count":1,"event_id":"d8a12cf7-6a43-4cd6-92b4-aabf1e917","event_name":"different locations","event_type":4004,"handle_method":"ignore","handle_status":"unhandled","handle_time":1698304933717,"host_id":"5a41ca47-8ea7-4a65-a8fb-950d03d8638e","host_name":"xxx","host_status":"ACTIVE","image_name":"image","occur_time":1661593036627,"os_type":"Linux","private_ip":"127.0.0.1","protect_status":"opened","public_ip":"127.0.0.2","recommendation":"建议处置","severity":"Medium"},"agent_version":"3.2.10","antivirus_result_info":{"agent_id":"5a41ca47-8ea7-4a65-a8fb-950d03d8638e","file_attr":"0","file_ctime":1700039800,"file_hash":"58693382bc0c9f60ef86e5b37cf3c2f3a9c9ec46936901eaa9131f7ee4a09bde","file_mtime":1700039800,"file_owner":"Administrators","file_path":"C:\\Users\\Public\\Public Docker\\system32.exe","file_size":58460,"malware_name":"Win32.Virus.Hidrag","result_id":"5a41ca47-8ea7-4a65-a8fb-950d03d8638e","update_time":1698304933717},"asset_value":"common","event_name":"间谍软件","file_attr":"0","file_hash":"58693382bc0c9f60ef86e5b37cf3c2f3a9c9ec46936901eaa9131f7ee4a09bde","file_path":"C:\\Users\\Public\\Public Docker\\system32.exe","host_id":"5a41ca47-8ea7-4a65-a8fb-950d03d8638e","host_name":"ecs-wi-800211","isolate_source":"event","isolation_status":"isolated","os_type":"Linux","private_ip":"127.0.0.2","public_ip":"127.0.0.1","update_time":1698304933717}],"total_num":1}},"schema":{"$ref":"#/definitions/IsolatedFilesResponseInfo"}}},"summary":"查询已隔离文件列表","tags":["事件管理"],"x-is-registered":"N","x-request-examples-description-1":"查询前10条已隔离的文件列表","x-request-examples-url-1":"GET https://{endpoint}/v5/{project_id}/event/isolated-file?limit=10&offset=0&enterprise_project_id=xxx","x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询已隔离文件列表","tags":"事件管理","uri":null,"version":"2.0"}