{"base_path":"/","components":null,"consumes":"","definitions":{"ListRaspProtectHistoryResponseInfo":{"properties":{"data_list":{"description":"data list","items":{"$ref":"#/definitions/RaspProtectHistoryResponseInfo"},"maxItems":10241,"minItems":0,"type":"array"},"total_num":{"description":"total number","format":"int64","maximum":2097152,"minimum":0,"type":"integer"}},"type":"object"},"RaspProtectHistoryResponseInfo":{"properties":{"alarm_time":{"description":"告警时间(ms)","example":1615564800000,"format":"int64","maximum":9223372036854775807,"minimum":0},"app_stack":{"description":"应用程序调用堆栈信息","maxLength":2048,"minLength":0,"type":"string"},"attack_input_name":{"description":"攻击附属字段","maxLength":1024,"minLength":0,"type":"string"},"attack_input_value":{"description":"攻击负载内容","maxLength":2048,"minLength":0,"type":"string"},"attack_tag":{"description":"攻击标识","maxLength":128,"minLength":1,"type":"string"},"chk_probe":{"description":"探针标识","maxLength":128,"minLength":1,"type":"string"},"chk_rule":{"description":"检测规则标识","maxLength":128,"minLength":1,"type":"string"},"chk_rule_desc":{"description":"规则描述","maxLength":256,"minLength":1,"type":"string"},"event_name":{"description":"告警名称","maxLength":128,"minLength":0,"type":"string"},"exist_bug":{"description":"应用是否存在bug","maxLength":32,"minLength":1,"type":"string"},"host_name":{"description":"主机名称","maxLength":64,"minLength":1,"type":"string"},"private_ip":{"description":"主机私有IP","maxLength":128,"minLength":1,"type":"string"},"query_string":{"description":"查询字符串","maxLength":1024,"minLength":0,"type":"string"},"req_headers":{"description":"web请求头信息","maxLength":1024,"minLength":0,"type":"string"},"req_method":{"description":"WEB请求方法","maxLength":32,"minLength":0,"type":"string"},"req_params":{"description":"WEB请求参数","maxLength":1024,"minLength":0,"type":"string"},"req_path":{"description":"WEB请求路径","maxLength":512,"minLength":0,"type":"string"},"req_protocol":{"description":"WEB请求协议","maxLength":128,"minLength":0,"type":"string"},"req_src_ip":{"description":"源IP","maxLength":128,"minLength":0,"type":"string"},"req_url":{"description":"WEB请求URL地址","maxLength":1024,"minLength":0,"type":"string"},"severity":{"description":"告警级别","maxLength":32,"minLength":1,"type":"string"}},"type":"object"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"b96b38f3ad5a48599107666545e539c5","info_version":"v5","method":"get","name":"ListRaspEvents","parameters":{},"paths":{"/v5/{project_id}/rasp/events":{"get":{"description":"查询应用防护事件列表:展示防护事件相关信息,包含告警级别、服务器名称、告警名称、告警时间、攻击源ip、攻击源url数据","operationId":"ListRaspEvents","parameters":[{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)","in":"header","maxLength":2097152,"minLength":32,"name":"x-auth-token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX..."},{"description":"项目ID","in":"path","maxLength":128,"minLength":20,"name":"project_id","pattern":"^[a-zA-Z0-9_-]+$","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"企业项目ID","in":"query","maxLength":128,"minLength":20,"name":"enterprise_project_id","pattern":"^[a-zA-Z0-9_-]+$","required":true,"type":"string","x-example":"5k87ed520xxxxebedb6e57xxxxxxxx"},{"description":"Host Id","in":"query","maxLength":128,"minLength":0,"name":"host_id","required":true,"type":"string","x-example":"96342d35-187c-xxxx-9e1a-5f61xxxx83de"},{"description":"查询时间段的起始时间,毫秒级时间戳(ms)","format":"int64","in":"query","maximum":9223372036854775807,"minimum":0,"name":"start_time","required":true,"type":"integer"},{"description":"查询时间段的终止时间,毫秒级时间戳(ms)","format":"int64","in":"query","maximum":9223372036854775807,"minimum":0,"name":"end_time","required":true,"type":"integer"},{"default":10,"description":"默认10","format":"int32","in":"query","maximum":1000,"minimum":0,"name":"limit","required":true,"type":"integer"},{"default":0,"description":"默认0","format":"int32","in":"query","maximum":100000,"minimum":0,"name":"offset","required":true,"type":"integer"},{"default":"java","description":"应用类型,包含如下1种。\n  - java :java类型应用防护。","enum":["java"],"in":"query","maximum":64,"minimum":0,"name":"app_type","required":false,"type":"string"},{"description":"告警级别 |- 告警级别,包含如下1种。 - 0 :Info级别告警 - 1 :Low级别告警 - 2 :Medium级别告警 - 3 :High级别告警 - 4 :Critical级别告警","in":"query","maxLength":64,"minLength":1,"name":"severity","required":false,"type":"string"},{"description":"攻击标识 |- 攻击标识,包含如下6种。 - 1 :Attack Success  攻击成功 - 2 :Attack Attempt  攻击尝试 - 3 :Attack Blocked  攻击被阻断 - 4 :Abnormal Behavior  异常行为 - 5 :Collapsible Host  主机失陷 - 6 :System Vulnerability  系统脆弱性","in":"query","maxLength":64,"minLength":1,"name":"attack_tag","required":false,"type":"string"},{"description":"防护状态,包含如下2种。\n  - closed :未开启。\n  - opened :防护中。","enum":["closed","opened"],"in":"query","name":"protect_status","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"请求已成功","examples":{"application/json":{"data_list":[{"alarm_time":1736414463000,"app_stack":"com.huawei.hisec.secshield.vulnsblock.**********shieldAndEscapeReturn(*******:225)","attack_tag":"abnormal_behavior","chk_probe":"EI-TemplateAwareExpressionParser.parseExpression","chk_rule":"ExpressionInject","chk_rule_desc":"the length of the expression over max length, length: 2908","event_name":"ExpressionInject","exist_bug":"yes","host_name":"test-lmh-003","private_ip":"192.168.0.97","query_string":"","req_headers":"{\"accept\":[\"*/*\"],\"host\":[\"127.0.0.1:8080\"],\"user-agent\":[\"curl/7.81.0\"]}","req_method":"GET","req_params":"","req_path":"","req_protocol":"HTTP/1.1","req_src_ip":"127.0.0.1","req_url":"/fileless","severity":"High"}],"total_num":21}},"schema":{"$ref":"#/definitions/ListRaspProtectHistoryResponseInfo"}}},"summary":"查询应用防护事件列表","tags":["应用防护"],"x-iam-auth-meta-anno":{"abacAction":"hss:rasp:listRaspEvents","abacActionAlias":"hss:rasp:list","authLevel":"PROJECT","rbac":["op_service","te_admin","hss_adm","te_admin+op_restricted","te_admin+op_suspended","hss_adm+op_restricted","hss_adm+op_suspended","readonly"]},"x-is-registered":"Y","x-method-annotations":["@CtsInfo(userOperationType = \"listRaspEvents\", operationId = \"ListRaspEvents\")"],"x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询应用防护事件列表","tags":"应用防护","uri":null,"version":"2.0"}