{"base_path":"/","components":null,"consumes":"","definitions":{"ManualCheckVulResponseBody":{"description":"手工检测漏洞接口请求体","properties":{"task_id":{"description":"检测任务id","example":"d8a12cf7-6a43-4cd6-92b4-aabf1e917","maxLength":32,"minLength":0,"type":"string"}},"type":"object"},"ManualVulScanRequestInfo":{"description":"手工检测漏洞接口请求体","properties":{"agent_id_list":{"description":"主机列表","items":{"maxLength":64,"minLength":0,"type":"string"},"maxItems":200,"minItems":1,"type":"array"},"batch_flag":{"description":"是否是批量操作,为true时扫描所有支持的主机","type":"boolean"},"manual_scan_type":{"description":"操作类型,包含如下:\n  -linux_vul : linux漏洞\n  -windows_vul : windows漏洞\n  -web_cms : Web-CMS漏洞\n  -app_vul : 应用漏洞\n  -urgent_vul : 应急漏洞","items":{"enum":["linux_vul","windows_vul","web_cms","app_vul","urgent_vul"],"type":"string"},"maxItems":200,"minItems":1,"type":"array","x-example":["urgent_vul"]},"range_type":{"description":"扫描主机的范围,包含如下:\n  -all_host : 扫描全部主机,此类型不需要填写agent_id_list\n  -specific_host : 扫描指定主机","example":"specific_host","maxLength":32,"minLength":0,"type":"string"},"urgent_vul_id_list":{"description":"扫描的应急漏洞id列表,若为空则扫描所有应急漏洞\n包含如下:\n\"URGENT-CVE-2023-46604   Apache ActiveMQ远程代码执行漏洞\"\n\"URGENT-HSSVD-2020-1109  Elasticsearch 未授权访问漏洞\"\n\"URGENT-CVE-2022-26134   Atlassian Confluence OGNL 远程代码执行漏洞(CVE-2022-26134)\"\n\"URGENT-CVE-2023-22515   Atlassian Confluence Data Center and Server 权限提升漏洞(CVE-2023-22515)\"\n\"URGENT-CVE-2023-22518   Atlassian Confluence Data Center & Server 授权机制不恰当漏洞(CVE-2023-22518)\"\n\"URGENT-CVE-2023-28432   MinIO 信息泄露漏洞(CVE-2023-28432)\"\n\"URGENT-CVE-2023-37582   Apache RocketMQ 远程代码执行漏洞(CVE-2023-37582)\"\n\"URGENT-CVE-2023-33246   Apache RocketMQ 远程代码执行漏洞(CVE-2023-33246)\"\n\"URGENT-CNVD-2023-02709  禅道项目管理系统远程命令执行漏洞(CNVD-2023-02709)\"\n\"URGENT-CVE-2022-36804   Atlassian Bitbucket Server 和 Data Center 命令注入漏洞(CVE-2022-36804)\"\n\"URGENT-CVE-2022-22965   Spring Framework JDK >= 9 远程代码执行漏洞\"\n\"URGENT-CVE-2022-25845   fastjson <1.2.83 远程代码执行漏洞\"\n\"URGENT-CVE-2019-14439   Jackson-databind远程命令执行漏洞(CVE-2019-14439)\"\n\"URGENT-CVE-2020-13933   Apache Shiro身份验证绕过漏洞(CVE-2020-13933)\"\n\"URGENT-CVE-2020-26217   XStream < 1.4.14 远程代码执行漏洞(CVE-2020-26217)\"\n\"URGENT-CVE-2021-4034    Linux Polkit 权限提升漏洞预警(CVE-2021-4034)\"\n\"URGENT-CVE-2021-44228   Apache Log4j2 远程代码执行漏洞(CVE-2021-44228、CVE-2021-45046)\"\n\"URGENT-CVE-2022-0847    Dirty Pipe - Linux 内核本地提权漏洞(CVE-2022-0847)\"","items":{"maxLength":32,"minLength":0,"type":"string"},"maxItems":200,"minItems":1,"type":"array"}},"type":"object"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"b8c7e65442ad490eaac50b91ff267892","info_version":"v5","method":"post","name":"CreateVulnerabilityScanTask","parameters":{},"paths":{"/v5/{project_id}/vulnerability/scan-task":{"post":{"description":"创建漏洞扫描任务","operationId":"CreateVulnerabilityScanTask","parameters":[{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)","in":"header","maxLength":2097152,"minLength":32,"name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX..."},{"description":"项目ID","in":"path","maxLength":64,"minLength":20,"name":"project_id","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"主机所属的企业项目ID。\n开通企业项目功能后才需要配置企业项目。\n企业项目ID默认取值为“0”,表示默认企业项目。如果需要查询所有企业项目下的主机,请传参“all_granted_eps”。如果您只有某个企业项目的权限,则需要传递该企业项目ID,查询该企业项目下的主机,否则会因权限不足而报错。","in":"query","maxLength":64,"minLength":0,"name":"enterprise_project_id","required":false,"type":"string","x-example":""},{"description":"手动检测漏洞请求体","in":"body","name":"CreateVulnerabilityScanTaskRequestBody","required":true,"schema":{"$ref":"#/definitions/ManualVulScanRequestInfo"}}],"produces":["application/json"],"responses":{"200":{"description":"请求已成功","examples":{"application/json":{"task_id":"d8a12cf7-6a43-4cd6-92b4-aabf1e917"}},"schema":{"$ref":"#/definitions/ManualCheckVulResponseBody"}}},"summary":"创建漏洞扫描任务","tags":["vul"],"x-api-type":"open-api","x-is-registered":"Y","x-request-examples-1":{"agent_id_list":["0253edfd-30e7-439d-8f3f-17c54c997064"],"batch_flag":false,"manual_scan_type":"urgent_vul","range_type":"specific_host","urgent_vul_id_list":["URGENT-CVE-2023-46604","URGENT-HSSVD-2020-1109","URGENT-CVE-2022-26134","URGENT-CVE-2023-22515","URGENT-CVE-2023-22518","URGENT-CVE-2023-28432","URGENT-CVE-2023-37582","URGENT-CVE-2023-33246","URGENT-CNVD-2023-02709","URGENT-CVE-2022-36804","URGENT-CVE-2022-22965","URGENT-CVE-2022-25845","URGENT-CVE-2019-14439","URGENT-CVE-2020-13933","URGENT-CVE-2020-26217","URGENT-CVE-2021-4034","URGENT-CVE-2021-44228","URGENT-CVE-2022-0847"]},"x-request-examples-description-1":"创建agent_id为0253edfd-30e7-439d-8f3f-17c54c997064,检测漏洞Id列表为urgent_vul_id_list的应急漏洞检测任务","x-request-examples-url-1":"POST https://{endpoint}/v5/{project_id}/vulnerability/scan-task?enterprise_project_id=XXX","x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建漏洞扫描任务","tags":"漏洞管理","uri":null,"version":"2.0"}