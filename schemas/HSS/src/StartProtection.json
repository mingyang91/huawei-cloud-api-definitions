{"base_path":"/","components":null,"consumes":"","definitions":{"BackupResources":{"description":"开启备份功能新版参数,必填;若为空代表兼容之前绑定HSS_projectid的存储库","properties":{"resource_list":{"description":"需要开启备份功能的主机情况列表","items":{"$ref":"#/definitions/ResourceInfo"},"maxItems":20,"minItems":0,"type":"array"},"vault_id":{"description":"选择需要绑定的存储库ID,不为空","maxLength":64,"minLength":0,"type":"string"}},"type":"object"},"BackupTriggerPropertiesRequestInfo1":{"description":"策略执行时间规则,若开启勒索防护时开启备份功能,则该字段必选","properties":{"pattern":{"description":"调度规则。若开启勒索防护时开启备份功能,则该字段必选。限制24条规则。调度器的调度规则,可参照iCalendar RFC 2445规范中的事件规则,但仅支持FREQ、BYDAY、BYHOUR、BYMINUTE、INTERVAL等参数,其中FREQ仅支持WEEKLY和DAILY,BYDAY支持一周七天(MO、TU、WE、TH、FR、SA、SU),BYHOUR支持0-23小时,BYMINUTE支持0-59分钟,并且间隔不能小于一小时,一天最大24个时间点。例如,周一到周天,每天14:00调度,其规则为:'FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00'。每天14:00调度,其规则为'FREQ=DAILY;INTERVAL=1;BYHOUR=14;BYMINUTE=00'。","items":{"maxLength":256,"minLength":1,"type":"string"},"maxItems":24,"minItems":0,"type":"array"}},"type":"object"},"BackupTriggerRequestInfo1":{"description":"策略时间调度规则","properties":{"properties":{"$ref":"#/definitions/BackupTriggerPropertiesRequestInfo1"}},"type":"object"},"OperationDefinitionRequestInfo":{"description":"调度参数","properties":{"day_backups":{"description":"保留日备个数,该备份不受保留最大备份数限制。取值为0到100。若选择该参数,则timezone 也必选。最小值:0,最大值:100","format":"int32","maximum":100,"minimum":0,"type":"integer"},"max_backups":{"description":"单个备份对象自动备份的最大备份数。取值为-1或0-99999。-1代表不按备份数清理。若该字段和retention_duration_days字段同时为空,备份会永久保留。最小值:1,最大值:99999,缺省值:-1","example":1,"format":"int32","maximum":99999,"minimum":-1,"type":"integer"},"month_backups":{"description":"保留月备个数,该备份不受保留最大备份数限制。取值为0到100。若选择该参数,则timezone 也必选。最小值:0, 最大值:100","example":1,"format":"int32","maximum":100,"minimum":0,"type":"integer"},"retention_duration_days":{"description":"备份保留时长,单位天。最长支持99999天。-1代表不按时间清理。若该字段和max_backups 参数同时为空,备份会永久保留。最小值:1, 最大值:99999, 缺省值:-1","format":"int32","maximum":99999,"minimum":-1,"type":"integer"},"timezone":{"description":"用户所在时区,格式形如UTC+08:00,若没有选择年备,月备,周备,日备中任一参数,则不能选择该参数。","maxLength":256,"minLength":0,"type":"string"},"week_backups":{"description":"保留周备个数,该备份不受保留最大备份数限制。取值为0到100。若选择该参数,则timezone 也必选。","format":"int32","maximum":100,"minimum":0,"type":"integer"},"year_backups":{"description":"保留年备个数,该备份不受保留最大备份数限制。取值为0到100。若选择该参数,则timezone 也必选。最小值:0,最大值:100","format":"int32","maximum":100,"minimum":0,"type":"integer"}},"type":"object"},"ProtectionInfoRequestInfo":{"properties":{"agent_id_list":{"description":"开启防护的Agent id列表","example":[],"items":{"maxLength":64,"minLength":0,"type":"string"},"maxItems":24,"minItems":0,"type":"array"},"backup_cycle":{"$ref":"#/definitions/UpdateBackupPolicyRequestInfo1"},"backup_policy_id":{"description":"备份策略ID","maxLength":64,"minLength":0,"type":"string"},"backup_protection_status":{"description":"是否服务器备份,包含如下:\n  - closed :关闭。\n  - opened :开启。\n  若选择开启服务器备份,则backup_cycle必填","maxLength":64,"minLength":0,"type":"string"},"backup_resources":{"$ref":"#/definitions/BackupResources"},"create_protection_policy":{"$ref":"#/definitions/ProtectionProxyInfoRequestInfo"},"host_id_list":{"description":"开启防护的host id列表","example":[],"items":{"maxLength":64,"minLength":0,"type":"string"},"maxItems":24,"minItems":0,"type":"array"},"operating_system":{"description":"需要开启防护的主机的操作系统,包含如下:\n  - Windows : Windows系统\n  - Linux : Linux系统","maxLength":64,"minLength":0,"type":"string"},"protection_policy_id":{"description":"勒索防护策略ID,若选择已有策略防护,则该字段必选","maxLength":64,"minLength":0,"type":"string"},"ransom_protection_status":{"description":"勒索防护是否开启,包含如下:\n  - closed :关闭。\n  - opened :开启。\n  若选择开启,protection_policy_id或者create_protection_policy必填一项","maxLength":64,"minLength":0,"type":"string"}},"required":["agent_id_list","backup_protection_status","host_id_list","operating_system","ransom_protection_status"],"type":"object"},"ProtectionProxyInfoRequestInfo":{"description":"创建防护策略。若新建防护策略,则protection_policy_id为空,create_protection_policy必选","properties":{"bait_protection_status":{"description":"是否开启诱饵防护,新建防护策略则必填。包含如下1种, 默认为开启防护诱饵防护。\n  - opened :开启。\n  - closed :关闭。","maxLength":64,"minLength":0,"type":"string"},"exclude_directory":{"description":"排除目录,可选填","example":"exclude_directory","maxLength":64,"minLength":0,"type":"string"},"operating_system":{"description":"操作系统,新建防护策略则必填。包含如下:\n  - Windows : Windows系统\n  - Linux : Linux系统","maxLength":64,"minLength":0,"type":"string"},"policy_id":{"description":"策略ID,新建策略可不填","maxLength":64,"minLength":0,"type":"string"},"policy_name":{"description":"策略名称,新建防护策略则必填","example":"policy_name","maxLength":64,"minLength":0,"type":"string"},"process_whitelist":{"description":"进程白名单","items":{"$ref":"#/definitions/TrustProcessInfo"},"maxItems":20,"minItems":0,"type":"array"},"protection_directory":{"description":"防护目录,新建防护策略则必填","example":"protection_directory","maxLength":64,"minLength":0,"type":"string"},"protection_mode":{"description":"防护动作,新建防护策略则必填。包含如下:\n  - alarm_and_isolation :告警并自动隔离。\n  - alarm_only :仅告警。","maxLength":64,"minLength":0,"type":"string"},"protection_type":{"description":"防护类型,新建防护策略则必填","example":"protection_type","maxLength":64,"minLength":0,"type":"string"},"runtime_detection_status":{"description":"是否运行时检测,选填。包含如下2种,暂时只有关闭一种状态,为保留字段。\n  - opened :开启。\n  - closed :关闭。","maxLength":64,"minLength":0,"type":"string"}},"type":"object"},"ResourceInfo":{"properties":{"history_backup_status":{"description":"历史开启备份状态,通过筛选可用服务器的error_message或者status判断,如果error_message为空,则没有开启备份,该字段为closed;若不为空,则为opened","enum":["opened","closed"],"maxLength":128,"minLength":0,"type":"string"},"host_id":{"description":"主机id","maxLength":128,"minLength":0,"type":"string"}},"type":"object"},"TrustProcessInfo":{"properties":{"hash":{"description":"进程hash","maxLength":128,"minLength":0,"type":"string"},"path":{"description":"进程路径","maxLength":128,"minLength":0,"type":"string"}},"type":"object"},"UpdateBackupPolicyRequestInfo1":{"description":"备份策略","properties":{"enabled":{"description":"策略是否启用,缺省值:true","example":true,"type":"boolean"},"operation_definition":{"$ref":"#/definitions/OperationDefinitionRequestInfo"},"policy_id":{"description":"策略ID,若开启防护时开启备份防护,该字段必选","example":"f75b333f-f42c-4ea4-b990-5e9be129797f","maxLength":256,"minLength":1,"type":"string"},"trigger":{"$ref":"#/definitions/BackupTriggerRequestInfo1"}},"type":"object"}},"description":null,"group_id":"3f29a7c68cc24a39a794ff9ddec0ba77","host":"hss.cn-north-4.myhuaweicloud.com","id":"4c721749e14b4943b6a802378f98414f","info_version":"v5","method":"post","name":"StartProtection","parameters":{},"paths":{"/v5/{project_id}/ransomware/protection/open":{"post":{"description":"开启勒索病毒防护,请保证该region有cbr云备份服务,勒索服务与云备份服务有关联关系","operationId":"StartProtection","parameters":[{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)","in":"header","maxLength":32768,"minLength":1,"name":"X-Auth-Token","pattern":"^.*$","required":true,"type":"string","x-example":"$${X-Auth-Token}"},{"description":"Region ID","in":"header","maxLength":128,"minLength":0,"name":"region","pattern":"^.*$","required":true,"type":"string","x-example":"cn-north-5"},{"description":"项目ID","in":"path","maxLength":256,"minLength":1,"name":"project_id","pattern":"^.*$","required":true,"type":"string","x-example":"9d4f774865034d119917acc61b1b806e"},{"default":"0","description":"企业项目ID,查询所有企业项目时填写:all_granted_eps","in":"query","maxLength":256,"minLength":1,"name":"enterprise_project_id","pattern":"^.*$","required":false,"type":"string"},{"description":"开启勒索病毒防护请求体","in":"body","name":"StartProtectionRequestBody","required":true,"schema":{"$ref":"#/definitions/ProtectionInfoRequestInfo"}}],"produces":["application/json"],"responses":{"200":{"description":"开启勒索病毒防护成功"}},"summary":"开启勒索病毒防护","tags":["勒索防护"],"x-is-registered":"Y","x-request-examples-1":{"agent_id_list":["c9bed5397db449ebdfba15e85fcfc36accee125c68954daf5cab0528bab59bd8"],"backup_protection_status":"closed","create_protection_policy":{"bait_protection_status":"opened","exclude_directory":"","policy_name":"test111","protection_directory":"/etc/test","protection_mode":"alarm_only","protection_type":"docx"},"host_id_list":["71a15ecc-049f-4cca-bd28-5e90aca1817f"],"operating_system":"Linux","protection_policy_id":"","ransom_protection_status":"opened"},"x-request-examples-description-1":"开启服务器勒索病毒防护,目标服务器操作系统类型为Linux,目标服务器ID为71a15ecc-049f-4cca-bd28-5e90aca1817f,目标服务器的Agent ID为c9bed5397db449ebdfba15e85fcfc36accee125c68954daf5cab0528bab59bd8,不开启服务器备份。","x-request-examples-url-1":"POST https://{endpoint}/v5/{project_id}/ransomware/protection/open","x-support-sdk":"Y","x-surpport-apiexplorer":true}}},"product_short":"HSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"开启勒索病毒防护","tags":"勒索防护","uri":null,"version":"2.0"}