{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"AuditSqlRequest":{"properties":{"client_ip":{"description":"客户端IP","example":null,"type":"string"},"client_name":{"description":"客户端名称","example":null,"type":"string"},"db_ip":{"description":"数据库IP","example":null,"type":"string"},"db_user":{"description":"数据库用户","example":null,"type":"string"},"page":{"description":"页码","example":1,"format":"int32","type":"integer"},"query_type":{"description":"查询类型\nLOGIN,CREATE_TABLE,CREATE_TABLESPACE,DROP_TABLE, DROP_TABLESPACE,DELETE,INSERT,INSERT_SELECT,SELECT,SELECT_FOR_UPDATE, UPDATE,CREATE_USER,DROP_USER,GRANT,OPERATE ALL","example":null,"type":"string"},"risk_levels":{"description":"风险级别\n- HIGH\n- MEDIUM\n- LOW\n- NO_RISK","enum":["HIGH","MEDIUM","LOW","NO_RISK"],"example":null,"type":"string"},"rule_name":{"description":"规则名称","example":null,"type":"string"},"size":{"description":"条数","example":50,"format":"int32","type":"integer"},"sql_response":{"description":"响应结果\n- SUCCESS\n- FAILED","example":null,"type":"string"},"sql_statement":{"description":"sql语句","example":null,"type":"string"},"time":{"description":"查询时间范围","properties":{"end_time":{"description":"结束时间,必须和start_time成对出现。格式必须为yyyy-MM-dd HH:mm:ss。UTC时间","example":null,"type":"string"},"start_time":{"description":"开始时间,必须和end_time成对出现。格式必须为yyyy-MM-dd HH:mm:ss。UTC时间","example":null,"type":"string"},"time_range":{"description":"时间范围。和start_time,end_time不能同时使用,同时传该参数优先级更高。\n- HALF_HOUR\n- HOUR\n- THREE_HOUR\n- TWELVE_HOUR\n- DAY\n- WEEK\n- MONTH","example":"DAY","type":"string"}}},"time_order":{"description":"时间顺序\n- DESC\n- ASC","example":"DESC","type":"string"}},"required":["time"],"type":"object"},"AuditSqlResponse":{"properties":{"count":{"description":"总数","example":2,"format":"int32","type":"integer"},"sqls":{"description":"sql语句列表","items":{"properties":{"sql":{"description":"sql信息","properties":{"client_ip":{"description":"客户端IP","example":"fe80::f816:3eff:feca:22f5","type":"string"},"client_name":{"description":"客户端名称","example":"","type":"string"},"db_instance":{"description":"数据库实例","example":"","type":"string"},"db_ip":{"description":"数据库IP","example":"fe80::f816:3eff:feca:22f5","type":"string"},"db_user":{"description":"数据库用户名","example":"root","type":"string"},"id":{"description":"ID","example":"o1n8BI8BDdIO3rwS4Rea","type":"string"},"operated_obj_info":{"description":"操作对象列表","items":{"properties":{"column_name":{"description":"列名","example":"","type":"string"},"object_type":{"description":"操作对象类型","example":"TABLE","type":"string"},"schema_name":{"description":"schema名称","example":"test","type":"string"},"sql_type":{"description":"sql类型","example":"CREATE TABLE","type":"string"},"sys_name":{"description":"系统名称","example":"","type":"string"},"table_name":{"description":"表名","example":"test","type":"string"}}},"type":"array"},"query_type":{"description":"查询类型\nLOGIN,CREATE_TABLE,CREATE_TABLESPACE,DROP_TABLE, DROP_TABLESPACE,DELETE,INSERT,INSERT_SELECT,SELECT,SELECT_FOR_UPDATE, UPDATE,CREATE_USER,DROP_USER,GRANT,OPERATE ALL","example":"SELECT","type":"string"},"risk_level":{"description":"风险级别\n- HIGH\n- MEDIUM\n- LOW\n- NO_RISK","example":"","type":"string"},"rule_name":{"description":"规则名称","example":"全审计规则","type":"string"},"sql_response":{"description":"响应结果\n- SUCCESS\n- FAILED","example":"SUCCESS","type":"string"},"sql_statement":{"description":"sql语句","example":"create table test(name varchar(1000), age int)","type":"string"},"start_time":{"description":"审计开始时间","example":"2024-04-22 08:46:02","type":"string"}},"required":["id","sql_response"]}},"required":["sql"]},"type":"array"},"total":{"description":"总数","example":2,"format":"int32","type":"integer"}},"required":["sqls"],"type":"object"},"Error":{"properties":{"error":{"description":"错误信息返回体。","items":{"$ref":"#/definitions/ErrorDetail"}}}},"ErrorDetail":{"properties":{"error_code":{"description":"错误请求返回的错误码。","maxLength":36,"minLength":3,"type":"string"},"error_msg":{"description":"错误请求返回的错误信息。","maxLength":1024,"minLength":0,"type":"string"}}}},"description":null,"group_id":"0ba875db15a142babc14f069c8b7c4f6","host":"dbss.cn-north-4.myhuaweicloud.com","id":"50768ac619664598b31b0a540aa9f72c","info_version":"v1","method":"post","name":"ListAuditSqls","parameters":{},"paths":{"/v1/{project_id}/{instance_id}/audit/sqls":{"post":{"description":"查询审计SQL语句","operationId":"ListAuditSqls","parameters":[{"description":"项目ID","in":"path","name":"project_id","required":true,"type":"string"},{"description":"实例ID。可在查询实例列表接口的ID字段获取。","in":"path","name":"instance_id","required":true,"type":"string"},{"description":"用户Token。 通过调用IAM服务查询用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"查询告警日志信息Body","in":"body","name":"ListAuditSqlsRequestBody","required":true,"schema":{"$ref":"#/definitions/AuditSqlRequest"}}],"produces":["application/json"],"responses":{"200":{"description":"成功","examples":{"application/json":{"count":2,"sqls":[{"sql":{"client_ip":"fe80::f816:3eff:feca:22f5","client_name":"","db_instance":"","db_ip":"fe80::f816:3eff:feca:22f5","db_user":"root","id":"o1n8BI8BDdIO3rwS4Rea","operated_obj_info":[{"column_name":"","object_type":"TABLE","schema_name":"test","sql_type":"CREATE TABLE","sys_name":"","table_name":"test"},{"column_name":"","object_type":"TABLE","schema_name":"test","sql_type":"CREATE","sys_name":"","table_name":"test"}],"query_type":"CREATE TABLE","risk_level":"","rule_name":"全审计规则","sql_response":"SUCCESS","sql_statement":"create table test(name varchar(1000), age int)","start_time":"2024-04-22 08:46:02"}},{"sql":{"client_ip":"fe80::f816:3eff:feca:22f5","client_name":"","db_instance":"","db_ip":"fe80::f816:3eff:feca:22f5","db_user":"root","id":"pFn8BI8BDdIO3rwS4Rea","operated_obj_info":[{"column_name":"","object_type":"","schema_name":"test","sql_type":"CREATE","sys_name":"","table_name":""}],"query_type":"CREATE","risk_level":"","rule_name":"全审计规则","sql_response":"FAILED","sql_statement":"create table test","start_time":"2024-04-22 08:46:02"}}],"total":2}},"schema":{"$ref":"#/definitions/AuditSqlResponse"}},"400":{"description":"请求参数错误","examples":{"application/json":{"error":{"error_code":"DBSS.XXXX","error_msg":"XXX"}}},"schema":{"$ref":"#/definitions/Error"}},"403":{"description":"认证失败","schema":{"$ref":"#/definitions/Error"}},"500":{"description":"服务器内部错误","examples":{"application/json":{"error":{"error_code":"DBSS.XXXX","error_msg":"XXX"}}},"schema":{"$ref":"#/definitions/Error"}}},"summary":"查询审计SQL语句","tags":["数据分析"],"x-hc":"Y","x-hcso":"Y","x-hk":"Y","x-is-registered":"Y","x-open-region-cloud":"hc,hk,hcso,sbc","x-order":5,"x-request-examples-1":{"client_ip":null,"client_name":null,"db_ip":null,"db_user":null,"page":1,"query_type":null,"risk_levels":null,"rule_name":null,"size":50,"sql_response":null,"sql_statement":null,"time":{"end_time":null,"start_time":null,"time_range":"DAY"},"time_order":"DESC"},"x-request-examples-text-1":{"client_ip":null,"client_name":null,"db_ip":null,"db_user":null,"page":1,"query_type":null,"risk_levels":null,"rule_name":null,"size":50,"sql_response":null,"sql_statement":null,"time":{"end_time":null,"start_time":null,"time_range":"DAY"},"time_order":"DESC"},"x-request-examples-url-1":"/v1/{project_id}/{instance_id}/audit/sqls","x-sbc":"Y","x-support-sdk":"Y"}}},"product_short":"DBSS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询审计SQL语句","tags":"数据分析","uri":null,"version":"2.0"}