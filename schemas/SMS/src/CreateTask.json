{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"BtrfsFileSystem":{"description":"btrfs分区类型","properties":{"data_profile":{"description":"数据配置(RAD)","maxLength":255,"minLength":0,"type":"string"},"default_subvol_mountpath":{"description":"默认子卷挂载路径/BTRFS文件系统的挂载路径","maxLength":255,"minLength":0,"type":"string"},"default_subvol_name":{"description":"默认子卷名称","maxLength":255,"minLength":0,"type":"string"},"default_subvolid":{"description":"默认子卷ID","maxLength":255,"minLength":0,"type":"string"},"device":{"description":"btrfs包含的设备名称","maxLength":255,"minLength":0,"type":"string"},"g_vol_used_size":{"description":"Btrfs卷已使用空间大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"global_reserve1":{"description":"Btrfs文件系统信息","maxLength":255,"minLength":0,"type":"string"},"label":{"description":"文件系统标签,若无标签为空字符串","maxLength":255,"minLength":0,"type":"string"},"metadata_profile":{"description":"元数据配置(RAD)","maxLength":255,"minLength":0,"type":"string"},"name":{"description":"文件系统名称","example":"/dev/vdb1","maxLength":255,"minLength":0,"type":"string"},"nodesize":{"description":"btrfs节点大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"sectorsize":{"description":"扇区大小","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"size":{"description":"文件系统数据占用大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"subvolumn":{"description":"子卷信息","items":{"$ref":"#/definitions/BtrfsSubvolumn"},"maxItems":65535,"minItems":0,"type":"array"},"system_profile":{"description":"文件系统配置(RAD)","maxLength":255,"minLength":0,"type":"string"},"uuid":{"description":"文件系统的uuid","maxLength":255,"minLength":0,"type":"string"}},"type":"object"},"BtrfsSubvolumn":{"description":"btrfs子卷信息","properties":{"is_snapshot":{"description":"子卷是否为快照","maxLength":255,"minLength":0,"type":"string"},"parent_id":{"description":"父卷ID","maxLength":255,"minLength":0,"type":"string"},"subvol_id":{"description":"子卷的ID","maxLength":255,"minLength":0,"type":"string"},"subvol_mount_path":{"description":"子卷的挂载路径","maxLength":255,"minLength":0,"type":"string"},"subvol_name":{"description":"子卷的名称","maxLength":255,"minLength":0,"type":"string"},"uuid":{"description":"父卷的uuid","maxLength":255,"minLength":0,"type":"string"}},"type":"object"},"CreateTaskResp":{"description":"创建任务返回","properties":{"id":{"description":"创建成功返回的任务ID","maxLength":255,"minLength":0,"type":"string","x-annotations":""}},"type":"object"},"Forbiddenstatus":{"description":"接口请求鉴权失败时返回的response body格式","properties":{"details":{"description":"详细错误信息","items":{"properties":{"error_code":{"description":"SMS错误代码","example":"SMS.9004","maxLength":65535,"minLength":0,"type":"string"},"error_msg":{"description":"SMS错误信息","example":"You do not have permission to perform action XXX on resource XXX.","maxLength":65535,"minLength":0,"type":"string"}}},"maxItems":20,"minItems":1,"type":"array"},"encoded_authorization_message":{"description":"加密授权信息","example":"XXXXXX","maxLength":65535,"minLength":0,"type":"string"},"error_code":{"description":"错误代码","example":"SMS.9004","maxLength":255,"minLength":0,"type":"string"},"error_msg":{"description":"错误信息","example":"The current account does not have the permission to execute policy. You do not have permission to perform action XXX on resource XXX.","maxLength":255,"minLength":0,"type":"string"},"error_param":{"description":"错误参数","example":["You do not have permission to perform action XXX on resource XXX."],"items":{"example":"XXXXXX","maxLength":65535,"minLength":0,"type":"string"},"maxItems":20,"minItems":1,"type":"array"}},"type":"object"},"LogicalVolumes":{"description":"逻辑卷信息","properties":{"block_count":{"default":0,"description":"块数量","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"block_size":{"default":0,"description":"块大小","format":"int64","maximum":1048576,"minimum":0,"type":"integer"},"device_use":{"description":"分区类型\n无强约束,可为空值,常见取值如下\nNORMAL:平常\nOS:系统设备\nBOOT:BOOT设备\nVOLUME_GROUP:VolumeGroup组成设备\nBTRFS:BTRFS组成设备","maxLength":255,"minLength":0,"type":"string"},"file_system":{"description":"文件系统","example":"ext4","maxLength":255,"minLength":0,"type":"string"},"free_size":{"description":"剩余空间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer","x-annotations":"空闲空间"},"inode_nums":{"description":"inode节点数量","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"inode_size":{"description":"inode数量","example":128,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"mount_point":{"description":"挂载点","example":"/mnt/data1","maxLength":256,"minLength":0,"type":"string"},"name":{"description":"名称","example":"/dev/mapper/l1170-lvg","maxLength":1024,"minLength":0,"type":"string"},"size":{"description":"大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"used_size":{"description":"使用大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"}},"type":"object"},"PhysicalVolumes":{"description":"使用大小","properties":{"device_use":{"description":"分区类型,普通分区,启动分区,系统分区","example":"BOOT","maxLength":255,"minLength":0,"type":"string"},"file_system":{"description":"文件系统类型","example":"NTFS","maxLength":255,"minLength":0,"type":"string"},"index":{"description":"顺序","example":1,"format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"inode_size":{"description":"inode数量","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"mount_point":{"description":"挂载点","example":"null","maxLength":255,"minLength":0,"type":"string"},"name":{"description":"名称,windows表示盘符,Linux表示设备号","example":"(Reserved)","maxLength":255,"minLength":0,"type":"string"},"size":{"description":"大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"used_size":{"description":"使用大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"uuid":{"description":"GUID,可从源端查询","example":"\\\\?\\Volume{f03444e4-7874-11e5-80b3-806e6f6e6963}\\","maxLength":255,"minLength":0,"type":"string"}}},"PostTask":{"description":"创建任务的参数","properties":{"auto_start":{"description":"是否自动启动","type":"boolean"},"clonevm_template_id":{"description":"克隆服务器模板ID","maxLength":100,"minLength":0,"type":"string"},"exist_server":{"description":"是否存在服务,如果存在,则创建任务","type":"boolean"},"is_need_consistency_check":{"description":"是否进行一致性校验","type":"boolean"},"migration_ip":{"description":"迁移IP,如果是自动创建虚拟机,不需要此参数。\nuse_ipv6是false时,migration_ip应满足ipv4的格式标准;use_ipv6是true时,migration_ip应满足ipv6的格式标准。","maxLength":255,"minLength":0,"type":"string"},"name":{"description":"任务名称,只能由中文字符、英文字母、数字、下划线、短横线组成","maxLength":64,"minLength":1,"pattern":"^[A-Za-z0-9_\\-\\u4e00-\\u9fa5]{1,64}$","type":"string"},"need_migration_test":{"description":"是否开启迁移演练","type":"boolean"},"os_type":{"description":"操作系统类型\nWINDOWS:Windows系统类型\nLINUX:Linux系统类型","enum":["WINDOWS","LINUX"],"type":"string"},"over_speed_threshold":{"default":10,"description":"停止迁移的超速阈值。 是一个迁移速率的保护机制,超出该阈值会停止任务。它主要用于控制迁移过程中资源(特别是网络带宽)的消耗,确保系统的整体性能不受单一迁移任务影响 单位是百分比","example":50.0,"format":"double","maximum":100,"minimum":10,"type":"number"},"priority":{"description":"优先级。默认为1","format":"int32","maximum":65535,"minimum":0,"type":"integer"},"project_id":{"description":"项目ID","maxLength":255,"minLength":0,"type":"string"},"project_name":{"description":"项目名称","maxLength":255,"minLength":0,"type":"string"},"region_id":{"description":"region ID","maxLength":255,"minLength":0,"type":"string"},"region_name":{"description":"region的名称","maxLength":255,"minLength":0,"type":"string"},"source_server":{"$ref":"#/definitions/SourceServerByTask","description":"源端主机应存在,且处于连接状态,且没有创建迁移任务"},"speed_limit":{"default":0,"description":"迁移速率限制值","example":100,"format":"int32","maximum":1000,"minimum":0,"type":"integer"},"start_network_check":{"description":"是否开启网络检测","type":"boolean"},"start_target_server":{"default":true,"description":"迁移后是否启动目的端虚拟机","type":"boolean"},"syncing":{"default":false,"description":"复制或者同步后是否会继续持续同步,不添加则默认是false","type":"boolean"},"target_server":{"$ref":"#/definitions/TargetServerByTask"},"type":{"description":"任务类型\nMIGRATE_FILE:文件级迁移\nMIGRATE_BLOCK:块级迁移","enum":["MIGRATE_FILE","MIGRATE_BLOCK"],"type":"string"},"use_ipv6":{"default":false,"description":"是否使用ipv6","type":"boolean"},"use_public_ip":{"default":true,"description":"是否使用公网ip","type":"boolean"},"vm_template_id":{"description":"自动创建虚拟机使用模板","maxLength":100,"minLength":0,"type":"string"}},"required":["name","type","source_server","target_server","region_name","region_id","project_name","project_id"],"type":"object"},"SourceServerByTask":{"description":"源端服务器信息","properties":{"id":{"description":"源端服务器ID","example":"dcdbe339-b02d-4578-95a1-9c9c547dxxxx","maxLength":255,"minLength":0,"type":"string"}},"required":["id"]},"TargetDisks":{"description":"目的端磁盘信息","properties":{"device_use":{"default":"NORMAL","description":"磁盘类型,仅起提示作用,不作校验\nBOOT:BOOT所在磁盘\nOS:OS所在磁盘\nNORMAL:普通磁盘","enum":["NORMAL","OS","BOOT"],"example":"OS","type":"string"},"disk_id":{"description":"磁盘ID,自动创建虚拟机不用设置","maxLength":255,"minLength":0,"type":"string"},"name":{"description":"名称,根据磁盘顺序设置为disk X","example":"Disk 0","maxLength":255,"minLength":0,"type":"string"},"physical_volumes":{"description":"物理卷信息","items":{"$ref":"#/definitions/PhysicalVolumes"},"maxItems":50,"minItems":0,"type":"array"},"size":{"description":"大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"used_size":{"description":"使用大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"}},"type":"object"},"TargetServerByTask":{"description":"目的端虚拟机信息","properties":{"btrfs_list":{"description":"btrfs信息,数据从源端获取","items":{"$ref":"#/definitions/BtrfsFileSystem"},"maxItems":65535,"minItems":0,"type":"array"},"disks":{"description":"磁盘信息","example":"[{\"name\":\"Disk 0\",\"size\":42949672960,\"used_size\":42947575808,\"device_use\":\"OS\",\"physical_volumes\":[{\"uuid\":\"\\\\\\\\?\\\\Volume{f03444e4-7874-11e5-80b3-806e6f6exxxx}\\\\\",\"index\":1,\"name\":\"(Reserved)\",\"device_use\":\"BOOT\",\"file_system\":\"NTFS\",\"size\":367001600,\"used_size\":31244288},{\"uuid\":\"\\\\\\\\?\\\\Volume{f03444e5-7874-11e5-80b3-806e6f6exxxx}\\\\\",\"index\":2,\"name\":\"C:\\\\\",\"device_use\":\"OS\",\"file_system\":\"NTFS\",\"size\":42580574208,\"used_size\":14003720192}],\"disk_id\":\"\"}]","items":{"$ref":"#/definitions/TargetDisks"},"maxItems":50,"minItems":0,"type":"array"},"name":{"description":"名称","maxLength":255,"minLength":0,"type":"string"},"vm_id":{"description":"虚拟机ID","maxLength":255,"minLength":0,"type":"string"},"volume_groups":{"description":"卷组,数据从源端获取","items":{"$ref":"#/definitions/VolumeGroups"},"maxItems":50,"minItems":0,"type":"array"}},"required":["name","vm_id"],"type":"object"},"VolumeGroups":{"description":"逻辑卷组信息","properties":{"components":{"description":"Pv信息","example":"/dev/vdd","maxLength":255,"minLength":0,"type":"string"},"free_size":{"description":"剩余空间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"logical_volumes":{"description":"lv信息","example":"[{\"name\":\"/dev/mapper/l1170-lvg\",\"size\":104857600,\"used_size\":1587200,\"file_system\":\"ext4\",\"mount_point\":\"/mnt/data1\",\"inode_size\":128,\"block_size\":0,\"block_count\":0}]","items":{"$ref":"#/definitions/LogicalVolumes"},"maxItems":50,"minItems":0,"type":"array"},"name":{"description":"名称","example":"l1170","maxLength":255,"minLength":0,"type":"string"},"size":{"description":"大小","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"}},"type":"object"}},"description":null,"group_id":"b335e41b37154b9c865b003f5fa2e3dd","host":"sms.cn-north-4.myhuaweicloud.com","id":"e9aa51f50b144f36a26c91633e36511d","info_version":"v3","method":"post","name":"CreateTask","parameters":{},"paths":{"/v3/tasks":{"post":{"consumes":["application/json"],"deprecated":false,"description":"根据源端服务器创建一个迁移任务。","operationId":"CreateTask","parameters":[{"description":"用户Token。  \n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","maxLength":16384,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-annotations":"","x-order":1},{"description":"迁移任务信息请求体","in":"body","name":"CreateTaskRequestBody","required":true,"schema":{"$ref":"#/definitions/PostTask"},"x-annotations":"","x-order":2}],"produces":["application/json"],"responses":{"200":{"description":"创建迁移任务成功","examples":{"application/json":{"id":"xxxxxxxxxxxxxxxxxxxxxxxx00000001"}},"schema":{"$ref":"#/definitions/CreateTaskResp"}},"403":{"description":"鉴权失败","examples":{"application/json":{"details":[{"error_code":"SMS.9004","error_msg":"You do not have permission to perform action XXX on resource XXX."}],"encoded_authorization_message":"XXXXXX","error_code":"SMS.9004","error_msg":"The current account does not have the permission to execute policy. You do not have permission to perform action XXX on resource XXX.","error_param":["You do not have permission to perform action XXX on resource XXX."]}},"schema":{"$ref":"#/definitions/Forbiddenstatus"}}},"summary":"创建迁移任务","tags":["任务管理"],"x-api-type":"TenantOpenAPI","x-apiErrorCodes":[{"errorCode":"SMS.6011","errorDescription":"请求体json不符合规范","errorDescriptionEn":"The request body json does not meet the specifications","errorMessage":"The request body json does not meet the specifications","httpStatus":"400","solution":"请按要求设置请求体","solutionEn":"Please set request body as required"},{"errorCode":"SMS.6012","errorDescription":"请求体为空","errorDescriptionEn":"empty request body.","errorMessage":"empty request body.","httpStatus":"400","solution":"请按要求设置请求体","solutionEn":""},{"errorCode":"SMS.6030","errorDescription":"源端id参数非法","errorDescriptionEn":"Illegal source id.","errorMessage":"Illegal source id.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"SMS.6031","errorDescription":"缺少目的端虚拟机参数","errorDescriptionEn":"target_server info in the task body is missing!","errorMessage":"target_server info in the task body is missing!","httpStatus":"400","solution":"请添加目的端虚拟机参数","solutionEn":""},{"errorCode":"SMS.6032","errorDescription":"目的端虚拟机参数缺少vm_id","errorDescriptionEn":"vm_id in target_server info is missing!","errorMessage":"vm_id in target_server info is missing!","httpStatus":"400","solution":"请添加目的端虚拟机vm_id","solutionEn":""},{"errorCode":"SMS.6033","errorDescription":"目的端虚拟机参数缺少磁盘信息","errorDescriptionEn":"disks info in target_server is missing!","errorMessage":"disks info in target_server is missing!","httpStatus":"400","solution":"请添加目的端磁盘信息","solutionEn":""},{"errorCode":"SMS.6539","errorDescription":"目的端磁盘空间小于所有分区大小之和","errorDescriptionEn":"The disk space is less than the total size of all partitions.","errorMessage":"目的端磁盘空间小于所有分区大小之和","httpStatus":"400","solution":"目的端磁盘空间大于所有分区大小之和","solutionEn":""},{"errorCode":"SMS.6601","errorDescription":"操作系统类型无效。","errorDescriptionEn":"Invalid OS type.","errorMessage":"Invalid OS type.","httpStatus":"400","solution":"请根据api文档设置os_type参数","solutionEn":""},{"errorCode":"SMS.6610","errorDescription":"任务类型和源端系统类型不匹配","errorDescriptionEn":"Mismatched task type and source server OS type.","errorMessage":"Mismatched task type and source server OS type.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"SMS.6611","errorDescription":"分区空间小于所需空间","errorDescriptionEn":"The space of the partition is less than the required size.","errorMessage":"The space of the partition is less than the required size.","httpStatus":"400","solution":"请增大分区空间","solutionEn":""},{"errorCode":"SMS.6612","errorDescription":"分区大小参数非法,必须是MB的整数倍","errorDescriptionEn":"The size of partition is not a multiple of MB.","errorMessage":"The size of partition is not a multiple of MB.","httpStatus":"400","solution":"请输入正确的分区信息","solutionEn":""},{"errorCode":"SMS.6613","errorDescription":"GPT格式磁盘需要预留33MB空间","errorDescriptionEn":"The target disk is a GPT disk. The reversed space must be a multiple of MB.","errorMessage":"The target disk is a GPT disk. The reversed space must be a multiple of MB.","httpStatus":"400","solution":"GPT格式磁盘需要预留33MB空间","solutionEn":""},{"errorCode":"SMS.6614","errorDescription":"目标磁盘空间需大于所有分区空间总和","errorDescriptionEn":"Target disk size should be bigger than the sum of the partitions.","errorMessage":"Target disk size should be bigger than the sum of the partitions.","httpStatus":"400","solution":"请增大目标磁盘空间","solutionEn":""},{"errorCode":"SMS.7602","errorDescription":"指定源端不存在","errorDescriptionEn":"SourceServer does not exist.","errorMessage":"SourceServer does not exist.","httpStatus":"400","solution":"请检查源端是否存在","solutionEn":""},{"errorCode":"SMS.7705","errorDescription":"请求体json不符合规范","errorDescriptionEn":"The request body json does not meet the specifications","errorMessage":"The request body json does not meet the specifications","httpStatus":"400","solution":"请按要求设置请求体","solutionEn":"Please set request body as required"},{"errorCode":"SMS.7705","errorDescription":"请求体不是json格式","errorDescriptionEn":"The request body is not in the JSON format.","errorMessage":"The request body is not in the JSON format.","httpStatus":"400","solution":"请按要求设置请求体","solutionEn":""},{"errorCode":"SMS.7711","errorDescription":"任务名称参数非法","errorDescriptionEn":"Illegal task name.","errorMessage":"Illegal task name.","httpStatus":"400","solution":"请输入合法的任务名称","solutionEn":""},{"errorCode":"SMS.7712","errorDescription":"任务类型参数非法","errorDescriptionEn":"Illegal task type.","errorMessage":"Illegal task type.","httpStatus":"400","solution":"请输入合法的任务类型","solutionEn":""}],"x-apiexplorer-hide":"false","x-apigateway-auth-type":"IAM","x-apigateway-match-mode":"NORMAL","x-apigateway-request-type":"public","x-constraint":"","x-is-registered":"Y","x-name":"创建迁移任务","x-open-region-cloud":"hc,hk","x-order":11,"x-publishpath":"CreateTask","x-request-examples-1":{"is_need_consistency_check":true,"migration_ip":"192.168.0.1","name":"MigrationTask","os_type":"LINUX","project_id":"xxxxxxxxxxxxxxxxxxxxxxxx00000001","project_name":"project_name","region_id":"region_id","region_name":"region_name","source_server":{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001"},"start_target_server":true,"target_server":{"disks":[{"device_use":"BOOT","disk_id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","name":"/dev/vda","physical_volumes":[{"device_use":"OS","file_system":"ext4","index":0,"mount_point":"/","name":"/dev/vda1","size":42947575808,"used_size":5346484224,"uuid":null}],"size":42949672960,"used_size":429496}],"name":"Auto-tar-name","vm_id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","volume_groups":[]},"type":"MIGRATE_FILE","use_public_ip":true},"x-request-examples-description-1":"创建一个迁移任务,迁移任务名称是MigrationTask,迁移类型是MIGRATE_FILE文件级迁移,源端操作系统类型是LINUX,使用公网迁移是true,迁移region名称是region_name,迁移region的ID是region_id。","x-request-examples-text-1":{"is_need_consistency_check":true,"migration_ip":"192.168.0.1","name":"MigrationTask","os_type":"LINUX","project_id":"xxxxxxxxxxxxxxxxxxxxxxxx00000001","project_name":"project_name","region_id":"region_id","region_name":"region_name","source_server":{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001"},"start_target_server":true,"target_server":{"disks":[{"device_use":"BOOT","disk_id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","name":"/dev/vda","physical_volumes":[{"device_use":"OS","file_system":"ext4","index":0,"mount_point":"/","name":"/dev/vda1","size":42947575808,"used_size":5346484224,"uuid":null}],"size":42949672960,"used_size":429496}],"name":"Auto-tar-name","vm_id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","volume_groups":[]},"type":"MIGRATE_FILE","use_public_ip":true},"x-request-examples-url-1":"POST https://{endpoint}/v3/tasks","x-scope":"Commercial","x-support-sdk":"Y","x-version":"v3"}}},"product_short":"SMS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建迁移任务","tags":"任务管理","uri":null,"version":"2.0"}