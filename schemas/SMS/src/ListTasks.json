{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"CloneServerBrief":{"description":"克隆服务器基本信息","properties":{"name":{"description":"克隆虚拟机的名称","maxLength":255,"minLength":0,"type":"string"},"vm_id":{"description":"克隆服务器ID","maxLength":255,"minLength":0,"type":"string"}}},"ConfigBody":{"description":"配置参数body","properties":{"config_key":{"description":"配置类型\nMIGRATE_EXCLUDE_DIR: 迁移时设定的不迁移目录\nSYNC_EXCLUDE_DIR: 同步时设定的不同步目录\nONLY_SYNC_DIR: 同步时设定的同步目录\nCONSISTENCY_DIR: 一致性校验的目录\nCONSISTENCY_DIR_ILLEGAL: 一致性校验后非法目录\nLINUX_BLOCK_COMPRESS_THREAD_NUM: linux块迁移压缩线程个数\nMIGRATE_DST_IP: 迁移目的ip\nLINUX_BLOCK_CACHE_SIZE: linux块迁移缓存大小\nLINUX_CPU_LIMIT: linux的cpu限制\nLINUX_MEM_LIMIT: linux的内存限制\nLINUX_IO_LIMIT: linux的IO限制\nNUM_PROCESS_MIGRATE: 迁移进程数\nNUM_PROCESS_SYNC: 同步进程数\nCONSISTENCY_RECHECK: 一致性校验再检\nCONSISTENCY_MODE: 一致性校验模式\nDYNAMIC_PORT: 动态端口","enum":["MIGRATE_EXCLUDE_DIR","SYNC_EXCLUDE_DIR","ONLY_SYNC_DIR","CONSISTENCY_DIR","CONSISTENCY_DIR_ILLEGAL","LINUX_BLOCK_COMPRESS_THREAD_NUM","MIGRATE_DST_IP","LINUX_BLOCK_CACHE_SIZE","LINUX_CPU_LIMIT","LINUX_MEM_LIMIT","LINUX_IO_LIMIT","NUM_PROCESS_MIGRATE","NUM_PROCESS_SYNC","CONSISTENCY_RECHECK","CONSISTENCY_MODE","DYNAMIC_PORT"],"type":"string"},"config_status":{"description":"描述配置状态的保留字段","maxLength":255,"minLength":0,"type":"string"},"config_value":{"description":"具体配置参数字段,保存于数据库,最终在agent端进行解析","maxLength":1024,"minLength":0,"type":"string"}},"required":["config_key","config_value"],"type":"object"},"Forbiddenstatus":{"description":"接口请求鉴权失败时返回的response body格式","properties":{"details":{"description":"详细错误信息","items":{"properties":{"error_code":{"description":"SMS错误代码","example":"SMS.9004","maxLength":65535,"minLength":0,"type":"string"},"error_msg":{"description":"SMS错误信息","example":"You do not have permission to perform action XXX on resource XXX.","maxLength":65535,"minLength":0,"type":"string"}}},"maxItems":20,"minItems":1,"type":"array"},"encoded_authorization_message":{"description":"加密授权信息","example":"XXXXXX","maxLength":65535,"minLength":0,"type":"string"},"error_code":{"description":"错误代码","example":"SMS.9004","maxLength":255,"minLength":0,"type":"string"},"error_msg":{"description":"错误信息","example":"The current account does not have the permission to execute policy. You do not have permission to perform action XXX on resource XXX.","maxLength":255,"minLength":0,"type":"string"},"error_param":{"description":"错误参数","example":["You do not have permission to perform action XXX on resource XXX."],"items":{"example":"XXXXXX","maxLength":65535,"minLength":0,"type":"string"},"maxItems":20,"minItems":1,"type":"array"}},"type":"object"},"NetworkCheckInfoRequestBody":{"properties":{"cpu_usage":{"description":"CPU占用率(%)","example":30.0,"format":"double","maximum":100,"minimum":0,"type":"number"},"destination_connectivity":{"description":"目的端连通性","type":"boolean"},"domain_connectivity":{"description":"域名连通性","type":"boolean"},"evaluation_result":{"description":"评估结果","example":"1:1:1","maxLength":9,"minLength":5,"type":"string"},"loss_percentage":{"description":"丢包率(%)","example":0.0,"format":"double","maximum":100,"minimum":0,"type":"number"},"mem_usage":{"description":"内存占用率(%)","example":20.0,"format":"double","maximum":100,"minimum":0,"type":"number"},"migration_speed":{"description":"带宽速率(Mbit/s)","example":500.0,"format":"double","maximum":10000,"minimum":0,"type":"number"},"network_delay":{"description":"网络时延(ms)","example":20.0,"format":"double","maximum":10000.0,"minimum":0,"type":"number"},"network_jitter":{"description":"网络抖动(ms)","example":10.0,"format":"double","maximum":10000,"minimum":0,"type":"number"}},"required":["network_delay","network_jitter","migration_speed","loss_percentage","cpu_usage","mem_usage","evaluation_result"],"type":"object"},"SourceServerAssociatedWithTask":{"description":"任务关联的源端信息","properties":{"id":{"description":"源端在SMS数据库中的ID","maxLength":255,"minLength":0,"type":"string"},"ip":{"description":"源端服务器ip,注册源端时必选,更新非必选","maxLength":255,"minLength":0,"type":"string"},"name":{"description":"用来区分不同源端服务器的名称","maxLength":255,"minLength":0,"type":"string"},"oem_system":{"description":"是否是OEM操作系统(Windows)","type":"boolean"},"os_type":{"description":"源端服务器的OS类型,分为Windows和Linux,注册必选,更新非必选","enum":["WINDOWS","LINUX"],"maxLength":255,"minLength":0,"type":"string"},"os_version":{"description":"操作系统版本,注册必选,更新非必选","maxLength":255,"minLength":0,"type":"string"},"state":{"description":"当前源端服务器状态\nunavailable:环境校验不通过\nwaiting:等待\ninitialize:初始化\nreplicate:复制\nsyncing:持续同步\nstopping:暂停中\nstopped:已暂停\nskipping:跳过中\ndeleting:删除中\nclearing: 清理快照资源中\ncleared:清理快照资源完成\nclearfailed:清理快照资源失败\npremigready:迁移演练就绪\npremiged:迁移演练完成\npremigfailed:迁移演练失败\ncloning:等待克隆完成\ncutovering:启动目的端中\nfinished:启动目的端完成\nerror:错误","enum":["unavailable","waiting","initialize","replicate","syncing","stopping","stopped","skipping","deleting","clearing","cleared","clearfailed","premigready","premiged","premigfailed","cloning","cutovering","finished","error"],"type":"string"}},"required":["name","ip","os_type","agent_version"]},"SubTaskAssociatedWithTask":{"description":"任务关联的子任务信息","properties":{"end_date":{"description":"子任务结束时间(如果子任务还没有结束,则为空)","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"id":{"description":"子任务ID","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"name":{"description":"子任务名称","maxLength":255,"minLength":0,"type":"string"},"process_trace":{"description":"迁移或同步时,具体的迁移详情","maxLength":2048,"minLength":0,"type":"string"},"progress":{"description":"子任务的进度,取值为0-100之间的整数","format":"int32","maximum":100,"minimum":0,"type":"integer"},"start_date":{"description":"子任务开始时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"}}},"TargetServerAssociatedWithTask":{"description":"任务关联的目的端信息","properties":{"id":{"description":"目的端在SMS数据库中的ID","maxLength":255,"minLength":0,"type":"string"},"ip":{"description":"目的端服务器IP","maxLength":255,"minLength":0,"type":"string"},"name":{"description":"目的端服务器名称","maxLength":255,"minLength":0,"type":"string"},"os_type":{"description":"目的端服务器的OS类型\nWINDOWS:WINDOWS系统\nLINUX:LINUX系统\n","enum":["WINDOWS","LINUX"],"maxLength":255,"minLength":0,"type":"string"},"os_version":{"description":"操作系统版本","maxLength":255,"minLength":0,"type":"string"},"vm_id":{"description":"目的端虚机ID","maxLength":255,"minLength":0,"type":"string"}}},"TasksResponse":{"description":"批量查询任务","properties":{"count":{"description":"符合要求的任务数量,不受分页影响","format":"int32","maximum":2147483647,"minimum":0,"type":"integer"},"tasks":{"description":"查询到的任务列表","items":{"$ref":"#/definitions/TasksResponseBody"},"maxItems":65535,"minItems":0,"type":"array"}},"type":"object"},"TasksResponseBody":{"description":"批量查询任务时返回体重返回的任务信息。","properties":{"agent_cpu_usage":{"description":"Agent的CPU使用率,单位是百分比","example":10.0,"format":"double","maximum":100,"minimum":0,"type":"number"},"agent_disk_io":{"description":"Agent的磁盘I/O值,单位是Mbit/s","example":100.0,"format":"double","maximum":10000.0,"minimum":0,"type":"number"},"agent_mem_usage":{"description":"Agent的内存使用值,单位是MB","example":100.0,"format":"double","maximum":1048576.0,"minimum":0,"type":"number"},"clone_server":{"$ref":"#/definitions/CloneServerBrief"},"compress_rate":{"description":"压缩率","format":"double","maximum":10000,"minimum":0,"type":"number"},"create_date":{"description":"任务创建时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"enterprise_project_id":{"description":"迁移项目ID","maxLength":255,"minLength":0,"type":"string"},"error_json":{"description":"错误信息","maxLength":1024,"minLength":0,"type":"string"},"estimate_complete_time":{"description":"预估完成时间","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"id":{"description":"迁移任务ID","maxLength":255,"minLength":0,"type":"string"},"log_collect_status":{"description":"日志收集状态\nINIT:就绪\nUPLOADING:上传中\nUPLOAD_FAIL:上传失败\nUPLOADED:已上传","enum":["INIT","UPLOADING","UPLOAD_FAIL","UPLOADED"],"type":"string"},"migrate_speed":{"description":"迁移速率,单位:Mbit/s","format":"double","maximum":10000,"minimum":0,"type":"number"},"migration_ip":{"description":"目的端服务器的IP地址。\n公网迁移时请填写弹性IP地址\n专线迁移时请填写私有IP地址","maxLength":255,"minLength":0,"type":"string"},"name":{"description":"任务名称(用户自定义)","maxLength":255,"minLength":0,"type":"string"},"need_migration_test":{"description":"是否开启迁移演练","type":"boolean"},"network_check_info":{"$ref":"#/definitions/NetworkCheckInfoRequestBody","description":"网络检测相关信息"},"os_type":{"description":"操作系统类型,分为WINDOWS和LINUX,创建时必选,更新时可选","enum":["WINDOWS","LINUX"],"maxLength":255,"minLength":0,"type":"string"},"priority":{"description":"进程优先级\n0:低\n1:标准\n2:高","enum":[0,1,2],"format":"int32","maximum":2,"minimum":0,"type":"integer"},"source_server":{"$ref":"#/definitions/SourceServerAssociatedWithTask"},"special_config":{"description":"特殊配置项配置信息","items":{"$ref":"#/definitions/ConfigBody"},"maxItems":1000,"minItems":0,"type":"array"},"speed_limit":{"description":"迁移限速","format":"int32","maximum":65535,"minimum":0,"type":"integer"},"start_target_server":{"default":false,"description":"迁移完成后是否启动目的端服务器\ntrue:启动\nfalse:停止","type":"boolean"},"state":{"description":"迁移任务状态\nREADY: 准备就绪\nRUNNING: 迁移中\nSYNCING: 同步中\nMIGRATE_SUCCESS: 迁移成功\nSYNC_SUCCESS: 同步成功\nMIGRATE_FAIL: 失败\nSYNC_FAIL: 同步失败\nABORTING: 中止中\nABORT: 中止\nSKIPPING: 跳过中\nDELETING: 删除中\nRESETING: 回滚中","enum":["READY","RUNNING","SYNCING","MIGRATE_SUCCESS","SYNC_SUCCESS","MIGRATE_FAIL","SYNC_FAIL","ABORTING","ABORT","SKIPPING","DELETING","RESETING"],"type":"string"},"sub_tasks":{"description":"任务关联的子任务信息","items":{"$ref":"#/definitions/SubTaskAssociatedWithTask"},"maxItems":65535,"minItems":0,"type":"array"},"subtask_info":{"description":"当前子任务及进度","maxLength":255,"minLength":0,"type":"string"},"syncing":{"description":"是否同步","type":"boolean"},"target_server":{"$ref":"#/definitions/TargetServerAssociatedWithTask"},"total_cpu_usage":{"description":"主机的CPU使用率,单位是百分比","example":50.0,"format":"double","maximum":100,"minimum":0,"type":"number"},"total_disk_io":{"description":"主机的磁盘I/O值,单位是Mbit/s","example":1000.0,"format":"double","maximum":10000.0,"minimum":0,"type":"number"},"total_mem_usage":{"description":"主机的内存使用值,单位是MB","example":500.0,"format":"double","maximum":1048576.0,"minimum":0,"type":"number"},"total_time":{"description":"任务总耗时","format":"int64","maximum":9223372036854775807,"minimum":0,"type":"integer"},"type":{"description":"任务类型,创建时必选,更新时可选\nMIGRATE_FILE:文件级迁移\nMIGRATE_BLOCK:块级迁移","enum":["MIGRATE_FILE","MIGRATE_BLOCK"],"maxLength":255,"minLength":0,"type":"string"}},"type":"object"}},"description":null,"group_id":"b335e41b37154b9c865b003f5fa2e3dd","host":"sms.cn-north-4.myhuaweicloud.com","id":"1a8f4db6fb924f96a15b4d11696ca874","info_version":"v3","method":"get","name":"ListTasks","parameters":{},"paths":{"/v3/tasks":{"get":{"consumes":["application/json"],"deprecated":false,"description":"在设置目的端后,主机迁移服务会自动创建迁移任务,使用该接口可以查询迁移任务列表。","operationId":"ListTasks","parameters":[{"description":"用户Token。  \n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","maxLength":16384,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-annotations":"","x-order":1},{"description":"迁移任务状态\nREADY:准备就绪\nRUNNING:迁移中\nSYNCING:同步中\nMIGRATE_SUCCESS:迁移成功\nMIGRATE_FAIL:迁移失败\nABORTING:中止中\nABORT:中止\nDELETING::删除中\nSYNC_F_ROLLBACKING:同步失败回滚中\nSYNC_F_ROLLBACK_SUCCESS:同步失败回滚成功","enum":["READY","RUNNING","SYNCING","MIGRATE_SUCCESS","MIGRATE_FAIL","ABORTING","ABORT","DELETING","SYNC_F_ROLLBACKING","SYNC_F_ROLLBACK_SUCCESS"],"in":"query","name":"state","required":false,"type":"string","x-annotations":"","x-order":2},{"description":"任务的名称","in":"query","maxLength":255,"minLength":0,"name":"name","required":false,"type":"string","x-order":3},{"description":"任务的ID","in":"query","maxLength":36,"minLength":1,"name":"id","required":false,"type":"string","x-order":4},{"description":"源端服务器的ID","in":"query","maxLength":36,"minLength":1,"name":"source_server_id","required":false,"type":"string","x-order":5},{"default":100,"description":"每一页记录的任务数量","format":"int32","in":"query","maximum":200,"minimum":0,"name":"limit","required":false,"type":"integer","x-order":6},{"default":0,"description":"偏移量","format":"int32","in":"query","maximum":65535,"minimum":0,"name":"offset","required":false,"type":"integer","x-order":7},{"description":"需要查询的企业项目ID","in":"query","maxLength":255,"minLength":0,"name":"enterprise_project_id","required":false,"type":"string","x-order":8}],"produces":["application/json"],"responses":{"200":{"description":"查询迁移任务列表成功","examples":{"application/json":{"count":3,"tasks":[{"create_date":1585139506000,"error_json":"","estimate_complete_time":null,"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","log_collect_status":"INIT","migrate_speed":0.0,"migration_ip":"","name":"sms_task_lxxxx11","os_type":"LINUX","priority":1,"source_server":{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","ip":"192.168.*.107","name":"xxx-linux-1","oem_system":false,"os_type":"LINUX","os_version":"CENTOS_7_6_64BIT","state":"AVAILABLE"},"speed_limit":0,"start_target_server":true,"state":"MIGRATE_SUCCESS","target_server":{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","ip":null,"name":"","os_type":"LINUX","os_version":null,"vm_id":""},"total_time":3878000,"type":"MIGRATE_FILE"},{"create_date":1585138569000,"error_json":"","estimate_complete_time":null,"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","log_collect_status":"INIT","migrate_speed":0.0,"migration_ip":"","name":"sms_task_xxx22","os_type":"WINDOWS","priority":1,"source_server":{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","ip":"192.168.*.245","name":"xxx-windows-2","oem_system":false,"os_type":"WINDOWS","os_version":"WINDOWS2012_R2_64BIT","state":"AVAILABLE"},"speed_limit":0,"start_target_server":true,"state":"MIGRATE_SUCCESS","target_server":{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","ip":null,"name":"","os_type":"WINDOWS","os_version":"WINDOWS2012_R2_64BIT","vm_id":""},"total_time":10824000,"type":"MIGRATE_BLOCK"},{"create_date":1566130392000,"error_json":"","estimate_complete_time":null,"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","log_collect_status":"INIT","migrate_speed":0.0,"migration_ip":"192.168.1.201","name":"sms_task_leddesktop","os_type":"WINDOWS","priority":1,"source_server":null,"speed_limit":200,"start_target_server":true,"state":"MIGRATE_SUCCESS","target_server":{"id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001","ip":null,"name":"xxx-sms-target","os_type":"WINDOWS","os_version":"WINDOWS2008_R2_64BIT","vm_id":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx0001"},"total_time":882000,"type":"MIGRATE_BLOCK"}]}},"schema":{"$ref":"#/definitions/TasksResponse"}},"403":{"description":"鉴权失败","examples":{"application/json":{"details":[{"error_code":"SMS.9004","error_msg":"You do not have permission to perform action XXX on resource XXX."}],"encoded_authorization_message":"XXXXXX","error_code":"SMS.9004","error_msg":"The current account does not have the permission to execute policy. You do not have permission to perform action XXX on resource XXX.","error_param":["You do not have permission to perform action XXX on resource XXX."]}},"schema":{"$ref":"#/definitions/Forbiddenstatus"}}},"summary":"查询迁移任务列表","tags":["任务管理"],"x-api-type":"TenantOpenAPI","x-apiexplorer-hide":"false","x-apigateway-auth-type":"IAM","x-apigateway-match-mode":"NORMAL","x-apigateway-request-type":"public","x-constraint":"","x-is-registered":"Y","x-name":"查询迁移任务列表","x-open-region-cloud":"hc,hk","x-order":12,"x-publishpath":"ListTasks","x-request-examples-description-1":"查询迁移任务列表","x-request-examples-url-1":"GET  https://{endpoint}/v3/tasks","x-scope":"Commercial","x-support-sdk":"Y","x-version":"v3"}}},"product_short":"SMS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询迁移任务列表","tags":"任务管理","uri":null,"version":"2.0"}