{"base_path":"/","components":null,"consumes":"","definitions":{"CreateRetentionRequestBody":{"properties":{"algorithm":{"description":"回收规则匹配策略,固定为\"or\"","type":"string"},"rules":{"description":"镜像老化规则","items":{"$ref":"#/definitions/Rule"},"type":"array"}},"required":["algorithm","rules"]},"CreateRetentionResp":{"properties":{"id":{"description":"镜像老化规则id","format":"int32","type":"integer"}},"required":["id"]},"Rule":{"properties":{"params":{"description":"template是date_rule时,设置params为{\"days\": \"xxx\"}\ntemplate是tag_rule时,设置params为{\"num\": \"xxx\"}","type":"object"},"tag_selectors":{"description":"例外镜像","items":{"$ref":"#/definitions/TagSelector"},"type":"array"},"template":{"description":"回收类型,date_rule、tag_rule","enum":["date_rule","tag_rule"],"type":"string"}},"required":["params","tag_selectors","template"]},"TagSelector":{"properties":{"kind":{"description":"匹配规则,label、regexp","type":"string"},"pattern":{"description":"kind是label时,设置为镜像版本,kind是regexp时,设置为正则表达式","type":"string"}},"required":["kind","pattern"]}},"description":null,"group_id":"fb5102f8c9554d70b608ae6cc563f6ae","host":"swr-api.cn-north-4.myhuaweicloud.com","id":"7b92edacc1d5482bbc509686e133d502","info_version":"v2","method":"post","name":"CreateRetention","parameters":{},"paths":{"/v2/manage/namespaces/{namespace}/repos/{repository}/retentions":{"post":{"description":"创建镜像老化规则","operationId":"CreateRetention","parameters":[{"default":"application/json","description":"消息体的类型(格式),下方类型可任选其一使用:\napplication/json;charset=utf-8\napplication/json","enum":["application/json;charset=utf-8","application/json"],"in":"header","name":"Content-Type","required":true,"type":"string","x-example":"application/json","x-order":1},{"description":"用户Token。\n\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX...","x-order":2},{"description":"组织名称。小写字母开头,后面跟小写字母、数字、小数点、下划线或中划线(其中下划线最多允许连续两个,小数点、下划线、中划线不能直接相连),小写字母或数字结尾,1-64个字符。","in":"path","name":"namespace","required":true,"type":"string","x-example":"huawei","x-order":3},{"description":"镜像仓库名称","in":"path","name":"repository","required":true,"type":"string","x-example":"test_repo","x-order":4},{"description":"需要创建镜像老化规则的信息","in":"body","name":"CreateRetentionRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateRetentionRequestBody"}}],"produces":["application/json"],"responses":{"201":{"description":"创建成功","examples":{"application/json":{"id":34}},"schema":{"$ref":"#/definitions/CreateRetentionResp"}},"400":{"description":"错误的请求"},"401":{"description":"鉴权失败"},"404":{"description":"组织或镜像仓库不存在"},"500":{"description":"内部错误"}},"summary":"创建镜像老化规则","tags":["镜像老化规则管理"],"x-apiexplorer-hide":"false","x-constraint":"无","x-is-registered":"N","x-name":"创建镜像老化规则","x-open-region-cloud":"hc,hk","x-publishpath":"swr_02_0025","x-request-examples-1":{"algorithm":"or","rules":[{"params":{"days":"30"},"tag_selectors":[{"kind":"label","pattern":"v5"},{"kind":"label","pattern":"1.0.1"},{"kind":"regexp","pattern":"^123$"}],"template":"date_rule"}]},"x-request-examples-description-1":"","x-request-examples-text-1":"{ \"algorithm\": \"string\", \"rules\": [ { \"params\": {}, \"tag_selectors\": [ { \"kind\": \"string\", \"pattern\": \"string\" } ], \"template\": \"string\" } ]}","x-request-examples-url-1":"POST https://{endpoint}/v2/manage/namespaces/{namespace}/repos/{repository}/retentions","x-scope":"Commercial","x-support-sdk":"Y","x-version":"v1"}}},"product_short":"SWR","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建镜像老化规则","tags":"镜像老化规则管理","uri":null,"version":"2.0"}