{"base_path":"/","components":null,"consumes":"","definitions":{"CreateWebhookPolicyRequestBody":{"properties":{"description":{"description":"触发器描述","type":"string"},"enabled":{"description":"是否启用","type":"boolean"},"event_types":{"description":"触发器触发条件,当前支持PUSH_ARTIFACT","items":{"type":"string"},"type":"array"},"name":{"description":"触发器名称,由字母、汉字、数字、下划线(_)、中划线 (-)组成,1-256个字符。","type":"string"},"scope_rules":{"description":"作用范围规则","items":{"$ref":"#/definitions/ScopeRule"},"type":"array"},"targets":{"description":"触发器目标参数","items":{"$ref":"#/definitions/Target"},"type":"array"}},"required":["name","targets","scope_rules","enabled","event_types"],"type":"object"},"CreateWebhookPolicyResponseBody":{"properties":{"id":{"description":"触发器ID","type":"integer"}},"required":["id"]},"RuleSelector":{"properties":{"decoration":{"description":"选择器匹配类型,当前支持repoMatches","type":"string"},"extras":{"description":"预留字段","type":"string"},"kind":{"description":"匹配类型,目前只支持doublestar","type":"string"},"pattern":{"description":"选择器匹配样式,最大长度512。支持正则表达式,正则表达式规则可填写如 nginx-* ,{repo1,repo2} 等,其中:\n* : 匹配不包含 '/' 的任何字段。\n**:匹配包含 '/' 的任何字段。\n? :匹配任何单个非 '/' 的字符。\n{选项1,选项2,...}:同时匹配多个选项。","type":"string"}},"required":["kind","decoration","pattern"]},"ScopeRule":{"properties":{"repo_scope_mode":{"description":"repository选择方式。可选regular、selection,前端显示需要,api调用时可选regular","type":"string"},"scope_selectors":{"additionalProperties":{"items":{"$ref":"#/definitions/RuleSelector"},"type":"array"},"description":"制品仓库选择器,目前只支持repository且长度为1","type":"object"},"tag_selectors":{"description":"制品版本选择器,目前只支持长度为1","items":{"$ref":"#/definitions/RuleSelector"},"type":"array"}},"required":["tag_selectors","scope_selectors","repo_scope_mode"]},"Target":{"properties":{"address":{"description":"触发地址,不可修改","type":"string"},"address_type":{"description":"触发地址类型,可选internal(内网),internet(公网)。internal必须为内网ip形式。","type":"string"},"auth_header":{"description":"请求头,格式为key1:value1;key2:value2","type":"string"},"skip_cert_verify":{"description":"是否跳过证书认证","type":"boolean"},"type":{"description":"触发类型,可选http","type":"string"}},"required":["type","address","address_type"],"type":"object"}},"description":null,"group_id":"fb5102f8c9554d70b608ae6cc563f6ae","host":"swr-api.cn-north-4.myhuaweicloud.com","id":"06bb264aa38d429f8e0f2329dd3751b3","info_version":"v2","method":"post","name":"CreateInstanceWebhook","parameters":{},"paths":{"/v2/{project_id}/instances/{instance_id}/namespaces/{namespace_name}/webhook/policies":{"post":{"description":"创建触发器","operationId":"CreateInstanceWebhook","parameters":[{"description":"项目ID","in":"path","name":"project_id","required":true,"type":"string"},{"description":"用户Token。\n\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX...","x-order":1},{"description":"企业仓库实例ID","in":"path","name":"instance_id","required":true,"type":"string","x-example":"test_instance_id","x-order":2},{"description":"命名空间名称","in":"path","name":"namespace_name","required":true,"type":"string","x-example":"test_namespace_name","x-order":3},{"description":"创建触发器需要的信息","in":"body","name":"CreateWebhookPolicyRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateWebhookPolicyRequestBody"}}],"produces":["application/json"],"responses":{"201":{"description":"创建触发器成功","examples":{"application/json":{"id":34}},"schema":{"$ref":"#/definitions/CreateWebhookPolicyResponseBody"}},"400":{"$ref":"#/responses/400"},"401":{"$ref":"#/responses/401"},"403":{"$ref":"#/responses/403"},"404":{"$ref":"#/responses/404"},"500":{"$ref":"#/responses/500"}},"summary":"创建触发器","tags":["触发器管理(SWR企业版)"],"x-api-type":"open-api","x-apiexplorer-hide":"false","x-apigateway-backend":{"httpVpcEndpoints":{"description":"","host":"swr-ee-internal.{{region_id}}.myhuaweicloud.com","method":"ANY","name":"cer-instance-manage","path":"/v2/{project_id}/instances/{instance_id}/namespaces/{namespace_name}/webhook/policies","scheme":"https","timeout":30000},"type":"HTTP-VPC"},"x-apigateway-cors":false,"x-apigateway-match-mode":"NORMAL","x-apigateway-request-type":"public","x-constraint":"无","x-is-registered":"N","x-name":"创建触发器","x-open-region-cloud":"hc,hk","x-publishpath":"swr_03_0901","x-request-examples-1":{"description":"my describe","enabled":true,"event_types":["PUSH_ARTIFACT"],"name":"mywebhook","scope_rules":[{"repo_scope_mode":"selection","scope_selectors":{"repository":[{"decoration":"repoMatches","kind":"doublestar","pattern":"{myrepo}"}]},"tag_selectors":[{"decoration":"matches","kind":"doublestar","pattern":"**"}]}],"targets":[{"address":"https://100.0.0.1:80","address_type":"internal","auth_header":"param1:value1","skip_cert_verify":false,"type":"http"}]},"x-request-examples-text-1":{"description":"my describe","enabled":true,"event_types":["PUSH_ARTIFACT"],"name":"mywebhook","scope_rules":[{"repo_scope_mode":"selection","scope_selectors":{"repository":[{"decoration":"repoMatches","kind":"doublestar","pattern":"{myrepo}"}]},"tag_selectors":[{"decoration":"matches","kind":"doublestar","pattern":"**"}]}],"targets":[{"address":"https://100.0.0.1:80","address_type":"internal","auth_header":"param1:value1","skip_cert_verify":false,"type":"http"}]},"x-request-examples-url-1":"POST https://{endpoint}/v2/{project_id}/instances/{instance_id}/webhook/policies","x-scope":"Commercial","x-support-sdk":"Y","x-version":"v1"}}},"product_short":"SWR","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建触发器","tags":"触发器管理(SWR企业版)","uri":null,"version":"2.0"}