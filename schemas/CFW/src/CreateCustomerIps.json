{"base_path":null,"components":null,"consumes":"","definitions":{"CreateCustomerIpsResp":{"properties":{"data":{"description":"**参数解释**:\n新增自定义IPS规则响应数据\n**约束限制**:\n  不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","properties":{"id":{"description":"**参数解释**:\n防火墙ID,用户创建防火墙实例后产生的唯一ID,配置后可区分不同防火墙,可通过[防火墙ID获取方式](cfw_02_0028.xml)获取\n**约束限制**:\n  不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n不涉及","readOnly":true,"type":"string"}},"type":"object"}},"title":"InsertCustomerIpsResp","type":"object"},"CustomerIpsSaveDto":{"properties":{"action_type":{"description":"**参数解释**:\n自定义IPS规则执行动作,仅更新自定义IPS规则场景下需要设置,其他场景无需设置\n**约束限制**:\n  不涉及\n**取值范围**:\n0:只记录日志\n1:重置/拦截\n**默认取值**:\n  不涉及","enum":[0,1],"format":"int32","type":"integer"},"affected_os":{"description":"**参数解释**:\n影响操作系统\n**约束限制**:\n  不涉及\n**取值范围**:\n  0:ANY\n  1:Windows\n  2:Linux\n  3:FreeBSD\n  4:Solaris\n  5:Other Unix\n  6:网络设备\n  7:Mac OS\n  8:IOS\n  9:Android\n  10:Others \n**默认取值**:\n  不涉及","enum":[0,1,2,3,4,5,6,7,8,9,10],"format":"int32","type":"integer"},"attack_type":{"description":"**参数解释**:\n攻击类型\n**约束限制**:\n不涉及\n**取值范围**:\n1:访问控制\n2:漏洞扫描\n3:邮件攻击\n4:漏洞攻击\n5:Web攻击\n6:密码攻击\n7:劫持攻击\n8:协议异常\n9:特洛伊木马\n10:蠕虫\n11:缓冲区溢出\n12:黑客工具\n13:间谍软件\n14:DDos泛洪\n15:应用层DDos攻击\n16:其他可疑行为\n17:可疑DNS活动\n18:网络钓鱼\n19:垃圾邮件\n20:其他攻击\n**默认取值**:\n不涉及","format":"int32","maximum":20,"minimum":1,"type":"integer"},"contents":{"description":"**参数解释**:\n匹配IPS攻击的报文内容\n**约束限制**:\n  不涉及\n**取值范围**:\n不涉及\n **默认取值**:\n不涉及","items":{"$ref":"#/definitions/IpsContent"},"maxItems":2048,"minItems":0,"type":"array"},"direction":{"description":"**参数解释**:\n方向\n**约束限制**:\n  不涉及\n**取值范围**:\n-1:Any\n0:客户端到服务端\n1:服务端到客户端\n**默认取值**:\n  不涉及","format":"int32","maximum":1,"minimum":-1,"type":"integer"},"dst_port":{"$ref":"#/definitions/Port"},"fw_instance_id":{"description":"**参数解释**:\n防火墙ID,用户创建防火墙实例后产生的唯一ID,配置后可区分不同防火墙,可通过[防火墙ID获取方式](cfw_02_0028.xml)获取\n**约束限制**:\n不涉及\n**取值范围**:\n32位UUID\n**默认取值**:\n不涉及","pattern":"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}","type":"string"},"ips_name":{"description":"**参数解释**:\nips规则名称\n**约束限制**:\n  不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","maxLength":255,"minLength":0,"type":"string","x-annotations":["@Pattern(regexp = CommonConstant.EN_CH_NEW_REG)"]},"object_id":{"description":"**参数解释**:\n防护对象ID,字段废弃\n**约束限制**:\n不涉及\n**取值范围**:\n32位UUID\n**默认取值**:\n不涉及","pattern":"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$","type":"string"},"protocol":{"description":"**参数解释**:\n协议类型\n**约束限制**:\n  不涉及\n**取值范围**:\n  1:FTP\n  2:TELNET\n  3:SMTP\n  4:DNS_TCP\n  5:DNS_UDP\n  6:DHCP\n  7:TFTP\n  8:FINGER\n  9:HTTP\n  10:POP3\n  11:SUNRPC_TCP\n  12:SUNRPC_UDP\n  13:NNTP\n  14:MSRPC_TCP\n  15:MSRPC_UDP\n  16:NETBIOS_NAME_TCP\n  17:NETBIOS_NAME_UDP\n  18:NETBIOS_SMB\n  19:NETBIOS_DATAGRAM\n  20:IMAP4\n  21:SNMP\n  22:LDAP\n  23:MSSQL\n  24:ORACLE\n**默认取值**:\n  不涉及","format":"int32","maximum":24,"minimum":1,"type":"integer"},"severity":{"description":"**参数解释**:\n严重程度\n**约束限制**:\n不涉及\n**取值范围**:\n0:致命\n1:高危\n2:中危\n3:低危\n**默认取值**:\n不涉及","format":"int32","maximum":3,"minimum":0,"type":"integer"},"software":{"description":"**参数解释**:\n影响软件\n**约束限制**:\n  不涉及\n**取值范围**:\n0:ANY\n1:ADOBE\n2:APACHE\n3:APPLE\n4:CA\n5:CISCO\n6:GOOGLE_CHROME\n7:HP\n8:IBM\n9:IE\n10:IIS\n11:MC_AFEE\n12:MEDIA_PLAYER\n13:MICROSOFT_NET\n14:MICROSOFT_EDGE\n15:MICROSOFT_EXCHANGE\n16:MICROSOFT_OFFICE\n17:MICROSOFT_OUTLOOK\n18:MICROSOFT_SHARE_POINT\n19:MICROSOFT_WINDOWS\n20:MOZILLA\n21:MSSQL\n22:MYSQL\n23:NOVELL\n24:ORACLE\n25:SAMBA\n26:SAMSUNG\n27:SAP\n28:SCADA\n29:SQUID\n30:SUN\n31:SYMANTEC\n32:TREND_MICRO\n33:VMWARE\n34:WORD_PRESS\n35:Others\n**默认取值**:\n  不涉及","format":"int32","maximum":35,"minimum":0,"type":"integer"},"src_port":{"$ref":"#/definitions/Port"}},"required":["action_type","affected_os","attack_type","contents","direction","dst_port","fw_instance_id","ips_name","protocol","severity","software","src_port"],"title":"CustomerIpsSaveDto","type":"object","x-imports":["com.huaweicloud.cfw.cnfw.common.CommonConstant"]},"ErrorRsp":{"description":"**参数解释**:\n失败时返回的错误信息\n**取值范围**:\n不涉及","properties":{"error_code":{"description":"**参数解释**:\n错误码\n**取值范围**:\n不涉及","readOnly":true,"type":"string"},"error_msg":{"description":"**参数解释**:\n错误描述\n**取值范围**:\n不涉及","readOnly":true,"type":"string"}}},"IpsContent":{"description":"**参数解释**:\n自定义IPS规则内容\n**约束限制**:\n    不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","properties":{"content":{"description":"**参数解释**:\n内容\n**约束限制**:\n不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","maxLength":2048,"minLength":0,"type":"string","x-annotations":["@NotBlank","@Pattern(regexp = CommonConstant.IPS_CONTENT_REG)"]},"depth":{"description":"**参数解释**:\n匹配特征时,截止匹配的位置\n**约束限制**:\n不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","format":"int32","maximum":65535,"minimum":1,"type":"integer"},"is_hex":{"description":"**参数解释**:\n报文内容是否为十六进制\n**约束限制**:\n不涉及\n**取值范围**:\ntrue: 是十六进制\nfalse: 不是十六进制\n**默认取值**:\n  不涉及","type":"boolean"},"is_ignore":{"description":"**参数解释**:\n是否忽略大小写\n**约束限制**:\n不涉及\n**取值范围**:\ntrue: 忽略\nfalse: 不忽略\n**默认取值**:\n  不涉及","type":"boolean"},"is_uri":{"description":"**参数解释**:\n是否匹配URL中跟“内容”一致的字段\n**约束限制**:\n不涉及\n**取值范围**:\ntrue: 匹配\nfalse: 不匹配\n**默认取值**:\n  不涉及","type":"boolean"},"offset":{"description":"**参数解释**:\n匹配特征时开始的位置\n**约束限制**:\n不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","format":"int32","maximum":65535,"minimum":0,"type":"integer"},"relative_position":{"description":"**参数解释**:\n匹配特征时,指定开始的位置\n**约束限制**:\n不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","format":"int32","maximum":1,"minimum":0,"type":"integer"}},"title":"IpsContent","type":"object","x-imports":["com.huaweicloud.cfw.cnfw.common.CommonConstant"]},"Port":{"description":"**参数解释**:\n端口信息\n**约束限制**:\n  不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","properties":{"port_type":{"description":"**参数解释**:\n端口操作类型\n**约束限制**:\n  不涉及\n**取值范围**:\n-1:Any\n0:包含\n1:排除\n**默认取值**:\n  不涉及","format":"int32","maximum":1,"minimum":-1,"type":"integer"},"ports":{"description":"**参数解释**:\n端口\n**约束限制**:\n  不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n  不涉及","maxLength":65535,"minLength":1,"type":"string"}},"title":"Port","type":"object"}},"description":null,"group_id":"908dce82fb734ea0801d7bf646ebe440","host":"cfw.cn-north-4.myhuaweicloud.com","id":"070b062964e343279367cfeb9cd158df","info_version":"v1","method":"post","name":"CreateCustomerIps","parameters":{},"paths":{"/v1/{project_id}/ips/custom-rule":{"post":{"consumes":["application/json"],"deprecated":false,"description":"创建自定义IPS规则","operationId":"CreateCustomerIps","parameters":[{"description":"**参数解释**:\n创建自定义IPS规则请求体\n**约束限制**:\n不涉及\n**取值范围**:\n不涉及\n**默认取值**:\n不涉及","in":"body","name":"CreateCustomerIpsRequestBody","required":true,"schema":{"$ref":"#/definitions/CustomerIpsSaveDto"}},{"description":"**参数解释**:\n项目ID,用于明确项目归属,配置后可通过该ID查询项目下资产,可以从调API处获取,也可以从控制台获取。[项目ID获取方式](cfw_02_0015.xml)\n**约束限制**:\n不涉及\n**取值范围**:\n32位UUID\n**默认取值**:\n不涉及","in":"path","maxLength":32,"minLength":0,"name":"project_id","required":true,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK","examples":{"application/json":{"data":{"id":"bc11e773-35cc-478c-a91c-772ed077e06e"}}},"schema":{"$ref":"#/definitions/CreateCustomerIpsResp"}},"400":{"description":"Bad Request","examples":{"application/json":{"error_code":"CFW.00200003","error_msg":"参数错误"}},"schema":{"$ref":"#/definitions/ErrorRsp"}}},"summary":"创建自定义IPS规则","tags":["IPS Rule Management"],"x-api-type":"open-api","x-is-registered":"Y","x-method-annotations":["@IamAuthMeta(rbac = {RoleConst.TE_ADMIN, RoleConst.OP_SERVICE, RoleConst.TE_ADMIN_RESTRICTED, RoleConst.TE_ADMIN_SUSPENDED}, needRbacCheck = false, needCbcCheck = false, authContextInitializerName =\"FirewallInitializer\")","@IamAuthAction(iam3Action = IamV3Action.SET_IPS_MODE, iam5Action = CommonConstant.IAM5_CREATE_CUSTOM_RULE)","@IamAuthMetaV5(needCbcCheck = false, needAbacResourceCheck = true, authContextInitializerName =\"FirewallInitializer\")","@IamAuthParam(instanceId = \"fw_instance_id\")"],"x-request-examples-description-1":"创建自定义IPS规则,项目ID为28f403ddd3f141daa6e046e85cb15519,防火墙ID为d06dad70-b3be-4480-86bc-b3d139e9938b,规则名称为IPS_test,攻击类型为访问控制,影响软件为ADOBE,操作系统为WINDOWS,方向为服务器到客户端,协议类型为HTTP,源类型为包括端口1,目的类型排除目的端口2,动作为观察,内容为content:\"test;\"distance:0;within:65535;nocase;","x-request-examples-text-1":{"action_type":0,"affected_os":5,"attack_type":1,"contents":[{"content":"12","depth":65535,"is_hex":true,"is_ignore":false,"is_uri":false,"offset":0,"relative_position":0}],"direction":1,"dst_port":{"port_type":0,"ports":"2"},"fw_instance_id":"d06dad70-b3be-4480-86bc-b3d139e9938b","ips_name":"IPS_test","protocol":9,"severity":1,"software":4,"src_port":{"port_type":1,"ports":"1"}},"x-request-examples-url-1":"https://{Endpoint}/v1/28f403ddd3f141daa6e046e85cb15519/ips/custom-rule","x-support-sdk":"Y"}}},"product_short":"CFW","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建自定义IPS规则","tags":"IPS管理","uri":null,"version":"2.0"}