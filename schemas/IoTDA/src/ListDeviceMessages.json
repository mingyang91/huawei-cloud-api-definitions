{"base_path":null,"components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"DeviceMessage":{"properties":{"created_time":{"description":"消息的创建时间,\"yyyyMMdd'T'HHmmss'Z'\"格式的UTC字符串。","example":"20151212T121212Z","type":"string"},"encoding":{"description":"消息内容编码格式,取值范围none|base64,默认值none, base64格式仅支持透传。","type":"string"},"error_info":{"$ref":"#/definitions/ErrorInfoDTO","description":"消息下发失败信息。"},"finished_time":{"description":"消息结束时间, \"yyyyMMdd'T'HHmmss'Z'\"格式的UTC字符串,包含消息转换到DELIVERED和TIMEOUT两个状态的时间。","example":"20151212T121212Z","type":"string"},"message":{"description":"消息内容。","example":"HelloWorld","properties":{},"type":"object"},"message_id":{"description":"设备消息ID,用于唯一标识一条消息,在下发设备消息时由物联网平台分配获得。","example":"b1224afb-e9f0-4916-8220-b6bab568e888","type":"string"},"name":{"description":"消息名称,在下发消息时由用户指定。","example":"message_name","type":"string"},"payload_format":{"description":"有效负载格式,在消息内容编码格式为none时有效,取值范围standard|raw,默认值standard(平台封装的标准格式),取值为raw时直接将消息内容作为有效负载下发。","type":"string"},"properties":{"$ref":"#/definitions/PropertiesDTO","description":"消息下行到设备的属性参数。"},"status":{"description":"消息状态,包含PENDING,DELIVERED,FAILED和TIMEOUT,PENDING指设备不在线,消息被缓存起来,等设备上线之后下发; DELIVERED指消息发送成功;FAILED消息发送失败;TIMEOUT指消息在平台默认时间内(1天)还没有下发送给设备,则平台会将消息设置为超时,状态为TIMEOUT。","example":"PENDING","type":"string"},"topic":{"description":"消息topic","type":"string"}},"title":"DeviceMessage 查询设备消息返回的具体消息结构体V5","type":"object"},"ErrorInfoDTO":{"description":"异常信息","properties":{"error_code":{"description":"**参数说明**:异常信息错误码,包含IOTDA.014016和IOTDA.014112。IOTDA.014016表示设备不在线;IOTDA.014112表示设备没有订阅topic。","example":"IOTDA.014112","type":"string"},"error_msg":{"description":"**参数说明**:异常信息说明,包含设备不在线和设备没有订阅topic说明。","example":"Send to device failed, device not subscribe topic.","type":"string"}},"title":"异常信息结构体","type":"object"},"PropertiesDTO":{"description":"属性数据","properties":{"correlation_data":{"description":"**参数说明**:MQTT 5.0版本请求和响应模式中的相关数据,可选。用户可以通过该参数配置MQTT协议请求和响应模式中的相关数据。\n**取值范围**:长度不超过128,只允许字母、数字、下划线(_)、连接符(-)的组合。","example":"d4922d8a-6c8e-4396-852c-164aefa6638q","pattern":"^[a-zA-Z0-9_-]{0,128}$","type":"string"},"response_topic":{"description":"**参数说明**:MQTT 5.0版本请求和响应模式中的响应主题,可选。用户可以通过该参数配置MQTT协议请求和响应模式中的响应主题。\n**取值范围**:长度不超过128, 只允许字母、数字、以及_-?=$#+/等字符的组合。","example":"/device/message/response","maxLength":128,"pattern":"^[a-zA-Z0-9_?=$#+/-]{0,128}$","type":"string"},"user_properties":{"description":"**参数说明**:用户自定义属性,可选。用户可以通过该参数配置用户自定义属性。可以配置的最大自定义属性数量为20。","items":{"$ref":"#/definitions/UserPropDTO"},"type":"array","x-maxLength":20,"x-minLength":0}},"title":"属性数据结构体","type":"object","x-imports":"java.util.List"},"QueryDeviceMessageResponse":{"properties":{"device_id":{"description":"设备ID,用于唯一标识一个设备,在注册设备时由物联网平台分配获得。","example":"d4922d8a-6c8e-4396-852c-164aefa6638f","type":"string"},"messages":{"description":"设备消息列表。","items":{"$ref":"#/definitions/DeviceMessage"},"type":"array"}},"title":"QueryDeviceMessageResponse 查询设备消息返回结构体V5","type":"object"},"UserPropDTO":{"description":"用户自定义属性","properties":{"prop_key":{"description":"**参数说明**:用户自定义属性键。\n**取值范围**:长度不超过128,只允许字母、数字、下划线(_)、连接符(-)的组合。","example":"propKey1","pattern":"^[a-zA-Z0-9_-]{0,128}$","type":"string"},"prop_value":{"description":"**参数说明**:用户自定义属性值。\n**取值范围**:长度不超过128,只允许中文、字母、数字、以及_? '#().,&%@!-等字符的组合。","example":"propValue1","pattern":"^[\\u4e00-\\u9fa5a-zA-Z0-9_?'#()\\.,&%@!-]{0,128}$","type":"string"}},"title":"用户自定义属性结构体","type":"object"}},"description":null,"group_id":"bf0cdd341d8b4c6f833486a40289d422","host":"iotda.cn-north-4.myhuaweicloud.com","id":"38941239e2cb44839f2f7dc76faf5292","info_version":"v5","method":"get","name":"ListDeviceMessages","parameters":{},"paths":{"/v5/iot/{project_id}/devices/{device_id}/messages":{"get":{"consumes":["application/json"],"description":"应用服务器可调用此接口查询平台下发给设备的消息,平台为每个设备默认最多保存20条消息,超过20条后, 后续的消息会替换下发最早的消息。","operationId":"ListDeviceMessages","parameters":[{"description":"**参数说明**:项目ID。获取方法请参见 [获取项目ID](https://support.huaweicloud.com/api-iothub/iot_06_v5_1001.html) 。","in":"path","name":"project_id","pattern":"^[a-fA-F0-9]{1,32}$","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"**参数说明**:下发消息的设备ID,用于唯一标识一个设备,在注册设备时由物联网平台分配获得。\n**取值范围**:长度不超过128,只允许字母、数字、下划线(_)、连接符(-)的组合。","in":"path","name":"device_id","pattern":"^[a-zA-Z0-9_-]{1,128}$","required":true,"type":"string"},{"description":"**参数说明**:用户Token。通过调用IAM服务 [获取IAM用户Token](https://support.huaweicloud.com/api-iam/iam_30_0001.html)接口获取,接口返回的响应消息头中“X-Subject-Token”就是需要获取的用户Token。简要的获取方法样例请参见 [Token认证](https://support.huaweicloud.com/api-iothub/iot_06_v5_0091.html#section0)。","in":"header","name":"X-Auth-Token","required":false,"type":"string","x-effective-scene":"huaweicloud","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX..."},{"description":"**参数说明**:实例ID。物理多租下各实例的唯一标识,建议携带该参数,在使用专业版时必须携带该参数。您可以在IoTDA管理控制台界面,选择左侧导航栏“总览”页签查看当前实例的ID,具体获取方式请参考[查看实例详情](https://support.huaweicloud.com/usermanual-iothub/iot_01_0121.html) 。","in":"header","name":"Instance-Id","pattern":"[0-9a-f-]{1,36}","required":false,"type":"string","x-example":"1a7ffc5c-d89c-44dd-8265-b1653d951ce0"}],"produces":["application/json"],"responses":{"200":{"description":"OK","examples":{"application/json":{"device_id":"d4922d8a-6c8e-4396-852c-164aefa6638f","messages":[{"created_time":"20151212T121212Z","finished_time":"20151212T121212Z","message":"string","message_id":"b1224afb-e9f0-4916-8220-b6bab568e888","name":"message_name","status":"PENDING","topic":"string"}]}},"schema":{"$ref":"#/definitions/QueryDeviceMessageResponse"},"x-SuccessCode":true},"403":{"description":"Forbidden","x-Error":["IOTDA.000021","IOTDA.001006","IOTDA.000022","IOTDA.014018"]},"404":{"description":"Not Found","x-Error":["IOTDA.014000"]},"500":{"description":"Internal Server Error","x-Error":["IOTDA.000001","IOTDA.000020"]}},"summary":"查询设备消息","tags":["MessageManagement"],"x-imports":"org.springframework.http.ResponseEntity;","x-is-registered":"Y","x-publishpath":"iot_06_v5_0058","x-request-examples-description-1":"列表查询所有消息。","x-request-examples-url-1":"GET https://{endpoint}/v5/iot/{project_id}/devices/{device_id}/messages","x-returnType":"ResponseEntity<QueryDeviceMessageResponse>","x-support-sdk":"Y"}}},"product_short":"IoTDA","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询设备消息","tags":"设备消息","uri":null,"version":"2.0"}