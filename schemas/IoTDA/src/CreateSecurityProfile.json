{"base_path":null,"components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"AddSecurityProfileDTO":{"description":"安全态势感知配置","properties":{"alarm_level":{"description":"安全态势感知告警级别,CRITICAL:严重告警,MAJOR:重要告警,MINOR:一般告警","pattern":"(CRITICAL|MAJOR|MINOR)","type":"string"},"enable":{"description":"安全态势感知项是否开启","type":"boolean"},"profile":{"description":"安全态势感知项配置结构体,用于设备侧检测项下发给设备","items":{"$ref":"#/definitions/SecurityProfile"},"type":"array"},"profile_targets":{"$ref":"#/definitions/SecurityTarget","description":"安全态势感知配置绑定对象结构体"},"security_level":{"description":"安全态势感知项所属安全风险级别;BASIC_SECURITY:基础安全,ADVANCE_SECURITY:高级安全,ULTIMATE_SECURITY:极致安全","pattern":"(BASIC_SECURITY|ADVANCE_SECURITY|ULTIMATE_SECURITY)","type":"string"},"security_type":{"description":"安全态势感知配置类型","pattern":"(DEVICE_MEMORY_CHECK|DEVICE_PORT_CHECK|DEVICE_CPU_USAGE_CHECK|DEVICE_DISK_SPACE_CHECK|DEVICE_BATTERY_PERCENTAGE_CHECK|DEVICE_LOGIN_LOCAL_CHECK|DEVICE_MALICIOUS_IP_CHECK|DEVICE_LOGIN_BRUTE_FORCE_CHECK|DEVICE_FILE_TAMPER_CHECK|INSECURE_TLS_PROTOCOL_CHECK|INSECURE_CIPHER_SUITE_CHECK|CONNECT_MULTIPLE_TIMES_CHECK|SECRET_COMPLEXITY_CHECK|TLS_CONNECT_CHECK|DEVICE_AUTH_FAIL_CHECK|DEVICE_OFFLINE_CHECK)","type":"string"}},"required":["security_type"],"title":"安全态势感知配置结构体","type":"object"},"SecurityProfile":{"properties":{"key":{"description":"安全态势感知项配置值名称","type":"string"},"value":{"description":"安全态势感知项配置值,数据格式参考创建安全态势感知接口说明","properties":{},"type":"object"}},"type":"object"},"SecurityProfileDTO":{"description":"安全态势感知配置","properties":{"alarm_level":{"description":"安全态势感知告警级别,CRITICAL:严重告警,MAJOR:重要告警,MINOR:一般告警","type":"string"},"enable":{"description":"安全态势感知项是否开启","type":"boolean"},"profile":{"description":"安全态势感知项配置结构体,用于设备侧检测项下发给设备","items":{"$ref":"#/definitions/SecurityProfile"},"type":"array"},"profile_id":{"description":"安全态势感知配置id","type":"string"},"profile_targets":{"$ref":"#/definitions/SecurityTarget","description":"安全态势感知配置绑定对象结构体"},"security_level":{"description":"安全态势感知项所属安全风险级别;BASIC_SECURITY:基础安全,ADVANCE_SECURITY:高级安全,ULTIMATE_SECURITY:极致安全","type":"string"},"security_type":{"description":"安全态势感知配置类型","type":"string"}},"title":"安全态势感知配置结构体","type":"object"},"SecurityTarget":{"properties":{"target_ids":{"description":"绑定对象id列表,target_type为PRODUCT时,由于产品ID在不同资源空间下可以重复,target_id格式为:资源空间ID:产品ID;资源空间ID与产品ID使用冒号拼接而成。","items":{"type":"string"},"type":"array","x-annotations":["@PatternInList(regexp = \"^[a-zA-Z0-9:_-]{1,128}$\")"],"x-maxLength":20,"x-minLength":1},"target_type":{"description":"安全态势感知配置绑定的对象,目前仅支持PRODUCT产品级别,仅对设备级别的安全态势感知项生效。","pattern":"(PRODUCT)","type":"string"}},"type":"object","x-imports":"javax.validation.constraints.Size;javax.validation.constraints.NotNull;javax.validation.constraints.Pattern;javax.validation.Valid;com.huawei.m2m.validator.PatternInList;"}},"description":null,"group_id":"bf0cdd341d8b4c6f833486a40289d422","host":"iotda.cn-north-4.myhuaweicloud.com","id":"de6c6d93bbea46c985d19be99f1338e1","info_version":"v5","method":"post","name":"CreateSecurityProfile","parameters":{},"paths":{"/v5/iot/{project_id}/security-profiles":{"post":{"consumes":["application/json"],"description":"#### 接口说明\n应用服务器调用该接口创建安全态势感知配置。\n#### 限制\n#### 目前支持的安全配置项有:\n\n| 配置名              | 默认告警级别 |   默认安全级别   | 设备维度 | 平台检测/设备上报 | 配置结构体   | 说明        |\n| :------------------ | :----------- | :--------------- | :------- | :---------------- | :----------------- | :-----------|\n| DEVICE_MEMORY_CHECK | CRITICAL  | ADVANCE_SECURITY | 是       | 设备上报          | [{\"key\":\"memory_threshold\",\"value\":80},{\"key\":\"report_period\",\"value\":1}] | 设备内存泄漏检测,report_period:上报周期单位(小时) 取值范围[1, 24];memory_threshold内存检测阈值百分比,取值范围:[1, 100] |\n| DEVICE_PORT_CHECK   | CRITICAL     | ADVANCE_SECURITY | 是       | 设备上报          | [{\"key\":\"safety_ports\",\"value\":[80,8080]},{\"key\":\"report_period\",\"value\":1}] | 设备异常端口检测,report_period:上报周期单位(小时) 取值范围[1, 24];safety_ports:安全端口白名单,数组,取值范围:[1, 65535] |\n| DEVICE_CPU_USAGE_CHECK | CRITICAL  | ADVANCE_SECURITY | 是       | 设备上报          | [{\"key\":\"cpu_usage_threshold\",\"value\":80},{\"key\":\"report_period\",\"value\":1}] | 设备CPU使用率检测,report_period:上报周期单位(小时) 取值范围[1, 24];cpu_usage_threshold:CPU检测阈值百分比,取值范围:[1, 100] |\n| DEVICE_DISK_SPACE_CHECK | CRITICAL  | ADVANCE_SECURITY | 是       | 设备上报          | [{\"key\":\"disk_space_threshold\",\"value\":80},{\"key\":\"report_period\",\"value\":1}] | 设备磁盘使用率检测,report_period:上报周期单位(小时) 取值范围[1, 24];disk_space_threshold:磁盘检测阈值百分比,取值范围:[1, 100] |\n| DEVICE_BATTERY_PERCENTAGE_CHECK | CRITICAL  | ADVANCE_SECURITY | 是       | 设备上报          | [{\"key\":\"battery_percentage_threshold\",\"value\":20},{\"key\":\"report_period\",\"value\":1}] | 设备电池电量检测,report_period:上报周期单位(小时) 取值范围[1, 24];battery_percentage_threshold:电池检测阈值百分比,取值范围:[1, 100] |\n| DEVICE_LOGIN_LOCAL_CHECK | MINOR  | BASIC_SECURITY | 是       | 设备上报          | NA | 设备本地登录检测 |\n| DEVICE_MALICIOUS_IP_CHECK | MINOR  | BASIC_SECURITY | 是       | 设备上报          | {\"key\":\"safety_ips\",\"value\":[\"192.168.0.0/16\"]} | 设备恶意ip检测 |\n| DEVICE_LOGIN_BRUTE_FORCE_CHECK | MINOR  | BASIC_SECURITY | 是       | 设备上报          | NA | 设备暴力破解登录检测 |\n| DEVICE_FILE_TAMPER_CHECK | MINOR  | BASIC_SECURITY | 是       | 设备上报          | NA | 设备本地文件篡改检测 |\n| INSECURE_TLS_PROTOCOL_CHECK | MAJOR  | ULTIMATE_SECURITY | 是       | 平台检测          | NA | 设备使用不安全的TLS协议接入检测 |\n| INSECURE_CIPHER_SUITE_CHECK | MAJOR  | ULTIMATE_SECURITY | 是       | 平台检测          | NA | 设备使用不安全TLS加密套件接入检测 |\n| CONNECT_MULTIPLE_TIMES_CHECK | CRITICAL  | ULTIMATE_SECURITY | 是       | 平台检测          | NA | 设备单位时间内多次建链检测 |\n| SECRET_COMPLEXITY_CHECK | MAJOR  | ULTIMATE_SECURITY | 是       | 平台检测          | NA | 设备弱密码检测 |\n| TLS_CONNECT_CHECK | MINOR  | ULTIMATE_SECURITY | 是       | 平台检测          | NA | 设备是否使用TLS加密通讯协议检测 |\n| DEVICE_AUTH_FAIL_CHECK | CRITICAL  | ULTIMATE_SECURITY | 是       | 平台检测          | NA | 设备鉴权失败检测 |\n| DEVICE_OFFLINE_CHECK | CRITICAL  | ULTIMATE_SECURITY | 是       | 平台检测          | NA | 设备异常离线检测 |","operationId":"CreateSecurityProfile","parameters":[{"description":"**参数说明**:项目ID。获取方法请参见 [获取项目ID](https://support.huaweicloud.com/api-iothub/iot_06_v5_1001.html)。","in":"path","name":"project_id","pattern":"^[a-fA-F0-9]{1,32}$","required":true,"type":"string","x-example":"04ed32dc1b0025b52fe3c01a27c2b0a8"},{"description":"**参数说明**:用户Token。通过调用IAM服务 [获取IAM用户Token](https://support.huaweicloud.com/api-iam/iam_30_0001.html)接口获取,接口返回的响应消息头中“X-Subject-Token”就是需要获取的用户Token。简要的获取方法样例请参见 [Token认证](https://support.huaweicloud.com/api-iothub/iot_06_v5_0091.html#section0)。","in":"header","name":"X-Auth-Token","required":false,"type":"string","x-effective-scene":"huaweicloud","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX..."},{"description":"**参数说明**:实例ID。物理多租下各实例的唯一标识,一般华为云租户无需携带该参数,仅在物理多租场景下从管理面访问API时需要携带该参数。您可以在IoTDA管理控制台界面,选择左侧导航栏“总览”页签查看当前实例的ID。","in":"header","name":"Instance-Id","pattern":"[0-9a-f-]{1,36}","required":false,"type":"string","x-example":"1a7ffc5c-d89c-44dd-8265-b1653d951ce0"},{"description":"**参数说明**:请求结构体,见请求结构体说明。","in":"body","name":"CreateSecurityProfileRequestBody","required":true,"schema":{"$ref":"#/definitions/AddSecurityProfileDTO"}}],"produces":["application/json"],"responses":{"201":{"description":"Create","examples":{"application/json":{"alarm_level":"CRITICAL","enable":true,"profile":[{"key":"memory_threshold","value":80}],"profile_id":"04ed32dc1b0025b52fe3c01a27c2babc","profile_targets":{"target_ids":["1d7616926636486cb05120018018cafc:67443bd4ad7db3647deb4f7a"],"target_type":"PRODUCT"},"security_level":"BASIC_SECURITY","security_type":"DEVICE_MEMORY_CHECK"}},"schema":{"$ref":"#/definitions/SecurityProfileDTO"}},"400":{"description":"Bad Request","x-Error":["IOTDA.013801","IOTDA.013802","IOTDA.013803"]},"403":{"description":"Forbidden","x-Error":["IOTDA.013804"]}},"summary":"创建或更新安全态势感知配置","tags":["SecurityProfileManagement"],"x-imports":"org.springframework.http.ResponseEntity;","x-is-registered":"N","x-order":1,"x-request-examples-1":{"alarm_level":"CRITICAL","enable":true,"profile":[{"key":"memory_threshold","value":80}],"profile_targets":{"target_ids":["1d7616926636486cb05120018018cafc:67443bd4ad7db3647deb4f7a"],"target_type":"PRODUCT"},"security_level":"BASIC_SECURITY","security_type":"DEVICE_MEMORY_CHECK"},"x-request-examples-url-1":"POST https://{endpoint}/v5/iot/{project_id}/security-profiles","x-returnType":"ResponseEntity<SecurityProfileDTO>","x-support-sdk":"Y"}}},"product_short":"IoTDA","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建或更新安全态势感知配置","tags":"安全态势感知配置管理","uri":null,"version":"2.0"}