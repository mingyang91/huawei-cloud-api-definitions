{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"Policy":{"properties":{"associated_vaults":{"description":"关联的存储库","items":{"$ref":"#/definitions/PolicyAssociateVault"},"type":"array"},"enabled":{"description":"策略是否启用","example":true,"type":"boolean"},"id":{"description":"策略ID","type":"string"},"name":{"description":"策略名称","example":"my_first_policy","type":"string"},"operation_definition":{"$ref":"#/definitions/PolicyoODCreate","description":"策略属性"},"operation_type":{"description":"策略类型,例如 ‘backup’:自动备份","enum":["backup","replication"],"type":"string","x-huawei-extraAnnotation":""},"policy_type":{"description":"策略类型,取值范围如下:\n- custom_policy:普通用户策略\n- organization_policy_v1:老版本组织策略\n- organization_policy_v2:新版本组织策略\n- organization_policy_removed:退出组织的用户已绑定在存储库上的新版本组织策略(不自动解绑策略与存储库绑定关系,但是不能新绑定存储库)","example":"custom_policy","type":"string"},"trigger":{"$ref":"#/definitions/PolicyTriggerResp","description":"策略时间调度规则"}},"required":["enabled","id","name","operation_definition","operation_type","trigger"]},"PolicyAssociateVault":{"description":"","properties":{"destination_vault_id":{"description":"关联的远端存储库ID","type":"string"},"vault_id":{"description":"存储库ID","type":"string"}},"required":["vault_id"]},"PolicyCreate":{"properties":{"enabled":{"default":true,"description":"是否启用策略","type":"boolean"},"name":{"description":"策略名称,长度限制:1- 64,只能由中文、字母、数字、“_”、“-”组成。","maxLength":64,"minLength":1,"pattern":"^[\\u4E00-\\u9FA5\\uf900-\\ufa2da-zA-Z0-9_\\-]*$","type":"string","x-huawei-extraAnnotation":""},"operation_definition":{"$ref":"#/definitions/PolicyoODCreate","description":"调度参数"},"operation_type":{"description":"策略类型,如备份,复制\nEnum:[ backup,replication]","enum":["backup","replication"],"example":"backup","type":"string","x-huawei-extraAnnotation":""},"trigger":{"$ref":"#/definitions/PolicyTriggerReq","description":"策略执行时间规则"}},"required":["name","operation_definition","operation_type","trigger"]},"PolicyCreateReq":{"properties":{"policy":{"$ref":"#/definitions/PolicyCreate","description":"创建策略body"}},"required":["policy"]},"PolicyCreateResp":{"properties":{"policy":{"$ref":"#/definitions/Policy","description":"创建响应"}},"required":["policy"]},"PolicyTriggerPropertiesReq":{"description":"","properties":{"pattern":{"description":"调度规则。限制24条规则。调度器的调度规则,可参照iCalendar RFC 2445规范中的事件规则,但仅支持FREQ、BYDAY、BYHOUR、BYMINUTE、INTERVAL等参数,其中FREQ仅支持WEEKLY和DAILY,BYDAY支持一周七天(MO、TU、WE、TH、FR、SA、SU),BYHOUR支持0-23小时,BYMINUTE支持0-59分钟,并且间隔不能小于一小时,一天最大24个时间点。例如,周一到周天,每天UTC时间的14:00调度,其规则为:'FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00'。例如:某个地区的时间为 UTC+8,如果在该地区每天14:00调度,则在14点基础上减8,其规则为'FREQ=DAILY;INTERVAL=1;BYHOUR=6;BYMINUTE=00'。","items":{"description":"","type":"string"},"type":"array","x-open-region-cloud":"hc,hk,otc,obc,tlf,ctc,hcso,sbc,g42,tm,cmcc,dt_test,hcso_dt,mix,hk_sbc,hws_ocb,fcs,fcs_dt,hcso_g42_b"}},"required":["pattern"]},"PolicyTriggerPropertiesResp":{"properties":{"pattern":{"description":"调度规则。限制24条规则。调度器的调度规则,可参照iCalendar RFC 2445规范中的事件规则,但仅支持FREQ、BYDAY、BYHOUR、BYMINUTE、INTERVAL等参数,其中FREQ仅支持WEEKLY和DAILY,BYDAY支持一周七天(MO、TU、WE、TH、FR、SA、SU),BYHOUR支持0-23小时,BYMINUTE支持0-59分钟,并且间隔不能小于一小时,一天最大24个时间点。例如,周一到周天,每天UTC时间的14:00调度,其规则为:'FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00'。例如:某个地区的时间为 UTC+8,若在该地区每天14:00调度,则在14点基础上减8,其规则为'FREQ=DAILY;INTERVAL=1;BYHOUR=6;BYMINUTE=00'。","items":{"description":"","type":"string"},"type":"array","x-admin":"False"},"start_time":{"description":"调度器开始时间,例如:\"2020-01-08 09:59:49\"","type":"string","x-huawei-extraAnnotation":""}},"required":["pattern"]},"PolicyTriggerReq":{"properties":{"properties":{"$ref":"#/definitions/PolicyTriggerPropertiesReq","description":"调度器属性"}},"required":["properties"]},"PolicyTriggerResp":{"properties":{"id":{"description":"调度器id","type":"string"},"name":{"description":"调度器名称","type":"string"},"properties":{"$ref":"#/definitions/PolicyTriggerPropertiesResp","description":"调度器属性"},"type":{"description":"调度器类型,目前只支持 time: 定时调度。","enum":["time"],"type":"string","x-huawei-extraAnnotation":""}},"required":["id","properties"]},"PolicyoODCreate":{"properties":{"day_backups":{"description":"保留日备个数,该备份不受保留最大备份数限制。取值为0到100。若选择该参数,则timezone 也必选。","format":"int32","maximum":100,"minimum":0,"type":"integer","x-huawei-extraAnnotation":""},"destination_project_id":{"description":"复制的目标项目ID,仅在跨区域复制时才会使用并且必须指定。","type":"string","x-open-region-cloud":"hc,hk"},"destination_region":{"description":"复制的目标区域,仅在跨区域复制时才会使用并且必须指定。长度限制:0- 255,只能由字母、数字、“_”、“-”组成","pattern":"^[a-zA-Z0-9._\\-]*$","type":"string","x-open-region-cloud":"hc,hk"},"enable_acceleration":{"description":"跨区域复制时,是否启用加速从而缩减复制的时间,如果不指定,默认不启用加速。","type":"boolean","x-open-region-cloud":"hc,hk"},"full_backup_interval":{"description":"每间隔多少次执行一次全量备份,当取值为 -1 时,不执行全量备份。 \n最小值:-1 \n最大值:100","format":"int32","maximum":100,"minimum":-1,"type":"integer"},"max_backups":{"default":-1,"description":"单个备份对象自动备份的最大备份数。取值为-1或0-99999。-1代表不按备份数清理。若该字段和retention_duration_days字段同时为空,备份会永久保留。","format":"int32","maximum":99999,"minimum":1,"type":"integer","x-huawei-extraAnnotation":""},"month_backups":{"description":"保留月备个数,该备份不受保留最大备份数限制。取值为0到100。若选择该参数,则timezone 也必选。","format":"int32","maximum":100,"minimum":0,"type":"integer","x-huawei-extraAnnotation":""},"retention_duration_days":{"default":-1,"description":"备份保留时长,单位天。最长支持99999天。-1代表不按时间清理。若该字段和max_backups 参数同时为空,备份会永久保留。","format":"int32","maximum":99999,"minimum":1,"type":"integer"},"timezone":{"description":"用户所在时区,格式形如UTC+08:00, 若选择年备,月备,周备,日备中任一参数,则该参数不能为空。","pattern":"'UTC([+-]{1,1}[0-9]{2,2}[:]{1,1}[0-9]{2,2})'","type":"string","x-huawei-extraAnnotation":""},"week_backups":{"description":"保留周备个数,该备份不受保留最大备份数限制。取值为0到100。若选择该参数,则timezone 也必选。","format":"int32","type":"integer","x-huawei-extraAnnotation":""},"year_backups":{"description":"保留年备个数,该备份不受保留最大备份数限制。取值为0到100。若选择该参数,则timezone 也必选。","format":"int32","maximum":100,"minimum":0,"type":"integer","x-huawei-extraAnnotation":""}}}},"description":null,"group_id":"11b1e4b30d524dacb6891902e04115dd","host":"cbr.cn-north-4.myhuaweicloud.com","id":"c3adb60849094ab48dc069d350948b89","info_version":"v1","method":"post","name":"CreatePolicy","parameters":{},"paths":{"/v3/{project_id}/policies":{"post":{"consumes":[],"deprecated":false,"description":"创建策略,策略分为备份策略和复制策略。","operationId":"CreatePolicy","parameters":[{"description":"创建策略body","in":"body","name":"CreatePolicyRequestBody","required":true,"schema":{"$ref":"#/definitions/PolicyCreateReq"},"x-order":1},{"description":"项目ID","in":"path","name":"project_id","required":true,"type":"string","x-order":2},{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX...","x-order":3}],"produces":[],"responses":{"200":{"description":"OK","examples":{"application/json":{"policy":{"associated_vaults":null,"enabled":true,"id":"cbb3ce6f-3332-4e7c-b98e-77290d8471ff","name":"policy001","operation_definition":{"day_backups":0,"month_backups":0,"retention_duration_days":1,"timezone":"UTC+08:00","week_backups":0,"year_backups":0},"operation_type":"backup","trigger":{"id":"d67269a6-5369-42d7-8150-5254bd446328","name":"default","properties":{"pattern":["FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00"],"start_time":"2019-05-08 06:57:05"},"type":"time"}}}},"schema":{"$ref":"#/definitions/PolicyCreateResp"}}},"summary":"创建策略","tags":["策略"],"x-apiexplorer-hide":"false","x-constraint":"","x-first-open-time":"","x-hybridcloud":"","x-is-registered":"Y","x-name":"创建策略","x-open-region-cloud":"hc,hk,otc,obc,ctc,hcso,sbc,g42,tm,cmcc,hk-g42,hcso_dt","x-order":47,"x-publishpath":"","x-request-examples-1":{"policy":{"enabled":true,"name":"policy001","operation_definition":{"day_backups":0,"month_backups":0,"retention_duration_days":1,"timezone":"UTC+08:00","week_backups":0,"year_backups":0},"operation_type":"backup","trigger":{"properties":{"pattern":["FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00"]}}}},"x-request-examples-description-1":"","x-request-examples-text-1":"{\n  \"policy\": {\n    \"enabled\": true,\n    \"name\": \"policy001\",\n    \"operation_definition\": {\n      \"day_backups\": 0,\n      \"month_backups\": 0,\n      \"retention_duration_days\": 1,\n      \"timezone\": \"UTC+08:00\",\n      \"week_backups\": 0,\n      \"year_backups\": 0\n    },\n    \"operation_type\": \"backup\",\n    \"trigger\": {\n      \"properties\": {\n        \"pattern\" : [\"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR,SA,SU;BYHOUR=14;BYMINUTE=00\" ]\n        } \n    }\n  }\n}","x-request-examples-url-1":"POST https://{endpoint}/v3/f841e01fd2b14e7fa41b6ae7aa6b0594/policies","x-scope":"Commercial","x-source":"","x-support-sdk":"Y"}}},"product_short":"CBR","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建策略","tags":"策略","uri":null,"version":"2.0"}