{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"OpenGaussErrorResponse":{"properties":{"error_code":{"description":"错误码。","example":"DBS.200022","type":"string"},"error_msg":{"description":"错误消息。","example":"实例名称已存在。","type":"string"}},"required":["error_code","error_msg"]},"OpenGaussJobId":{"description":"","properties":{"job_id":{"description":"任务id。按需实例时仅返回任务id。","example":"6ad4eb1f-73bd-4876-aa31-aa9a1e41c4bc","type":"string"},"order_id":{"description":"订单id。包周期实例时仅返回订单id。","example":"CS2205191100OWHLL","type":"string"}}},"OpenGaussUpgradeRequest":{"description":"GaussDB(for openGauss)实例版本升级接口传参参数。","properties":{"target_version":{"description":"实例升级目标版本,非必填。如果未传值则默认升级到当前实例的优选版本。仅热补丁升级方式下支持传入多个值,升级操作为升级自动提交,则实例版本从小到大批量升级,升级操作为升级回退,则实例版本从大到小批量回退。","type":"string"},"upgrade_action":{"description":"实例升级操作,就地升级无需传值。灰度升级包括升级自动提交,升级待观察,提交升级,升级回退四种。热补丁升级包括升级自动提交,升级回退两种。详见接口描述。\n\tupgradeAutoCommit 升级自动提交\n\tupgrade 升级待观察\n\tcommit 提交升级\n\trollback 升级回退。","type":"string"},"upgrade_az":{"description":"主备版实例灰度升级,滚动升级az值,可以支持多az一起升级,az之间以’,’分割。集中式实例灰度升级,升级待观察必填。该值不能填入不属于该实例的az值。","type":"string"},"upgrade_shard_num":{"description":"分布式实例灰度升级,滚动升级分片数。分布式实例灰度升级,升级待观察必填。该值不能大于实例未升级分片总数。","format":"int32","type":"integer"},"upgrade_type":{"description":"实例升级类型,包括就地升级,灰度升级,热补丁升级三种,三种升级方式的异同,详见接口描述。\n\tinplace 就地升级\n\tgrey 灰度升级\n\thotfix 热补丁升级。","type":"string"}},"required":["upgrade_type"]}},"description":null,"group_id":"cb81c3e0ae314c27a40e8fc90fd34a80","host":"gaussdb-opengauss.cn-north-4.myhuaweicloud.com","id":"796430ee2bc54ab9a93d279e12e3879a","info_version":"v3","method":"put","name":"UpgradeInstanceVersion","parameters":{},"paths":{"/v3.1/{project_id}/instances/{instance_id}/db-upgrade":{"put":{"description":"GaussDB(for openGauss)实例版本升级。包括灰度升级,就地升级,热补丁升级等三种升级方式。 \n就地升级:\n就地升级需要停止业务进行,会一次性升级集群中所有节点。就地升级需要暂停业务30分钟来升级。 \n灰度升级: \n升级自动提交:所有节点进程一起升级,在升级过程中有大概10秒的业务中断,不阻塞其他业务操作。 \n升级待观察:升级待观察,将数据库升级过程细分为升级,提交两个阶段。升级阶段可以根据部署方式细分为按分片或者按az的滚动升级,提交阶段可以对升级完成后的实例进行业务测试,根据需要可以选择提交升级,或者升级回退。每个主dn或者cn组件升级就有一次10秒业务中断。升级过程均是先管理面,再数据面,由备到主的升级方式。 分布式实例:根据分片数滚动升级,每次滚动升级可以根据选择的分片数进行指定分片数量的节点进行升级。 主备版实例:根据AZ数进行滚动升级,每次滚动升级可以根据选择的AZ进行1个分区或者多个分区进行升级。 \n提交升级:提交升级。在升级完成,进入提交阶段时。业务测试正常后提交升级,完成本次升级流程。\n升级回退:升级回退,在升级完成,进入提交阶段时。可以根据需要回退本次升级,回退到升级前的版本。\n热补丁升级: \n升级自动提交:热补丁自动升级并提交,中间无业务中断,仅修复产品bug。 \n升级回退:热补丁回退,无业务中断时间","operationId":"UpgradeInstanceVersion","parameters":[{"description":"用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"******"},{"description":"语言。","in":"header","name":"X-Language","required":false,"type":"string","x-example":"zh-cn"},{"description":"租户在某一region下的project ID。 获取方法请参见[获取项目ID](https://support.huaweicloud.com/api-opengauss/opengauss_api_0034.html)。","in":"path","name":"project_id","required":true,"type":"string","x-example":"619d3e78f61b4be68bc5aa0b59edcf7b"},{"description":"实例ID。","in":"path","name":"instance_id","required":true,"type":"string"},{"description":"请求体","in":"body","name":"UpgradeInstanceVersionRequestBody","required":true,"schema":{"$ref":"#/definitions/OpenGaussUpgradeRequest"}}],"responses":{"202":{"description":"Success.","examples":{"application/json":{"job_id":"2b414788a6004883a02390e2eb0ea227"}},"schema":{"$ref":"#/definitions/OpenGaussJobId"}},"default":{"description":"Client or server error.","schema":{"$ref":"#/definitions/OpenGaussErrorResponse"}}},"summary":"实例内核版本升级","tags":["版本升级"],"x-api-type":"open-api","x-apiexplorer-hide":"false","x-is-registered":"Y","x-order":18,"x-request-examples-1":{"upgrade_type":"inplace"},"x-request-examples-2":{"upgrade_action":"upgradeAutoCommit","upgrade_type":"grey"},"x-request-examples-3":{"upgrade_action":"upgrade","upgrade_shard_num":1,"upgrade_type":"grey"},"x-request-examples-4":{"upgrade_action":"upgrade","upgrade_az":"az1,az2","upgrade_type":"grey"},"x-request-examples-description-1":"实例就地升级。","x-request-examples-description-2":"实例灰度升级并采用升级自动提交升级方式升级传参。","x-request-examples-description-3":"分布式实例灰度升级并采用升级待观察方式升级传参。","x-request-examples-description-4":"主备版实例灰度升级并采用升级待观察方式升级传参。","x-request-examples-text-1":{"upgrade_type":"inplace"},"x-request-examples-text-2":{"upgrade_action":"upgradeAutoCommit","upgrade_type":"grey"},"x-request-examples-text-3":{"upgrade_action":"upgrade","upgrade_shard_num":1,"upgrade_type":"grey"},"x-request-examples-text-4":{"upgrade_action":"upgrade","upgrade_az":"az1,az2","upgrade_type":"grey"},"x-request-examples-url-1":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3.1/0483b6b16e954cb88930a360d2c4e663/instances/cc6fd964d93f4003851dfc29d57d30a5in14/db-upgrade","x-request-examples-url-2":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3.1/0483b6b16e954cb88930a360d2c4e663/instances/cc6fd964d93f4003851dfc29d57d30a5in14/db-upgrade","x-request-examples-url-3":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3.1/0483b6b16e954cb88930a360d2c4e663/instances/cc6fd964d93f4003851dfc29d57d30a5in14/db-upgrade","x-request-examples-url-4":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3.1/0483b6b16e954cb88930a360d2c4e663/instances/cc6fd964d93f4003851dfc29d57d30a5in14/db-upgrade","x-support-sdk":"Y"}}},"product_short":"GaussDBforopenGauss","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"实例内核版本升级","tags":"版本升级","uri":null,"version":"2.0"}