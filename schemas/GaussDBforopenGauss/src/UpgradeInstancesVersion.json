{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"GaussDBUpgradeInstancesVersionRequest":{"description":"GaussDB批量实例版本升级接口传参参数。","properties":{"instance_ids":{"description":"批量实例ID。","items":{"type":"string"},"type":"array"},"target_version":{"description":"批量实例升级目标版本,非必填。如果未传值灰度升级和就地升级默认升级到当前实例的优选版本,热补丁升级无需传该值,默认升级实例所有可升级热补丁。","type":"string"},"upgrade_action":{"description":"实例升级操作,就地升级无需传值。灰度升级包括升级自动提交,升级待观察,提交升级,升级回退四种。","enum":["upgradeAutoCommit","upgrade","commit","rollback"],"type":"string"},"upgrade_type":{"description":"实例升级类型,包括就地升级,灰度升级、热补丁升级三种。","enum":["inplace","grey","hotfix"],"type":"string"}},"required":["upgrade_type","instance_ids"]},"InstancesUpgradeRsp":{"properties":{"error_messages":{"description":"下发失败错误信息列表。","items":{"type":"string"},"type":"array"},"failed_instance_ids":{"description":"下发失败的实例ID列表。","items":{"type":"string"},"type":"array"},"failed_num":{"description":"下发失败的实例数量。","type":"integer"},"job_ids":{"description":"任务id。","items":{"type":"string"},"type":"array"},"succeeded_num":{"description":"下发成功的实例数量。","type":"integer"}}},"OpenGaussErrorResponse":{"properties":{"error_code":{"description":"错误码。","example":"DBS.200022","type":"string"},"error_msg":{"description":"错误消息。","example":"实例名称已存在。","type":"string"}},"required":["error_code","error_msg"]}},"description":null,"group_id":"cb81c3e0ae314c27a40e8fc90fd34a80","host":"gaussdb-opengauss.cn-north-4.myhuaweicloud.com","id":"43e24d96937f44339e5eb09e7a23e48c","info_version":"v3","method":"put","name":"UpgradeInstancesVersion","parameters":{},"paths":{"/v3/{project_id}/instances/db-upgrade":{"put":{"description":"GaussDB批量实例版本升级。包括灰度升级,就地升级、热补丁升级三种升级方式。 \n就地升级:\n就地升级需要停止业务进行,会一次性升级集群中所有节点。就地升级需要暂停业务30分钟来升级。 \n灰度升级: \n升级自动提交:所有节点进程一起升级,在升级过程中有大概10秒的业务中断,不阻塞其他业务操作。 \n升级待观察:升级待观察,将数据库升级过程细分为升级,提交两个阶段。升级阶段可以根据部署方式细分为按分片或者按az的滚动升级,提交阶段可以对升级完成后的实例进行业务测试,根据需要可以选择提交升级,或者升级回退。每个主dn或者cn组件升级就有一次10秒业务中断。升级过程均是先管理面,再数据面,由备到主的升级方式。 分布式实例:根据分片数滚动升级,每次滚动升级可以根据选择的分片数进行指定分片数量的节点进行升级。 主备版实例:根据AZ数进行滚动升级,每次滚动升级可以根据选择的AZ进行1个分区或者多个分区进行升级。 \n热补丁升级: \n升级自动提交:热补丁自动升级并提交,中间无业务中断,仅修复产品bug。 \n提交升级:提交升级。在升级完成,进入提交阶段时。业务测试正常后提交升级,完成本次升级流程。\n升级回退:升级回退,在升级完成,进入提交阶段时。可以根据需要回退本次升级,回退到升级前的版本。\n批量实例可升级版本大于当前所有实例的引擎版本,且选择的所有实例,其升级方式和操作方式要保持一致。\n若批量实例升级方式是灰度升级,默认升级所有az和分片。","operationId":"UpgradeInstancesVersion","parameters":[{"description":"用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"******"},{"description":"语言。","in":"header","name":"X-Language","required":false,"type":"string","x-example":"zh-cn"},{"description":"租户在某一region下的project ID。","in":"path","name":"project_id","required":true,"type":"string","x-example":"619d3e78f61b4be68bc5aa0b59edcf7b"},{"description":"请求体","in":"body","name":"UpgradeInstancesVersionRequestBody","required":true,"schema":{"$ref":"#/definitions/GaussDBUpgradeInstancesVersionRequest"}}],"responses":{"202":{"description":"Success.","examples":{"application/json":{"error_messages":["实例状态异常,无法进行该操作"],"failed_instance_ids":["cc0ae5c47bf94834bf9e44138f7f995ain14"],"failed_num":1,"job_ids":["2b414788a6004883a02390e2eb0ea227","aa414788a6004883a02390e2eb0ea228"],"succeeded_num":2}},"schema":{"$ref":"#/definitions/InstancesUpgradeRsp"}},"default":{"description":"Client or server error.","schema":{"$ref":"#/definitions/OpenGaussErrorResponse"}}},"summary":"批量实例内核版本升级","tags":["版本升级"],"x-api-type":"open-api","x-apiexplorer-hide":"false","x-is-registered":"Y","x-order":4,"x-request-examples-1":{"instance_ids":["cc0ae5c47bf94834bf9e44138f7f995ain14","aa0ae5c47bf94834bf9e44138f7f995ain14"],"upgrade_type":"inplace"},"x-request-examples-2":{"instance_ids":["cc0ae5c47bf94834bf9e44138f7f995ain14","aa0ae5c47bf94834bf9e44138f7f995ain14"],"target_version":"8.100.0","upgrade_action":"upgrade","upgrade_type":"grey"},"x-request-examples-3":{"instance_ids":["cc0ae5c47bf94834bf9e44138f7f995ain14","aa0ae5c47bf94834bf9e44138f7f995ain14"],"target_version":"8.100.0","upgrade_action":"rollback","upgrade_type":"grey"},"x-request-examples-4":{"instance_ids":["cc0ae5c47bf94834bf9e44138f7f995ain14","aa0ae5c47bf94834bf9e44138f7f995ain14"],"target_version":"8.100.0","upgrade_action":"upgradeAutoCommit","upgrade_type":"grey"},"x-request-examples-5":{"instance_ids":["cc0ae5c47bf94834bf9e44138f7f995ain14","aa0ae5c47bf94834bf9e44138f7f995ain14"],"upgrade_action":"upgradeAutoCommit","upgrade_type":"hotfix"},"x-request-examples-description-1":"批量实例就地升级。","x-request-examples-description-2":"批量实例灰度升级并采用升级待观察方式升级传参。","x-request-examples-description-3":"批量实例灰度升级并采用回滚方式升级传参。","x-request-examples-description-4":"批量实例灰度升级并采用升级自动提交方式升级传参。","x-request-examples-description-5":"批量实例热补丁升级并采用升级自动提交方式升级传参。","x-request-examples-url-1":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3/0483b6b16e954cb88930a360d2c4e663/instances/db-upgrade","x-request-examples-url-2":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3/0483b6b16e954cb88930a360d2c4e663/instances/db-upgrade","x-request-examples-url-3":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3/0483b6b16e954cb88930a360d2c4e663/instances/db-upgrade","x-request-examples-url-4":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3/0483b6b16e954cb88930a360d2c4e663/instances/db-upgrade","x-request-examples-url-5":"PUT https://gaussdb-opengauss.cn-north-1.myhuaweicloud.com/v3/0483b6b16e954cb88930a360d2c4e663/instances/db-upgrade","x-support-sdk":"Y"}}},"product_short":"GaussDBforopenGauss","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"批量实例内核版本升级","tags":"版本升级","uri":null,"version":"2.0"}