{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"CreateLimitTaskNodeOption":{"properties":{"node_id":{"description":"**参数解释**:\n节点ID。\n**约束限制**:\n必须是当前实例的某一个节点ID。\n**取值范围**:\n不涉及。\n**默认取值**:\n不涉及。","type":"string"},"sql_id":{"description":"**参数解释**:\n该节点执行的SQL语句ID。\n**约束限制**:\n如果“limit_type”为SQL_ID,必须与“limit_type_value”值一致。\n**取值范围**:\n不涉及。\n**默认取值**:\n不涉及。","type":"string"}},"required":["node_id","sql_id"]},"CreateSqlLimitTaskRequestBody":{"properties":{"cpu_utilization":{"description":"**参数解释**:\nCPU利用率阈值。\n**约束限制**:\n如果“limit_type”为SESSION_ACTIVE_MAX_COUNT,必传。不支持和内存利用率阈值同时为0,如果选择只限制CPU、内存中的其中一个,则另一个必须传值0。\n**取值范围**:\n整数,取值范围[0,100)。\n**默认取值**:\n不涉及。","type":"integer"},"databases":{"description":"**参数解释**:\n数据库名称,限流只对指定的数据库生效,多个数据库名称用英文逗号分割。\n**约束限制**:\n当“limit_type”为SQL_TYPE类型时,databases参数必选。\n**取值范围**:\n不涉及。\n**默认取值**:\n不涉及。","type":"string"},"end_time":{"description":"**参数解释**:\n任务结束时间。\n**约束限制**:\n当“task_scope”为SQL时必传。\n**取值范围**:\n大于任务开始时间,格式必须为yyyy-mm-ddThh:mm:ssZ,当前时间指UTC时间。\n**默认取值**:\n不涉及。","type":"string"},"key_words":{"description":"**参数解释**:\n关键词。\n**约束限制**:\n当且仅当“limit_type”为SQL_TYPE时,必传。\n**取值范围**:\n多个关键词以逗号隔开,数量范围为[2,100]个,每个关键词长度范围[2,64]位,关键词不允许包含 \" 或 \\ 或 {} 或 null值以及非首尾的空格符。\n**默认取值**:\n不涉及。","type":"string"},"limit_type":{"description":"**参数解释**:\n限流类型。\n**约束限制**:\n不涉及。\n**取值范围**:\n- 当“task_scope”为SQL时,可选SQL_ID、SQL_TYPE类型。\n- 当“task_scope”为SESSION时,可选SESSION_ACTIVE_MAX_COUNT类型。\n\n**默认取值**:\n不涉及。","type":"string"},"limit_type_value":{"description":"**参数解释**:\n限流类型值。\n**约束限制**:\n不涉及。\n**取值范围**:\n- 当“limit_type”为SQL_ID类型时,该值为选中模板的sql_id。\n- 当“limit_type”为SQL_TYPE类型时,值为SQL类型,目前支持select,update,insert,delete,merge。\n- 当“limit_type”为SESSION_ACTIVE_MAX_COUNT类型时,只支持CPU_OR_MEMORY一种值。\n\n**默认取值**:\n不涉及。","type":"string"},"memory_utilization":{"description":"**参数解释**:\n内存利用率阈值。\n**约束限制**:\n如果“limit_type”为SESSION_ACTIVE_MAX_COUNT,必传。不支持和CPU利用率阈值同时为0,如果选择只限制CPU、内存中的其中一个,则另一个必须传值0。\n**取值范围**:\n整数,取值范围[0,100)。\n**默认取值**:\n不涉及。","type":"integer"},"node_infos":{"description":"**参数解释**:\nCN节点信息列表\n**约束限制**:\n如果“limit_type”为SQL_ID,则“node_infos”必选。","items":{"$ref":"#/definitions/CreateLimitTaskNodeOption"},"type":"array"},"parallel_size":{"description":"**参数解释**:\n并发数。\n**约束限制**:\n不涉及。\n**取值范围**:\n大于等于零的整数,取值范围[0, 2147483647]。\n**默认取值**:\n不涉及。","type":"integer"},"sql_model":{"description":"**参数解释**:\nSQL模板。\n**约束限制**:\n如果“limit_type”为SQLID,必传。\n**取值范围**:\n不涉及。\n**默认取值**:\n不涉及。","type":"string"},"start_time":{"description":"**参数解释**:\n任务开始时间,如果该值小于当前时间,会取当前时间的前两分钟。\n**约束限制**:\n当“task_scope”为SQL时必传。\n**取值范围**:\n格式必须为yyyy-mm-ddThh:mm:ssZ,当前时间指UTC时间。\n**默认取值**:\n不涉及。","type":"string"},"task_name":{"description":"**参数解释**:\n限流任务名。\n**约束限制**:\n不涉及。\n**取值范围**:\n只能为英文字母大小写,下划线,数字和$符,最大长度为100个字符。\n**默认取值**:\n不涉及。","type":"string"},"task_scope":{"description":"**参数解释**:\n限流任务范围,目前支持SQL、SESSION级别范围。\n**约束限制**:\n不涉及。\n**取值范围**:\n- SQL\n- SESSION\n\n**默认取值**:\n不涉及。","type":"string"}},"required":["task_scope","limit_type","parallel_size","task_name"]},"CreateSqlLimitTaskResponseBody":{"properties":{"job_id":{"description":"**参数解释**:\n工作流ID。\n**取值范围**:\n不涉及。","type":"string"}},"type":"object"},"ErrorResponseBody":{"properties":{"error_code":{"description":"**参数解释**:\n错误码。\n**取值范围**:\n不涉及。","example":"DBS.00114000","type":"string"},"error_msg":{"description":"**参数解释**:\n错误消息。\n**取值范围**:\n不涉及。","example":"系统内部错误","type":"string"}},"required":["error_code","error_msg"]}},"description":null,"group_id":"cb81c3e0ae314c27a40e8fc90fd34a80","host":"gaussdb-opengauss.cn-north-4.myhuaweicloud.com","id":"b43c4fa2c36446beb16649c8aa1f2f87","info_version":"v3","method":"post","name":"CreateSqlLimitTask","parameters":{},"paths":{"/v3.1/{project_id}/instances/{instance_id}/limit-task":{"post":{"description":"根据具体范围和类型,进行限流任务的创建。","operationId":"CreateSqlLimitTask","parameters":[{"description":"**参数解释**:\n用户Token。\n通过调用IAM服务[获取用户token](https://support.huaweicloud.com/intl/zh-cn/api-iam/iam_30_0001.html)。\n**约束限制**:\n不涉及。\n**取值范围**:\n不涉及。\n**默认取值**:\n不涉及。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"******"},{"description":"**参数解释**:\n租户在某一Region下的项目ID。\n获取方法请参见[获取项目ID](https://support.huaweicloud.com/api-gaussdb/gaussdb_api_196.html)。\n**约束限制**:\n不涉及。\n**取值范围**:\n只能由英文字母、数字组成,且长度为32个字符。\n**默认取值**:\n不涉及。","in":"path","name":"project_id","required":true,"type":"string","x-example":"43391853d5634d7e98fdcce8192e414c"},{"description":"**参数解释**:\n实例ID,此参数是用户创建实例的唯一标识。\n**约束限制**:\n不涉及。\n**取值范围**:\n只能由英文字母、数字组成,且长度为32个字符。\n**默认取值**:\n不涉及。","in":"path","name":"instance_id","required":true,"type":"string","x-example":"cb651ac71c5a447685ef981e44a0422fin14"},{"description":"请求体。","in":"body","name":"CreateLimitTaskRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateSqlLimitTaskRequestBody"}},{"default":"en-us","description":"**参数解释**:\n语言。\n**约束限制**:\n不涉及。\n**取值范围**:\n- zh-cn \n- en-us\n\n**默认取值**:\nen-us","enum":["zh-cn","en-us"],"in":"header","name":"X-Language","required":false,"type":"string","x-example":"en-us"}],"responses":{"202":{"description":"Success.","examples":{"application/json":{"job_id":"d8819ac11297598d06e591b5786aab86"}},"schema":{"$ref":"#/definitions/CreateSqlLimitTaskResponseBody"}},"default":{"description":"系统内部错误。","schema":{"$ref":"#/definitions/ErrorResponseBody"}}},"summary":"创建SQL限流任务","tags":["SQL限流"],"x-api-is-publish":true,"x-api-type":"open-api","x-apigateway-ratelimit":"opengauss_default_policy","x-constraint":"- 分布式版实例不支持自治限流任务。\n- 不支持对系统级别用户(例如root等)进行SQL限流。\n- 每个实例最多支持1000条限流任务。\n- 对于关键词限流任务,一个关键词中包含英文逗号视作以逗号分隔的两个关键词,作用时不区分关键词前后顺序。\n- 限流功能仅支持V2.0-8.0及以上版本实例。","x-file":"haoqian","x-is-registered":"Y","x-request-examples-1":{"databases":"test1","end_time":"2023-06-07T01:47:20+0800","limit_type":"SQL_ID","node_infos":[{"node_id":"46d996fdda594f58b17fe509061e0893no14","sql_ids":"39b6a1a"}],"parallel_size":100,"start_time":"2023-06-06T01:47:20+0800","task_name":"test1","task_scope":"SQL"},"x-request-examples-2":{"databases":"test1","end_time":"2023-06-07T01:47:20+0800","key_words":"table1,id","limit_type":"SQL_TYPE","limit_type_value":"select","parallel_size":100,"start_time":"2023-06-06T01:47:20+0800","task_name":"test1","task_scope":"SQL"},"x-request-examples-3":{"cpu_utilization":80,"end_time":"2023-06-07T01:47:20+0800","limit_type":"SESSION_ACTIVE_MAX_COUNT","limit_type_value":"CPU_OR_MEMORY","memory_utilization":80,"parallel_size":100,"start_time":"2023-06-06T01:47:20+0800","task_name":"test","task_scope":"SESSION"},"x-request-examples-description-1":"创建限流任务","x-request-examples-text-1":{"databases":"test1","end_time":"2023-06-07T01:47:20+0800","limit_type":"SQL_ID","node_infos":[{"node_id":"46d996fdda594f58b17fe509061e0893no14","sql_id":"39b6a1a"}],"parallel_size":100,"start_time":"2023-06-06T01:47:20+0800","task_name":"test1","task_scope":"SQL"},"x-request-examples-text-2":{"databases":"test1","end_time":"2023-06-07T01:47:20+0800","key_words":"table1,id","limit_type":"SQL_TYPE","limit_type_value":"select","parallel_size":100,"start_time":"2023-06-06T01:47:20+0800","task_name":"test1","task_scope":"SQL"},"x-request-examples-text-3":{"cpu_utilization":80,"end_time":"2023-06-07T01:47:20+0800","limit_type":"SESSION_ACTIVE_MAX_COUNT","limit_type_value":"CPU_OR_MEMORY","memory_utilization":80,"parallel_size":100,"start_time":"2023-06-06T01:47:20+0800","task_name":"test","task_scope":"SESSION"},"x-request-examples-url-1":"POST https://{endpoint}/v3.1/4f07d3f50ce2466a9a7c014337b36409/instances/3d39c18788b54a919bab633874c159dfin14/limit-task","x-request-examples-url-2":"POST https://{endpoint}/v3.1/4f07d3f50ce2466a9a7c014337b36409/instances/3d39c18788b54a919bab633874c159dfin14/limit-task","x-request-examples-url-3":"POST https://{endpoint}/v3.1/4f07d3f50ce2466a9a7c014337b36409/instances/3d39c18788b54a919bab633874c159dfin14/limit-task","x-support-sdk":"Y"}}},"product_short":"GaussDBforopenGauss","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建SQL限流任务","tags":"SQL限流","uri":null,"version":"2.0"}