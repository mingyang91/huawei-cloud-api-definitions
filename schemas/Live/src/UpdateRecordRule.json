{"base_path":"/","components":null,"consumes":"[\"application/json; charset=UTF-8\"]","definitions":{"DefaultRecordConfig":{"properties":{"flv_config":{"$ref":"#/definitions/FLVRecordConfig"},"hls_config":{"$ref":"#/definitions/HLSRecordConfig"},"mp4_config":{"$ref":"#/definitions/MP4RecordConfig"},"obs_addr":{"$ref":"#/definitions/RecordObsFileAddr","description":"录制保存的租户的桶信息","type":"object"},"record_format":{"description":"录制格式,当前支持:FLV,HLS,MP4三种格式,设置格式时必须使用大写字母","items":{"$ref":"#/definitions/VideoFormatVar"},"maxItems":3,"minItems":1,"type":"array"}},"required":["record_format","obs_addr"]},"ErrorResponse":{"properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误描述","type":"string"}},"required":["error_code","error_msg"],"type":"object"},"FLVRecordConfig":{"properties":{"record_cycle":{"description":"单位为秒,周期录制时长,最小1分钟,最大12小时。如果为0则整个流录制一个文件。","maximum":43200,"minimum":0,"type":"integer"},"record_max_duration_to_merge_file":{"default":0,"description":"录制flv拼接时长,如果流中断超过该时间,则生成新文件。单位秒。如果为0表示流中断就生成新文件。默认为0。","maximum":300,"minimum":0,"type":"integer"},"record_prefix":{"default":"Record/{publish_domain}/{app}/{record_type}/{record_format}/{stream}_{file_start_time}/{file_start_time}","description":"录制FLV文件含路径和文件名的前缀, 默认Record/{publish_domain}/{app}/{record_type}/{record_format}/{stream}_{file_start_time}/{file_start_time}","maxLength":512,"minLength":1,"type":"string"}},"required":["record_cycle"]},"HLSRecordConfig":{"properties":{"record_cycle":{"description":"单位为秒,周期录制时长,最小1分钟(60秒),最大12小时。如果为0则整个流录制一个文件。","maximum":43200,"minimum":0,"type":"integer"},"record_max_duration_to_merge_file":{"default":0,"description":"录制HLS文件拼接时长,如果流中断超过该时间,则生成新文件。单位秒。如果为0表示流中断就生成新文件,如果为-1则表示相同的流中断恢复后继续在30天内的前一个文件保存。默认为0。","maximum":300,"minimum":-1,"type":"integer"},"record_prefix":{"default":"Record/{publish_domain}/{app}/{record_type}/{record_format}/{stream}_{file_start_time}/{stream}_{file_start_time}","description":"录制m3u8文件含路径和文件名的前缀, 默认Record/{publish_domain}/{app}/{record_type}/{record_format}/{stream}_{file_start_time}/{stream}_{file_start_time}","maxLength":512,"minLength":1,"type":"string"},"record_slice_duration":{"default":10,"description":"录制HLS时ts的切片时长,非必须,缺省为10,单位秒,最小2,最大60","maximum":60,"minimum":2,"type":"integer"},"record_ts_prefix":{"default":"{file_start_time_unix}_{file_end_time_unix}_{ts_sequence_number}","description":"录制ts文件名的前缀, 默认{file_start_time_unix}_{file_end_time_unix}_{ts_sequence_number}","maxLength":512,"minLength":1,"type":"string"}},"required":["record_cycle"]},"MP4RecordConfig":{"properties":{"record_cycle":{"description":"单位为秒,周期录制时长,最小1分钟,最大12小时。如果为0则整个流录制一个文件。","maximum":43200,"minimum":0,"type":"integer"},"record_max_duration_to_merge_file":{"default":0,"description":"录制mp4拼接时长,如果流中断超过该时间,则生成新文件。单位秒。如果为0表示流中断就生成新文件。默认为0。","maximum":300,"minimum":0,"type":"integer"},"record_prefix":{"default":"Record/{publish_domain}/{app}/{record_type}/{record_format}/{stream}_{file_start_time}/{file_start_time}","description":"录制文件含路径和文件名的前缀, 默认Record/{publish_domain}/{app}/{record_type}/{record_format}/{stream}_{file_start_time}/{file_start_time}","maxLength":512,"minLength":1,"type":"string"}},"required":["record_cycle"]},"RecordObsFileAddr":{"properties":{"bucket":{"description":"OBS的bucket名称","example":"mybucket","maxLength":256,"minLength":1,"type":"string"},"location":{"description":"OBS Bucket所在RegionID","enum":["cn-north-4","cn-north-5","cn-north-6"],"type":"string"},"object":{"description":"OBS对象路径,遵守OBS Object定义。如果为空则保存到根目录","example":"Record/","maxLength":1024,"minLength":0,"type":"string"}},"required":["bucket","location","object"]},"RecordRule":{"properties":{"app":{"description":"应用名,如果任意应用填写*。录制规则匹配的时候,优先精确app匹配,如果匹配不到,则匹配*","maxLength":128,"minLength":1,"type":"string"},"create_time":{"description":"创建时间,格式:yyyy-mm-ddThh:mm:ssZ,UTC时间。 在查询的时候返回","format":"date","maxLength":64,"minLength":1,"type":"string"},"default_record_config":{"$ref":"#/definitions/DefaultRecordConfig","description":"默认录制规则配置","type":"object"},"id":{"description":"规则id,由服务端返回。创建或修改的时候不携带","maxLength":128,"minLength":1,"type":"string"},"publish_domain":{"description":"直播推流域名","maxLength":128,"minLength":1,"type":"string"},"record_type":{"default":"CONTINUOUS_RECORD","description":"录制类型,包括:CONTINUOUS_RECORD,COMMAND_RECORD,PLAN_RECORD, ON_DEMAND_RECORD。默认CONTINUOUS_RECORD。\n- CONTINUOUS_RECORD: 持续录制,在该规则类型配置后,只要有流到推送到录制系统,就触发录制。\n- COMMAND_RECORD: 命令录制,在该规则类型配置后,在流推送到录制系统后,租户需要通过命令控制该流的录制开始和结束。命令控制的接口参考/v1/{project_id}/record/control\n- PLAN_RECORD: 计划录制,在该规则类型配置后,推的流如果在计划录制的时间区间则触发录制。\n- ON_DEMAND_RECORD: 按需录制,在该规则类型配置后,录制系统收到推流后,需要调用租户提供的接口查询录制规则,并根据规则录制。租户提供的接口定义参考:/customer-record-ondemand-url","enum":["CONTINUOUS_RECORD","COMMAND_RECORD","PLAN_RECORD","ON_DEMAND_RECORD"],"type":"string"},"stream":{"description":"录制的流名,如果任意流名则填写*。录制规则匹配的时候,优先精确stream匹配,如果匹配不到,则匹配*","maxLength":128,"minLength":1,"type":"string"},"update_time":{"description":"修改时间,格式:yyyy-mm-ddThh:mm:ssZ,UTC时间。 在查询的时候返回","format":"date","maxLength":64,"minLength":1,"type":"string"}},"required":["publish_domain","app","stream"]},"RecordRuleRequest":{"properties":{"app":{"description":"应用名,如需匹配任意应用则填写*。录制规则匹配的时候,优先精确app匹配,如果匹配不到,则匹配*","maxLength":128,"minLength":1,"type":"string"},"default_record_config":{"$ref":"#/definitions/DefaultRecordConfig"},"publish_domain":{"description":"直播推流域名","maxLength":128,"minLength":1,"type":"string"},"record_type":{"default":"CONTINUOUS_RECORD","description":"录制类型,包括:CONTINUOUS_RECORD,COMMAND_RECORD,PLAN_RECORD,ON_DEMAND_RECORD。默认CONTINUOUS_RECORD。\n- CONTINUOUS_RECORD:持续录制,在该规则类型配置后,只要有流到推送到录制系统,就触发录制。\n- COMMAND_RECORD:命令录制,在该规则类型配置后,在流推送到录制系统后,租户需要通过命令控制该流的录制开始和结束。\n- PLAN_RECORD:计划录制,在该规则类型配置后,推的流如果在计划录制的时间区间则触发录制。\n- ON_DEMAND_RECORD:按需录制,在该规则类型配置后,录制系统收到推流后,需要调用租户提供的接口查询录制规则,并根据规则录制。","enum":["CONTINUOUS_RECORD","COMMAND_RECORD","PLAN_RECORD","ON_DEMAND_RECORD"],"type":"string"},"stream":{"description":"录制的流名,如需匹配任流名则填写*。录制规则匹配的时候,优先精确stream匹配,如果匹配不到,则匹配*","maxLength":128,"minLength":1,"type":"string"}},"required":["publish_domain","app","stream","default_record_config"]},"VideoFormatVar":{"enum":["FLV","HLS","MP4"],"type":"string"}},"description":null,"group_id":"f01a6cf256d84c16985bc98f70ef068d","host":"live.cn-north-4.myhuaweicloud.com","id":"2e20185f69024b4eb197a6fcf7ef7550","info_version":"v1","method":"put","name":"UpdateRecordRule","parameters":{},"paths":{"/v1/{project_id}/record/rules/{id}":{"put":{"description":"修改录制规则接口,如果规则修改后,修改后的规则对正在录制的流无效,对新的流有效。","operationId":"UpdateRecordRule","parameters":[{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","maxLength":16384,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX..."},{"description":"项目ID,获取方法请参考[获取项目ID](https://support.huaweicloud.com/api-live/live_03_0023.html)。","in":"path","maxLength":64,"minLength":1,"name":"project_id","required":true,"type":"string","x-example":"70b76xxxxxx34253880af501cdxxxxxx"},{"description":"规则ID,在创建成功规则后返回","in":"path","maxLength":128,"minLength":1,"name":"id","required":true,"type":"string"},{"description":"录制规则配置","in":"body","name":"UpdateRecordRuleRequestBody","required":true,"schema":{"$ref":"#/definitions/RecordRuleRequest"}}],"responses":{"200":{"description":"修改录制配置操作成功","schema":{"$ref":"#/definitions/RecordRule"}},"400":{"description":"修改录制配置操作失败","examples":{"application/json":{"error_code":"LIVE.100011001","error_msg":"Request Illegal"}},"schema":{"$ref":"#/definitions/ErrorResponse"}}},"summary":"修改录制规则","tags":["录制管理"],"x-apiexplorer-hide":"N","x-is-registered":"Y","x-navigation-title":"录制管理","x-open-region-cloud":"hc,hk","x-request-examples-1":{"app":"live","default_record_config":{"flv_config":{"record_cycle":9000,"record_max_duration_to_merge_file":0,"record_prefix":"Record/{publish_domain}/{app}/{record_format}/{stream}_{file_start_time}/{file_start_time}"},"hls_config":{"record_cycle":3600,"record_max_duration_to_merge_file":0,"record_prefix":"Record/{publish_domain}/{app}/{record_type}/{record_format}/{stream}_{file_start_time}/{file_start_time}","record_slice_duration":10,"record_ts_prefix":"{file_start_time_unix}-{file_end_time_unix}-{ts_sequence_number}"},"obs_addr":{"bucket":"mybucket","location":"cn-north-4","object":"record/"},"record_format":["HLS","FLV"]},"publish_domain":"publish.xxx.com","record_type":"CONTINUOUS_RECORD","stream":"*"},"x-request-examples-url-1":"PUT https://{endpoint}/v1/{project_id}/record/rule/e89b76xxxxxx3425ui80af501cdxxxxxx","x-support-sdk":"Y"}}},"product_short":"Live","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"修改录制规则","tags":"录制管理","uri":null,"version":"2.0"}