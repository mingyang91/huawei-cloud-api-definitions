{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"CreateSparkJobRequestBody":{"description":"创建批处理作业请求body体。","properties":{"args":{"description":"传入主类的参数。","items":{"type":"string"},"type":"array","x-vision":""},"auto_recovery":{"description":"是否开启重试功能,如果开启,可在Spark作业异常失败后自动重试。默认值为“false”。","type":"boolean"},"catalog_name":{"description":"访问元数据时,需要将该参数配置为dli。","type":"string"},"className":{"description":"批处理作业的Java/Spark主类。","example":"org.apache.spark.examples.SparkPi","type":"string","x-vision":""},"cluster_name":{"description":"用于指定队列,填写已创建DLI的队列名。","example":"test","type":"string","x-vision":""},"conf":{"additionalProperties":{"type":"object"},"description":"batch配置项。","type":"object","x-vision":""},"driverCores":{"description":"Spark应用Driver的CPU核数。该配置项会替换sc_type中对应的默认参数。","example":8,"format":"int32","type":"integer","x-vision":""},"driverMemory":{"description":"Spark应用的Driver内存, 参数配置例如2G, 2048M。该配置项会替换“sc_type”中对应的默认参数,使用时必需带单位,否则会启动失败。","example":"2G","type":"string","x-vision":""},"executorCores":{"description":"Spark应用每个Executor的CPU核数。该配置项会替换sc_type中对应的默认参数。","example":8,"format":"int32","type":"integer","x-vision":""},"executorMemory":{"description":"Spark应用的Executor内存, 参数配置例如2G, 2048M。该配置项会替换“sc_type”中对应的默认参数,使用时必需带单位,否则会启动失败。","example":"2G","type":"string","x-vision":""},"feature":{"description":"作业特性,作业运行在vm队列上支持basic,在container队列上支持basic、ai、custom,其中填写custom时需要同时填写image参数。","enum":["basic","ai","custom"],"type":"string"},"file":{"description":"用户已上传到DLI资源管理系统的类型为jar的资源包名。","example":"batchTest/spark-examples_2.11-2.1.0.luxor.jar","type":"string","x-vision":""},"files":{"description":"用户已上传到DLI资源管理系统的类型为file的资源包名。","example":"[\"count.txt\"]","items":{"type":"string"},"type":"array","x-vision":""},"groups":{"description":"JSON对象列表,填写用户组类型资源,格式详见请求示例。resources中的name未进行type校验,只要此分组中存在这个名字的包即可。","items":{"$ref":"#/definitions/SparkJobGroup"},"type":"array","x-vision":""},"image":{"description":"自定义镜像。格式为:组织名/镜像名:镜像版本。当用户设置“feature”为“custom”时,该参数生效。用户可通过与“feature”参数配合使用,指定作业运行使用自定义的Spark镜像。关于如何使用自定义镜像,请参考《数据湖探索用户指南》。","type":"string"},"jars":{"description":"用户已上传到DLI资源管理系统的类型为jar的资源包名。","items":{"type":"string"},"type":"array","x-vision":""},"max_retry_times":{"description":"最大重试次数。最大值为“100”,默认值为“20”。","format":"int32","type":"integer"},"modules":{"description":"依赖的系统资源模块名,具体模块名可通过查询所有资源包接口查看。\nDLI系统提供了用于执行跨源作业的依赖模块,各个不同的服务对应的模块列表如下:\nCloudTable/MRS HBase: sys.datasource.hbase\nCloudTable/MRS OpenTSDB: sys.datasource.opentsdb\nRDS MySQL: sys.datasource.rds\nRDS PostGre: 不需要选\nDWS: 不需要选\nCSS: sys.datasource.css","items":{"type":"string"},"type":"array","x-vision":""},"name":{"description":"创建时用户指定的批处理名称,不能超过128个字符。","example":"TestDemo4","type":"string","x-vision":""},"numExecutors":{"description":"Spark应用Executor的个数。该配置项会替换sc_type中对应的默认参数。","example":6,"format":"int32","type":"integer","x-vision":""},"obs_bucket":{"description":"保存Spark作业的obs桶,需要保存作业时配置该参数","type":"string"},"pyFiles":{"description":"用户已上传到DLI资源管理系统的类型为pyFile的资源包名。","items":{"type":"string"},"type":"array","x-vision":""},"queue":{"description":"用于指定队列,填写已创建DLI的队列名","type":"string"},"resources":{"description":"JSON对象列表,填写用户已上传到队列的类型为JSON的资源包名和类型。","items":{"$ref":"#/definitions/SparkJobResource"},"type":"array","x-vision":""},"sc_type":{"description":"计算资源类型,目前可接受参数A, B, C。如果不指定,则按最小类型创建。\n资源类型:\nA:物理资源:8核32G内存,driverCores:2;executorCores:1;driverMemory:7G;executorMemory:4G;numExecutor:6。\nB:16核64G内存,2,2,7G,8G,7。\nC:32核128G内存,4,2,15G,8G,14。","example":"A","type":"string","x-vision":""},"spark_version":{"description":"作业使用spark组件的版本号,在feature为“basic”或“ai”时填写,若不填写,则使用默认的spark组件版本号2.3.2。","type":"string"}},"required":["file","className"],"type":"object"},"CreateSparkJobResponseBody":{"description":"创建批处理作业的响应参数。","properties":{"appId":{"description":"批处理作业的后台app id。","type":"string"},"cluster_name":{"description":"会话所在队列。","example":"test","type":"string","x-vision":""},"create_time":{"description":"Batch的创建时间。是单位为“毫秒”的时间戳。","format":"int64","type":"integer","x-vision":""},"duration":{"description":"作业运行时长,单位毫秒。","format":"int64","type":"integer"},"id":{"description":"Batch作业的id。","example":"80ceaaff-3cfc-4162-a56f-70031ea4fa91","type":"string","x-vision":""},"image":{"description":"自定义镜像。格式为:组织名/镜像名:镜像版本。","type":"string"},"kind":{"description":"批处理作业类型,只支持spark类型参数。","type":"string"},"log":{"description":"显示当前Batch作业的最后10条记录。","items":{"type":"string"},"type":"array","x-vision":""},"name":{"description":"创建时用户指定的批处理名称,不能超过128个字符。","type":"string"},"owner":{"description":"批处理作业所属用户","type":"string"},"proxyUser":{"description":"批处理作业所属代理用户(资源租户)。","type":"string"},"queue":{"description":"用于指定队列,填写已创建DLI的队列名","type":"string"},"sc_type":{"description":"计算资源类型。用户自定义时返回CUSTOMIZED。","example":"A","type":"string","x-vision":""},"state":{"description":"Batch作业的状态。包括: starting:正在启动;running:正在执行任务;dead:session已退出;success:session停止成功;recovering:正在恢复。","example":" starting","type":"string","x-vision":""},"update_time":{"description":"更新时间","format":"int64","type":"integer"}},"type":"object"},"FailResponse":{"properties":{"error_code":{"description":"错误码。","type":"string"},"error_msg":{"description":"错误描述信息。","type":"string"}},"required":["error_code","error_msg"],"type":"object"},"SparkJobGroup":{"description":"创建会话请求参数groups的元素。","properties":{"name":{"description":"用户组名称。","example":"group.tesddws","type":"string","x-vision":""},"resources":{"description":"用户组资源。","items":{"$ref":"#/definitions/SparkJobResource"},"type":"array","x-vision":""}},"type":"object"},"SparkJobResource":{"description":"创建会话请求参数resources的元素。","properties":{"name":{"description":"资源名称。","example":"group.tesddws/gsjdbc3.jar","type":"string","x-vision":""},"type":{"description":"资源类型。","example":"jar","type":"string","x-vision":""}},"type":"object"}},"description":null,"group_id":"065e44b2fe564922aa79230ec761dca6","host":"dli.cn-north-4.myhuaweicloud.com","id":"a3a57092a44a4940b7037fe3b577436e","info_version":"v1","method":"post","name":"CreateSparkJob","parameters":{},"paths":{"/v2.0/{project_id}/batches":{"post":{"deprecated":false,"description":"该API用于在某个队列上创建作业。","operationId":"CreateSparkJob","parameters":[{"description":"项目编号,用于资源隔离。","in":"path","name":"project_id","required":true,"type":"string","x-example":"48cc2c48765f481480c7db940d6409d1","x-order":1},{"in":"header","name":"USER-ID","required":false,"type":"string","x-order":4},{"description":"从IAM服务获取的用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"xxx","x-order":3,"x-vision":""},{"description":"创建批处理作业请求body体。","in":"body","name":"CreateSparkJobRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateSparkJobRequestBody"},"x-order":2,"x-vision":""}],"responses":{"201":{"description":"Created","schema":{"$ref":"#/definitions/CreateSparkJobResponseBody"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/FailResponse"}},"500":{"description":"Internal Server Error"}},"summary":"创建批处理作业","tags":["Spark作业-作业相关API"],"x-apiErrorCodes":[{"errorCode":"DLI.0001","errorDescription":"","errorDescriptionEn":"","errorMessage":"Parameter check errors occur.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0002","errorDescription":"","errorDescriptionEn":"","errorMessage":"The object does not exist.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0003","errorDescription":"","errorDescriptionEn":"","errorMessage":"SQL permission verification fails.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0004","errorDescription":"","errorDescriptionEn":"","errorMessage":"SQL syntax parsing errors occur.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0005","errorDescription":"","errorDescriptionEn":"","errorMessage":"SQL semantics parsing errors occur.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0006","errorDescription":"","errorDescriptionEn":"","errorMessage":"The object exists.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0007","errorDescription":"","errorDescriptionEn":"","errorMessage":"Feature not supported.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0008","errorDescription":"","errorDescriptionEn":"","errorMessage":"Metadata errors occur.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0009","errorDescription":"","errorDescriptionEn":"","errorMessage":"System restrictions","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0011","errorDescription":"","errorDescriptionEn":"","errorMessage":"The file permission check fails.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0012","errorDescription":"","errorDescriptionEn":"","errorMessage":"Resource objects are unavailable.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0016","errorDescription":"","errorDescriptionEn":"","errorMessage":"The identity and role are incorrect.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0018","errorDescription":"","errorDescriptionEn":"","errorMessage":"Data conversion errors occur.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0019","errorDescription":"","errorDescriptionEn":"","errorMessage":"The task times out.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0100","errorDescription":"","errorDescriptionEn":"","errorMessage":"The result expires.","httpStatus":"400","solution":"","solutionEn":""},{"errorCode":"DLI.0013","errorDescription":"","errorDescriptionEn":"","errorMessage":"User authentication errors occur.","httpStatus":"401","solution":"","solutionEn":""},{"errorCode":"DLI.0014","errorDescription":"","errorDescriptionEn":"","errorMessage":"Service authentication errors occur.","httpStatus":"401","solution":"","solutionEn":""},{"errorCode":"DLI.0023","errorDescription":"","errorDescriptionEn":"","errorMessage":"No related resources were found.","httpStatus":"404","solution":"","solutionEn":""},{"errorCode":"DLI.0999","errorDescription":"","errorDescriptionEn":"","errorMessage":"Server-side errors occur.","httpStatus":"500","solution":"","solutionEn":""}],"x-is-registered":"Y","x-open-region-cloud":"hc,hws_hk","x-order":0,"x-support-sdk":"Y"}}},"product_short":"DLI","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建批处理作业","tags":"Spark作业-作业相关API","uri":null,"version":"2.0"}