{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"CreateStreamJobRequestBody":{"description":"提交流作业的请求参数。","properties":{"description":{"description":"流作业描述。长度限制:0-512个字符。","example":"流作业","maxLength":512,"minLength":0,"type":"string","x-vision":""},"environment_config":{"$ref":"#/definitions/StreamEnvironmentConfig","description":"流作业上下文配置。","x-vision":""},"flink_jar_parameter":{"$ref":"#/definitions/FlinkJarParameter","description":"Flink Jar 作业参数。","x-vision":""},"flink_sql_parameter":{"$ref":"#/definitions/FlinkSqlParameter","description":"Flink SQL 作业参数。","x-vision":""},"job_type":{"default":"flink_sql_job","description":"作业类型:flink_sql_job或flink_jar_job","example":"flink_sql_job","type":"string","x-vision":""},"runtime_config":{"$ref":"#/definitions/StreamRuntimeConfig","description":"流作业运行时配置。","x-vision":""},"tags":{"description":"标签。","items":{"$ref":"#/definitions/Tag"},"minItems":0,"type":"array"},"transaction_id":{"description":"流作业事务 ID,防止重复提交。长度限制:0-64个字符。","example":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx","maxLength":64,"minLength":0,"type":"string","x-vision":""}},"required":["transaction_id"],"type":"object"},"CreateStreamJobResponseBody":{"description":"提交作业的响应参数。","properties":{"is_success":{"description":"执行请求是否成功。“true”表示请求执行成功。","example":true,"type":"string","x-vision":""},"job":{"$ref":"#/definitions/StreamJobStatus","description":"提交作业的job模型。","x-vision":""},"message":{"description":"消息内容","example":"提交作业成功","type":"string","x-vision":""}},"type":"object"},"FailResponse":{"properties":{"error_code":{"description":"错误码。","type":"string"},"error_msg":{"description":"错误描述信息。","type":"string"}},"required":["error_code","error_msg"],"type":"object"},"FlinkJarParameter":{"description":"Flink Jar 作业参数。","properties":{"dependency_files":{"description":"Flink Jar 作业依赖文件的 OBS 路径数组。示例:[obs://bucket/demo/test1.csv,obs://bucket/demo/test2.csv]","example":["obs://bucket/demo/test1.csv","obs://bucket/demo/test2.csv"],"items":{"type":"string"},"type":"array"},"dependency_jars":{"description":"Flink Jar 作业依赖 Jar 包的 OBS 路径数组。示例:[obs://bucket/demo/test1.jar,obs://bucket/demo/test2.jar]","example":["obs://bucket/demo/test1.jar","obs://bucket/demo/test2.jar"],"items":{"type":"string"},"type":"array","x-vision":""},"main_args":{"description":"Flink Jar 作业入口类参数,多个参数之间空格分隔。","example":"name","type":"string","x-vision":""},"main_class":{"description":"Flink Jar 作业入口类。","example":"Main.class","type":"string","x-vision":""},"main_jar":{"description":"Flink Jar 作业主类所在 Jar 包的 OBS 路径。","example":"obs://bucket/demo/main.jar","type":"string","x-vision":""}},"type":"object"},"FlinkResourceConfig":{"description":"Flink 作业的资源配置。","properties":{"jobmanager_resource_spec":{"$ref":"#/definitions/ResourceSpec","description":"JobManager 资源规格。"},"max_slot":{"description":"最大的 slot 数。","format":"int32","type":"integer"},"parallel_number":{"default":1,"description":"用户设置的作业并行数目。默认值为1。","example":1,"format":"int32","type":"integer","x-vision":""},"taskmanager_resource_spec":{"$ref":"#/definitions/ResourceSpec","description":"TaskManager 资源规格。"}},"type":"object"},"FlinkRestoreStrategy":{"description":"Flink 作业的启动策略。","properties":{"allow_non_restored_state":{"description":"允许忽略部分算子状态。仅当作业选择有状态恢复时需要设置。","example":true,"type":"boolean"},"job_start_time_in_ms":{"description":"无状态启动时间,需输入 13 位时间戳。当选择无状态启动时,可以设置本参数让所有支持 startTime 的源表均从该时刻开始读取数据。","example":1660293803155,"format":"long","type":"integer"},"restore_type":{"description":"启动位点类型。\nNONE:无状态启动。\nLATEST_SAVEPOINT:最新的作业快照启动。\nFROM_SAVEPOINT:从指定快照启动。\nLATEST_STATE:最新状态启动。","example":"LATEST_STATE","type":"string"},"savepoint_id":{"description":"启动作业快照 ID,启动策略为 FROM_SAVEPOINT 时必填。","example":"354dde66-a3ae-463e-967a-0b4107fd****","type":"string"}},"type":"object"},"FlinkRuntimeConfig":{"description":"Flink 作业运行时配置。","properties":{"resource_config":{"$ref":"#/definitions/FlinkResourceConfig","description":"Flink 作业的资源配置。","x-vision":""},"restore_strategy":{"$ref":"#/definitions/FlinkRestoreStrategy","description":"Flink 作业的启动策略。","x-vision":""},"version":{"description":"Flink 版本。仅支持 Flink 1.15及以上版本。","type":"string"}},"type":"object"},"FlinkSqlParameter":{"description":"Flink SQL 作业参数。","properties":{"dependency_jars":{"description":"Flink SQL 作业依赖的 Jar 包所在的 OBS 路径。","example":"obs://bucket/demo/test.jar","type":"string","x-vision":""},"sql_body":{"description":"Flink SQL 语句。长度限制:1048576个字符。","example":"select * from source_table","type":"string","x-vision":""}},"type":"object"},"Properties":{"example":{"key1":"value1","key2":"value2"},"type":"object","x-ref-external":"java.util.Properties"},"ResourceSpec":{"description":"表示对作业使用 CPU 和内存资源的包装,依据本数据结构可以生成对 JM/TM 资源的粗粒度的描述。","properties":{"cpu":{"default":1.0,"description":"CPU 核数","example":1,"format":"double","type":"number"},"memory":{"description":"内存,单位 GiB。","example":"4 GiB","type":"string"}},"type":"object"},"StreamClassLoggerLevel":{"description":"输出日志的类名称对应的日志级别配置。","properties":{"logger_level":{"description":"输出日志的级别,DEBUG\\TRACE\\WARNNING\\INFO\\ERROR。","example":"DEBUG","type":"string"},"logger_name":{"description":"输出日志的类的名称。","example":"com.aaa.bbb.ccc","type":"string"}},"type":"object"},"StreamEnvironmentConfig":{"description":"流作业的上下文配置。","properties":{"execution_agency_urn":{"description":"自定义委托名,定义作业级访问权限。","example":"job_agency","type":"string"},"image_feature":{"description":"表示用户作业使用的镜像类型。basic:表示使用 DLI 提供的基础镜像; custom:表示使用用户自定义的镜像。","type":"string"},"image_uri":{"description":"自定义镜像。当前只支持 SWR,格式为:组织名/镜像名:镜像版本。当用户设置“image_feature”为“custom”时,该参数生效。用户可通过与“image_feature”参数配合使用,指定作业运行使用自定义的镜像。关于如何使用自定义镜像,请参考《数据湖探索用户指南》。","type":"string"},"queue_name":{"description":"队列名称。长度限制:1-128个字符。","example":"queue","maxLength":128,"minLength":0,"type":"string","x-vision":""}},"type":"object"},"StreamJobStatus":{"description":"流作业的job模型。","properties":{"status_desc":{"description":"当前状态描述,包含异常状态原因及建议。","example":"当前状态描述","type":"string","x-vision":""},"status_name":{"description":"流作业状态名称。","example":"running","type":"string","x-vision":""},"stream_id":{"description":"流作业Id。","example":50320,"format":"int64","type":"integer","x-vision":""}},"type":"object"},"StreamLoggingConfig":{"description":"流日志配置。","properties":{"log_enabled":{"default":false,"description":"是否开启作业的日志上传到用户的 OBS 功能。默认为 false。","example":false,"type":"boolean","x-vision":""},"loggers_level_of_class":{"description":"输出日志的类名称对应的日志级别配置。","items":{"$ref":"#/definitions/StreamClassLoggerLevel"},"type":"array"},"obs_bucket":{"description":"用户授权保存作业日志的 OBS 桶名。","example":"my_obs_bucket","type":"string","x-vision":""},"root_logger_level":{"description":"根目录日志级别配置,DEBUG\\TRACE\\WARNNING\\INFO\\ERROR","example":"DEBUG","type":"string","x-vision":""}},"type":"object"},"StreamRuntimeConfig":{"description":"流作业运行时配置。","properties":{"flink_runtime_config":{"$ref":"#/definitions/FlinkRuntimeConfig","description":"Flink 作业运行时配置。","x-vision":""},"logging":{"$ref":"#/definitions/StreamLoggingConfig","description":"作业日志配置。","type":"string"},"properties":{"$ref":"#/definitions/Properties","description":"自定义配置。"},"staging_uri":{"description":"临时文件存储 URI,作业运行时产生的临时文件存储的 OBS 路径。(当前不支持配置)","type":"string"}},"type":"object","x-import":null},"Tag":{"description":"资源标签","properties":{"key":{"description":"键","maxLength":128,"minLength":1,"type":"string"},"value":{"description":"值","maxLength":255,"minLength":1,"type":"string"}},"required":["key","value"],"type":"object"}},"description":null,"group_id":"065e44b2fe564922aa79230ec761dca6","host":"dli.cn-north-4.myhuaweicloud.com","id":"3e4c188a39904bf5b42efe0bd1f38909","info_version":"v1","method":"post","name":"CreateStreamJob","parameters":{},"paths":{"/v2/{project_id}/streams":{"post":{"deprecated":false,"description":"通过 POST 方式,提交流式作业,请求体为 JSON 格式。","operationId":"CreateStreamJob","parameters":[{"description":"项目编号,用于资源隔离。","in":"path","name":"project_id","required":true,"type":"string","x-example":"48cc2c48765f481480c7db940d6409d1","x-order":1},{"description":"租户 Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"xxx","x-order":2,"x-vision":""},{"description":"提交流作业的请求参数。","in":"body","name":"CreateStreamJobRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateStreamJobRequestBody"},"x-order":3,"x-vision":""}],"responses":{"200":{"description":"OK","examples":{"application/json":{"is_success":"true","job":{"job_id":148,"status_desc":"","status_name":"job_submitting"},"message":"提交作业成功"}},"schema":{"$ref":"#/definitions/CreateStreamJobResponseBody"}},"400":{"description":"Bad Request","examples":{"application/json":{"error_code":"DLI.11032","error_msg":"SMN主题不存在请用户选择一个可用SMN主题"}},"schema":{"$ref":"#/definitions/FailResponse"}}},"summary":"提交流作业","tags":["流作业-作业相关API"],"x-apiErrorCodes":"[]","x-iam-auth-meta-anno":{"abacAction":"dli:jobs:create","authLevel":"INSTANCE","model":"v5-pkitoken","needAbacCheck":true,"needAbacResourceCheck":true,"needApigwJwtAuthCheck":true,"needCbcCheck":false,"needResourceTagCheck":true,"supportAllGrantedEps":false},"x-is-registered":"Y","x-order":1,"x-support-sdk":"Y"}}},"product_short":"DLI","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"提交流作业","tags":"流作业-作业相关API","uri":null,"version":"2.0"}