{"base_path":null,"components":{"parameters":{"SecurityTokenHeader":{"description":"通过临时安全凭证调用接口时,需要提供“X-Security-Token”Http头,取值为临时安全凭证的security_token字段。","in":"header","name":"X-Security-Token","required":false,"schema":{"type":"string"}}},"schemas":{"AssumeAgencyReqBody":{"description":"接口/v5/agencies/assume的Http请求体。","properties":{"agency_session_name":{"description":"委托会话的会话名。","maxLength":128,"minLength":2,"pattern":"^[\\w+=,.@-]*$","type":"string"},"agency_urn":{"description":"目标委托的URN。","maxLength":1500,"type":"string"},"duration_seconds":{"default":3600,"description":"获得的临时安全凭证的有效时间(单位秒)。请注意,该时间需要小于委托本身设置的最大会话持续时间,同时在携带X-Security-Token的Header头时该时间不能超过3600秒。","format":"int32","maximum":43200,"minimum":900,"type":"integer"},"external_id":{"description":"外部ID,防止混淆代理人问题。","maxLength":1224,"minLength":2,"pattern":"^[\\w+=,.@:\\/-]*$","type":"string"},"policy":{"description":"自定义策略,限制本次会话获得的临时安全凭证的权限范围不会超过该自定义策略指定的权限。","maxLength":2048,"minLength":2,"type":"string"},"policy_ids":{"description":"预置策略列表,限制本次会话获得的临时安全凭证的权限范围不会超过该预置策略指定的权限。","items":{"description":"预置策略,限制本次会话获得的临时安全凭证的权限范围不会超过该预置策略指定的权限。","maxLength":64,"pattern":"^[\\w-]+$","type":"string"},"maxItems":10,"type":"array"},"serial_number":{"description":"调用者绑定的MFA设备的序列号。","maxLength":256,"minLength":9,"pattern":"^[\\w+=/:,.@-]*$","type":"string"},"source_identity":{"description":"调用链里最初调用者所声明的身份。","maxLength":64,"minLength":2,"pattern":"^[\\w+=,.@-]*$","type":"string"},"tags":{"description":"自定义标签列表。","items":{"$ref":"#/components/schemas/TagDto"},"maxItems":20,"type":"array"},"token_code":{"description":"调用者绑定的MFA设备上的6位数字码。","maxLength":6,"minLength":6,"pattern":"^[\\d]{6,6}$","type":"string"},"transitive_tag_keys":{"description":"随着临时安全凭证调用链持续透传的标签键列表。","items":{"$ref":"#/components/schemas/TagKeyDto","description":"随着临时安全凭证调用链持续透传的标签键。"},"maxItems":20,"type":"array"}},"required":["agency_urn","agency_session_name"],"type":"object"},"AssumeAgencyResp":{"description":"接口/v5/agencies/assume的返回结果。","properties":{"assumed_agency":{"$ref":"#/components/schemas/AssumedAgencyDto","description":"目标委托信息。"},"credentials":{"$ref":"#/components/schemas/CredentialsDto","description":"生成的临时安全凭证。"},"source_identity":{"description":"调用链里最初调用者所声明的身份。","maxLength":64,"minLength":2,"pattern":"^[\\w+=,.@-]*$","type":"string"}},"required":["assumed_agency","credentials"],"type":"object"},"AssumedAgencyDto":{"description":"目标委托信息。","properties":{"id":{"description":"目标委托的唯一标志,包含了委托ID和委托会话名称信息。","maxLength":256,"pattern":"^[\\w+=,.@:-]*$","type":"string"},"urn":{"description":"目标委托的URN。","maxLength":1500,"type":"string"}},"required":["urn","id"],"type":"object"},"CredentialsDto":{"description":"临时安全凭证。","properties":{"access_key_id":{"description":"临时安全凭证的AK。","maxLength":20,"minLength":20,"type":"string"},"expiration":{"description":"临时安全凭证的失效时间。","format":"date-time","type":"string"},"secret_access_key":{"description":"临时安全凭证的SK。","maxLength":40,"minLength":40,"type":"string"},"security_token":{"description":"临时安全凭证的security_token。","type":"string"}},"required":["access_key_id","expiration","secret_access_key","security_token"],"type":"object"},"ErrorResp":{"properties":{"error_code":{"description":"错误码。","type":"string"},"error_msg":{"description":"错误信息。","type":"string"}},"required":["error_code","error_msg"],"type":"object"},"ForbiddenErrorResp":{"properties":{"encoded_authorization_message":{"description":"加密后的认证失败信息,可以通过STS5解密接口进行解密。","type":"string"},"error_code":{"description":"错误码。","type":"string"},"error_msg":{"description":"错误信息。","type":"string"}},"required":["error_code","error_msg","encoded_authorization_message"],"type":"object"},"TagDto":{"description":"标签,包含key、value两个字段。","properties":{"key":{"description":"标签键。","maxLength":128,"minLength":1,"pattern":"^(?!_sys_)[\\p{L}\\p{Z}\\p{N}_.:=+\\-@]*$","type":"string"},"value":{"description":"标签值,取值可以为空字符串,不可以为null。","maxLength":255,"minLength":0,"pattern":"^([\\p{L}\\p{Z}\\p{N}_.:\\/=+\\-@]*)$","type":"string"}},"required":["key","value"],"type":"object"},"TagKeyDto":{"description":"标签键,仅包含key字段。","maxLength":128,"minLength":1,"pattern":"^(?!_sys_)[\\p{L}\\p{Z}\\p{N}_.:=+\\-@]*$","type":"string"}}},"consumes":"","definitions":null,"description":null,"group_id":"7e4b094b2a1f46ff87c8537f5f407470","host":"sts.cn-north-4.myhuaweicloud.com","id":"ed2586820f7045f89a2f6146dd15f78f","info_version":"v1","method":"post","name":"AssumeAgency","parameters":null,"paths":{"/v5/agencies/assume":{"post":{"description":"通过委托或者信任委托获取临时安全凭证,临时安全凭证可用于对云资源发起访问。","operationId":"AssumeAgency","parameters":[{"$ref":"#/components/parameters/SecurityTokenHeader"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AssumeAgencyReqBody"}}},"required":true},"responses":{"200":{"content":{"application/json":{"example":{"assumed_agency":{"id":"{agency_id}:{agency_session_name}","urn":"sts::{domain_id}::assumed-agency:{agency_name}/{agency_session_name}"},"credentials":{"access_key_id":"HSTANO...XBS55JLJ3","expiration":"2022-09-07T03:27:51.158Z","secret_access_key":"EoWCQrr...SCcw4Whkt2aXKWAr","security_token":"hQpjbi1XXXXXX...XXXXXKbhBbA0TQ=="}},"schema":{"$ref":"#/components/schemas/AssumeAgencyResp"}}},"description":"请求成功。"},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"请求体异常。"},"403":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForbiddenErrorResp"}}},"description":"没有操作权限。"},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"未找到对应资源。"},"500":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"服务端异常。"}},"security":[{"AccessKeySignature":[]}],"summary":"通过委托或者信任委托获取临时安全凭证","tags":["Agency"],"x-is-registered":"Y","x-request-examples-1":{"agency_session_name":"session1","agency_urn":"iam::27680d67da6b47eb82d00a1a118be145:agency:Y0yfCQYJGO","duration_seconds":3600},"x-request-examples-description-1":"通过账号27680d67da6b47eb82d00a1a118be145下的委托Y0yfCQYJGO获取临时安全凭证。","x-request-examples-url-1":"POST https://{endpoint}/v5/agencies/assume","x-support-sdk":"Y"}}},"product_short":"STS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"通过委托或者信任委托获取临时安全凭证","tags":"临时安全凭证","uri":null,"version":"3.0.1"}