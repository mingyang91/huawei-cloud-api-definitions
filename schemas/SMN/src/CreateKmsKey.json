{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"AddKmsKeyRequestBody":{"properties":{"key_id":{"description":"在DEW服务上创建的用户主密钥对应的密钥ID,具体参考在DEW服务上创建密钥章节。","example":"9a618041-a917-49e0-bb3a-1a90163e97fe","maxLength":36,"pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","type":"string"}},"required":["key_id"],"type":"object"},"AddKmsKeyResponseBody":{"properties":{"id":{"description":"所使用密钥对应的ID。该ID由SMN生成,是主题下的该密钥的唯一标识ID。","example":"6bff5217846346a69832caa7450e28ff","type":"string"},"request_id":{"description":"请求的唯一标识ID。","example":"6a63a18b8bab40ffb71ebd9cb80d0085","maxLength":36,"minLength":0,"type":"string"}},"required":["request_id","id"],"type":"object"},"FailedResp":{"properties":{"code":{"description":"服务异常错误信息编码。","example":"SMN.0167","type":"string"},"message":{"description":"服务异常错误信息描述。","example":"xxxxxxxx","type":"string"},"request_id":{"description":"请求的唯一标识ID。","example":"6a63a18b8bab40ffb71ebd9cb80d0085","type":"string"}},"required":["request_id","code","message"]}},"description":null,"group_id":"28d7e20abf9b4048b20fdaf3ce746d32","host":"smn.cn-north-4.myhuaweicloud.com","id":"7cb2d8c14bd048b4b32cf88e42c78bf5","info_version":"v2","method":"post","name":"CreateKmsKey","parameters":{"X-Auth-Token":{"description":"用户Token。\n\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."}},"paths":{"/v2/{project_id}/notifications/topics/{topic_urn}/kms":{"post":{"description":"为主题绑定KMS密钥。KMS密钥于绑定后五分钟生效,生效后该主题下发布的消息(确认订阅消息、取消订阅消息、主题消息)均使用指定密钥的数据密钥进行加解密,并将消息内容在SMN服务内部加密传输。执行绑定KMS密钥时,用户需要先在IAM处创建名为smn_kms_agency的委托,并将资源操作权限授权给SMN服务。SMN会使用该委托进行创建数据密钥操作。","operationId":"CreateKmsKey","parameters":[{"description":"项目ID。 获取项目ID请参考 [获取项目ID](smn_api_66000.xml)。","in":"path","name":"project_id","required":true,"type":"string"},{"description":"Topic的唯一的资源标识,可通过[查询主题列表](smn_api_51004.xml)获取该标识。","in":"path","name":"topic_urn","required":true,"type":"string"},{"$ref":"#/parameters/X-Auth-Token"},{"description":"在主题下绑定密钥的请求体。","in":"body","name":"AddKmsKeyRequestBody","required":true,"schema":{"$ref":"#/definitions/AddKmsKeyRequestBody"}}],"responses":{"200":{"description":"请求成功的返回体。","examples":{"application/json":{"id":"df9831e92dc24c289c0048170f61d5ad","request_id":"44a8e3a585ab4da3954579f5d76ab626"}},"schema":{"$ref":"#/definitions/AddKmsKeyResponseBody"}},"400":{"description":"Bad Request","examples":{"application/json":{"error_code":"SMN.00013056","error_msg":"The kms key id is not available.","request_id":"12641f59208d4114a86aace62897980d"}},"schema":{"$ref":"#/definitions/FailedResp"}},"403":{"description":"Forbidden","examples":{"application/json":{"code":"SMN.0001","message":"No permission to request resources.","request_id":"1b261437accc427da6c43eec2fc7e324"}},"schema":{"$ref":"#/definitions/FailedResp"}},"404":{"description":"Not Found","examples":{"application/json":{"error_code":"SMN.00010008","error_msg":"Topic information is not found.","request_id":"cfa7a869d1404329adff10ac4bea9308"}},"schema":{"$ref":"#/definitions/FailedResp"}},"409":{"description":"Conflict","examples":{"application/json":{"error_code":"SMN.00013049","error_msg":"Kms key already exists.","request_id":"03651b5ef1da4b3d9545036d2a954d7f"}},"schema":{"$ref":"#/definitions/FailedResp"}},"500":{"description":"Internal Server Error","examples":{"application/json":{"error_code":"SMN.00013054","error_msg":"Failed to save kms key.","request_id":"cfa7a869d1404329adff10ac4bea9308"}},"schema":{"$ref":"#/definitions/FailedResp"}}},"summary":"主题绑定KMS密钥","tags":["密钥操作"],"x-apiexplorer-hide":"N","x-iftype":"externalAPI","x-is-registered":"Y","x-name":"主题绑定KMS密钥","x-open-region-cloud":"hk,hc","x-request-examples-1":{"key_id":"9a618041-a917-49e0-bb3a-1a90163e97fe"},"x-request-examples-description-1":"绑定KMS密钥成功的请求示例","x-request-examples-text-1":{"key_id":"9a618041-a917-49e0-bb3a-1a90163e97fe"},"x-request-examples-url-1":"https://{SMN_Endpoint}/v2/{project_id}/notifications/topics/urn:smn:regionId:44ef0bd78eb24f02b40614fe85a7d234:topic_6b10aa8f904111f08c3584a93e8ae4b6/kms","x-support-sdk":"Y"}}},"product_short":"SMN","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"主题绑定KMS密钥","tags":"密钥操作","uri":null,"version":"2.0"}