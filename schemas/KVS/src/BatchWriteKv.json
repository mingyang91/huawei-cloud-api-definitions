{"base_path":"/","components":null,"consumes":"[\"application/bson;charset=UTF-8\"]","definitions":{"BatchWriteKvRequestBody":{"properties":{"table_opers":{"description":"行操作数组,可以是多个表的操作。","items":{"$ref":"#/definitions/table_batch"},"type":"array"}},"required":["table_opers"],"type":"object"},"BatchWriteKvResponseBody":{"properties":{"unprocessed_opers":{"description":"未处理的操作列表。","items":{"$ref":"#/definitions/table_oper_ids"},"type":"array"}},"type":"object"},"composed_expression":{"properties":{"expressions":{"description":"多个相同优先级且相同逻辑的单字段或多字段条件。","items":{"$ref":"#/definitions/expression"},"type":"array"},"logic":{"description":"逻辑关系,取值如\"$and\", \"$or\", \"$nor\"。","type":"string"}},"required":["expressions"],"type":"object"},"condition_expression":{"properties":{"composed_expression":{"$ref":"#/definitions/composed_expression","description":"组合条件, 逐层同级的子表达式嵌套。"},"multi_field_expression":{"$ref":"#/definitions/multi_field_expression","description":"多字段条件,多个相同优先级的单字段条件。"},"single_field_expression":{"$ref":"#/definitions/single_field_expression","description":"单字段条件。"},"single_kv_expression":{"$ref":"#/definitions/single_kv_expression","description":"文档表达式。"}},"type":"object"},"delete_kv":{"properties":{"oper_id":{"description":"请求内的操作编码,未成功的操作返回该标识。","format":"int32","type":"integer"},"primary_key":{"description":"用户自定义的主键名及值。","format":"bson-document","type":"string"}},"required":["oper_id","primary_key"],"type":"object"},"expression":{"properties":{"composed_expression":{"$ref":"#/definitions/composed_expression","description":"组合条件, 逐层同级的子表达式嵌套。"},"multi_field_expression":{"$ref":"#/definitions/multi_field_expression","description":"多字段条件,多个相同优先级的单字段条件。"},"single_field_expression":{"$ref":"#/definitions/single_field_expression","description":"单字段条件。"}},"type":"object"},"kv_blob":{"properties":{"primary_key":{"description":"用户自定义的主键名及值。\n> 内容字段:主键字段名和值,组合索引多个元素。","format":"bson-document","type":"string"},"xattr":{"description":"非结构化数据内容。","format":"bson-binary","type":"string"},"xblob":{"description":"属性信息,最大2kb。","format":"bson-binary","type":"string"}},"required":["primary_key"],"type":"object"},"kv_oper_ids":{"properties":{"delete_kv_ids":{"description":"请求内的操作编码,未成功的操作返回该标识。 - 数组元素:请求内的操作编码,未成功的操作返回该标识。","items":{"format":"int32","type":"integer"},"type":"array"},"put_kv_ids":{"description":"上传kv操作, \"oper_id\"数组。\n- 数组元素:请求内的操作编码,未成功的操作返回该标识。","items":{"format":"int32","type":"integer"},"type":"array"},"update_kv_ids":{"description":"请求内的操作编码,未成功的操作返回该标识。 - 数组元素:请求内的操作编码,未成功的操作返回该标识。","items":{"format":"int32","type":"integer"},"type":"array"}},"type":"object"},"multi_field_expression":{"properties":{"expressions":{"description":"多个相同逻辑操作的单字段条件。","items":{"$ref":"#/definitions/single_field_expression"},"type":"array"},"logic":{"description":"多字段条件,多个相同优先级的单字段条件。","type":"string"}},"required":["expressions"],"type":"object"},"oper_item":{"description":"put_kv或delete_kv或update_kv操作。","properties":{"delete_kv":{"$ref":"#/definitions/delete_kv","description":"删除kv操作。"},"put_kv":{"$ref":"#/definitions/put_kv","description":"上传kv操作。"},"update_kv":{"$ref":"#/definitions/update_kv","description":"更新kv操作。"}},"type":"object"},"put_kv":{"properties":{"condition_expression":{"$ref":"#/definitions/condition_expression","description":"条件表达式,参见conditional小节。\n- 长度:[8,4096]"},"kv_blob":{"$ref":"#/definitions/kv_blob","description":"用户非结构化数据。"},"kv_doc":{"description":"用户文档。","format":"bson-document","type":"string"},"oper_id":{"description":"请求内的操作编码,未成功的操作返回该标识。","format":"int32","type":"integer"}},"required":["oper_id"],"type":"object"},"single_field_expression":{"properties":{"field":{"description":"条件字段。","type":"string"},"func":{"description":"条件函数,取值如\"$gt\", $lt\",\"$gte\", $lte\" \"$eq\", \"$ne\", \"$prefix\", \"$exists\"。","type":"string"},"value":{"description":"value和value_array二选一。\n- value条件值,适用于除\"$in\", \"$nin\"外的func。\n- 字段名无意义,可以传空,也可以传字段名。\n- $exists值为true/false。\n> $prefix操作只适用于string和binary类型。","format":"bson-document","type":"string"},"value_array":{"description":"\"value\"和\"value_array\"二选一。\n- \"value_array\" 条件值列表, 值用于\"$in\", \"$nin\"。","items":{"format":"bson-document","type":"string"},"type":"array"}},"required":["field","func"],"type":"object"},"single_kv_expression":{"properties":{"func":{"description":"取值:\"is_doc\", \"is_blob\", \"is_exist\", \"not_exist\"。","type":"string"}},"required":["func"],"type":"object"},"table_batch":{"description":"单个表的所有kv操作。","properties":{"kv_opers":{"description":"kv操作数组。","items":{"$ref":"#/definitions/oper_item"},"type":"array"},"table_name":{"description":"表名,仓内唯一。\n- 长度:[3, 63]\n- 取值字符限制:[a-z0-9_-]+","type":"string"}},"required":["table_name","kv_opers"],"type":"object"},"table_oper_ids":{"description":"某个表的行操作数组, 可以是多个文档的put_kv或delete_kv。","properties":{"kv_oper_ids":{"$ref":"#/definitions/kv_oper_ids","description":"kv操作数组。"},"table_name":{"description":"表名,仓内唯一。\n- 长度:[3, 63]\n- 取值字符限制:[a-z0-9_-]+","type":"string"}},"required":["table_name","kv_oper_ids"],"type":"object"},"update_blob":{"properties":{"blob_data":{"description":"二进制内容。","format":"bson-binary","type":"string"},"len":{"description":"更新内容长度。","format":"int32","type":"integer"},"offset":{"description":"value部分的偏移位置。\n> - 超过value当前size无效\n> - \"offset\"与\"len\"与\"blob_data\" 要么都带,要么都不带。","format":"int32","type":"integer"},"xattr":{"description":"属性信息。","format":"bson-binary","type":"string"}},"type":"object"},"update_fields":{"properties":{"add":{"description":"对1个或多个字段做加法运算,并更新为运算后的值。","format":"bson-document","type":"string"},"delete":{"description":"从数组中删除某个元素\n> 非数组返回失败。","format":"bson-document","type":"string"},"insert":{"description":"插入元素到数组中\n> 非数组返回失败。","format":"bson-document","type":"string"},"rmv":{"description":"删除1个或多个字段。\n- 数组元素为待删除字段名。","items":{"type":"string"},"type":"array"},"set":{"description":"新增或覆盖更新1个或多个字段的值。\n> 禁止修改sortkey的字段。","format":"bson-document","type":"string"},"update_blob":{"$ref":"#/definitions/update_blob","description":"对kv_blob有效,修改局部数据。"},"upsert":{"description":"文档不存在时,插入该完整文档。","format":"bson-document","type":"string"}},"type":"object"},"update_kv":{"properties":{"condition_expression":{"$ref":"#/definitions/condition_expression","description":"条件表达式,参见conditional小节。\n- 长度:[8,4096]"},"oper_id":{"description":"请求内的操作编码,未成功的操作返回该标识。","format":"int32","type":"integer"},"primary_key":{"description":"用户自定义的主键名及值。","format":"bson-document","type":"string"},"update_fields":{"$ref":"#/definitions/update_fields","description":"对kv_doc有效。"}},"required":["oper_id","primary_key"],"type":"object"}},"description":null,"group_id":"1d253eb51d8046a894e8b1aa21b72079","host":"kvs.cn-north-4.myhuaweicloud.com","id":"324a62ce22f946ae9868b7569f832297","info_version":"v1","method":"post","name":"BatchWriteKv","parameters":{},"paths":{"/v1/batch-write-kv":{"post":{"consumes":["application/bson"],"description":"批量写请求,其中可以携带一或多个表的不同kv的写操作,上传kv/删除kv。","operationId":"BatchWriteKv","parameters":[{"description":"仓名,全域唯一,不同租户的仓名不能相同。 \n- 格式:${prefix}-${region-code}-${account-id},其中prefix为自定义前缀,region-code为kvs集群所在的区域代码,account-id为用户的账户id\n- 取值字符限制:[a-z0-9-]+\n- 长度:[16,52]\n> \"-\"不能出现在名字头部或尾部","in":"query","name":"store_name","type":"string","x-location-cname":true},{"description":"批量写请求的请求体","in":"body","name":"BatchWriteKvRequestBody","required":true,"schema":{"$ref":"#/definitions/BatchWriteKvRequestBody"}}],"produces":["application/bson"],"responses":{"200":{"description":"表示批量写请求请求成功","schema":{"$ref":"#/definitions/BatchWriteKvResponseBody"}},"400":{"description":"BatchExceedLimit"}},"summary":"批量写请求","tags":["KV接口"],"x-request-examples-1":{"table_opers":[{"table_batch":{"kv_opers":[{"put_kv":{"kv_doc":{"filename":"test_file_3","owner":"user_3"},"oper_id":1}},{"delete_kv":{"oper_id":2,"primary_key":{"filename":"test_file_2","owner":"user_2"}}}],"table_name":"test_table_1"}}]},"x-request-examples-description-1":"批量写请求,向test_table_1表中插入和删除一个kv","x-request-examples-tags-1":"hws","x-request-examples-url-1":"POST https://{endpoint}/v1/batch-write-kv","x-support-sdk":"Y"}}},"product_short":"KVS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"批量写请求","tags":"KV接口","uri":null,"version":"2.0"}