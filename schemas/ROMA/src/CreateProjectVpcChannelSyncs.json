{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"MemberBase":{"properties":{"host":{"description":"后端服务器地址\n\n后端实例类型为ip时必填","maxLength":64,"type":"string"},"is_backup":{"default":false,"description":"是否备用节点。\n\n开启后对应后端服务为备用节点,仅当非备用节点全部故障时工作。\n\n实例需要升级到对应版本才支持此功能,若不支持请联系技术支持。","type":"boolean"},"member_group_name":{"description":"后端服务器组名称。为后端服务地址选择服务器组,便于统一修改对应服务器组的后端地址。","type":"string"},"port":{"description":"后端服务器端口","format":"int32","maximum":65535,"minimum":0,"type":"integer"},"status":{"description":"后端服务器状态\n  - 1:可用\n  - 2:不可用","enum":[1,2],"format":"int32","type":"integer"},"weight":{"description":"权重值。\n\n允许您对后端服务进行评级,权重值越大,转发到该云服务的请求数量越多。","format":"int32","maximum":10000,"minimum":0,"type":"integer"}}},"MemberGroupCreate":{"properties":{"dict_code":{"description":"VPC通道后端服务器组的字典编码\n\n支持英文,数字,特殊字符(-_.)\n\n暂不支持","maxLength":64,"minLength":3,"pattern":"([a-zA-Z0-9._-]){2,63}$","type":"string"},"member_group_name":{"description":"VPC通道后端服务器组名称","type":"string"},"member_group_remark":{"description":"VPC通道后端服务器组描述","type":"string"},"member_group_weight":{"description":"VPC通道后端服务器组权重值。\n\n当前服务器组存在服务器且此权重值存在时,自动使用此权重值分配权重。","format":"int32","maximum":100,"minimum":0,"type":"integer"},"microservice_labels":{"description":"VPC通道后端服务器组的标签,仅VPC通道类型为微服务时支持。","items":{"$ref":"#/definitions/MicroserviceLabel"},"type":"array"},"microservice_port":{"description":"VPC通道后端服务器组的端口号,仅VPC通道类型为微服务时支持。端口号为0时后端服务器组下的所有地址沿用原来负载端口继承逻辑。","example":80,"format":"int32","maximum":65535,"minimum":0,"type":"integer"},"microservice_version":{"description":"VPC通道后端服务器组的版本,仅VPC通道类型为微服务时支持。","maxLength":64,"type":"string"}},"required":["member_group_name"]},"MemberGroupInfo":{"allOf":[{"$ref":"#/definitions/MemberGroupCreate"},{"properties":{"create_time":{"description":"VPC通道后端服务器组创建时间","format":"date-time","type":"string"},"member_group_id":{"description":"VPC通道后端服务器组编号","type":"string"},"update_time":{"description":"VPC通道后端服务器组更新时间","format":"date-time","type":"string"}},"type":"object"}]},"MemberInfo":{"allOf":[{"$ref":"#/definitions/MemberBase"},{"properties":{"ecs_id":{"description":"后端云服务器的编号。\n\n后端实例类型为ecs时必填,支持英文,数字,“-”,“_”,1 ~ 64字符。","maxLength":255,"type":"string"},"ecs_name":{"description":"[后端云服务器的名称。]\n\n后端实例类型为ecs时必填,支持汉字,英文,数字,“-”,“_”,“.”,1 ~ 64字符。","maxLength":64,"type":"string"}},"type":"object"}]},"MicroServiceInfo":{"description":"微服务的响应对象","properties":{"cce_info":{"$ref":"#/definitions/MicroServiceInfoCCE","description":"暂不支持"},"create_time":{"description":"微服务创建时间","example":"2020-11-02T12:31:23.353Z","format":"date-time","type":"string"},"cse_info":{"$ref":"#/definitions/MicroServiceInfoCSE","description":"CSE基础信息"},"id":{"description":"微服务编号","example":"a802aead5122433a91ea7df2c45c2a58","type":"string"},"instance_id":{"description":"实例编号","example":"eddc4d25480b4cd6b512f270a1b8b341","type":"string"},"service_type":{"description":"微服务类型:\n- CSE:CSE微服务注册中心\n- CCE:CCE云容器引擎(暂不支持)","enum":["CSE","CCE"],"example":"CSE","type":"string"},"update_time":{"description":"微服务更新时间","example":"2020-11-02T12:31:23.353Z","format":"date-time","type":"string"}}},"MicroServiceInfoCCE":{"allOf":[{"$ref":"#/definitions/MicroServiceInfoCCEBase"},{"properties":{"cluster_name":{"description":"云容器引擎集群名称","example":"cluster001","type":"string"}},"type":"object"}],"description":"CCE微服务详细信息(暂不支持)"},"MicroServiceInfoCCEBase":{"description":"CCE云容器引擎详细信息,service_type为CCE时必填。app_name或(label_key、label_value)至少填一个,只填app_name时,相当于(label_key=‘app’、label_value=app_name值)","properties":{"app_name":{"description":"APP名称","example":"default","maxLength":64,"type":"string"},"cluster_id":{"description":"云容器引擎集群编号","example":"fde2c21c-5bd9-40f0-ad6a-81e4b6782805a","maxLength":64,"type":"string"},"label_key":{"description":"标签名","example":"default","maxLength":64,"type":"string"},"label_value":{"description":"标签值","example":"default","maxLength":64,"type":"string"},"namespace":{"description":"命名空间","example":"default","maxLength":64,"type":"string"},"workload_type":{"description":"工作负载类型\n - deployment:无状态负载\n - statefulset:有状态负载\n - daemonset:守护进程集","enum":["deployment","statefulset","daemonset"],"type":"string"}},"required":["cluster_id","namespace","workload_type"]},"MicroServiceInfoCSE":{"allOf":[{"$ref":"#/definitions/MicroServiceInfoCSEBase"},{"properties":{"cse_app_id":{"description":"微服务所属的应用","example":"default","type":"string"},"engine_name":{"description":"微服务引擎名称","example":"engine001","type":"string"},"register_address":{"description":"注册中心地址","example":"https://1.2.3.4:8888","type":"string"},"service_name":{"description":"微服务名称","example":"service001","type":"string"},"version":{"description":"微服务的版本,已废弃,通过后端服务器组中的版本承载。","example":"v1","maxLength":64,"type":"string"}},"type":"object"}],"description":"CSE微服务详细信息"},"MicroServiceInfoCSEBase":{"description":"CSE微服务详细信息,service_type为CSE时必填","properties":{"engine_id":{"description":"微服务引擎编号","example":"fde2c21c-5bd9-40f0-ad6a-81e4b6782805a","maxLength":64,"type":"string"},"service_id":{"description":"微服务编号","example":"92919f98fba80c2df13cc285c983946c90e635ff","maxLength":64,"type":"string"}},"required":["engine_id","service_id"]},"MicroserviceLabel":{"properties":{"label_name":{"description":"标签名称。\n\n以字母或者数字开头和结尾,由字母、数字、连接符('-')、下划线('_')、点号('.')组成且63个字符之内。","example":"clusterid","maxLength":63,"minLength":1,"pattern":"^[a-zA-Z0-9]$|(^[a-zA-Z0-9]([a-zA-Z0-9._-]{0,61})[a-zA-Z0-9]$)","type":"string"},"label_value":{"description":"标签值。\n\n以字母或者数字开头和结尾,由字母、数字、连接符('-')、下划线('_')、点号('.')组成且63个字符之内。","example":"c429700c-5dc4-482a-9c0e-99f6c0635113","maxLength":63,"minLength":1,"pattern":"^[a-zA-Z0-9]$|(^[a-zA-Z0-9]([a-zA-Z0-9._-]{0,61})[a-zA-Z0-9]$)","type":"string"}},"required":["label_name","label_value"]},"ProjectVpcChannelInfo":{"allOf":[{"$ref":"#/definitions/VpcBase"},{"properties":{"create_time":{"description":"VPC通道的创建时间","format":"date-time","type":"string"},"id":{"description":"VPC通道的编号","type":"string"},"instance_id":{"description":"实例编号","type":"string"},"instance_name":{"description":"实例名称","type":"string"},"member_groups":{"description":"后端云服务器组列表。","items":{"$ref":"#/definitions/MemberGroupInfo"},"type":"array"},"members":{"description":"后端实例列表。","items":{"$ref":"#/definitions/VpcMemberInfo"},"type":"array"},"microservice_info":{"$ref":"#/definitions/MicroServiceInfo"},"status":{"description":"VPC通道的状态。\n- 1:正常\n- 2:异常","enum":[1,2],"type":"integer"},"type":{"description":"vpc通道类型。\n- BUILTIN:BUILTIN通道类型\n- MICROSERVICE:微服务类型","enum":["BUILTIN","MICROSERVICE"],"example":"BUILTIN","type":"string"},"vpc_health_config":{"$ref":"#/definitions/VpcHealthConfigInfo"}},"type":"object"}]},"ProjectVpcChannelList":{"properties":{"project_vpc_channels":{"description":"项目VPC通道列表","items":{"$ref":"#/definitions/ProjectVpcChannelInfo"},"type":"array"}}},"ProjectVpcSync":{"properties":{"force_sync":{"default":false,"description":"是否强制同步,默认不强制同步","example":false,"type":"boolean"},"instance_ids":{"description":"新增关联的实例列表","example":["eea73cde015940908ae0117d67bf7330","ddd73cde017890908ae0117d67bf7330"],"items":{"type":"string"},"type":"array"},"vpc_channel_id":{"description":"VPC通道编号","type":"string"}}},"ResponseModel":{"properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误描述","type":"string"}},"required":["error_code","error_msg"]},"VpcBase":{"properties":{"balance_strategy":{"default":1,"description":"分发算法。\n- 1:加权轮询(wrr)\n- 2:加权最少连接(wleastconn)\n- 3:源地址哈希(source)\n- 4:URI哈希(uri)","enum":[1,2,3,4],"format":"int32","type":"integer"},"dict_code":{"description":"VPC通道的字典编码\n\n支持英文,数字,特殊字符(-_.)\n\n暂不支持","maxLength":64,"minLength":3,"pattern":"([a-zA-Z0-9._-]){2,63}$","type":"string"},"member_type":{"default":"ecs","description":"VPC通道的成员类型。\n- ip\n- ecs","enum":["ip","ecs"],"type":"string"},"name":{"description":"VPC通道的名称。\n\n长度为3 ~ 64位的字符串,字符串由中文、英文字母、数字、中划线、下划线组成,且只能以英文或中文开头。\n> 中文字符必须为UTF-8或者unicode编码。","pattern":"^([a-zA-Z]|[\\u4e00-\\u9fa5])([a-zA-Z0-9-_]|[\\u4e00-\\u9fa5]){2,63}$","type":"string"},"port":{"description":"VPC通道中主机的端口号。\n\n取值范围1 ~ 65535。","format":"int32","type":"integer"},"type":{"default":2,"description":"vpc通道类型,默认为服务器类型。\n- 2:服务器类型\n- 3:微服务类型","enum":[2,3],"example":2,"type":"integer"}},"required":["name","port","member_type","balance_strategy"]},"VpcHealthConfig":{"allOf":[{"$ref":"#/definitions/VpcHealthConfigBase"},{"properties":{"timeout":{"description":"超时时间:检查期间,无响应的时间,单位为秒。必须小于time_interval字段取值。","format":"int32","maximum":30,"minimum":2,"type":"integer"}},"type":"object"}],"description":"健康检查详情。","required":["timeout"]},"VpcHealthConfigBase":{"properties":{"enable_client_ssl":{"default":false,"description":"是否开启双向认证。若开启,则使用实例配置中的backend_client_certificate配置项的证书","type":"boolean"},"http_code":{"description":"检查目标HTTP响应时,判断成功使用的HTTP响应码。取值范围为100到599之前的任意整数值,支持如下三种格式:\n- 多个值,如:200,201,202\n- 一系列值,如:200-299\n- 组合值,如:201,202,210-299\nprotocol = http时必选","type":"string"},"method":{"default":"GET","description":"健康检查时的请求方法","enum":["GET","HEAD"],"type":"string"},"path":{"description":"健康检查时的目标路径。protocol = http或https时必选","type":"string"},"port":{"description":"健康检查的目标端口,缺少或port = 0时为VPC中主机的端口号。\n\n若此端口存在非0值,则使用此端口进行健康检查。","format":"int32","maximum":65535,"minimum":0,"type":"integer"},"protocol":{"description":"使用以下协议,对VPC中主机执行健康检查:\n- TCP\n- HTTP\n- HTTPS","enum":["TCP","HTTP","HTTPS"],"type":"string"},"status":{"description":"健康检查状态\n  - 1:可用\n  - 2:不可用","enum":[1,2],"format":"int32","type":"integer"},"threshold_abnormal":{"description":"异常阈值。判定VPC通道中主机异常的依据为:连续检查x失败,x为您设置的异常阈值。","format":"int32","maximum":10,"minimum":1,"type":"integer"},"threshold_normal":{"description":"正常阈值。判定VPC通道中主机正常的依据为:连续检查x成功,x为您设置的正常阈值。","format":"int32","maximum":10,"minimum":1,"type":"integer"},"time_interval":{"description":"间隔时间:连续两次检查的间隔时间,单位为秒。必须大于timeout字段取值。","format":"int32","maximum":300,"minimum":5,"type":"integer"}},"required":["protocol","threshold_normal","threshold_abnormal","time_interval"]},"VpcHealthConfigInfo":{"allOf":[{"$ref":"#/definitions/VpcHealthConfig"},{"properties":{"create_time":{"description":"创建时间","format":"date-time","type":"string"},"id":{"description":"健康检查的编号","type":"string"},"vpc_channel_id":{"description":"VPC通道的编号","type":"string"}},"type":"object"}],"description":"健康检查详情。"},"VpcMemberInfo":{"allOf":[{"$ref":"#/definitions/MemberInfo"},{"properties":{"create_time":{"description":"后端实例增加到VPC通道的时间","format":"date-time","type":"string"},"id":{"description":"后端实例对象的编号","type":"string"},"member_group_id":{"description":"后端服务器组编号","type":"string"},"vpc_channel_id":{"description":"VPC通道的编号","type":"string"}},"type":"object"}]}},"description":null,"group_id":"025d125ee4da4956af037c3315e94b30","host":"roma.cn-north-4.myhuaweicloud.com","id":"aaebdf0a9cd44bee97b9a0b123469c69","info_version":"v2","method":"post","name":"CreateProjectVpcChannelSyncs","parameters":{"apic_project_id":{"description":"项目ID,获取方式请参见API参考的“附录 > 获取项目ID”章节。","in":"path","name":"project_id","required":true,"type":"string","x-example":"73d69ae0cfcf460190522d06b60f05ad"},"apic_x_auth_token":{"description":"用户Token。通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."}},"paths":{"/v2/{project_id}/apic/vpc-channels/syncs":{"post":{"description":"同步VPC通道到多个实例。注意:实例特性vpc_name_modifiable配置为off时才可使用。","operationId":"CreateProjectVpcChannelSyncs","parameters":[{"$ref":"#/parameters/apic_project_id"},{"$ref":"#/parameters/apic_x_auth_token"},{"description":"同步VPC通道的请求体","in":"body","name":"CreateProjectVpcChannelSyncsRequestBody","required":true,"schema":{"$ref":"#/definitions/ProjectVpcSync"}}],"responses":{"201":{"description":"OK","examples":{"application/json":{"project_vpc_channels":[{"balance_strategy":1,"instance_id":"eea73cde015940908ae0117d67bf7330","instance_name":"test1","member_groups":[{"create_time":"2021-08-30T14:02:25Z","member_group_id":"ec79066c6f6f462e91ff3f17f0e43f2a","member_group_name":"test","member_group_remark":"","member_group_weight":1,"update_time":"2021-08-30T14:02:25Z"},{"create_time":"2021-08-04T06:03:47Z","member_group_id":"5b26a82cd18547f3ada54b3cfa641df9","member_group_name":"default","member_group_remark":"","member_group_weight":1,"update_time":"2021-08-04T06:03:47Z"}],"member_type":"ip","name":"VPC_demo","port":22,"type":2,"vpc_health_config":{"enable_client_ssl":false,"http_code":"200","path":"/vpc/demo","port":22,"protocol":"http","threshold_abnormal":5,"threshold_normal":2,"time_interval":10,"timeout":5}},{"balance_strategy":1,"instance_id":"ddd73cde017890908ae0117d67bf7330","instance_name":"test2","member_groups":[{"create_time":"2021-08-30T14:02:25Z","member_group_id":"ec79066c6f6f462e91ff3f17f0e43f2a","member_group_name":"test","member_group_remark":"","member_group_weight":1,"update_time":"2021-08-30T14:02:25Z"},{"create_time":"2021-08-04T06:03:47Z","member_group_id":"5b26a82cd18547f3ada54b3cfa641df9","member_group_name":"default","member_group_remark":"","member_group_weight":1,"update_time":"2021-08-04T06:03:47Z"}],"member_type":"ip","name":"VPC_demo","port":22,"type":2,"vpc_health_config":{"enable_client_ssl":false,"http_code":"200","path":"/vpc/demo","port":22,"protocol":"http","threshold_abnormal":5,"threshold_normal":2,"time_interval":10,"timeout":5}}]}},"schema":{"$ref":"#/definitions/ProjectVpcChannelList"}},"400":{"description":"Bad Request","examples":{"application/json":{"error_code":"APIG.2011","error_msg":"The request parameters must be specified,parameterName:id. Please refer to the support documentation"}},"schema":{"$ref":"#/definitions/ResponseModel"}},"401":{"description":"Unauthorized","examples":{"application/json":{"error_code":"APIG.1002","error_msg":"Incorrect token or token resolution failed"}},"schema":{"$ref":"#/definitions/ResponseModel"}},"403":{"description":"Forbidden","examples":{"application/json":{"error_code":"APIG.1005","error_msg":"No permissions to request this method"}},"schema":{"$ref":"#/definitions/ResponseModel"}},"500":{"description":"Internal Server Error","examples":{"application/json":{"error_code":"APIG.9999","error_msg":"System error"}},"schema":{"$ref":"#/definitions/ResponseModel"}}},"schemes":["https"],"summary":"项目下同步VPC通道","tags":["VPC通道管理-项目级"],"x-api-version":"v2","x-apigateway-request-type":"public","x-is-registered":"Y","x-open-region-cloud":"hc","x-order":1,"x-request-examples-1":{"instance_ids":["ddd73cde017890908ae0117d67bf7330","eea73cde015940908ae0117d67bf7330"],"vpc_channel_id":"04be10fd3a3f424fac9f603df3297a06"},"x-request-examples-description-1":"同步项目下的指定VPC通道到多个实例","x-romaconnect-mode":"huaweicloud","x-support-sdk":"Y"}}},"product_short":"ROMA","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"项目下同步VPC通道","tags":"VPC通道管理-项目级","uri":null,"version":"2.0"}