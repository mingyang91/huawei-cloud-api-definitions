{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"CreateEndpointServiceRequestBody":{"description":"创建终端节点服务接口请求结构体","properties":{"approval_enabled":{"default":true,"description":"是否需要审批。\n● false:不需要审批,创建的终端节点连接直接为accepted状态。\n● true:需要审批,创建的终端节点连接为pendingAcceptance状态,\n需要终端节点服务所属用户审核后方可使用。\n默认为true,需要审批。","type":"boolean"},"description":{"description":"描述字段,支持中英文字母、数字等字符,不支持“<”或“>”字符。\t\n描述字段,支持中英文字母、数字等字符,不支持“<”或“>”字符。","type":"string"},"enable_policy":{"default":false,"description":"是否开启终端节点策略。\n● false:不支持设置终端节点策略\n● true:支持设置终端节点策略\n默认为false","type":"boolean"},"port_id":{"description":"标识终端节点服务后端资源的ID,\n格式为通用唯一识别码(Universally Unique Identifier,下文简称UUID)。\n取值为:\n- LB类型:负载均衡器内网IP对应的端口ID。\n详细内容请参考《弹性负载均衡API参考》中的“查询负载均衡详情”。\n- VM类型:弹性云服务器IP地址对应的网卡ID。\n详细内容请参考《弹性云服务器API参考》中的“查询云服务器网卡信息”,\n详见响应消息中的“port_id”字段。\n- VIP类型:虚拟IP所在虚拟机的网卡ID(VIP类型业务已不支持,该取值类型已废弃)\n说明:\n- 创建终端节点服务时,VPC的子网网段不能与198.19.128.0/17重叠。\n- VPC路由表中自定义路由的目的地址不能与198.19.128.0/17重叠。","type":"string"},"ports":{"description":"服务开放的端口映射列表,详细内容请参见表4-10。\n同一个终端节点服务下,不允许重复的端口映射。若多个终端节点服务共用一个port_id,\n则终端节点服务之间的所有端口映射的server_port和protocol的组合不能重复,\n单次最多添加200个。","items":{"$ref":"#/definitions/PortList"},"type":"array"},"server_type":{"description":"资源类型。\n● VM:云服务器,适用于作为服务器使用。\n● VIP:虚拟IP,适用于作为虚IP场景使用。(该字段已废弃,请优先使用LB类型)\n● LB:负载均衡,适用于高访问量业务和对可靠性和容灾性要求较高的业务。","enum":["VM","VIP","LB"],"type":"string"},"service_name":{"description":"终端节点服务的名称,长度不大于16,允许传入大小写字母、数字、下划线、中划线。\n- 传入为空,存入值为regionName+.+serviceId\n- 传入不为空并校验通过,存入值为regionName+.+serviceName+.+serviceId","type":"string"},"service_type":{"default":"interface","description":"终端节点服务类型。\n仅支持将用户私有服务创建为interface类型的终端节点服务。\n终端节点服务类型包括“网关(gateway)型”和“接口(interface)型”:\n● gateway:由运维人员配置。用户无需创建,可直接使用。\n● interface:包括运维人员配置的云服务和用户自己创建的私有服务。\n其中,运维人员配置的云服务无需创建,\n用户可直接使用。\n您可以通过查询公共终端节点服务列表,\n查看由运维人员配置的所有用户可见且可连接的终端节点服务,\n并通过创建终端节点创建访问Gateway和Interface类型终端节点服务的终端节点。","type":"string"},"tags":{"description":"资源标签列表。同一个终端节点服务最多可添加10个标签。","items":{"$ref":"#/definitions/TagList"},"type":"array"},"tcp_proxy":{"default":"close","description":"用于控制将哪些信息(如客户端的源IP、源端口、marker_id等)携带到服务端。\n支持携带的客户端信息包括如下两种类型:\n● TCP TOA:表示将客户端信息插入到tcp option字段中携带至服务端。\n说明:仅当后端资源为OBS时,支持TCP TOA类型信息携带方式。\n● Proxy Protocol:表示将客户端信息插入到tcp payload字段中携带至服务端。\n仅当服务端支持解析上述字段时,该参数设置才有效。\n该参数的取值包括:\n● close:表示关闭代理协议。\n● toa_open:表示开启代理协议“tcp_toa”。\n● proxy_open:表示开启代理协议“proxy_protocol”。\n● open:表示同时开启代理协议“tcp_toa”和“proxy_protocol”。\n● proxy_vni: 关闭toa,开启proxy和vni。\n默认值为“close”。","enum":["close","toa_open","proxy_open","open","proxy_vni"],"type":"string"},"vpc_id":{"description":"终端节点服务对应后端资源所在的VPC的ID。\n详细内容请参考《虚拟私有云API参考》中的“查询VPC”,详见响应消息中的“id”字段。","type":"string"}},"required":["port_id","vpc_id","server_type","ports"],"type":"object"},"Error":{"description":"提交任务异常时返回的异常信息","properties":{"code":{"description":"任务异常错误信息编码","type":"string"},"message":{"description":"任务异常错误信息描述","type":"string"}}},"FailedRsp":{"description":"接口响应失败信息","properties":{"error":{"$ref":"#/definitions/Error"}}},"PortList":{"description":"服务开放的端口映射列表","properties":{"client_port":{"description":"终端节点访问的端口。\n终端节点提供给用户,作为访问终端节点服务的端口,范围1-65535。","type":"integer","x-maxLength":65535,"x-minLength":1},"protocol":{"default":"TCP","description":"端口映射协议,支持TCP。","enum":["TCP"],"type":"string"},"server_port":{"description":"终端节点服务的端口。\n终端节点服务绑定了后端资源,作为提供服务的端口,范围1-65535。","type":"integer","x-maxLength":65535,"x-minLength":1}}},"ServiceResp":{"description":"终端节点服务响应结构体","properties":{"approval_enabled":{"description":"是否需要审批。\n● false:不需要审批,创建的终端节点连接直接为accepted状态。\n● true:需要审批,创建的终端节点连接为pendingAcceptance状态,\n需要终端节点服务所属用户审核后方可使用。","type":"boolean"},"created_at":{"description":"终端节点服务的创建时间。\n采用UTC时间格式,格式为:YYYY-MMDDTHH:MM:SSZ","type":"string"},"description":{"description":"描述字段,支持中英文字母、数字等字符,不支持“<”或“>”字符。","type":"string"},"enable_policy":{"description":"是否开启终端节点策略。\n● false:不支持设置终端节点策略\n● true:支持设置终端节点策略\n默认为false","type":"boolean"},"id":{"description":"终端节点服务的ID,唯一标识。","type":"string"},"pool_id":{"description":"终端节点服务对应的集群id","type":"string"},"port_id":{"description":"标识终端节点服务后端资源的ID,\n格式为通用唯一识别码(Universally Unique Identifier,下文简称UUID)。\n取值为:\n● LB类型:负载均衡器内网IP对应的端口ID。\n● VM类型:弹性云服务器IP地址对应的网卡ID。\n● VIP类型:虚拟资源所在物理服务器对应的网卡ID。(该字段已废弃,请优先使用LB类型)","type":"string"},"ports":{"description":"服务开放的端口映射列表\n同一个终端节点服务下,不允许重复的端口映射。\n若多个终端节点服务共用一个port_id,\n则终端节点服务之间的所有端口映射的server_port和protocol的组合不能重复。","items":{"$ref":"#/definitions/PortList"},"type":"array"},"project_id":{"description":"项目ID","type":"string"},"server_type":{"description":"资源类型。\n● VM:云服务器。\n● VIP:虚拟IP。\n● LB:增强负载均衡型。","enum":["VM","VIP","LB"],"type":"string"},"service_name":{"description":"终端节点服务的名称。","type":"string","x-maxLength":128,"x-minLength":0},"service_type":{"description":"终端节点服务类型。\n终端节点服务类型包括“网关(gataway)型”和“接口(interface)型”:\n● gataway:由运维人员配置。用户无需创建,可直接使用。\n● interface:包括运维人员配置的云服务和用户自己创建的私有服务。\n其中,运维人员配置的云服务无需创建,用户可直接使用。\n您可以通过创建终端节点创建访问Gateway和Interface类型终端节点服务的终端节点。","type":"string"},"status":{"description":"终端节点服务的状态。\n● creating:创建中\n● available:可连接\n● failed:失败","enum":["creating","available","failed"],"type":"string"},"tags":{"description":"资源标签列表","items":{"$ref":"#/definitions/TagList"},"type":"array"},"tcp_proxy":{"description":"用于控制将哪些信息(如客户端的源IP、源端口、marker_id等)携带到服务端。\n支持携带的客户端信息包括如下两种类型:\n● TCP TOA:表示将客户端信息插入到tcp option字段中携带至服务端。\n说明:仅当后端资源为OBS时,支持TCP TOA类型信息携带方式。\n● Proxy Protocol:表示将客户端信息插入到tcp payload字段中携带至服务端。\n仅当服务端支持解析上述字段时,该参数设置才有效。\n该参数的取值包括:\n● close:表示关闭代理协议。\n● toa_open:表示开启代理协议“tcp_toa”。\n● proxy_open:表示开启代理协议“proxy_protocol”。\n● open:表示同时开启代理协议“tcp_toa”和“proxy_protocol”。\n● proxy_vni: 关闭toa,开启proxy和vni。\n默认值为“close”。","enum":["close","toa_open","proxy_open","open","proxy_vni"],"type":"string"},"updated_at":{"description":"终端节点服务的更新时间。\n采用UTC时间格式,格式为:YYYY-MMDDTHH:MM:SSZ","type":"string"},"vpc_id":{"description":"终端节点服务对应后端资源所在的VPC的ID。","type":"string"}},"type":"object"},"TagList":{"description":"标签列表,没有标签默认为空数组。","properties":{"key":{"description":"键。\n最大长度36个unicode字符。 \nkey不能为空。不能包含“=”、“*”、“<”、“>”、“\\”、“,”、“|”和“/”,且首尾字符不能为空格。","type":"string","x-maxLength":36,"x-minLength":1},"value":{"description":"值。\n每个值最大长度43个unicode字符,可以为空字符串。 \n不能包含“=”、“*”、“<”、“>”、“\\”、“,”、“|”和“/”,且首尾字符不能为空格。","type":"string","x-maxLength":43,"x-minLength":1}}}},"description":null,"group_id":"2e385073206049fd822df2ef2e7c7ce9","host":"vpcep.cn-north-4.myhuaweicloud.com","id":"f70d1429049d40868879b5c1cb489a7e","info_version":"v1","method":"post","name":"CreateEndpointService","parameters":{},"paths":{"/v1/{project_id}/vpc-endpoint-services":{"post":{"description":"创建终端节点服务,允许其他用户创建终端节点连接您创建的终端节点服务,\n使用您所提供的服务。\n说明\n该接口为异步接口,调用成功会返回200状态码,说明请求已正常下发。\n通常创建终端节点服务需要1~2分钟,可以通过查询终端节点服务详情查看创建结果。","operationId":"CreateEndpointService","parameters":[{"description":"用户Token。用户Token也就是调用获取用户Token接口的响应值, 该接口是唯一不需要认证的接口。 请求响应成功后在响应消息头(Headers)中包含的“X-Subject-Token”的值即为Token值。","in":"header","maxLength":2048,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-order":1},{"default":"application/json","description":"发送的实体的MIME类型。推荐用户默认使用application/json, 如果API是对象、镜像上传等接口,媒体类型可按照流类型的不同进行确定。","in":"header","name":"Content-Type","required":false,"type":"string","x-order":2},{"description":"项目ID,获取方法请参见获取项目ID。","in":"path","maxLength":64,"minLength":1,"name":"project_id","required":true,"type":"string","x-order":3},{"description":"创建终端节点服务接口请求结构体","in":"body","name":"CreateEndpointServiceRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateEndpointServiceRequestBody"},"x-order":4}],"responses":{"200":{"description":"服务器已成功处理了请求","examples":{"application/json":{"approval_enabled":false,"created_at":"2022-04-14T09:35:47Z","id":"4189d3c2-8882-4871-a3c2-d380272eed83","pool_id":"5289d3c2-8882-4871-a3c2-d380272eed80","port_id":"4189d3c2-8882-4871-a3c2-d380272eed88","ports":[{"client_port":8080,"protocol":"TCP","server_port":90},{"client_port":8081,"protocol":"TCP","server_port":80}],"project_id":"6e9dfd51d1124e8d8498dce894923a0d","server_type":"VM","service_name":"test123","service_type":"interface","status":"available","vpc_id":"4189d3c2-8882-4871-a3c2-d380272eed80"}},"schema":{"$ref":"#/definitions/ServiceResp"}},"400":{"description":"服务器未能处理请求","schema":{"$ref":"#/definitions/FailedRsp"}},"401":{"description":"被请求的页面需要用户名和密码","schema":{"$ref":"#/definitions/FailedRsp"}},"403":{"description":"对被请求页面的访问被禁止","schema":{"$ref":"#/definitions/FailedRsp"}},"404":{"description":"服务器无法找到被请求的页面","schema":{"$ref":"#/definitions/FailedRsp"}},"405":{"description":"请求中指定的方法不被允许","schema":{"$ref":"#/definitions/FailedRsp"}},"406":{"description":"服务器生成的响应无法被客户端所接受","schema":{"$ref":"#/definitions/FailedRsp"}},"407":{"description":"用户必须首先使用代理服务器进行验证,这样请求才会被处理","schema":{"$ref":"#/definitions/FailedRsp"}},"408":{"description":"请求超出了服务器的等待时间","schema":{"$ref":"#/definitions/FailedRsp"}},"409":{"description":"由于冲突,请求无法被完成","schema":{"$ref":"#/definitions/FailedRsp"}},"500":{"description":"请求未完成。服务异常","schema":{"$ref":"#/definitions/FailedRsp"}},"501":{"description":"请求未完成。服务器不支持所请求的功能","schema":{"$ref":"#/definitions/FailedRsp"}},"502":{"description":"请求未完成。服务器从上游服务器收到一个无效的响应","schema":{"$ref":"#/definitions/FailedRsp"}},"503":{"description":"请求未完成。系统暂时异常","schema":{"$ref":"#/definitions/FailedRsp"}},"504":{"description":"网关超时","schema":{"$ref":"#/definitions/FailedRsp"}}},"summary":"创建终端节点服务","tags":["终端节点服务功能"],"x-first-open-time":"2018-06-01","x-flow-control-group":"vpcep","x-hybridcloud":"false","x-in-cli":"","x-is-calling":"Y","x-is-registered":"Y","x-multi-tenant-flow-time":"1","x-multi-tenant-flow-value":"200","x-name":"创建终端节点服务","x-order":1,"x-request-examples-1":{"approval_enabled":false,"port_id":"4189d3c2-8882-4871-a3c2-d380272eed88","ports":[{"client_port":8080,"protocol":"TCP","server_port":90},{"client_port":8081,"protocol":"TCP","server_port":80}],"server_type":"VM","service_type":"interface","vpc_id":"4189d3c2-8882-4871-a3c2-d380272eed80"},"x-request-examples-description-1":"创建接口型终端节点服务,资源类型为VM,访问端口为8080和8081,服务端口为90和80,端口映射协议为TCP,无需审批。","x-request-examples-text-1":{"approval_enabled":false,"port_id":"4189d3c2-8882-4871-a3c2-d380272eed88","ports":[{"client_port":8080,"protocol":"TCP","server_port":90},{"client_port":8081,"protocol":"TCP","server_port":80}],"server_type":"VM","service_type":"interface","vpc_id":"4189d3c2-8882-4871-a3c2-d380272eed80"},"x-request-examples-url-1":"POST https://{endpoint}/v1/{project_id}/vpc-endpoint-services","x-scope":"Commercial","x-source":"SelfDeveloped","x-support-sdk":"Y","x-tenant-flow-time":"1","x-tenant-flow-value":"50","x-timeout":"30s","x-un-cli":"","x-version":""}}},"product_short":"VPCEP","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":{"JWTAuthorization":{"description":"APIG网关的JWT鉴权参数","in":"header","name":"Authorization","type":"apiKey"}},"summary":"创建终端节点服务","tags":"终端节点服务功能","uri":null,"version":"2.0"}