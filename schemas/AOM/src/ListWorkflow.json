{"base_path":"/v1","components":null,"consumes":"","definitions":{"Metadata":{"description":"任务节点元数据。","properties":{"configuration":{"additionalProperties":{"type":"object"},"description":"配置信息。","example":"NOdeConfiguration","type":"object"},"type":{"description":"节点类型。","example":"start,end,opeartor,foreach","maxLength":32,"minLength":1,"type":"string"}},"type":"object"},"Node":{"description":"任务节点定义。","properties":{"category":{"description":"节点类型。","example":"service","maxLength":32,"minLength":1,"type":"string"},"description":{"description":"节点描述。","example":"wad","maxLength":1024,"minLength":1,"type":"string"},"id":{"description":"节点id","example":"2ed4e082a4714e539cef77c57473fb19","maxLength":64,"minLength":1,"type":"string"},"ignore_error":{"description":"是否忽略错误","example":false,"type":"boolean"},"metadata":{"$ref":"#/definitions/Metadata","description":"元数据。"},"name":{"description":"节点名称,比如是Node。","example":1,"maxLength":64,"minLength":1,"type":"string"},"parent_node":{"description":"父亲节点的名称。","example":"parentNodeName","maxLength":64,"minLength":1,"type":"string"},"task_name":{"description":"任务名称,节点上任务的名称。","example":"CMS::ECS::runScript","maxLength":64,"minLength":1,"type":"string"}},"type":"object"},"Parameter":{"allOf":[{"$ref":"#/definitions/TaskParam"},{"properties":{"description":{"description":"参数描述。","maxLength":1000,"minLength":1,"type":"string"},"encryption":{"description":"是否加密。","example":true,"type":"boolean"},"hint":{"description":"参数提示。","maxLength":1000,"minLength":1,"type":"string"},"id":{"description":"参数id。","maxLength":64,"minLength":1,"type":"string"},"quote_param":{"description":"是否从参数库选择。","example":true,"type":"boolean"},"required":{"description":"是否为必填参数。","example":true,"type":"boolean"}},"required":["encryption","quote_param","required"],"type":"object"}],"description":"全局参数"},"ResultInfo":{"description":"调用失败时的返回值。","properties":{"error_code":{"description":"响应码。","maxLength":64,"minLength":1,"type":"string"},"error_msg":{"description":"调用失败响应信息描述。","maxLength":1024,"minLength":1,"type":"string"},"http_code":{"description":"http返回码","format":"int32","maximum":999,"minimum":0,"type":"integer"}},"required":["error_code","error_msg","http_code"],"type":"object"},"Step":{"description":"创建作业时的步骤参数","properties":{"description":{"description":"步骤说明。","maxLength":1000,"minLength":1,"type":"string"},"id":{"description":"步骤id。","maxLength":64,"minLength":1,"type":"string"},"ignore_error":{"description":"是否自动忽略错误。","example":true,"type":"boolean"},"input":{"additionalProperties":{"maxLength":9999999999999,"minLength":1,"type":"string"},"description":"步骤参数。","type":"object"},"name":{"description":"步骤名称。","maxLength":32,"minLength":1,"type":"string"},"type":{"description":"步骤类型。","example":"script,package,stop","maxLength":16,"minLength":1,"type":"string"}},"required":["ignore_error"],"type":"object"},"TaskParam":{"description":"任务参数对象。","properties":{"default_value":{"description":"参数初始值。","maxLength":40960,"minLength":1,"type":"string"},"param_group":{"description":"参数分组。","example":"ecs_instance","maxLength":32,"minLength":1,"type":"string"},"param_name":{"description":"参数名称。","example":"get_instances","pattern":"[^\\>+<;#\";&?%=']{1,64}","type":"string"},"param_type":{"description":"参数类型。","example":"STRING,LIST,HOST","maxLength":16,"minLength":1,"type":"string"}},"required":["param_name"],"type":"object"},"WorkFlowModel":{"properties":{"en-us":{"additionalProperties":{"type":"string"},"description":"英文描述","example":"","type":"object"},"zh-cn":{"additionalProperties":{"type":"string"},"description":"中文描述","example":"","type":"object"}},"type":"object"},"Workflow":{"description":"变更服务工作流工作流元数据。","properties":{"approve_id":{"description":"审批id","maxLength":64,"minLength":1,"type":"string"},"citation_urns":{"description":"工作流的引用。","example":"{“aaaaaaaa”,\"bbbbbbbbbbbbbbbbbb\"}","items":{"maxLength":256,"minLength":1,"type":"string"},"maxItems":200,"minItems":0,"type":"array"},"create_by":{"description":"工作流创人,从接口调用传入的token中获取。","example":"kaifatest","maxLength":64,"minLength":1,"type":"string"},"create_time":{"description":"工作流创建时间,为utc时间毫秒数。","example":"2021/11/11 17:45:19 GMT+","format":"int64","maximum":9999999999999,"minimum":0,"type":"integer"},"description":{"description":"工作流描述信息。","example":"this is s workFlow","maxLength":128,"minLength":1,"type":"string"},"edit_time":{"description":"编辑时间","example":0,"format":"int64","maximum":9999999999999,"minimum":0,"type":"integer"},"enterprise_project_id":{"description":"任务所属的企业项目","example":0,"maxLength":64,"minLength":1,"type":"string"},"execution_action_rules":{"description":"执行动作细粒度权限","items":{"maxLength":128,"minLength":1,"type":"string"},"maxItems":200,"minItems":0,"type":"array"},"execution_permission":{"description":"云服务权限","items":{"maxLength":128,"minLength":1,"type":"string"},"maxItems":32,"minItems":1,"type":"array"},"global_parameters":{"description":"全局参数","items":{"$ref":"#/definitions/Parameter"},"maxItems":20,"minItems":0,"type":"array"},"id":{"description":"工作流id,唯一标识,根据project_id和workflow_name生成。","example":"048cd398-27d8-4747-a46a-f45cb7906957\t","maxLength":64,"minLength":1,"type":"string"},"input":{"additionalProperties":{"type":"object"},"description":"任务执行时需要的参数列表。","example":"\"param_name\" : \"param_value\"","type":"object"},"is_delete":{"description":"逻辑删除","example":false,"type":"boolean"},"job_id":{"description":"作业id","maxLength":64,"minLength":1,"type":"string"},"job_name":{"description":"作业名称","maxLength":64,"minLength":1,"type":"string"},"last_execute_by":{"description":"任务最后一次执行人","example":"paas_apm_z00418070_01","maxLength":64,"minLength":1,"type":"string"},"last_execution_end_time":{"description":"最近一次执行结束时间,为utc时间毫秒数","example":"1637667939000","format":"int64","maximum":9999999999999,"minimum":0,"type":"integer"},"last_execution_id":{"description":"最近一次执行id,也是工作流id","example":"74c4e2a3-ddd2-4a52-bf8d-67226070f33e\t","maxLength":64,"minLength":1,"type":"string"},"last_execution_start_time":{"description":"最近一次执行开始时间,为utc时间毫秒数","example":"1637667939000","format":"int64","maximum":9999999999999,"minimum":0,"type":"integer"},"name":{"description":"工作流名称。","example":"workflowTest","maxLength":64,"minLength":1,"pattern":"[^\\\\>+<^;#\"\\s&?%='$¥@*/\\]\\[【】{}|:,.,。:‘’“、—!!~`·?《》...]{1,64}","type":"string"},"nodes":{"description":"任务节点","items":{"$ref":"#/definitions/Node"},"maxItems":20,"minItems":1,"type":"array"},"output":{"description":"任务输出","maxLength":40960,"minLength":1,"type":"string"},"project_id":{"description":"functiongraph返回的PROJECT_ID","example":"a0a12b069ab4491185d7cf26c3e86ada","maxLength":32,"minLength":1,"type":"string"},"quote":{"description":"引用,参数引用","example":["ssxsss","ccccccccccc"],"items":{"maxLength":256,"minLength":1,"type":"string"},"maxItems":999,"minItems":1,"type":"array"},"service_name":{"description":"服务名称","maxLength":64,"minLength":1,"type":"string"},"service_scenario":{"description":"服务场景分类","maxLength":64,"minLength":1,"type":"string"},"status":{"description":"任务状态,包含success,fail,executing","example":"successfail,executing","maxLength":16,"minLength":1,"type":"string"},"steps":{"description":"任务步骤","items":{"$ref":"#/definitions/Step"},"maxItems":10,"minItems":1,"type":"array"},"tags":{"additionalProperties":{"maxLength":20,"minLength":0,"type":"string"},"description":"标签键和值列表,标签键值对数量范围是0至20。","example":"testCMS=testCMS","pattern":"[^\\>+<^;#\";\\s;&?%='$¥@*/\\]\\[【】{}|:,.,。;:‘’“、——!!~`·/??《》......]{1,20}","type":"object"},"task_status":{"description":"任务状态","example":"not_started","maxLength":32,"minLength":1,"type":"string"},"task_type":{"description":"任务类型","example":"package,script,job,cloud,standard,customize","maxLength":16,"minLength":1,"type":"string"},"template_i18n":{"$ref":"#/definitions/WorkFlowModel","description":"任务国际化字段,包含中英文描述"},"template_id":{"description":"模板id","maxLength":64,"minLength":1,"type":"string"},"template_name":{"description":"模板名称。","example":"templateNameTest","maxLength":64,"minLength":1,"type":"string"},"trigger_id":{"description":"触发器id","maxLength":64,"minLength":1,"type":"string"},"trigger_status":{"description":"触发器状态","maxLength":64,"minLength":1,"type":"string"},"type":{"description":"工作流类型,可以为cron、manual","example":"cron,manual","maxLength":16,"minLength":1,"type":"string"},"update_by":{"description":"工作流更新人,从接口调用传入的token中获取。","example":"kaifatest","maxLength":64,"minLength":1,"type":"string"},"update_time":{"description":"工作流更新时间,为utc时间毫秒数。","example":"2021/11/11 17:45:19 GMT+","format":"int64","maximum":9999999999999,"minimum":0,"type":"integer"},"workflow_id":{"description":"functiongraph返回的WORKFLOW_ID","example":"9c590539fc52fb18a3ec4d8955482800af5550e17d65d4dc348fa03a0dcbca77","maxLength":64,"minLength":1,"type":"string"}},"required":["name"],"type":"object"},"WorkflowList":{"description":"工作流列表。","properties":{"elements":{"description":"工作流详情集合。","example":[{"citation_urns":["string"],"create_by":"string","create_time":"integer","description":"string","id":"string","input":{"< * >":{}},"last_execution_end_time":"string","last_execution_id":"string","last_execution_start_time":"string","name":"string","param_name":"string","quote":["string"],"status":"string","tags":{},"template_i18n":{"en-us":{"description":"string","name":"string"},"zh-cn":{"description":"string","name":"string"}},"template_name":"string","type":"string","update_by":"string","update_time":"long"},{"citation_urns":["string"],"create_by":"string","create_time":"integer","description":"string","id":"string","input":{"< * >":{}},"last_execution_end_time":"string","last_execution_id":"string","last_execution_start_time":"string","name":"string","param_name":"string","quote":["string"],"status":"string","tags":{},"template_i18n":{"en-us":{"description":"string","name":"string"},"zh-cn":{"description":"string","name":"string"}},"template_name":"string","type":"string","update_by":"string","update_time":"long"}],"items":{"$ref":"#/definitions/Workflow"},"maxItems":9999999,"minItems":0,"type":"array"},"total_elements":{"description":"总数","format":"int64","maximum":99999999,"minimum":0,"type":"integer"}},"type":"object"},"WorkflowQueryParam":{"description":"查询工作流列表。","properties":{"create_by":{"description":"工作流创建人。","example":"kafatest","maxLength":64,"minLength":1,"type":"string"},"enterprise_project_id":{"description":"企业项目id。","example":"xxxxxxxxxxxxxxx","maxLength":64,"minLength":1,"type":"string"},"page":{"description":"查询当前的页数,默认值为0。","example":1,"maximum":9999999,"minimum":1,"type":"integer"},"search":{"description":"搜索内容,可以针对工作流名称和描述内容进行搜索。","example":"searchTest","maxLength":64,"minLength":1,"type":"string"},"search_time_end":{"description":"时间范围查询的结束时间。","format":"int64","maximum":9999999999999,"minimum":0,"type":"integer"},"search_time_start":{"description":"时间范围查询的开始时间。","format":"int64","maximum":9999999999999,"minimum":0,"type":"integer"},"size":{"description":"查询当前页的大小,默认值为10。","example":100,"maximum":100,"minimum":1,"type":"integer"},"sort_field":{"description":"排序字段,取值[\"create_time\",\"last_execution_start_time\",\"update_time\"]。","example":"create_time,last_execution_start_time,update_time","maxLength":64,"minLength":1,"type":"string"},"sort_type":{"description":"排序类型,取值[\"ASC\",\"DESC\"]。","example":"DESC,ASC","maxLength":16,"minLength":1,"type":"string"},"status":{"description":"任务的状态 [\"success\",\"fail\",\"executing\",\"cancel\",\"waitExecute\",\"waitApproval\",\"approvalFailed\",\"pausing\",\"canceling\"]","maxLength":16,"minLength":1,"type":"string"},"tags":{"additionalProperties":{"maxLength":10,"minLength":0,"type":"string"},"description":"工作流标签,最多支持10个。","example":"aa=aaa","type":"object"},"type":{"description":"工作流分类,可以取值[\"cron\",\"event\",\"manual\"]。","example":"cron,event,manual","maxLength":16,"minLength":1,"type":"string"}},"required":["sort_field","sort_type"],"type":"object"}},"description":null,"group_id":"ac32153cf89a435d96dd423fdce82920","host":"aom.cn-north-4.myhuaweicloud.com","id":"8fb09248671c42fca82de97f547583eb","info_version":"v1","method":"post","name":"ListWorkflow","parameters":{},"paths":{"/{project_id}/cms/workflow-list":{"post":{"consumes":["application/json"],"description":"该接口可返回已经创建的任务列表,可按任务名称,任务状态,任务类型,执行人,更新时间为查询条件分页查询任务。(注:接口目前开放的region为:华北-北京四,华东-上海一,华东-上海二,华南-广州)。","operationId":"ListWorkflow","parameters":[{"description":"租户从IAM申请到的projectid,一般为32位字符串。","in":"path","maxLength":32,"minLength":32,"name":"project_id","pattern":"^[\\w-]{0,64}$","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},{"description":"从IAM服务获取的用户Token。","in":"header","maxLength":40960,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."},{"description":"指定类型为application/json。","in":"header","maxLength":32,"minLength":1,"name":"Content-Type","required":true,"type":"string"},{"description":"查询工作流实体。","in":"body","name":"ListWorkflowRequestBody","required":true,"schema":{"$ref":"#/definitions/WorkflowQueryParam"}}],"produces":["application/json"],"responses":{"200":{"description":"请求响应成功,返回任务列表。","examples":{"application/json":{"elements":[{"citation_urns":[],"create_by":"xxxx","create_time":16000000000,"description":"","edit_time":0,"enterprise_project_id":"0","execution_action_rules":["xxxxxxx","xxxxxxx"],"execution_permission":["xxxxxxx","xxxxxx"],"id":"xxxxxx","input":{"approve":{"group":"approve","need_approve":"false"},"get_instances":{"ecs_id_list":"[xxxxxxx]","frontend_info":"{xxxxxx}","group":"ecs_instance","type":"cmdb_manual"},"package":{"cmd_user":"xxxxx","group":"package","install_file_dir":"xxxxx","install_script":"xxxx","operate_type":"install","package_basic_id":"xxxxxx","package_name":"xxxxx","package_version_id":"xxxxxx","plat_form":"Linux","pre_install_script":"","software_list":"[xxxxxxx]","time_out":"7200","un_install_script":"","version_number":"1"},"project_id":"xxxxxxx","rate_control":{"group":"rate_control","max":"0","timeDelay":"0"},"region_id":"cn-north-7"},"is_delete":false,"last_execute_by":"xxxxxx","last_execution_end_time":1600000000,"last_execution_id":"xxxxxx","last_execution_start_time":1600000000,"name":"xxxxxx","nodes":[{"category":"service","description":"download obs plug and install plug","id":"xxxxxx","ignore_error":true,"metadata":{"configuration":{"dataInputPath":"","dataOutputPath":"","dataResultsPath":"","func_app":"CMS","func_urn":"xxxxxxx","func_version":"latest","parameters":[{"default":"","format":"","isEditor":false,"key":"properties.cmd_user","showFormat":false,"value":"root"},{"default":"","format":"","isEditor":false,"key":"properties.software_list","showFormat":false,"value":"[xxxxxx]"},{"default":"","format":"","isEditor":false,"key":"properties.pre_install_script","showFormat":false,"value":""},{"default":"","format":"","isEditor":false,"key":"properties.operate_type","showFormat":false,"value":"install"},{"default":"","format":"","isEditor":false,"key":"properties.un_install_script","showFormat":false,"value":""},{"default":"","format":"","isEditor":false,"key":"properties.version_number","showFormat":false,"value":"1"},{"default":"","format":"","isEditor":false,"key":"properties.time_out","showFormat":false,"value":"7200"},{"default":"","format":"","isEditor":false,"key":"properties.install_script","showFormat":false,"value":"xxxx"},{"default":"","format":"","isEditor":false,"key":"properties.package_version_id","showFormat":false,"value":"xxxxxx"},{"default":"","format":"","isEditor":false,"key":"properties.package_basic_id","showFormat":false,"value":"xxxxxx"},{"default":"","format":"","isEditor":false,"key":"properties.package_name","showFormat":false,"value":"xxxxx"},{"default":"","format":"","isEditor":false,"key":"properties.install_file_dir","showFormat":false,"value":"xxxx"},{"default":"","format":"","isEditor":false,"key":"properties.plat_form","showFormat":false,"value":"Linux"},{"default":"","format":"","isEditor":false,"key":"properties.group","showFormat":false,"value":"package"},{"default":"","format":"","isEditor":false,"key":"properties.project_id","showFormat":false,"value":"xxxxxx"},{"default":"","format":"","isEditor":false,"key":"properties.region_id","showFormat":false,"value":"cn-north-4"},{"default":"","format":"","isEditor":false,"key":"properties.frontend_info","showFormat":false,"value":"{xxxxxx}"},{"default":"","format":"","isEditor":false,"key":"properties.ecs_id_list","showFormat":false,"value":"[xxxxxx]"},{"default":"","format":"","isEditor":false,"key":"properties.type","showFormat":false,"value":"cmdb_manual"},{"default":"","format":"","isEditor":false,"key":"properties.group","showFormat":false,"value":"ecs_instance"},{"default":"","format":"","isEditor":false,"key":"properties.max","showFormat":false,"value":"0"},{"default":"","format":"","isEditor":false,"key":"properties.timeDelay","showFormat":false,"value":"0"},{"default":"","format":"","isEditor":false,"key":"properties.group","showFormat":false,"value":"rate_control"},{"default":"","format":"","isEditor":false,"key":"properties.executionId","showFormat":false,"value":"$.executionId"},{"default":"","format":"","isEditor":false,"key":"properties.workflowId","showFormat":false,"value":"xxxxxxx"},{"default":"","format":"","isEditor":false,"key":"properties.cmsTaskName2Distribute","showFormat":false,"value":"CMS::ECS::Package"},{"default":"","format":"","isEditor":false,"key":"properties.cmsAccessPodLb","showFormat":false,"value":"xxxxxx"},{"default":"","format":"","isEditor":false,"key":"properties.workflowType","showFormat":false,"value":"manual"},{"default":"","format":"","isEditor":false,"key":"properties.nodeId","showFormat":false,"value":"package-manipulation"}],"validator":true},"type":"operation"},"name":"package","task_name":"CMS::ECS::Package"}],"project_id":"xxxxxx","quote":[],"status":"fail","steps":[],"tags":{},"task_type":"package","template_i18n":{"en-us":{"description":"download install plug or uninstall plug","name":"Package"},"zh-cn":{"description":" ","name":"文件管理"}},"template_id":"CMS::ECS::Package","template_name":"CMS::ECS::Package","type":"manual","update_time":1600000000}],"total_elements":1}},"schema":{"$ref":"#/definitions/WorkflowList"}},"400":{"description":"BadRequest。非法请求。建议直接修改该请求,不要重试该请求。","examples":{"application/json":{"error_code":"AOM.31001302","error_msg":"Invalid input parameter.","http_code":400}},"schema":{"$ref":"#/definitions/ResultInfo"}},"401":{"description":"Unauthorized。在客户端提供认证信息后,返回该状态码,表明服务端指出客户端所提供的认证信息不正确或非法。","examples":{"application/json":{"error_code":"AOM.31009003","error_msg":"auth failed.","http_code":401}},"schema":{"$ref":"#/definitions/ResultInfo"}},"500":{"description":"InternalServerError 表明服务端能被请求访问到,但是不能理解用户的请求。","examples":{"application/json":{"error_code":"AOM.31001305","error_msg":"workflow internal server error.","http_code":500}},"schema":{"$ref":"#/definitions/ResultInfo"}}},"summary":"查询任务列表","tags":["自动化运维"],"x-is-registered":"Y","x-open-region-cloud":"hws","x-order":11,"x-request-examples-1":{"create_by":"xxx","enterprise_project_id":"0","page":0,"search":"","search_time_end":160000000000,"search_time_start":160000000000,"size":10,"sort_field":"update_time","sort_type":"DESC","status":"xxx","tags":{},"type":"manual"},"x-request-examples-description-1":"可指定name为xxx、last_execute_by为xxx、status为xxx、task_type为xxx、search_time_start为1600060125000的查询参数用于查询任务列表。\n","x-request-examples-text-1":{"create_by":"xxx","enterprise_project_id":"0","page":0,"search":"","search_time_end":160000000000,"search_time_start":160000000000,"size":10,"sort_field":"update_time","sort_type":"DESC","status":"xxx","tags":{},"type":"manual"},"x-request-examples-url-1":"https://{Endpoint}/v1/{project_id}/cms/workflow-list","x-support-sdk":"Y"}}},"product_short":"AOM","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询任务列表","tags":"自动化运维","uri":null,"version":"2.0"}