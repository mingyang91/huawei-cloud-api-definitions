{"base_path":"/","components":null,"consumes":"","definitions":{"AlarmNotification":{"description":"告警规则通知模块。","properties":{"bind_notification_rule_id":{"description":"告警行动策略id。\n- 当notification_enable为true时,填告警行动策略id\n- 当notification_enable为false时,填“”","type":"string"},"notification_enable":{"description":"是否启用告警行动规则。\n- 当通知类型为“direct”时,填true\n- 当通知类型为“alarm_policy”时,填false","type":"boolean"},"notification_type":{"description":"通知类型。\n- “direct”:直接告警\n- “alarm_policy”:告警降噪","enum":["direct","alarm_policy"],"type":"string"},"notify_frequency":{"description":"通知频率\n- 当通知类型为“alarm_policy”时,填“-1”\n- 当通知类型为“direct”时,\n   - “0”:只告警一次\n   - “300”:每5分钟\n   - “600”:每10分钟\n   - “900”:每15分钟\n   - “1800”:每30分钟\n   - “3600”:每1小时\n   - “10800”:每3小时\n   - “21600”:每6小时\n   - “43200”:每12小时\n   - “86400”:每天","format":"int32","type":"integer"},"notify_resolved":{"description":"告警解决是否通知。\n- true:通知\n- false:不通知","enum":[true,false],"example":"","type":"boolean"},"notify_triggered":{"description":"告警触发是否通知。\n- true:通知\n- false:不通知","enum":[true,false],"example":"","type":"boolean"},"route_group_enable":{"description":"启用分组规则。\n- 当通知类型为“alarm_policy”时:true\n- 当通知类型为“direct”时:false","enum":[true,false],"type":"boolean"},"route_group_rule":{"description":"分组规则名称。\n- 当route_group_enable 为true时,填分组规则名称\n- 当route_group_enable 为false时,填“”","type":"string"}},"required":["notification_type","route_group_enable","route_group_rule"],"type":"object"},"AlarmParamForV4Db":{"properties":{"alarm_create_time":{"description":"告警规则创建时间。","format":"int64","type":"integer"},"alarm_notifications":{"$ref":"#/definitions/AlarmNotification","description":"告警规则通知模块。"},"alarm_rule_description":{"description":"告警规则描述。","type":"string"},"alarm_rule_enable":{"description":"是否启用。","type":"boolean"},"alarm_rule_id":{"description":"告警规则id。","format":"int64","type":"integer"},"alarm_rule_name":{"description":"告警规则名称。","type":"string"},"alarm_rule_status":{"description":"告警状态。\n- “OK”:正常\n- “alarm”:超限阈值\n- “Effective”:生效中\n- “Invalid”:停用中","example":"OK,alarm,Effective,Invalid","type":"string"},"alarm_rule_type":{"description":"规则类型。\n- “metric”:指标告警规则\n- “event”:事件告警规则","enum":["metric","event"],"type":"string"},"alarm_update_time":{"description":"告警规则修改时间。","format":"int64","type":"integer"},"enterprise_project_id":{"description":"企业项目id。","type":"string"},"event_alarm_spec":{"$ref":"#/definitions/EventAlarmSpec","description":"事件类告警结构。"},"metric_alarm_spec":{"$ref":"#/definitions/MetricAlarmSpec","description":"指标类告警结构。"},"prom_instance_id":{"description":"Prometheus实例id。","type":"string"},"user_id":{"description":"用户id。","type":"string"}},"required":["alarm_create_time","alarm_update_time","alarm_rule_name","alarm_rule_id","enterprise_project_id","alarm_rule_description","alarm_rule_enable","alarm_rule_status","alarm_rule_type","alarm_notifications"],"type":"object"},"AlarmTags":{"properties":{"auto_tags":{"description":"自动标签。","items":{"type":"string"},"type":"array"},"custom_annotations":{"description":"告警标注。","items":{"type":"string"},"type":"array"},"custom_tags":{"description":"自定义标签。","items":{"type":"string"},"type":"array"}},"type":"object"},"ApiException":{"properties":{"error_code":{"description":"错误码","example":"AOM.02007102","maxLength":12,"minLength":12,"type":"string"},"error_msg":{"description":"错误信息","example":"this Threshold has been existed","maxLength":1024,"minLength":0,"type":"string"},"error_type":{"description":"错误类型","example":"BAD_REQUEST","maxLength":128,"minLength":0,"type":"string"},"trace_id":{"description":"请求id","example":"8fb508e9e31b44279016f708e1c60e4c","maxLength":32,"minLength":32,"type":"string"}},"type":"object"},"CmdbInfo":{"properties":{"app_id":{"description":"应用id。","type":"string"},"node_ids":{"description":"节点信息列表。","items":{"$ref":"#/definitions/NodeInfo"},"type":"array"}},"type":"object"},"EventAlarmSpec":{"description":"事件类告警结构。","properties":{"alarm_rule_template_bind_enable":{"default":false,"description":"是否绑定告警规则模版(废弃)。","type":"boolean"},"alarm_rule_template_id":{"default":"“”","description":"告警规则模版id(废弃)。","type":"string"},"alarm_source":{"description":"告警规则来源。\n- “systemEvent”:系统事件\n- “customEvent”:自定义事件","enum":["systemEvent","customEvent"],"type":"string"},"event_source":{"description":"告警来源。\n- “RDS”\n- “EVS”\n- “CCE”\n- “LTS”\n- “AOM”","type":"string"},"monitor_objects":{"description":"监控对象列表。键值对形式,键值为:\n- “event_type”:通知类型\n- “event_severity”:告警级别\n- “event_name”:事件名称\n- “namespace”:命名空间\n- “clusterId”:集群id\n- “customField”:用户自定义字段","items":{"additionalProperties":{"type":"string"},"description":"监控对象。","type":"object"},"type":"array"},"trigger_conditions":{"description":"触发条件。","items":{"$ref":"#/definitions/EventTriggerCondition"},"type":"array"}},"type":"object"},"EventTriggerCondition":{"properties":{"aggregation_window":{"description":"统计周期。单位为秒,例如 1小时 填“3600”,当trigger_type为“immediately”时 不填。","format":"int64","type":"integer"},"event_name":{"description":"事件名称。","type":"string"},"frequency":{"description":"事件类告警频率。当trigger_type为“immediately”时 不填。\n- “0”:只告警一次\n- “300”:每5分钟\n- “600”:每10分钟:\n- “900”:每15分钟:\n- “1800”:每30分钟:\n- “3600”:每1小时:\n- “10800”:每3小时:\n- “21600”:每6小时:\n- “43200”:每12小时:\n- “86400”:每天:","type":"string"},"operator":{"description":"判断条件:“>”,“<”,“=”,“>=”,“<=”,当trigger_type为“immediately”时 不填。","type":"string"},"thresholds":{"additionalProperties":{"format":"int32","type":"integer"},"description":"键值对形式,键为告警级别,值为累计次数,当trigger_type为“immediately”时 值为空。","type":"object"},"trigger_type":{"description":"触发方式:\n- “immediately”:立即触发\n- “accumulative”:累计触发","enum":["immediately","accumulative"],"type":"string"}},"type":"object"},"MetricAlarmSpec":{"description":"指标类告警结构。","properties":{"alarm_rule_template_bind_enable":{"default":false,"description":"是否绑定告警规则模版(废弃)。","type":"boolean"},"alarm_rule_template_id":{"default":"“”","description":"告警规则模版id(废弃)。","type":"string"},"alarm_tags":{"description":"告警标签。","items":{"$ref":"#/definitions/AlarmTags"},"type":"array"},"monitor_objects":{"description":"监控对象列表。","items":{"additionalProperties":{"type":"string"},"description":"监控对象。","type":"object"},"type":"array"},"monitor_type":{"description":"监控类型。\n- “all_metric”:全量指标\n- “promql”:PromQL\n- “resource”:(日落)资源类型","enum":["all_metric","promql","resource"],"type":"string"},"no_data_conditions":{"description":"无数据处理。","items":{"$ref":"#/definitions/NoDataCondition"},"type":"array"},"recovery_conditions":{"$ref":"#/definitions/RecoveryCondition","description":"告警恢复条件。"},"trigger_conditions":{"description":"触发条件。","items":{"$ref":"#/definitions/TriggerCondition"},"type":"array"}},"required":["monitor_type","alarm_tags","recovery_conditions","trigger_conditions"],"type":"object"},"NoDataCondition":{"properties":{"no_data_alert_state":{"description":"数据不足时,阈值规则的状态。\n- “no_data”:数据不足并发送通知\n- “alerting”:告警\n- “ok”:正常\n- “pre_state”:保持上一个状态","enum":["no_data","alerting","ok","pre_state"],"example":"","type":"string"},"no_data_timeframe":{"description":"无数据周期的个数。","format":"int32","type":"integer"},"notify_no_data":{"description":"数据不足是否通知。","type":"boolean"}},"type":"object"},"NodeInfo":{"properties":{"node_id":{"description":"节点id。","type":"string"},"node_type":{"description":"节点类型。","type":"string"}},"type":"object"},"QueryAlarmRulesV4Response":{"properties":{"alarm_rules":{"description":"告警规则列表。","items":{"$ref":"#/definitions/AlarmParamForV4Db"},"type":"array"},"count":{"description":"告警规则数量。","format":"int32","type":"integer"},"metadata":{"description":"元数据信息。","type":"object"}},"required":["alarm_rules","metadata","count"],"type":"object"},"RecoveryCondition":{"properties":{"recovery_timeframe":{"description":"告警恢复周期的个数。","format":"int32","type":"integer"}},"type":"object"},"TriggerCondition":{"properties":{"aggregate_type":{"description":"聚合方式。\n- “by”:不分组\n- “avg”\n- “max”\n- “min”\n- “sum”","enum":["by","avg","max","min","sum"],"type":"string"},"aggregation_type":{"description":"统计方式:\n- average\n- minimum\n- maximum\n- sum\n- sampleCount","type":"string"},"aggregation_window":{"description":"统计周期。\n- “15s”\n- “30s”\n- “1m”\n- “5m”\n- “15m”\n- “1h”","type":"string"},"aom_monitor_level":{"description":"监控层级。","type":"string"},"cmdb":{"$ref":"#/definitions/CmdbInfo","description":"cmdb信息。"},"expression":{"description":"混合运算的表达式。","type":"string"},"metric_labels":{"description":"指标维度。","items":{"type":"string"},"type":"array"},"metric_name":{"description":"指标名称。","type":"string"},"metric_namespace":{"description":"指标命名空间。","type":"string"},"metric_query_mode":{"description":"指标查询模式。\n- “AOM”:AOM原生\n- “PROM”:AOM Prometheus\n- “NATIVE_PROM”:原生Prometheus","enum":["AOM","PROM","NATIVE_PROM"],"type":"string"},"metric_statistic_method":{"description":"当配置方式为全量指标时可选择的指标运算方式。\n- “single”:单个指标进行运算\n- “mix”:多个指标进行混合运算","enum":["single","mix"],"type":"string"},"metric_unit":{"description":"指标单位。","type":"string"},"mix_promql":{"description":"混合运算的promQL。","type":"string"},"operator":{"description":"判断条件:“>”,“<”,“=”,“>=”,“<=”","type":"string"},"promql":{"description":"Prometheus语句。","type":"string"},"promql_expr":{"description":"Prometheus语句模板。","items":{"type":"string"},"type":"array"},"promql_for":{"description":"Prometheus原生监控时长。","type":"string"},"query_match":{"description":"查询筛选条件。","type":"string"},"query_param":{"description":"查询参数","type":"string"},"thresholds":{"additionalProperties":{"type":"string"},"description":"键值对形式,键为告警级别,值为告警阈值","type":"object"},"trigger_interval":{"description":"检查频率周期。\n- 当trigger_type 为“HOURLY”时,填“”\n- 当trigger_type为“DAILY”时,格式为:“小时” 例如 每天凌晨三点\"03:00\"\n- 当trigger_type为“WEEKLY”时,格式为:“星期 小时”例如每周一凌晨三点 “1 03:00”\n- 当trigger_type为“CRON”时,格式为 标准CRON表达式\n- 当trigger_type为“FIXED_RATE”时,秒的取值为15s,30s,分钟为 1~59,小时为 1~24。例如:“15s”,“30s”,“1min”,“1h”","type":"string"},"trigger_times":{"description":"连续周期个数。","format":"int32","type":"integer"},"trigger_type":{"description":"触发频率的类型:\n- “FIXED_RATE”:固定间隔\n- “HOURLY”:每小时\n- “DAILY”:每天\n- “WEEKLY”:每周\n- “CRON”:Cron表达式","enum":["FIXED_RATE","HOURLY","DAILY","WEEKLY","CRON"],"type":"string"}},"required":["metric_query_mode","metric_namespace","metric_name","metric_unit","metric_labels","promql","query_param"],"type":"object"}},"description":null,"group_id":"ac32153cf89a435d96dd423fdce82920","host":"aom.cn-north-4.myhuaweicloud.com","id":"01c1ff9d96534d27ae4a74f4b97b4008","info_version":"v2","method":"get","name":"ListMetricOrEventAlarmRule","parameters":{},"paths":{"/v4/{project_id}/alarm-rules":{"get":{"description":"查询AOM2.0指标类或者事件类告警规则列表。(注:接口目前开放的region为:华东-上海一)","operationId":"ListMetricOrEventAlarmRule","parameters":[{"description":"租户从IAM申请到的projectid,一般为32位字符串。","in":"path","name":"project_id","required":true,"type":"string"},{"description":"告警规则名称。","in":"query","name":"name","required":false,"type":"string"},{"description":"从IAM服务获取的用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"指定类型为application/json。","in":"header","name":"Content-Type","required":true,"type":"string"},{"description":"用于限制本次返回的结果数据条数。","in":"query","maximum":1000,"minimum":1,"name":"limit","required":false,"type":"string"},{"description":"分页查询起始位置,为非负整数。","in":"query","name":"offset","required":false,"type":"string"},{"description":"根据告警规则名称或者告警创建时间排序。\n- alarm_rule_name.asc\n- alarm_create_time.desc","in":"query","name":"sort_by","required":false,"type":"string"},{"description":"事件告警规则事件来源。\n- “RDS”\n- “EVS”\n- “CCE”\n- “LTS”\n- “AOM”","in":"query","name":"event_source","required":false,"type":"string"},{"description":"事件告警级别。\n- “Critical\"\n- “Major”\n- “Minor”\n- “Info”","in":"query","name":"event_severity","required":false,"type":"string"},{"description":"告警规则状态。\n- “OK”:正常\n- “alarm”:超限阈值\n- “Effective”:生效中\n- “Invalid”:停用中","enum":["OK","alarm","Effective","Invalid"],"in":"query","name":"alarm_rule_status","required":false,"type":"string"},{"description":"告警规则类型。\n- “metric”:指标告警规则\n- “event”:事件告警规则","enum":["metric","event"],"in":"query","name":"alarm_rule_type","required":false,"type":"string"},{"description":"Prometheus实例id。","in":"query","name":"prom_instance_id","required":false,"type":"string"},{"description":"绑定的告警行动规则名称。","in":"query","name":"bind_notification_rule_id","required":false,"type":"string"},{"description":"CCE集群id。","in":"query","name":"related_cce_clusters","required":false,"type":"string"},{"description":"企业项目id。 \n- 查询单个企业项目下实例,填写企业项目id。 \n- 查询所有企业项目下实例,填写“all_granted_eps”。","in":"header","name":"Enterprise-Project-Id","required":false,"type":"string"}],"responses":{"200":{"description":"OK 请求响应成功。","examples":{"application/json":{"alarm_rules":[{"alarm_create_time":1713929265429,"alarm_notifications":{"bind_notification_rule_id":"aom_notification_rule","notification_enable":true,"notification_type":"direct","notify_frequency":-1,"notify_resolved":false,"notify_triggered":false,"route_group_enable":false,"route_group_rule":""},"alarm_rule_description":"","alarm_rule_enable":true,"alarm_rule_id":0,"alarm_rule_name":"aom_alarm_rule","alarm_rule_status":"Effective","alarm_rule_type":"event","alarm_update_time":0,"enterprise_project_id":"0","event_alarm_spec":{"alarm_rule_template_bind_enable":false,"alarm_rule_template_id":"","alarm_source":"systemEvent","event_source":"CCE","monitor_objects":[{"clusterId":"a4****6b-f**9-1**e-a**d-02****10***a","event_type":"event"}],"trigger_conditions":[{"aggregation_window":300,"event_name":"","frequency":"1","operator":">=","thresholds":{"Critical":2},"trigger_type":"immediately"}]},"user_id":"2a****56****48****73****1b****cf"},{"alarm_create_time":1711458243395,"alarm_notifications":{"bind_notification_rule_id":"","notification_enable":false,"notification_type":"direct","notify_frequency":0,"notify_resolved":false,"notify_triggered":false,"route_group_enable":false,"route_group_rule":""},"alarm_rule_description":"","alarm_rule_enable":false,"alarm_rule_id":1,"alarm_rule_name":"aom_alarm_rule_1","alarm_rule_status":"Invalid","alarm_rule_type":"metric","alarm_update_time":0,"enterprise_project_id":"0","metric_alarm_spec":{"alarm_rule_template_bind_enable":false,"alarm_rule_template_id":"","alarm_tags":[{"auto_tags":[],"custom_annotations":[],"custom_tags":[]}],"monitor_objects":[],"monitor_type":"all_metric","no_data_conditions":[{"no_data_timeframe":0,"notify_no_data":false}],"recovery_conditions":{"recovery_timeframe":1},"trigger_conditions":[{"aggregate_type":"by","aggregation_type":"average","aggregation_window":"30s","aom_monitor_level":"","cmdb":{"app_id":"","node_ids":[]},"expression":"","metric_labels":[],"metric_name":"container_memory_rss","metric_namespace":"","metric_query_mode":"PROM","metric_statistic_method":"single","metric_unit":"","mix_promql":"","operator":">","promql":"label_replace(container_memory_rss{node=\"172.**.**.206\"},\"__name__\",\"container_memory_rss\",\"\",\"\") or label_replace(avg_over_time(container_memory_rss{node=\"172.**.**.206\"}[29999ms]),\"__name__\",\"container_memory_rss\",\"\",\"\")","promql_for":"1m","query_match":"[{\"conditionList\":[{\"name\":\"172.**.**.206\"},{\"name\":\"172.**.**.133\"}],\"addMode\":\"first\",\"conditionValue\":[{\"name\":\"172.**.**.206\"}],\"id\":\"first\",\"conditionCompare\":\"=\",\"dimension\":\"node\"}]","query_param":{"apmMetricReg":"","code":"a"},"thresholds":{"Critical":"1"},"trigger_interval":"15s","trigger_times":1,"trigger_type":"FIXED_RATE"}]},"prom_instance_id":"90e***88-1**4-4**9-9**3-1f*******cd3","user_id":"2a****56****48****73****1b****cf"}],"count":29,"metadata":{"alarm_rule_template_id":[],"bind_notification_rule_id":["aom_notification_rule","1","00********qq","00*****3","m***m"],"event_source":["CCE","DCS","ES","AOM"],"prom_instance_id":["0","796***7d-1**8-4**9-a**0-99*******ca0","6cc***c8-f**f-4**4-9**2-90*******fcf","90e***88-1**4-4**9-9**3-1f*******cd3"],"resource_kind":["HC:DCS:REDIS_3.0","CCE","HC:ES:METRICS","AOM"]}}},"schema":{"$ref":"#/definitions/QueryAlarmRulesV4Response"}},"500":{"description":"InternalServerError 表明服务端能被请求访问到,但是不能理解用户的请求。","examples":{"application/json":{"error_code":"AOM.02022500","error_msg":"internal server error","error_type":"INTERNAL_SERVER_ERROR","trace_id":""}},"schema":{"$ref":"#/definitions/ApiException"}}},"summary":"查询指标类或者事件类告警规则列表","tags":["告警"],"x-api-type":"open-api","x-is-registered":"Y","x-open-region-cloud":"hws,hws_hk,hws_eu","x-request-examples-description-1":"分页查询指标类或者事件类告警规则","x-request-examples-url-1":"https://{Endpoint}/v4/{project_id}/alarm-rules?limit=100&offset=0","x-support-sdk":"Y"}}},"product_short":"AOM","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询指标类或者事件类告警规则列表","tags":"告警","uri":null,"version":"2.0"}