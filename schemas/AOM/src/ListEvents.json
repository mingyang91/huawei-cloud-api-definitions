{"base_path":"/","components":null,"consumes":"","definitions":{"EventList":{"description":"事件告警上报实体。","properties":{"events":{"description":"事件或者告警详情。","items":{"$ref":"#/definitions/EventModel","type":"object"},"type":"array"}},"required":["events"],"type":"object"},"EventModel":{"description":"事件或者告警元数据。","example":{"annotations":{"alarm_fix_suggestion_zh_cn":"修复建议","alarm_probableCause_zh_cn":"可能原因"},"attach_rule":{},"ends_at":1579420868000,"metadata":{"event_name":"test","event_severity":"Major","event_type":"alarm","resource_id":"ecs123","resource_provider":"ecs","resource_type":"vm"},"resource_group_id":"5680587ab6*******755c543c1f","starts_at":1579420868000,"timeout":60000},"properties":{"annotations":{"additionalProperties":{"type":"object"},"description":"事件或者告警附加字段,可以为空。","type":"object"},"attach_rule":{"additionalProperties":{"type":"object"},"description":"事件或者告警预留字段,为空。","type":"object"},"ends_at":{"description":"事件或者告警清除的时间,CST毫秒级时间戳,为0时表示未删除。","format":"int64","type":"integer"},"id":{"description":"事件或者告警id,系统会自动生成,上报无须填写该字段。","type":"string"},"metadata":{"additionalProperties":{"type":"string"},"description":"事件或者告警的详细信息,为键值对形式。必须字段为:\n\n- event_name:事件或者告警名称,类型为String;\n\n- event_severity:事件级别枚举值。类型为String,四种类型 \"Critical\", \"Major\", \"Minor\",\n\"Info\";\n\n- event_type:事件类别枚举值。类型为String,event为告警事件,alarm为普通告警;\n\n- resource_provider:事件对应云服务名称。类型为String;\n\n- resource_type:事件对应资源类型。类型为String;\n\n- resource_id:事件对应资源信息。类型为String。","type":"object"},"starts_at":{"description":"事件或者告警产生的时间,CST毫秒级时间戳。","format":"int64","type":"integer"},"timeout":{"description":"告警自动清除时间。毫秒数,例如一分钟则填写为60000。默认清除时间为3天,对应数字为 4320 * 1000(即:3天 * 24小时 * 60分钟 * 1000毫秒)。","format":"int64","type":"integer"}},"type":"object"},"EventQueryParam2":{"description":"查询事件或者告警信息 。","example":{"metadata_relation":[{"key":"event_name","relation":"AND","value":["test1","test2"]},{"key":"event_severity","relation":"AND","value":["test1","test2"]},{"key":"expert_advice_url","relation":"NOT","value":["test1","test2"]}],"search":"test","sort":{"order":"desc","order_by":["starts_at"]},"step":60000,"time_range":"-1.-1.5"},"properties":{"metadata_relation":{"description":"查询条件组合,可以为空。","items":{"$ref":"#/definitions/RelationModel"},"type":"array"},"search":{"description":"模糊查询匹配字段,可以为空。如果值不为空,可以模糊匹配。metadata字段为必选字段。","type":"string"},"sort":{"description":"返回列表的排序方式,可以为空。","properties":{"order":{"description":"排序方式枚举值。asc代表正序,desc代表倒序。","enum":["asc","desc"],"type":"string"},"order_by":{"description":"排序字段列表。会根据列表中定义顺序对返回列表最排序。","items":{"type":"string"},"type":"array"}}},"step":{"description":"统计步长。毫秒数,例如一分钟则填写为60000。","format":"int64","type":"integer"},"time_range":{"description":"timeRange用于指标查询时间范围,主要用于解决客户端时间和服务端时间不一致情况下,查询最近N分钟的数据。另可用于精确查询某一段时间的数据。\n\n\n如:\n\n\n- -1.-1.60(表示最近60分钟),不管当前客户端是什么时间,都以服务端时间为准查询最近60分钟。\n\n- 1650852000000.1650852300000.5(表示GMT+8 2022-04-25 10:00:00至2022-04-25\n10:05:00指定的5分钟)\n\n\n格式:\n\n\nstartTimeInMillis.endTimeInMillis.durationInMinutes\n\n\n参数解释:\n\n\n- startTimeInMillis: 查询的开始时间,格式为UTC毫秒,如果指定为-1,服务端将按(endTimeInMillis -\ndurationInMinutes * 60 *\n1000)计算开始时间。如-1.1650852300000.5,则相当于1650852000000.1650852300000.5\n\n- endTimeInMillis: 查询的结束时间,格式为UTC毫秒,如果指定为-1,服务端将按(startTimeInMillis +\ndurationInMinutes * 60 *\n1000)计算结束时间,如果计算出的结束时间大于当前系统时间,则使用当前系统时间。如1650852000000.-1.5,则相当于1650852000000.1650852300000.5\n\n- durationInMinutes:查询时间的跨度分钟数。 取值范围大于0并且大于等于(endTimeInMillis -\nstartTimeInMillis) / (60 * 1000) -\n1。当开始时间与结束时间都设置为-1时,系统会将结束时间设置为当前时间UTC毫秒值,并按(endTimeInMillis -\ndurationInMinutes * 60 * 1000)计算开始时间。如:-1.-1.60(表示最近60分钟)\n\n\n约束:\n\n\n单次请求中,查询时长与周期需要满足以下条件: durationInMinutes * 60 / period <= 1440","type":"string"}},"required":["time_range"],"type":"object"},"RelationModel":{"description":"查询条件。","properties":{"key":{"description":"指定查询字段的key,对应metadata里面的key 。","type":"string"},"relation":{"description":"该条件与其他条件的组合方式。 AND:必须满足所有条件; OR:可以满足其中一个条件; NOT:必须不满足所有条件。","enum":["AND","OR","NOT"],"type":"string"},"value":{"description":"查询条件中指定key的值。","items":{"type":"string"},"type":"array"}}},"ResultInfo2":{"description":"调用失败时的返回值。","properties":{"error_code":{"description":"响应码。","type":"string"},"error_msg":{"description":"调用失败响应信息描述。","type":"string"},"error_type":{"description":"调用失败类型。","type":"string"},"trace_id":{"description":"请求id","type":"string"}}}},"description":null,"group_id":"ac32153cf89a435d96dd423fdce82920","host":"aom.cn-north-4.myhuaweicloud.com","id":"c18b0ea73c1c468c809206a643a28d3f","info_version":"v2","method":"post","name":"ListEvents","parameters":{},"paths":{"/v2/{project_id}/events":{"post":{"consumes":["application/json"],"description":"该接口用于查询对应用户的事件、告警。","operationId":"ListEvents","parameters":[{"description":"租户从IAM申请到的projectid,一般为32位字符串。","in":"path","name":"project_id","required":true,"type":"string"},{"description":"从IAM服务获取的用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"指定类型为application/json。","enum":["application/json"],"in":"header","name":"Content-Type","required":true,"type":"string"},{"description":"查询类型。type=active_alert代表查询活动告警,type=history_alert代表查询历史告警。不传或者传其他值则返回指定查询条件的所有信息。","enum":["history_alert","active_alert"],"in":"query","name":"type","required":false,"type":"string"},{"description":"查询事件或者告警列表请求参数。","in":"body","name":"ListEventsRequestBody","required":true,"schema":{"$ref":"#/definitions/EventQueryParam2"}},{"description":"企业项目id。\n- 查询单个企业项目下实例,填写企业项目id。\n- 查询所有企业项目下实例,填写“all_granted_eps”。","in":"header","name":"Enterprise-Project-Id","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK 请求响应成功。","examples":{"application/json":{"events":[{"annotations":{"alarm_fix_suggestion_zh_cn":"修复建议","alarm_probableCause_zh_cn":"可能原因","message":"告警详情"},"attach_rule":{},"ends_at":0,"id":"6775161208461480000","metadata":{"event_name":"test","event_severity":"Major","event_type":"alarm","resource_id":"ecs123","resource_provider":"ecs","resource_type":"vm"},"starts_at":16377362908000,"timeout":60000}]}},"schema":{"$ref":"#/definitions/EventList"}},"400":{"description":"BadRequest 非法请求。建议直接修改该请求,不要重试该请求。","examples":{"application/json":{"error_code":"AOM.08032002","error_message":"The request body is illegal","error_type":"SC_BAD_REQUEST"}},"schema":{"$ref":"#/definitions/ResultInfo2"}},"401":{"description":"Unauthorized  在客户端提供认证信息后,返回该状态码,表明服务端指出客户端所提供的认证信息不正确或非法。","examples":{"application/json":{"error_code":"AOM.0403","error_message":"auth failed.","error_type":"AUTH_FAILED","trace_id":null}},"schema":{"$ref":"#/definitions/ResultInfo2"}},"403":{"description":"Forbidden 请求被拒绝访问。返回该状态码,表明请求能够到达服务端,且服务端能够理解用户请求,但是拒绝做更多的事情,因为该请求被设置为拒绝访问,建议直接修改该请求,不要重试该请求。","examples":{"application/json":{"error_code":"AOM.0403","error_message":"auth failed.","error_type":"AUTH_FAILED","trace_id":null}},"schema":{"$ref":"#/definitions/ResultInfo2"}},"500":{"description":"InternalServerError 表明服务端能被请求访问到,但是不能理解用户的请求。","examples":{"application/json":{"error_code":"APM.00000500","error_message":"Internal Server Error","trace_id":null}},"schema":{"$ref":"#/definitions/ResultInfo2"}},"503":{"description":"ServiceUnavailable 被请求的服务无效。建议直接修改该请求,不要重试该请求。","examples":{"application/json":{"error_code":"AOM.0503","error_message":"SC_NOT_IMPLEMENTED","error_type":"SC_NOT_IMPLEMENTED"}},"schema":{"$ref":"#/definitions/ResultInfo2"}}},"summary":"查询事件告警信息","tags":["告警"],"x-api-type":"open-api","x-is-devspore":"true","x-is-registered":"Y","x-request-examples-1":{"metadata_relation":[{"key":"event_type","relation":"AND","value":["alarm"]},{"key":"event_severity","relation":"AND","value":["Critical","Major","Minor","Info"]}],"search":"","sort":{"order":"desc","order_by":["starts_at"]},"time_range":"-1.-1.30"},"x-request-examples-description-1":"查询对应用户{project_id}的事件、告警列表。","x-request-examples-text-1":{"metadata_relation":[{"key":"event_type","relation":"AND","value":["alarm"]},{"key":"event_severity","relation":"AND","value":["Critical","Major","Minor","Info"]}],"search":"","sort":{"order":"desc","order_by":["starts_at"]},"time_range":"-1.-1.30"},"x-request-examples-url-1":"https://{endpoint}/v2/{project_id}/events","x-support-sdk":"Y"}}},"product_short":"AOM","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询事件告警信息","tags":"告警","uri":null,"version":"2.0"}