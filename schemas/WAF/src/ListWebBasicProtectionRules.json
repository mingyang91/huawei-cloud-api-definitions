{"base_path":"/","components":null,"consumes":"","definitions":{"IAM5ErrorDetails":{"description":"调用下游服务的报错信息集合,IAM5鉴权错误时才会返回此信息0。","properties":{"error_code":{"description":"下游服务错误码","type":"string"},"error_msg":{"description":"下游服务报错信息","type":"string"}}},"ListWebBasicProtectionRulesBody":{"properties":{"items":{"description":"web基础防护内置规则数组","items":{"$ref":"#/definitions/WebBasicProtectionRulesItem"},"type":"array"},"total":{"description":"该策略下web基础防护内置规则数量","type":"integer"}},"type":"object"},"RestErrorResponse":{"properties":{"details":{"description":"调用下游服务的报错信息集合,IAM5鉴权错误时才会返回此字段。","items":{"$ref":"#/definitions/IAM5ErrorDetails"},"type":"array"},"encoded_authorization_message":{"description":"编码 (加密) 后的详细拒绝原因,用户可以自行调用 STS 服务的decode-authorization-message接口进行解码,可参考STS5联调自验证。IAM5鉴权错误时才会返回此字段。","type":"string"},"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误信息","type":"string"}},"title":"RestErrorResponse","type":"object"},"WebBasicProtectionRulesItem":{"description":"web基础防护内置规则","properties":{"application_type":{"description":"**参数解释:**\n应用类型\n**取值范围:**\n不涉及","type":"string"},"create_time":{"description":"**参数解释:**\n创建时间\n**取值范围:**\n不涉及","format":"int64","type":"integer"},"cve_number":{"description":"**参数解释:**\nCVE编号\n**取值范围:**\n不涉及","type":"string"},"description":{"description":"**参数解释:**\n规则描述\n**取值范围:**\n不涉及","type":"string"},"effective_time":{"description":"**参数解释:**\n生效时间\n**取值范围:**\n不涉及","format":"int64","type":"integer"},"id":{"description":"**参数解释:**\n规则的ID,规则的唯一标识\n**取值范围:**\n不涉及","type":"string"},"protection_type":{"description":"**参数解释:**\n防护类型\n**取值范围:**\n不涉及","type":"string"},"risk_level":{"description":"**参数解释:**\n危险等级\n- 1:高危\n- 2:中危\n- 3:低危\n\n**取值范围:**\n- 1\n- 2\n- 3","enum":[1,2,3],"format":"int32","type":"integer"},"update_time":{"description":"**参数解释:**\n更新时间\n**取值范围:**\n不涉及","format":"int64","type":"integer"}}}},"description":null,"group_id":"29975c0bd7ce463ca70ad5c074e3974b","host":"waf.cn-north-4.myhuaweicloud.com","id":"30f5ef81779b450fb76a9c822bac4032","info_version":"v1","method":"get","name":"ListWebBasicProtectionRules","parameters":{},"paths":{"/v1/{project_id}/waf/policy/basic-protection/default-rules":{"get":{"description":"查询web基础防护内置规则列表","operationId":"ListWebBasicProtectionRules","parameters":[{"description":"**参数解释:**\n用户Token,通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\n不涉及","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"default":"application/json;charset=utf8","description":"**参数解释:**\n内容类型\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\napplication/json;charset=utf8","in":"header","name":"Content-Type","required":true,"type":"string"},{"description":"**参数解释:**\n语言,默认值为zh-cn。zh-cn(中文)/en-us(英文)。\n**约束限制:**\n不涉及\n**取值范围:**\n- zh-cn:中文\n- en-us:英文\n\n**默认取值:**\n- zh-cn","enum":["zh-cn","en-us"],"in":"header","name":"X-Language","required":false,"type":"string"},{"default":"","description":"**参数解释:**\n项目ID,对应控制台用户名->我的凭证->项目列表->项目ID。\n**约束限制:**\n不涉及\n**取值范围:**\n只能由英文字母、数字组成,且长度为32个字符。\n**默认取值:**\n不涉及","in":"path","name":"project_id","required":true,"type":"string"},{"description":"**参数解释:**\n您可以通过调用企业项目管理服务(EPS)的查询企业项目列表接口(ListEnterpriseProject)查询企业项目ID。若需要查询当前用户所有企业项目绑定的资源信息,请传参all_granted_eps。\n**约束限制:**\n不涉及\n**取值范围:**\n - 0:代表default企业项目\n - all_granted_eps:代表所有企业项目\n - 其它企业项目ID:长度为36个字符\n\n**默认取值:**\n0","in":"query","name":"enterprise_project_id","required":false,"type":"string"},{"description":"**参数解释:**\n分页查询的起始位置,表示从第几条记录开始返回(从1开始计数)。\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\n1","in":"query","name":"offset","required":false,"type":"integer"},{"description":"**参数解释:**\n分页查询的单页返回数量,控制每次请求返回的记录条数。\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\n10","in":"query","name":"limit","required":false,"type":"integer"},{"description":"**参数解释:**\n起始时间(13位毫秒时间戳),需要和to同时使用。\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\n不涉及","format":"int64","in":"query","name":"from","required":false,"type":"integer"},{"description":"**参数解释:**\n结束时间(13位毫秒时间戳),需要和from同时使用。\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\n不涉及","format":"int64","in":"query","name":"to","required":false,"type":"integer"},{"description":"**参数解释:**\n规则集的防护严格程度。规则集(宽松)下对业务的误报率降低,但漏报率可能会增高;而规则集(严格)下对业务的误报率可能会增高,但漏报率降低。\n**约束限制:**\n不涉及\n**取值范围:**\n- 1:宽松\n- 2:中等\n- 3:严格\n\n**默认取值:**\n不涉及","enum":[1,2,3],"format":"int32","in":"query","name":"level","required":false,"type":"integer"},{"description":"**参数解释:**\n规则ID,规则的唯一标识。\n**约束限制:**\n不涉及\n**取值范围:**\n长度为6个字符\n**默认取值:**\n不涉及","in":"query","name":"id","required":false,"type":"string"},{"description":"**参数解释:**\n规则描述\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\n不涉及","in":"query","name":"description","required":false,"type":"string"},{"description":"**参数解释:**\nCVE编号\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\n不涉及","in":"query","name":"cve_number","required":false,"type":"string"},{"description":"**参数解释:**\n危险等级\n**约束限制:**\n不涉及\n**取值范围:**\n- 1:高危\n- 2:中危\n- 3:低危\n\n**默认取值:**\n不涉及","enum":[1,2,3],"format":"int32","in":"query","name":"risk_level","required":false,"type":"integer"},{"description":"**参数解释:**\n防护类型\n**约束限制:**\n不涉及\n**取值范围:**\n- vuln:其他\n- xss:跨站脚本\n- cmdi:命令注入\n- lfi:本地文件包含\n- rfi:远程文件包含\n- webshell:网站木马\n- robot:恶意爬虫\n- sqli:SQL注入\n\n**默认取值:**\n不涉及","enum":["vuln","xss","cmdi","lfi","rfi","webshell","robot","sqli"],"in":"query","name":"protection_type_names","required":false,"type":"string"},{"description":"**参数解释:**\n应用类型\n**约束限制:**\n不涉及\n**取值范围:**\n请参见WAF控制台,Web基础防护规则详情页面的应用类型。\n**默认取值:**\n不涉及","in":"query","name":"application_type_names","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"请求成功","examples":{"application/json":{"items":[{"application_type":null,"create_time":1618539073821,"cve_number":null,"description":"利用nmap的命令注入攻击","effective_time":0,"id":12298,"protection_type":"cmdi","risk_level":1,"update_time":1749738600000}],"total":1}},"schema":{"$ref":"#/definitions/ListWebBasicProtectionRulesBody"}},"400":{"description":"请求失败","schema":{"$ref":"#/definitions/RestErrorResponse"}},"401":{"description":"token权限不足","schema":{"$ref":"#/definitions/RestErrorResponse"}},"500":{"description":"服务器内部错误","schema":{"$ref":"#/definitions/RestErrorResponse"}}},"summary":"查询web基础防护内置规则列表","tags":["策略规则管理"],"x-api-type":"open-api","x-is-registered":"Y","x-request-examples-description-1":"查询项目id为project_id,Web基础防护的规则集详情。","x-request-examples-url-1":"GET https://{endpoint}/v1/{project_id}/waf/policy/basic-protection/default-rules","x-support-international":true,"x-support-sdk":"Y"}}},"product_short":"WAF","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询web基础防护内置规则列表","tags":"策略规则管理","uri":null,"version":"2.0"}