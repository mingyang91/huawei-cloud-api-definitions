{"base_path":"/","components":null,"consumes":"","definitions":{"RestErrorResponse":{"properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误信息","type":"string"}},"title":"RestErrorResponse","type":"object"},"ShowEventItems":{"description":"攻击类型","properties":{"action":{"description":"防护动作","type":"string"},"attack":{"description":"攻击类型","type":"string"},"cookie":{"description":"攻击请求的cookie","type":"string"},"headers":{"description":"攻击请求的headers","type":"object"},"host":{"description":"域名","type":"string"},"host_id":{"description":"被攻击的域名id","type":"string"},"id":{"description":"防护事件id","type":"string"},"payload":{"description":"恶意负载","type":"string"},"payload_location":{"description":"恶意负载位置","type":"string"},"policyid":{"description":"策略id","type":"string"},"process_time":{"description":"处理时长","type":"integer"},"region":{"description":"源ip地理位置","type":"string"},"request_body":{"description":"请求体","type":"string"},"request_line":{"description":"攻击请求的请求行","type":"string"},"response_size":{"description":"返回大小(字节)","type":"integer"},"response_time":{"description":"响应时间(毫秒)","format":"int64","type":"integer"},"rule":{"description":"命中的规则id","type":"string"},"sip":{"description":"源ip,Web访问者的IP地址(攻击者IP地址)","type":"string"},"status":{"description":"响应码","type":"string"},"time":{"description":"攻击发生时的时间戳(毫秒)","format":"int64","type":"integer"},"url":{"description":"攻击的url链接","type":"string"}},"type":"object"},"ShowEventResponseBody":{"description":"查询攻击事件详情","properties":{"items":{"description":"攻击事件详情","items":{"$ref":"#/definitions/ShowEventItems"},"type":"array"},"total":{"description":"攻击事件数量","type":"integer"}},"type":"object"}},"description":null,"group_id":"29975c0bd7ce463ca70ad5c074e3974b","host":"waf.cn-north-4.myhuaweicloud.com","id":"df6c6fe39279469ab944d4ed4d458712","info_version":"v1","method":"get","name":"ShowEvent","parameters":{},"paths":{"/v1/{project_id}/waf/event/{eventid}":{"get":{"description":"查询指定事件id的防护事件详情","operationId":"ShowEvent","parameters":[{"description":"用户Token,通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"default":"application/json;charset=utf8","description":"内容类型","in":"header","name":"Content-Type","required":true,"type":"string"},{"description":"语言,默认值为en-us。zh-cn(中文)/en-us(英文)","in":"header","name":"X-Language","required":false,"type":"string"},{"description":"项目ID,对应华为云控制台用户名->我的凭证->项目列表->项目ID","in":"path","name":"project_id","required":true,"type":"string"},{"description":"您可以通过调用企业项目管理服务(EPS)的查询企业项目列表接口(ListEnterpriseProject)查询企业项目id","in":"query","name":"enterprise_project_id","required":false,"type":"string"},{"description":"防护事件id,通过调用查询攻击事件列表(ListEvent)接口获取防护事件id","in":"path","name":"eventid","required":true,"type":"string"}],"produces":["application/json;charset=utf-8"],"responses":{"200":{"description":"ok","examples":{"application/json":{"items":[{"action":"block","attack":"vuln","cookie":"HWWAFSESID=2a0bf76a111c93926d; HWWAFSESTIME=1650505086260","headers":{"accept-encoding":"gzip","host":"x.x.x.x:81","lb-id":"68d3c435-2607-45e0-a5e2-38980544dd45","ls-id":"c0d957e6-26a8-4f2e-8216-7fc9332a250f","user-agent":"Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 CSIRTx/2022"},"host":"x.x.x.x:xxxxxx-xxx-xxx-xxx-xxxxxxxxx","host_id":"e093a352fd3a4ddd994c585e2e1dda59","id":"09-0000-0000-0000-12120220421093806-a60a6166","payload":" /mobile/dbconfigreader.jsp","payload_location":"uri","policyid":"173ed802272a4b0798049d7edffeff03","process_time":0,"region":"Reserved IP","request_body":"{}","request_line":"GET /mobile/DBconfigReader.jsp","response_size":3318,"response_time":0,"rule":"091004","sip":"x.x.x.x","status":"418","time":1650505086000,"url":"/mobile/DBconfigReader.jsp"}],"total":1}},"schema":{"$ref":"#/definitions/ShowEventResponseBody"}},"400":{"description":"请求失败","schema":{"$ref":"#/definitions/RestErrorResponse"}},"401":{"description":"token权限不足","schema":{"$ref":"#/definitions/RestErrorResponse"}},"500":{"description":"服务器内部错误","schema":{"$ref":"#/definitions/RestErrorResponse"}}},"summary":"查询指定事件id的防护事件详情","tags":["防护事件管理"],"x-hybridcloud":true,"x-is-registered":"Y","x-request-examples-description-1":"查询项目id为project_id,防护事件id为event_id的的防护事件详情","x-request-examples-url-1":"GET https://{Endpoint}/v1/{project_id}/waf/event{event_id}?enterprise_project_id=0","x-support-sdk":"Y"}}},"product_short":"WAF","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询指定事件id的防护事件详情","tags":"防护事件管理","uri":null,"version":"2.0"}