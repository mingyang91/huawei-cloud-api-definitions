{"base_path":null,"components":{"schemas":{"CreateHttpCcRuleRequestBody":{"properties":{"action":{"$ref":"#/components/schemas/HttpRuleAction"},"conditions":{"description":"cc规则防护规则限速条件,当cc防护规则为高级模式(mode参数值为1)时,该参数必填。","items":{"$ref":"#/components/schemas/HttpCcRuleCondition"},"type":"array"},"description":{"description":"规则描述,最长512字符","pattern":"^[a-zA-Z.。,,_\\-/:0-9\\u4E00-\\u9FFF\\s]{0,512}$","type":"string"},"domain_aggregation":{"description":"是否聚合域名","type":"boolean"},"limit_num":{"description":"单个用户的周期内请求次数","maximum":2147483647,"minimum":0,"type":"integer"},"limit_period":{"description":"限速周期","maximum":3600,"minimum":0,"type":"integer"},"lock_time":{"description":"阻断时长","maximum":2147483647,"minimum":0,"type":"integer"},"mode":{"description":"cc规则防护模式,现在只支持创建高级cc规则防护模式。 \n - 0:标准,只支持对域名的防护路径做限制。\n - 1:高级,支持对路径、IP、Cookie、Header、Params字段做限制。","maximum":1,"minimum":0,"type":"integer"},"name":{"description":"规则名称","pattern":"^[a-zA-Z.。,,:_\\/:0-9\\u4E00-\\u9FFF\\s-]{0,255}$","type":"string"},"period_type":{"description":"period每日生效时间类型,目前只有day","enum":["day"],"type":"string"},"priority":{"description":"cc规则优先级,越大优先级越高,默认1,创建必填","maximum":100,"minimum":1,"type":"integer"},"start":{"description":"customize生效时间区间开始","format":"int64","maximum":4102415999,"minimum":946656000,"type":"integer"},"tag_condition":{"$ref":"#/components/schemas/HttpCcRuleCondition"},"tag_index":{"description":"防护模式标签","pattern":"^[\\s\\S]{0,2048}$","type":"string"},"tag_type":{"description":"限速模式: \n - ip:IP限速,根据IP区分单个Web访问者。 \n - cookie:用户限速,根据Cookie键值区分单个Web访问者 \n - header:用户限速,根据Header区分单个Web访问者。 \n - ip_segment_c:根据IP C段区分单个Web访问者。","enum":["ip","cookie","header","ip_segment_c"],"pattern":"^[\\s\\S]{0,128}$","type":"string"},"terminal":{"description":"customize生效时间区间结束","format":"int64","maximum":4102415999,"minimum":946656000,"type":"integer"},"time_mode":{"default":"permanent","description":"生效模式","enum":["permanent","period","customize"],"type":"string"},"time_range":{"description":"period每日生效时间区间","items":{"$ref":"#/components/schemas/TimeRangeItem"},"type":"array"},"total_num":{"description":"所有用户的周期内请求次数","minimum":0,"type":"integer"},"unlock_num":{"description":"放行次数","maximum":2147483647,"minimum":0,"type":"integer"}},"required":["action","limit_num","limit_period","mode","name","priority","tag_type","time_mode"],"type":"object"},"ErrorResponseBody":{"description":"通用错误响应","properties":{"encoded_authorization_message":{"description":"对接IAM5.0的服务,拒绝访问时需要返回IAM的相关响应","type":"string"},"error_code":{"description":"标准化错误码:服务名.八位数字编码","type":"string"},"error_msg":{"description":"清晰的错误信息","type":"string"}},"type":"object"},"HttpCcRuleCondition":{"description":"防护规则条件","properties":{"category":{"description":"防护规则字段","enum":["url","ip","params","cookie","header","custom_geoip","response_code"],"type":"string"},"check_all_indexes_logic":{"description":"- 1:所有子字段\n- 2:任意子字段","type":"integer"},"contents":{"description":"条件列表逻辑匹配内容。当logic_operation参数不以any或者all结尾时,需要传该参数。","items":{"pattern":"^[\\S\\s]{0,4096}$","type":"string"},"type":"array"},"index":{"description":"子字段,当字段类型(category)选择“params”、“cookie”、“header”时,请根据实际需求配置子字段且该参数必填。","pattern":"^[\\S\\s]{0,4096}$","type":"string"},"logic_operation":{"description":"条件列表匹配逻辑。 \n -  如果字段类型category是url, 匹配逻辑可以为:contain、 not_contain、 equal、 not_equal、 prefix、 not_prefix、 suffix、 not_suffix、 contain_any、 not_contain_all、 equal_any、 not_equal_all、 equal_any、 not_equal_all、 prefix_any、 not_prefix_all、 suffix_any、 not_suffix_all、 len_greater、 len_less、len_equal或者len_not_equal \n - 如果字段类型category是ip或者ipv6,匹配逻辑可以为: equal、not_equal、equal_any或者not_equal_all \n - 如果字段类型category是params、cookie或者header, 匹配逻辑可以为:contain、 not_contain、 equal、 not_equal、 prefix、 not_prefix、 suffix、 not_suffix、 contain_any、 not_contain_all、 equal_any、not_equal_all、 equal_any、 not_equal_all、 prefix_any、 not_prefix_all、 suffix_any、 not_suffix_all、 len_greater、 len_less、len_equal、len_not_equal、、num_greater、num_less、num_equal、num_not_equal、exist或者not_exist","pattern":"^[a-zA-Z0-9_\\-/:.]{0,256}$","type":"string"},"size":{"description":"若防护规则涉及阈值,即使用该字段","format":"int64","type":"integer"},"value_list_id":{"description":"引用表id。当logic_operation参数以any或者all结尾时,需要传该参数。此外,引用表类型要与category类型保持一致。","pattern":"^[a-zA-Z0-9-]{32,36}$","type":"string"}},"required":["category","logic_operation"],"type":"object"},"HttpRuleAction":{"description":"防护规则动作","properties":{"category":{"description":"操作类型。 \n - “block”:拦截。 \n - “pass”:放行。 \n - “log”:仅记录","pattern":"^[a-zA-Z0-9_\\-/:.]{0,256}$","type":"string"},"detail":{"$ref":"#/components/schemas/HttpRuleActionDetail"},"followed_action_id":{"description":"攻击惩罚规则id,只有当category参数值为block时才可配置该参数","pattern":"^[a-zA-Z0-9-]{32,36}$","type":"string"}},"required":["category"],"type":"object"},"HttpRuleActionDetail":{"description":"防护规则动作","properties":{"redirect_url":{"description":"返回页面重定向的url","pattern":"^[\\s\\S]{0,2048}$","type":"string"},"response":{"$ref":"#/components/schemas/HttpRuleActionResponse"}},"type":"object"},"HttpRuleActionResponse":{"description":"防护规则返回页面","properties":{"content":{"description":"内容","pattern":"^[\\s\\S]{0,2048}$","type":"string"},"content_type":{"description":"内容类型","pattern":"^[\\s\\S]{0,256}$","type":"string"}},"type":"object"},"ShowHttpCcRuleResponseBody":{"properties":{"action":{"$ref":"#/components/schemas/HttpRuleAction"},"conditions":{"description":"条件列表参数较为复杂,存在级联关系,建议同时使用控制台上的添加误报屏蔽规则,单击F12键查看路径后缀为/cc-rule,方法为POST的请求参数,便于理解参数的填写","items":{"$ref":"#/components/schemas/HttpCcRuleCondition"},"type":"array"},"description":{"description":"规则描述","type":"string"},"domain_aggregation":{"description":"是否聚合域名","type":"boolean"},"id":{"description":"规则id","type":"string"},"limit_num":{"description":"单个用户的周期内请求次数","type":"integer"},"limit_period":{"description":"限速周期","type":"integer"},"lock_time":{"description":"锁定时长","type":"integer"},"mode":{"description":"规则类型(0:标准/1:高级)","type":"integer"},"name":{"description":"规则名称","type":"string"},"period_type":{"description":"period每日生效时间类型,目前只有day","type":"string"},"policy_id":{"description":"规则所在策略id","type":"string"},"policy_name":{"description":"规则所在策略名称","type":"string"},"priority":{"description":"cc规则优先级,越大优先级越高,默认1","maximum":100,"minimum":1,"type":"integer"},"producer":{"description":"创建来源","type":"integer"},"start":{"description":"customize生效时间区间开始","format":"int64","type":"integer"},"status":{"description":"规则开关状态","type":"integer"},"tag_condition":{"$ref":"#/components/schemas/HttpCcRuleCondition"},"tag_index":{"description":"防护模式标签","type":"string"},"tag_type":{"description":"防护模式","type":"string"},"terminal":{"description":"customize生效时间区间结束","format":"int64","type":"integer"},"time_mode":{"description":"生效模式","type":"string"},"time_range":{"description":"period每日生效时间区间","items":{"$ref":"#/components/schemas/TimeRangeItem"},"type":"array"},"timestamp":{"description":"创建规则时间戳","format":"int64","type":"integer"},"total_num":{"description":"所有用户的周期内请求次数","type":"integer"},"unlock_num":{"description":"放行次数","type":"integer"}},"type":"object"},"TimeRangeItem":{"description":"period每日生效时间区间","properties":{"end":{"description":"period每日生效时间区间结束","format":"int32","maximum":864000,"minimum":0,"type":"integer"},"st":{"description":"period每日生效时间区间开始","format":"int32","maximum":864000,"minimum":0,"type":"integer"}},"type":"object"}}},"consumes":"","definitions":null,"description":null,"group_id":"097b41aa00ce42768253a0a028ddb99b","host":"esa.cn-north-4.myhuaweicloud.com","id":"1ce514e8277645d2976ddfa53ea88cc5","info_version":"v2","method":"post","name":"CreateHttpCcRule","parameters":null,"paths":{"/v1/edgesec/configuration/http/policies/{policy_id}/cc-rule":{"post":{"description":"创建cc规则","operationId":"CreateHttpCcRule","parameters":[{"description":"auth token","in":"header","name":"X-Auth-Token","required":true,"schema":{"type":"string"}},{"description":"策略id","in":"path","name":"policy_id","required":true,"schema":{"pattern":"^[a-zA-Z0-9-]{32,36}$","type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateHttpCcRuleRequestBody"}}},"description":"创建cc规则body","required":false},"responses":{"200":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShowHttpCcRuleResponseBody"}}},"description":"OK"},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseBody"}}},"description":"请求失败"},"401":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseBody"}}},"description":"token权限不足"},"500":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponseBody"}}},"description":"服务器内部错误"}},"summary":"创建cc规则","tags":["Http防护规则管理-CC"],"x-codegen-request-body-name":"CreateHttpCcRuleRequestBody","x-cts-meta-anno":{"isAsyncApi":"false","resourceType":"wafCcRule","traceName":"createWafCcRule"},"x-iam-auth-meta-anno":{"abacAction":"edgesec:wafCcRule:create","authLevel":"token","rbac":"{\"op_service\",\"te_admin\"}"},"x-is-registered":"Y","x-support-sdk":"Y"}}},"product_short":"EdgeSec","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建cc规则","tags":"Http防护规则管理-CC","uri":null,"version":"3.0.1"}