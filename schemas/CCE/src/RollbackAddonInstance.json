{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"AddonInstance":{"description":"插件实例详细信息-response结构体","properties":{"apiVersion":{"default":"v3","description":"API版本,固定值“v3”,该值不可修改。","type":"string"},"kind":{"default":"Addon","description":"API类型,固定值“Addon”,该值不可修改。","type":"string"},"metadata":{"$ref":"#/definitions/AddonMetadata","description":"基本信息,为集合类的元素类型,包含一组由不同名称定义的属性"},"spec":{"$ref":"#/definitions/InstanceSpec","description":"spec是集合类的元素类型,内容为插件实例具体信息,实例的详细描述主体部分都在spec中给出"},"status":{"$ref":"#/definitions/AddonInstanceStatus","description":"插件实例状态"}},"required":["apiVersion","kind","spec","status"]},"AddonInstanceRollbackRequest":{"properties":{"clusterID":{"description":"集群ID","type":"string"}},"required":["clusterID"]},"AddonInstanceStatus":{"description":"插件状态信息","properties":{"Reason":{"description":"插件安装失败原因","type":"string"},"currentVersion":{"$ref":"#/definitions/Versions","description":"当前插件实例使用的具体插件版本信息"},"isRollbackable":{"description":"是否支持回滚到插件升级前的插件版本","type":"boolean"},"message":{"description":"安装错误详情","type":"string"},"previousVersion":{"description":"插件升级或回滚前的版本","type":"string"},"status":{"description":"插件实例状态, 取值如下\n- running:运行中,表示插件全部实例状态都在运行中,插件正常使用。\n- abnormal:不可用,表示插件状态异常,插件不可使用。可单击插件名称查看实例异常事件。\n- installing:安装中,表示插件正在安装中。\n- installFailed:安装失败,表示插件安装失败,需要卸载后重新安装。\n- upgrading:升级中,表示插件正在更新中。\n- upgradeFailed:升级失败,表示插件升级失败,可重试升级或卸载后重新安装。\n- deleting:删除中,表示插件正在删除中。\n- deleteFailed:删除失败,表示插件删除失败,可重试卸载。\n- deleteSuccess:删除成功,表示插件删除成功。\n- available:部分就绪,表示插件下只有部分实例状态为运行中,插件部分功能可用。\n- rollbacking:回滚中,表示插件正在回滚中。\n- rollbackFailed:回滚失败,表示插件回滚失败,可重试回滚或卸载后重新安装。\n- unknown:未知状态,表示插件模板实例不存在。","enum":["running","abnormal","installing","installFailed","upgrading","upgradeFailed","deleting","deleteSuccess","deleteFailed","available","rollbacking","rollbackFailed"],"type":"string"},"targetVersions":{"description":"此插件版本,支持升级的集群版本","items":{"description":"","type":"string"},"type":"array"}},"required":["currentVersion","message","Reason","status"]},"AddonMetadata":{"description":"插件基本信息,集合类的元素类型,包含一组由不同名称定义的属性。","properties":{"alias":{"description":"插件别名","type":"string"},"annotations":{"additionalProperties":{"type":"string"},"description":"插件注解,由key/value组成\n- 安装:固定值为{\"addon.install/type\":\"install\"}\n- 升级:固定值为{\"addon.upgrade/type\":\"upgrade\"}","type":"object"},"creationTimestamp":{"description":"创建时间","format":"date","type":"string"},"labels":{"additionalProperties":{"type":"string"},"description":"插件标签,key/value对格式,接口保留字段,填写不会生效","type":"object"},"name":{"description":"插件名称","type":"string"},"uid":{"description":"唯一id标识","type":"string"},"updateTimestamp":{"description":"更新时间","format":"date","type":"string"}}},"InstanceSpec":{"description":"spec是集合类的元素类型,内容为插件实例具体信息","properties":{"addonTemplateLabels":{"description":"插件模板所属类型","items":{"type":"string"},"type":"array"},"addonTemplateLogo":{"description":"插件模板logo图片的地址","maxLength":200,"type":"string"},"addonTemplateName":{"description":"插件模板名称,如coredns","type":"string"},"addonTemplateType":{"description":"插件模板类型","type":"string"},"clusterID":{"description":"集群id","type":"string"},"description":{"description":"插件模板描述","type":"string"},"values":{"additionalProperties":{"type":"object"},"description":"插件模板安装参数(各插件不同),请根据具体插件模板信息填写安装参数。","type":"object"},"version":{"description":"插件模板版本号,如1.0.0","type":"string"}},"required":["addonTemplateName","addonTemplateType","clusterID","description","values","version"]},"SupportVersions":{"description":"插件支持升级的集群版本","properties":{"category":{"description":"作用的集群类型\n**取值范围:**\n- CCE:CCE Standard集群\n- Turbo:CCE Turbo集群\n- Autopilot:CCE Autopilot集群\n\n**默认取值**\n为空时默认为CCE Standard,CCE Turbo集群","items":{"type":"string"},"type":"array"},"clusterType":{"description":"支持的集群类型","type":"string"},"clusterVersion":{"description":"支持的集群版本(正则表达式)","items":{"type":"string"},"type":"array"}},"required":["clusterType","clusterVersion"]},"Versions":{"description":"具体插件版本信息","properties":{"creationTimestamp":{"description":"创建时间","format":"date","type":"string"},"input":{"description":"插件安装参数","type":"object"},"stable":{"description":"是否为稳定版本","type":"boolean"},"supportVersions":{"description":"支持集群版本号","items":{"$ref":"#/definitions/SupportVersions"},"type":"array"},"translate":{"description":"供界面使用的翻译信息","type":"object"},"updateTimestamp":{"description":"更新时间","format":"date","type":"string"},"version":{"description":"插件版本号","type":"string"}},"required":["input","stable","supportVersions","translate","updateTimestamp","version"]}},"description":null,"group_id":"394aeee55c894cd89bc6a709f45ae609","host":"cce.cn-north-4.myhuaweicloud.com","id":"9097101d70074f4a84eb6fff1f355a7b","info_version":"v3","method":"post","name":"RollbackAddonInstance","parameters":{"param_header_x_auth_token":{"description":"调用接口的认证方式分为Token和AK/SK两种,如果您使用的Token方式,此参数为必填,请填写Token的值,获取方式请参见[获取token](cce_02_0004.xml)。","in":"header","maxLength":16384,"name":"X-Auth-Token","required":true,"type":"string","x-order":52}},"paths":{"/api/v3/addons/{id}/operation/rollback":{"post":{"consumes":["application/json"],"deprecated":false,"description":"将插件实例回滚到升级前的版本。只有在当前插件实例版本支持回滚到升级前的版本(status.isRollbackable为true),且插件实例状态为running(运行中)、available(可用)、abnormal(不可用)、upgradeFailed(升级失败)、rollbackFailed(回滚失败)时支持回滚。","operationId":"RollbackAddonInstance","parameters":[{"description":"插件实例ID","in":"path","maxLength":255,"minLength":1,"name":"id","required":true,"type":"string","x-order":2},{"$ref":"#/parameters/param_header_x_auth_token"},{"description":"请求body体","in":"body","name":"AddonInstanceRollbackRequestBody","required":true,"schema":{"$ref":"#/definitions/AddonInstanceRollbackRequest"},"x-order":3}],"produces":[],"responses":{"200":{"description":"插件实例回滚成功","examples":{"application/json":{"apiVersion":"v3","kind":"Addon","metadata":{"alias":"everest","creationTimestamp":"2023-03-15T02:48:01Z","name":"everest","uid":"******","updateTimestamp":"2023-03-15T04:18:45Z"},"spec":{"addonTemplateLabels":["Storage"],"addonTemplateLogo":"******","addonTemplateName":"everest","addonTemplateType":"helm","clusterID":"******","description":"Everest is a cloud native container storage system based on CSI, used to support cloud storages services for Kubernetes","values":{"basic":{"base_image":"euleros","bms_url":"******","cluster_version":"v1.25","driver_init_image_version":"2.1.16","ecsEndpoint":"******","euleros_version":"2.2.5","everest_image_version":"2.1.16","evs_url":"******","iam_url":"******","ims_url":"******","obs_url":"******","platform":"linux-amd64","rbac_enabled":true,"sfs30_url":"******","sfs_turbo_url":"******","sfs_url":"******","supportHcs":false,"swr_addr":"******","swr_user":"******"},"custom":{"cluster_id":"******","cluster_version":"v1.25.3-r0","csi_attacher_detach_worker_threads":"60","csi_attacher_worker_threads":"60","default_vpc_id":"******","disable_auto_mount_secret":false,"enable_node_attacher":false,"flow_control":{},"multiAZEnabled":false,"over_subscription":"80","project_id":"******","volume_attaching_flow_ctrl":"0"},"flavor":{"category":["CCE","Turbo"],"description":"High avaiable","name":"HA","replicas":2,"resources":[{"limitsCpu":"250m","limitsMem":"1500Mi","name":"everest-csi-controller","requestsCpu":"250m","requestsMem":"600Mi"},{"limitsCpu":"500m","limitsMem":"300Mi","name":"everest-csi-driver","requestsCpu":"100m","requestsMem":"300Mi"}]},"multiAZPreferred":{"podAntiAffinity":{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"app","operator":"In","values":["everest-csi-controller"]}]},"topologyKey":"topology.kubernetes.io/zone"},"weight":100}]}},"multiAZRequired":{"podAntiAffinity":{"requiredDuringSchedulingIgnoredDuringExecution":[{"labelSelector":{"matchExpressions":[{"key":"app","operator":"In","values":["everest-csi-controller"]}]},"topologyKey":"topology.kubernetes.io/zone"}]}},"systemAutoInject":{"cluster":{"category":"CCE","clusterID":"******","clusterNetworkMode":"vpc-router","clusterVersion":"v1.25.3-r0"},"user":{"projectID":"******"}},"tolerations":[{"effect":"NoExecute","key":"node.kubernetes.io/not-ready","operator":"Exists","tolerationSeconds":60},{"effect":"NoExecute","key":"node.kubernetes.io/unreachable","operator":"Exists","tolerationSeconds":60}]},"version":"2.1.16"},"status":{"Reason":"Rollback to 4","currentVersion":{"creationTimestamp":"2023-02-21T16:29:02Z","input":{"basic":{"bms_url":"******","driver_init_image_version":"2.1.16","ecsEndpoint":"******","everest_image_version":"2.1.16","evs_url":"******","iam_url":"******","ims_url":"******","obs_url":"******","platform":"linux-amd64","sfs30_url":"******","sfs_turbo_url":"******","sfs_url":"******","supportHcs":false,"swr_addr":"******","swr_user":"******"},"parameters":{"common":{"defaultVPCId":0},"custom":{"cluster_id":"","csi_attacher_detach_worker_threads":"60","csi_attacher_worker_threads":"60","default_vpc_id":"","disable_auto_mount_secret":false,"enable_node_attacher":false,"flow_control":{},"multiAZEnabled":false,"over_subscription":"80","project_id":"","volume_attaching_flow_ctrl":"0"},"flavor1":{"description":"High avaiable","name":"HA","replicas":2,"resources":[{"limitsCpu":"250m","limitsMem":"1500Mi","name":"everest-csi-controller","requestsCpu":"250m","requestsMem":"600Mi"},{"limitsCpu":"500m","limitsMem":"300Mi","name":"everest-csi-driver","requestsCpu":"100m","requestsMem":"300Mi"}]},"flavor2":{"description":"Has only one instance","name":"Single","replicas":1,"resources":[{"limitsCpu":"250m","limitsMem":"600Mi","name":"everest-csi-controller","requestsCpu":"250m","requestsMem":"600Mi"},{"limitsCpu":"100m","limitsMem":"300Mi","name":"everest-csi-driver","requestsCpu":"100m","requestsMem":"300Mi"}]},"flavor3":{"description":"custom resources","name":"custom-resources","replicas":2,"resources":[{"limitsCpu":"250m","limitsMem":"2000Mi","name":"everest-csi-controller","requestsCpu":"250m","requestsMem":"1500Mi"},{"limitsCpu":"500m","limitsMem":"300Mi","name":"everest-csi-driver","requestsCpu":"100m","requestsMem":"300Mi"}]}}},"stable":true,"supportVersions":null,"translate":{"en_US":{"addon":{"changeLog":"******","description":"******"},"description":{"Parameters.flavor1.description":"******","Parameters.flavor1.name":"******","Parameters.flavor2.description":"******","Parameters.flavor2.name":"******","Parameters.flavor3.name":"******"}},"zh_CN":{"addon":{"changeLog":"******","description":"******"},"description":{"Parameters.flavor1.description":"******","Parameters.flavor1.name":"******","Parameters.flavor2.description":"******","Parameters.flavor2.name":"******","Parameters.flavor3.description":"******","Parameters.flavor3.name":"******"}}},"updateTimestamp":"2023-02-22T06:49:50Z","version":"2.1.16"},"isRollbackable":false,"message":"","previousVersion":"2.1.19","status":"rollbacking","targetVersions":["2.1.18","2.1.19"]}}},"schema":{"$ref":"#/definitions/AddonInstance"}}},"summary":"回滚AddonInstance","tags":["插件管理"],"x-api-category":"cce","x-apiexplorer-hide":"false","x-constraint":"","x-is-registered":"Y","x-name":"回滚AddonInstance","x-order":3,"x-publishpath":"RollbackAddonInstance","x-request-examples-1":{"clusterID":"******"},"x-scope":"Commercial","x-support-sdk":"Y"}}},"product_short":"CCE","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"回滚AddonInstance","tags":"插件管理","uri":null,"version":"2.0"}