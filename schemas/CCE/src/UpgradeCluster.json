{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"ClusterUpgradeAction":{"properties":{"addons":{"description":"插件配置列表","items":{"$ref":"#/definitions/UpgradeAddonConfig"},"type":"array"},"nodeOrder":{"additionalProperties":{"description":"对应节点池内的节点升级顺序配置","items":{"$ref":"#/definitions/NodePriority"},"type":"array"},"description":"节点池内节点升级顺序配置。\n> key表示节点池ID,默认节点池取值为\"DefaultPool\"","type":"object"},"nodePoolOrder":{"additionalProperties":{"default":0,"description":"节点池的优先级,默认值为0,优先级最低,数值越大优先级越高","type":"integer"},"description":"节点池升级顺序配置,key/value对格式。\n> key表示节点池ID,默认节点池取值为\"DefaultPool\"\n> value表示对应节点池的优先级,默认值为0,优先级最低,数值越大优先级越高","type":"object"},"strategy":{"$ref":"#/definitions/UpgradeStrategy","description":"升级策略"},"targetVersion":{"description":"目标集群版本,例如\"v1.23\"","type":"string"}},"required":["strategy","targetVersion"]},"ClusterUpgradeResponseAction":{"properties":{"config":{"description":"升级过程中指定的集群配置","type":"object"},"strategy":{"$ref":"#/definitions/UpgradeStrategy","description":"升级策略"},"targetPlatformVersion":{"description":"目标集群的平台版本号,表示集群版本(version)下的内部版本,不支持用户指定。","type":"string"},"targetVersion":{"description":"目标集群版本,例如\"v1.23\"","type":"string"},"version":{"description":"当前集群版本","type":"string"}}},"InPlaceRollingUpdate":{"description":"原地升级配置","properties":{"userDefinedStep":{"description":"节点升级步长,取值范围为[1, 40],建议取值20","type":"integer"}}},"NodePriority":{"description":"节点优先级批量配置","properties":{"nodeSelector":{"$ref":"#/definitions/NodeSelector","description":"节点标签选择器,选择一批节点"},"priority":{"default":0,"description":"该批次节点的优先级,默认值为0,优先级最低,数值越大优先级越高","type":"integer"}},"required":["nodeSelector","priority"]},"NodeSelector":{"description":"节点标签选择器,匹配Kubernetes中nodeSelector相关约束","properties":{"key":{"description":"标签键","type":"string"},"operator":{"description":"标签逻辑运算符","type":"string"},"value":{"description":"标签值列表","items":{"description":"标签值","type":"string"},"type":"array"}},"required":["key","operator"]},"UpgradeAddonConfig":{"properties":{"addonTemplateName":{"description":"插件名称","type":"string"},"operation":{"description":"执行动作,当前升级场景支持操作为\"patch\"","type":"string"},"values":{"description":"插件参数列表,Key:Value格式","type":"object"},"version":{"description":"目标插件版本号","type":"string"}},"required":["addonTemplateName","operation","version"]},"UpgradeCluserResponseMetadata":{"description":"升级任务元数据","properties":{"uid":{"description":"升级任务ID,可通过调用获取集群升级任务详情API查询进展","type":"string"}}},"UpgradeClusterRequestBody":{"properties":{"metadata":{"$ref":"#/definitions/UpgradeClusterRequestMetadata","description":"升级元数据"},"spec":{"$ref":"#/definitions/UpgradeSpec","description":"升级配置信息"}},"required":["metadata","spec"]},"UpgradeClusterRequestMetadata":{"properties":{"apiVersion":{"description":"api版本,默认为v3","type":"string"},"kind":{"description":"资源类型,默认为UpgradeTask","type":"string"}},"required":["apiVersion","kind"]},"UpgradeClusterResponseBody":{"description":"原地升级配置","properties":{"metadata":{"$ref":"#/definitions/UpgradeCluserResponseMetadata","description":"升级任务元数据信息"},"spec":{"$ref":"#/definitions/UpgradeResponseSpec","description":"升级配置信息"}}},"UpgradeResponseSpec":{"description":"升级任务元数据","properties":{"clusterUpgradeAction":{"$ref":"#/definitions/ClusterUpgradeResponseAction","description":"集群升级配置"}}},"UpgradeSpec":{"properties":{"clusterUpgradeAction":{"$ref":"#/definitions/ClusterUpgradeAction","description":"集群升级配置"}}},"UpgradeStrategy":{"description":"升级配置","properties":{"inPlaceRollingUpdate":{"$ref":"#/definitions/InPlaceRollingUpdate","description":"原地升级配置,指定原地升级策略类型时必选。"},"type":{"description":"升级策略类型,当前仅支持原地升级类型\"inPlaceRollingUpdate\"","type":"string"}},"required":["type"]}},"description":null,"group_id":"394aeee55c894cd89bc6a709f45ae609","host":"cce.cn-north-4.myhuaweicloud.com","id":"a59f76ecf4f846aa91ae4218a1eda5bc","info_version":"v3","method":"post","name":"UpgradeCluster","parameters":{"param_path_clusterid":{"description":"集群ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"cluster_id","pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","required":true,"type":"string","x-order":2},"param_path_projectid":{"description":"项目ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"project_id","required":true,"type":"string","x-order":1}},"paths":{"/api/v3/projects/{project_id}/clusters/{cluster_id}/operation/upgrade":{"post":{"description":"集群升级。\n> - 集群升级涉及多维度的组件升级操作,强烈建议统一通过CCE控制台执行交互式升级,降低集群升级过程的业务意外受损风险;\n> - 当前集群升级相关接口受限开放。","operationId":"UpgradeCluster","parameters":[{"$ref":"#/parameters/param_path_projectid"},{"$ref":"#/parameters/param_path_clusterid"},{"description":"集群升级请求体","in":"body","name":"UpgradeClusterRequestBody","required":true,"schema":{"$ref":"#/definitions/UpgradeClusterRequestBody"}}],"produces":["application/json"],"responses":{"200":{"description":"表示集群升级任务下发成功。","examples":{"application/json":{"metadata":{"uid":"976a33e2-f545-11ed-87af-0255ac1002c2"},"spec":{"clusterUpgradeAction":{"config":{},"strategy":{"inPlaceRollingUpdate":{"userDefinedStep":20},"type":"inPlaceRollingUpdate"},"targetPlatformVersion":"cce.10","targetVersion":"v1.23.8-r0","version":"v1.19.16-r20"}}}},"schema":{"$ref":"#/definitions/UpgradeClusterResponseBody"}}},"summary":"集群升级","tags":["集群升级"],"x-apiexplorer-hide":"false","x-constraint":"","x-is-registered":"Y","x-name":"集群升级","x-open-region-cloud":"hws,hws_hk","x-order":1,"x-publishpath":"","x-request-examples-1":{"metadata":{"apiVersion":"v3","kind":"UpgradeTask"},"spec":{"clusterUpgradeAction":{"strategy":{"inPlaceRollingUpdate":{"userDefinedStep":20},"type":"inPlaceRollingUpdate"},"targetVersion":"v1.23"}}},"x-request-examples-description-1":"升级集群至v1.23版本,并设置节点升级步长为20。","x-request-examples-url-1":"POST /api/v3/projects/{project_id}/clusters/{cluster_id}/operation/upgrade","x-scope":"Commercial","x-support-sdk":"Y"}}},"product_short":"CCE","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"集群升级","tags":"集群升级","uri":null,"version":"2.0"}