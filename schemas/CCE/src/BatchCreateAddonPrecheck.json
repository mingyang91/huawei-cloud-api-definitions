{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"AddonCheckRequest":{"description":"插件检查-request结构体","properties":{"apiVersion":{"default":"v3","description":"**参数解释:**\nAPI版本\n**约束限制:**\n该值不可修改\n**取值范围:**\n固定值\"v3\"\n**默认取值:**\nv3","type":"string"},"kind":{"default":"AddonCheck","description":"**参数解释:**\nAPI类型\n**约束限制:**\n该值不可修改\n**取值范围:**\n固定值\"AddonCheck\"\n**默认取值:**\nAddonCheck","type":"string"},"spec":{"$ref":"#/definitions/AddonCheckSpec","description":"**参数解释:**\nspec是集合类的元素类型,内容为插件检查具体信息,检查配置的详细描述主体部分都在spec中给出\n**约束限制:**\n不涉及"}},"required":["apiVersion","kind","spec"]},"AddonCheckResponse":{"description":"插件检查任务创建-response结构体","properties":{"apiVersion":{"default":"v3","description":"**参数解释:**\nAPI版本\n**约束限制:**\n该值不可修改\n**取值范围:**\n固定值\"v3\"\n**默认取值:**\nv3","type":"string"},"kind":{"default":"AddonCheck","description":"**参数解释:**\nAPI类型\n**约束限制:**\n该值不可修改\n**取值范围:**\n固定值\"AddonCheck\"\n**默认取值:**\nAddonCheck","type":"string"},"spec":{"$ref":"#/definitions/AddonCheckSpec","description":"**参数解释:**\nspec是集合类的元素类型,内容为插件检查具体信息,检查配置的详细描述主体部分都在spec中给出\n**约束限制:**\n不涉及"},"status":{"$ref":"#/definitions/AddonCheckStatus","description":"**参数解释:**\nstatus是集合类的元素类型,内容为插件检查任务的创建结果,包含task_id用于插件检查结果查询\n**约束限制:**\n不涉及"}},"required":["apiVersion","kind","spec","status"]},"AddonCheckSpec":{"description":"插件检查Spec-request结构体","properties":{"addonList":{"description":"**参数解释:**\n插件检查信息列表,包含了需要检查的插件模板名称,插件实例ID,插件升级配置等。\n**约束限制:**\n不涉及","items":{"$ref":"#/definitions/AddonInfo","description":""},"type":"array"},"clusterID":{"description":"**参数解释:**\n集群ID\n**约束限制:**\n不涉及\n**取值范围:**\n不涉及\n**默认取值:**\n不涉及","type":"string"}},"required":["clusterID","addonList"]},"AddonCheckStatus":{"properties":{"items":{"description":"**参数解释:**\n插件检查任务信息列表,包含了插件检查任务ID,插件模板名称,插件实例ID等。\n**约束限制:**\n不涉及","items":{"$ref":"#/definitions/AddonCheckTask","description":""},"type":"array"}},"required":["items"]},"AddonCheckTask":{"properties":{"metadata":{"$ref":"#/definitions/CheckTaskMetadata","description":"**参数解释:**\n基本信息,为集合类的元素类型,包含一组由不同名称定义的属性\n**约束限制:**\n不涉及"},"spec":{"$ref":"#/definitions/CheckTaskSpec","description":"**参数解释:**\n插件检查目标信息,包含插件升级的目标版本和集群升级的目标版本\n**约束限制:**\n不涉及"},"status":{"$ref":"#/definitions/CheckTaskStatus","description":"**参数解释**:\n插件检查任务状态信息\n**约束限制**:\n不涉及"}},"required":["metadata","status"]},"AddonInfo":{"properties":{"addonInstanceID":{"description":"**参数解释:**\n插件实例ID,可以通过[获取AddonInstance列表](cce_02_0326.xml)中的items[].metadata.uid字段获取\n**约束限制:**\n此参数必填\n**取值范围:**\n不涉及\n**默认取值:**\n不涉及","type":"string"},"addonTemplateName":{"description":"**参数解释:**\n插件模板名称\n**约束限制:**\n不涉及\n**取值范围:**\ncce服务支持的插件模板\n**默认取值:**\n不涉及","type":"string"},"targetVersion":{"description":"**参数解释:**\n插件升级的目标版本\n**约束限制:**\n插件升级场景下,此参数必填。\n**取值范围:**\ncce服务提供的插件版本,可以通过[查询AddonTemplates列表](cce_02_0321.xml)中的items[].spec.versions.version字段获取\n**默认取值:**\n不涉及","type":"string"},"type":{"description":"**参数解释:**\n插件检查类型\n**约束限制:**\n此参数必填。\n**取值范围:**\n- addonStatic: 运行中插件巡检\n- addonUpgrade: 插件升级前检查\n\n**默认取值:**\n不涉及","enum":["addonStatic","addonUpgrade"],"type":"string"},"values":{"additionalProperties":{"type":"object"},"description":"**参数解释:**\n插件模板编辑/升级参数(各插件不同),请根据具体插件模板信息填写参数\n**约束限制:**\n不涉及","type":"object"}},"required":["addonTemplateName","addonInstanceID","type"]},"CheckTaskMetadata":{"properties":{"addonInstanceID":{"description":"**参数解释:**\n插件实例ID\n**取值范围:**\n不涉及","type":"string"},"addonInstanceName":{"description":"**参数解释:**\n插件实例名称\n**取值范围:**\n不涉及","type":"string"},"addonTemplateName":{"description":"**参数解释:**\n插件模板名称\n**取值范围:**\ncce服务提供的插件模板,可以通过[查询AddonTemplates列表](cce_02_0321.xml)中的items[].metadata.name字段获取","type":"string"},"createTimeStamp":{"description":"**参数解释:**\n插件检查任务创建时间\n**取值范围:**\n不涉及","type":"string"},"expireTimeStamp":{"description":"**参数解释:**\n插件检查任务超时时间,仅终态(Failed/Success)任务存在此字段\n**取值范围:**\n不涉及","type":"string"},"taskID":{"description":"**参数解释:**\n插件检查任务ID,用于任务检查结果查询\n**取值范围:**\n不涉及","type":"string"},"type":{"description":"**参数解释:**\n插件检查类型\n**取值范围:**\n- addonStatic: 运行中插件巡检\n- addonUpgrade: 插件升级前检查","enum":["addonStatic","addonUpgrade"],"type":"string"}},"required":["type","taskID","addonTemplateName","createTimeStamp"]},"CheckTaskRisk":{"properties":{"level":{"description":"**参数解释:**\n风险等级\n**取值范围:**\n- Warning: 中危,允许跳过\n- Fatal: 高危,不允许跳过","enum":["Warning","Fatal"],"type":"string"},"message":{"description":"**参数解释:**\n风险检查结果说明\n**取值范围:**\n不涉及","type":"string"},"riskName":{"description":"**参数解释:**\n风险项名称\n**取值范围:**\n不涉及","type":"string"},"status":{"description":"**参数解释:**\n风险项检查状态\n**取值范围:**\n- Init: 风险项检查状态,初始化\n- Running: 风险项检查状态,检查中\n- Failed: 风险项检查状态,检查完成有风险\n- Success: 风险项检查状态,检查完成无风险","enum":["Init","Running","Failed","Success"],"type":"string"}},"required":["riskName","status","level"]},"CheckTaskSpec":{"properties":{"addonTargetVersion":{"description":"**参数解释:**\n插件升级目标版本\n**取值范围:**\n不涉及","type":"string"}}},"CheckTaskStatus":{"properties":{"message":{"description":"**参数解释:**\n插件检查结果信息\n**取值范围:**\n不涉及","type":"string"},"riskList":{"description":"**参数解释:**\n插件检查风险项列表,不同插件对应的风险检查项不同。\n**约束限制:**\n不涉及","items":{"$ref":"#/definitions/CheckTaskRisk","description":""},"type":"array"},"status":{"description":"**参数解释:**\n插件检查状态\n**取值范围:**\n- Init: 插件检查状态,初始化\n- Running: 插件检查状态,检查中\n- Failed: 插件检查状态,检查完成有风险\n- Success: 插件检查状态,检查完成无风险","enum":["Init","Running","Failed","Success"],"type":"string"}},"required":["status","message"]}},"description":null,"group_id":"394aeee55c894cd89bc6a709f45ae609","host":"cce.cn-north-4.myhuaweicloud.com","id":"d45c7d9215e546f38e4ca5731d99520c","info_version":"v3","method":"post","name":"BatchCreateAddonPrecheck","parameters":{"param_header_content_type":{"default":"application/json","description":"消息体的类型(格式)","in":"header","name":"Content-Type","required":true,"type":"string","x-order":51},"param_header_x_auth_token":{"description":"调用接口的认证方式分为Token和AK/SK两种,如果您使用的Token方式,此参数为必填,请填写Token的值,获取方式请参见[获取token](cce_02_0004.xml)。","in":"header","maxLength":16384,"name":"X-Auth-Token","required":true,"type":"string","x-order":52},"param_path_clusterid":{"description":"集群ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"cluster_id","pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","required":true,"type":"string","x-order":2},"param_path_projectid":{"description":"项目ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"project_id","required":true,"type":"string","x-order":1}},"paths":{"/api/v3/projects/{project_id}/clusters/{cluster_id}/addons/precheck":{"post":{"consumes":["application/json"],"deprecated":false,"description":"该API用于在指定集群下批量创建插件检查任务。","operationId":"BatchCreateAddonPrecheck","parameters":[{"$ref":"#/parameters/param_path_projectid"},{"$ref":"#/parameters/param_path_clusterid"},{"$ref":"#/parameters/param_header_content_type"},{"$ref":"#/parameters/param_header_x_auth_token"},{"description":"批量创建插件检查任务的请求体","in":"body","name":"BatchCreateAddonCheckRequestBody","required":true,"schema":{"$ref":"#/definitions/AddonCheckRequest"},"x-order":501}],"produces":[],"responses":{"201":{"description":"表示在指定集群下批量创建插件检查任务下发成功。","examples":{"application/json":{"apiVersion":"v3","kind":"AddonCheck","spec":{"addonList":[{"addonInstanceID":"8fcaa506-809d-4f33-91b3-b27efcbeb540","addonTemplateName":"coredns","type":"addonUpgrade","values":{"basic":{"cluster_ip":"10.247.3.10","image_version":"1.17.15","platform":"linux-amd64","rbac_enabled":true,"swr_addr":"","swr_user":"hwofficial"},"custom":{"cluster_id":"8fcaa506-809d-4f33-91b3-b27efcbeb540","stub_domains":{},"tenant_id":"0504201b6c80256b2f08c0099f0c8fe4","upstream_nameservers":[]},"flavor":{"name":2500,"replicas":2,"resources":[{"limitsCpu":"500m","limitsMem":"512Mi","name":"coredns","requestsCpu":"500m","requestsMem":"512Mi"}]}}}],"clusterID":"6b400e1c-4368-11f0-ba56-0255ac100037"},"status":{"items":[{"metadata":{"addonInstanceID":"8fcaa506-809d-4f33-91b3-b27efcbeb540","addonInstanceName":"cceaddon-coredns","addonTemplateName":"coredns","createTimeStamp":"2025-08-13T11:24:37.312017086+08:00","taskID":"22386048-d955-4409-bc71-20cc2b774245","type":"addonUpgrade"},"spec":{"addonTargetVersion":"1.27.1"},"status":{"riskList":[{"level":"Warning","riskName":"K8sResourceModified","status":"Init"},{"level":"Warning","riskName":"AddonValidate","status":"Init"},{"level":"Warning","riskName":"AddonStatus","status":"Init"}],"status":"Init"}}]}}},"schema":{"$ref":"#/definitions/AddonCheckResponse"}}},"summary":"批量创建插件检查任务","tags":["插件管理"],"x-api-category":"cce","x-api-type":"open-api","x-apiexplorer-hide":"false","x-is-registered":"Y","x-name":"创建插件检查任务","x-open-region-cloud":"hws,hws_hk,sbc,hk_sbc,ctc,cmcc,g42,tm,hk_tm,hk_g42,hcso,hcs,ocb,hws_ocb,hws_eu,hcso_dt,dt","x-order":500,"x-publishpath":"BatchCreateAddonPrecheck","x-request-examples-1":{"apiVersion":"v3","kind":"AddonCheck","spec":{"addonList":[{"addonInstanceID":"8fcaa506-809d-4f33-91b3-b27efcbeb540","addonTemplateName":"coredns","type":"addonUpgrade","values":{"basic":{"cluster_ip":"10.247.3.10","image_version":"1.17.15","platform":"linux-amd64","rbac_enabled":true,"swr_addr":"","swr_user":"hwofficial"},"custom":{"cluster_id":"8fcaa506-809d-4f33-91b3-b27efcbeb540","stub_domains":{},"tenant_id":"0504201b6c80256b2f08c0099f0c8fe4","upstream_nameservers":[]},"flavor":{"name":2500,"replicas":2,"resources":[{"limitsCpu":"500m","limitsMem":"512Mi","name":"coredns","requestsCpu":"500m","requestsMem":"512Mi"}]}}}],"clusterID":"6b400e1c-4368-11f0-ba56-0255ac100037"}},"x-request-examples-2":{"apiVersion":"v3","kind":"AddonCheck","spec":{"addonList":[{"addonInstanceID":"8fcaa506-809d-4f33-91b3-b27efcbeb540","addonTemplateName":"coredns","type":"addonStatic"}],"clusterID":"6b400e1c-4368-11f0-ba56-0255ac100037"}},"x-request-examples-description-1":"创建一个coredns插件的检查任务,检查类型为插件升级。\n","x-request-examples-description-2":"创建一个coredns插件的检查任务,检查类型为插件巡检。\n","x-request-examples-tags-1":"hws,hws_hk","x-request-examples-url-1":"POST /api/v3/projects/{project_id}/clusters/{cluster_id}/addons/precheck","x-request-examples-url-2":"POST /api/v3/projects/{project_id}/clusters/{cluster_id}/addons/precheck","x-scope":"Commercial","x-support-sdk":"Y"}}},"product_short":"CCE","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"批量创建插件检查任务","tags":"插件管理","uri":null,"version":"2.0"}