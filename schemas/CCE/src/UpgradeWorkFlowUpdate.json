{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"LineStatus":{"properties":{"critical":{"description":"表示是否为关键线路(关键线路未执行无法取消升级流程)","type":"string"},"endPoint":{"$ref":"#/definitions/Point","description":"线路终点"},"startPoint":{"$ref":"#/definitions/Point","description":"线路起点"}}},"Metadata":{"description":"资源描述基本信息,集合类的元素类型,包含一组由不同名称定义的属性。","properties":{"annotations":{"additionalProperties":{"type":"string"},"description":"资源注解,由key/value组成","type":"object"},"creationTimestamp":{"description":"创建时间","format":"date","type":"string"},"labels":{"additionalProperties":{"type":"string"},"description":"资源标签,key/value对格式,接口保留字段,填写不会生效","type":"object"},"name":{"description":"资源名称","type":"string"},"uid":{"description":"唯一id标识","type":"string"},"updateTimestamp":{"description":"更新时间","format":"date","type":"string"}}},"Point":{"$ref":"#/definitions/TaskType"},"PointStatus":{"properties":{"endTimeStamp":{"description":"升级任务结束时间","type":"string"},"expireTimeStamp":{"description":"升级任务过期时间(当前仅升级前检查任务适用)","type":"string"},"startTimeStamp":{"description":"升级任务开始时间","type":"string"},"status":{"$ref":"#/definitions/UpgradeWorkflowTaskStatus"},"taskID":{"description":"升级任务项ID","type":"string"},"taskType":{"$ref":"#/definitions/TaskType"}}},"TaskType":{"description":"集群升级任务类型:\nCluster: 集群升级任务\nPreCheck: 集群升级预检查任务\nRollback: 集群升级回归任务\nSnapshot: 集群升级快照任务\nPostCheck: 集群升级后检查任务","enum":["Cluster","PreCheck","Rollback","Snapshot","PostCheck"],"type":"string"},"UpgradeWorkFlow":{"properties":{"apiVersion":{"default":"v3","description":"API版本,固定值“v3”,该值不可修改。","pattern":"v3","type":"string"},"kind":{"default":"WorkFlowTask","description":"API类型,固定值“WorkFlowTask”,该值不可修改。","pattern":"WorkFlowTask","type":"string"},"metadata":{"$ref":"#/definitions/Metadata","description":"升级流程的元数据信息"},"spec":{"$ref":"#/definitions/WorkFlowSpec","description":"集合类的元素类型,您对集群升级流程主体都在spec中给出。CCE通过spec的描述来创建或更新对象。"},"status":{"$ref":"#/definitions/WorkFlowStatus","description":"集合类的元素类型,用于记录本次集群升级流程的当前状态信息,包含了集群升级流程的各个流程的执行状态"}}},"UpgradeWorkFlowUpdateRequestBody":{"properties":{"status":{"description":"更新后workflow的状态(当前仅支持Cancel)","properties":{"phase":{"$ref":"#/definitions/WorkFlowPhase"}}}}},"UpgradeWorkflowTaskStatus":{"description":"集群升级状态:\nInit: 任务初始状态\nQueuing: 任务已进入执行队列\nRunning: 任务开始执行\nSuccess: 任务执行成功\nFailed: 任务执行失败","enum":["Init","Queuing","Running","Success","Failed"],"type":"string"},"WorkFlowPhase":{"description":"集群升级流程的执行状态:\nInit: 表示该升级流程中还未有任何任务开始运行\nRunning: 表示该升级流程中已有任务开始执行\nPending: 表示该升级流程中有任务执行失败\nSuccess: 表示该升级流程中所有任务都已执行成功\nCancel: 表示该升级流程已被取消","enum":["Init","Running","Pending","Success","Cancel"],"type":"string"},"WorkFlowSpec":{"properties":{"clusterID":{"description":"集群ID,资源唯一标识,创建成功后自动生成,填写无效","pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","type":"string"},"clusterVersion":{"description":"本次集群升级的当前版本","example":"v1.23.4-r0","pattern":"^v\\d\\.\\d\\.\\d-r\\d$","type":"string"},"targetVersion":{"description":"本次集群升级的目标版本","example":"v1.25.2-r0","pattern":"^v\\d\\.\\d\\.\\d-r\\d$","type":"string"}},"required":["targetVersion"]},"WorkFlowStatus":{"properties":{"lineStatuses":{"description":"表示该升级流程的任务执行线路","items":{"$ref":"#/definitions/LineStatus"},"maxItems":100,"minItems":0,"type":"array"},"phase":{"$ref":"#/definitions/WorkFlowPhase"},"pointStatuses":{"description":"升级流程中的各个任务项的执行状态","items":{"$ref":"#/definitions/PointStatus"},"maxItems":100,"minItems":0,"type":"array"}}}},"description":null,"group_id":"394aeee55c894cd89bc6a709f45ae609","host":"cce.cn-north-4.myhuaweicloud.com","id":"dcc46ca2c4e743658aa08158c07f311a","info_version":"v3","method":"patch","name":"UpgradeWorkFlowUpdate","parameters":{"param_header_content_type":{"default":"application/json","description":"消息体的类型(格式)","in":"header","name":"Content-Type","required":true,"type":"string","x-order":51},"param_header_x_auth_token":{"description":"调用接口的认证方式分为Token和AK/SK两种,如果您使用的Token方式,此参数为必填,请填写Token的值,获取方式请参见[获取token](cce_02_0004.xml)。","in":"header","maxLength":16384,"name":"X-Auth-Token","required":true,"type":"string","x-order":52},"param_path_clusterid":{"description":"集群ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"cluster_id","pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","required":true,"type":"string","x-order":2},"param_path_projectid":{"description":"项目ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"project_id","required":true,"type":"string","x-order":1},"param_path_upgradeworkflowid":{"description":"集群升级任务引导流程ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"upgrade_workflow_id","pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","required":true,"type":"string","x-order":55}},"paths":{"/api/v3/projects/{project_id}/clusters/{cluster_id}/operation/upgradeworkflows/{upgrade_workflow_id}":{"patch":{"consumes":[],"description":"该API用于更新指定集群升级引导任务状态,当前仅适用于取消升级流程\n调用该API时升级流程引导任务状态不能为进行中(running) 已完成(success) 已取消(cancel),升级子任务状态不能为running(进行中) init(已初始化) pause(任务被暂停) queue(队列中)","operationId":"UpgradeWorkFlowUpdate","parameters":[{"$ref":"#/parameters/param_path_projectid"},{"$ref":"#/parameters/param_path_clusterid"},{"$ref":"#/parameters/param_path_upgradeworkflowid"},{"$ref":"#/parameters/param_header_content_type"},{"$ref":"#/parameters/param_header_x_auth_token"},{"description":"更新集群升级流程引导任务请求体","in":"body","name":"UpgradeWorkFlowUpdateRequestBody","required":true,"schema":{"$ref":"#/definitions/UpgradeWorkFlowUpdateRequestBody"},"x-order":500}],"produces":[],"responses":{"200":{"description":"表示更新集群升级引导任务状态成功","examples":{"application/json":{"apiVersion":"v3","kind":"WorkFlowTask","metadata":{"creationTimestamp":"2023-11-25 06:32:34.923248 +0000 UTC","uid":"c271e39e-1a6e-4d3d-8fa8-2a36329c68d1","updateTimestamp":"2023-11-25 07:49:30.281911 +0000 UTC"},"spec":{"clusterID":"b4b9e60f-8aa2-11ee-af09-0255ac10004f","clusterVersion":"v1.17.17-r0","targetVersion":"v1.19.16-r80"},"status":{"lineStatuses":[{"endPoint":{"taskType":"Cluster"},"startPoint":{"taskType":"PreCheck"}},{"endPoint":{"taskType":"PostCheck"},"startPoint":{"taskType":"Cluster"}}],"phase":"Cancel","pointStatuses":[{"endTimeStamp":"2023-11-25 07:21:05.518966 +0000 UTC","expireTimeStamp":"2023-11-25 08:21:05.518966 +0000 UTC","startTimeStamp":"2023-11-25 07:20:04.592972 +0000 UTC","status":"Success","taskID":"f61e008c-1600-41c0-9bde-121de5a30660","taskType":"PreCheck"},{"taskType":"Snapshot"},{"endTimeStamp":"2023-11-25 07:58:35.507243 +0000 UTC","startTimeStamp":"2023-11-25 07:49:30.283459 +0000 UTC","status":"Failed","taskID":"6d799ff6-3afe-4242-80b4-6f0a0fa746cb","taskType":"Cluster"},{"taskType":"PostCheck"}]}}},"schema":{"$ref":"#/definitions/UpgradeWorkFlow"}}},"summary":"更新指定集群升级引导任务状态","tags":["集群升级"],"x-api-type":"open-api","x-apiexplorer-hide":"false","x-constraint":"","x-is-registered":"Y","x-name":"更新指定集群升级引导任务状态详情","x-order":19,"x-publishpath":"","x-request-examples-1":{"status":{"phase":"Cancel"}},"x-request-examples-description-1":"取消升级流程","x-request-examples-url-1":"PATCH /api/v3/projects/47eb1d64cbeb45cfa01ae20af4f4b563/clusters/f9960c6b-8e60-11ee-9754-0255ac100b05/operation/upgradeworkflows/d0b7e319-8172-424c-86ea-543cd23f9756","x-scope":"Commercial","x-support-sdk":"Y"}}},"product_short":"CCE","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"更新指定集群升级引导任务状态","tags":"集群升级","uri":null,"version":"2.0"}