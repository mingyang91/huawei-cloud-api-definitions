{"base_path":null,"components":null,"consumes":"","definitions":{"AggregateMetric":{"description":"查询指标","properties":{"expression":{"description":"表达式","example":"avg(x1)","maxLength":64,"minLength":0,"type":"string"},"inputs":{"description":"声明属性作为表达式参数","items":{"$ref":"#/definitions/InputParam"},"maxItems":1,"minItems":1,"type":"array"},"metric_name":{"description":"指标名称","example":"temperature_avg","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9_]{1,64}$","type":"string"}},"required":["expression","inputs","metric_name"],"type":"object"},"AggregateMetrics":{"description":"聚合计算定义","properties":{"interval":{"description":"聚合时间间隔, 示例:\"1d|1h|10m|10s\"","example":"1d|1h|10m|10s","maxLength":32,"minLength":1,"type":"string"},"limit":{"default":100,"description":"返回值个数限制","example":100,"format":"int32","maximum":2000,"minimum":1,"type":"integer"},"metrics":{"description":"查询的测量指标列表","items":{"$ref":"#/definitions/AggregateMetric"},"maxItems":20,"minItems":1,"type":"array"},"offset":{"description":"聚合时间偏移量, 需要小于interval, 示例: \"1h|10m|10s\"","example":"1h|10m|10s","maxLength":32,"minLength":1,"type":"string"},"tags":{"$ref":"#/definitions/TagFilter"},"time_span":{"$ref":"#/definitions/TimeSpan"}},"required":["metrics","tags","time_span"],"type":"object"},"ErrorMessage":{"properties":{"error_code":{"description":"错误编码","type":"string"},"error_msg":{"description":"错误消息","type":"string"}},"type":"object"},"GetMetricsRequest":{"description":"查询指标请求","properties":{"aggregate":{"$ref":"#/definitions/AggregateMetrics"},"transform":{"$ref":"#/definitions/TransformMetrics"},"type":{"description":"查询类型","example":"aggregate","maxLength":64,"minLength":1,"pattern":"transform|aggregate","type":"string"}},"required":["type"],"type":"object"},"GetMetricsResponse":{"description":"聚合与转换查询结果","properties":{"metrics":{"description":"查询的测量指标列表","items":{"$ref":"#/definitions/MetricList"},"maxItems":20,"minItems":1,"type":"array"},"timestamps":{"description":"时间序列","items":{"example":"2021-01-08T02:03:41.907Z","type":"string"},"maxItems":2000,"minItems":0,"type":"array"}},"type":"object"},"InputParam":{"description":"属性定义为输入参数","properties":{"name":{"description":"参数名称","example":"x1","pattern":"^[a-zA-Z][a-zA-Z_0-9]{0,31}$","type":"string"},"property_name":{"description":"属性名称","example":"prop_1","pattern":"^[a-zA-Z0-9_]{1,64}$","type":"string"}},"required":["name","property_name"],"type":"object"},"MetricList":{"properties":{"metric_name":{"description":"metric 名称","maxLength":64,"minLength":1,"type":"string"},"values":{"description":"计算结果","items":{"properties":{},"type":"object"},"maxItems":2000,"minItems":0,"type":"array"}},"type":"object"},"TagFilter":{"additionalProperties":{"description":"设备标签过滤值","type":"string"},"description":"对property按指定tags标签进行过滤查询,填入设备标签与标签值,不可为空,例如 {\"deviceId\": \"id0001\"}","example":{"deviceId":"IA2006300"},"type":"object"},"TimeSpan":{"description":"起止时间范围","properties":{"from":{"description":"起始时间","example":"2021-02-01T00:00:00.123Z","maxLength":64,"minLength":1,"type":"string"},"to":{"description":"结束时间","example":"2021-02-05T20:00:00.100Z","maxLength":64,"minLength":1,"type":"string"}},"required":["from","to"],"type":"object"},"TransformMetric":{"description":"查询指标","properties":{"expression":{"description":"表达式","example":"floor(x1)","maxLength":64,"minLength":0,"type":"string"},"inputs":{"description":"声明属性作为表达式参数","items":{"$ref":"#/definitions/InputParam"},"maxItems":3,"minItems":1,"type":"array"},"metric_name":{"description":"指标名称","example":"temperature_floor","maxLength":64,"minLength":1,"pattern":"^[a-zA-Z0-9_]{1,64}$","type":"string"}},"required":["expression","inputs","metric_name"],"type":"object"},"TransformMetrics":{"description":"转换计算定义","properties":{"limit":{"default":100,"description":"返回值个数限制","example":100,"format":"int32","maximum":2000,"minimum":1,"type":"integer"},"metrics":{"description":"查询的测量指标列表","items":{"$ref":"#/definitions/TransformMetric"},"maxItems":20,"minItems":1,"type":"array"},"tags":{"$ref":"#/definitions/TagFilter"},"time_span":{"$ref":"#/definitions/TimeSpan"}},"required":["metrics","tags","time_span"],"type":"object"}},"description":null,"group_id":"cfd5b7ef8cbe41c8b49ff6f50523b75d","host":"iota.cn-north-4.myhuaweicloud.com","id":"5c95166bbc864098a8cf0d8bd4c33321","info_version":"v1","method":"post","name":"ListMetrics","parameters":{},"paths":{"/v1/{project_id}/data-stores/{data_store_id}/metrics/query":{"post":{"consumes":["application/json"],"description":"根据标签聚合、查询数据","operationId":"ListMetrics","parameters":[{"description":"项目ID","in":"path","maxLength":128,"minLength":1,"name":"project_id","pattern":"^[-a-zA-Z0-9]{1,128}$","required":true,"type":"string"},{"description":"存储ID","in":"path","maxLength":64,"minLength":1,"name":"data_store_id","pattern":"^[-a-zA-Z0-9]{1,64}$","required":true,"type":"string"},{"description":"租户鉴权Token","in":"header","maxLength":65535,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string","x-maxLength":65535},{"description":"设备时序聚合查询参数","in":"body","name":"ListMetricsRequestBody","required":true,"schema":{"$ref":"#/definitions/GetMetricsRequest"}}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/GetMetricsResponse"}},"400":{"description":"Bad Request","examples":{"application/json-1":{"error_code":"IoTA.99000010","error_msg":"参数错误"}},"schema":{"$ref":"#/definitions/ErrorMessage"},"x-Error":["IoTA.99000010"]},"401":{"description":"Unauthorized","examples":{"application/json-1":{"error_code":"IoTA.99000003","error_msg":"未授权"}},"schema":{"$ref":"#/definitions/ErrorMessage"},"x-Error":["IoTA.99000003"]},"403":{"description":"Forbidden","examples":{"application/json-1":{"error_code":"IoTA.99000007","error_msg":"未开通数据分析服务"},"application/json-2":{"error_code":"IoTA.99000008","error_msg":"数据分析服务被冻结"}},"schema":{"$ref":"#/definitions/ErrorMessage"},"x-Error":["IoTA.99000007","IoTA.99000008"]},"500":{"description":"Internal Server Error","examples":{"application/json-1":{"error_code":"IoTA.99999999","error_msg":"服务内部错误"}},"schema":{"$ref":"#/definitions/ErrorMessage"},"x-Error":["IoTA.99999999"]}},"summary":"根据标签聚合、查询指标数据","tags":["DataStoreQuery"],"x-externalAPI":"YES","x-iftype":"OpenAPI","x-imports":"org.springframework.http.ResponseEntity;","x-is-registered":"Y","x-open-for-CLOUD":"Y","x-open-for-HCS":"Y","x-returnType":"ResponseEntity<GetMetricsResponse>","x-support-sdk":"Y"}}},"product_short":"IoTAnalytics","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"根据标签聚合、查询指标数据","tags":"设备存储数据查询","uri":null,"version":"2.0"}