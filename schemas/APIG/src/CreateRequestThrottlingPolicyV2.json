{"base_path":"/v2","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"ErrorMsg":{"properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误描述","type":"string"}},"required":["error_code","error_msg"]},"ThrottleBaseInfo":{"properties":{"api_call_limits":{"description":"API流量限制是指时长内一个API能够被访问的次数上限。该值不超过系统默认配额限制,系统默认配额为200tps,用户可根据实际情况修改该系统默认配额。输入的值不超过2147483647。正整数。","example":800,"format":"int32","type":"integer"},"app_call_limits":{"description":"APP流量限制是指一个API在时长之内被每个APP访问的次数上限,该数值不超过用户流量限制值。输入的值不超过2147483647。正整数。","example":300,"format":"int32","type":"integer"},"enable_adaptive_control":{"description":"是否开启动态流控:\n- TRUE\n- FALSE\n\n暂不支持","example":false,"type":"string"},"ip_call_limits":{"description":"源IP流量限制是指一个API在时长之内被每个IP访问的次数上限,该数值不超过API流量限制值。输入的值不超过2147483647。正整数。","example":600,"format":"int32","type":"integer"},"name":{"description":"流控策略名称。支持汉字,英文,数字,下划线,且只能以英文和汉字开头,3 ~ 64字符。\n> 中文字符必须为UTF-8或者unicode编码。","example":"throttleName","type":"string"},"remark":{"description":"流控策略描述字符长度不超过255。\n> 中文字符必须为UTF-8或者unicode编码。","example":"API每秒800次,用户500次,APP300次,IP600次","type":"string"},"time_interval":{"description":"流量控制的时长单位。与“流量限制次数”配合使用,表示单位时间内的API请求次数上限。输入的值不超过2147483647。正整数。","example":1,"format":"int32","type":"integer"},"time_unit":{"description":"流控的时间单位","enum":["SECOND","MINUTE","HOUR","DAY"],"example":"SECOND","type":"string"},"type":{"description":"流控策略的类型\n- 1:基础,表示绑定到流控策略的单个API流控时间内能够被调用多少次。\n- 2:共享,表示绑定到流控策略的所有API流控时间内能够被调用多少次。","enum":[1,2],"example":1,"format":"int32","type":"integer"},"user_call_limits":{"description":"用户流量限制是指一个API在时长之内每一个用户能访问的次数上限,该数值不超过API流量限制值。输入的值不超过2147483647。正整数。","example":500,"format":"int32","type":"integer"}},"required":["name","api_call_limits","time_interval","time_unit"]},"ThrottlesInfo":{"allOf":[{"$ref":"#/definitions/ThrottleBaseInfo"},{"properties":{"bind_num":{"description":"流控绑定的API数量","format":"int32","type":"integer"},"create_time":{"description":"创建时间","format":"date-time","type":"string"},"id":{"description":"流控策略的ID","type":"string"},"is_inclu_special_throttle":{"description":"是否包含特殊流控配置\n- 1:包含\n- 2:不包含","enum":[1,2],"format":"int32","type":"integer"}},"type":"object"}]}},"description":null,"group_id":"d0b771ab4a6d46a895580726f0d5479b","host":"apig.cn-north-4.myhuaweicloud.com","id":"c5c56ce662c047fcb8f01985538a97de","info_version":"v2","method":"post","name":"CreateRequestThrottlingPolicyV2","parameters":{"apic_instance_id":{"description":"实例ID,在API网关控制台的“实例信息”中获取。","in":"path","name":"instance_id","required":true,"type":"string","x-example":"f0fa1789-3b76-433b-a787-9892951c620e","x-sec-authority-parameter":"Y"},"apic_project_id":{"description":"项目ID,获取方式请参见[获取项目ID](apig-api-180713009.xml)。","in":"path","name":"project_id","required":true,"type":"string","x-example":"73d69ae0cfcf460190522d06b60f05ad","x-sec-authority-parameter":"Y"},"apic_x_auth_token":{"description":"用户Token。通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."}},"paths":{"/{project_id}/apigw/instances/{instance_id}/throttles":{"post":{"description":"当API上线后,系统会默认给每个API提供一个流控策略,API提供者可以根据自身API的服务能力及负载情况变更这个流控策略。\n流控策略即限制API在一定长度的时间内,能够允许被访问的最大次数。","operationId":"CreateRequestThrottlingPolicyV2","parameters":[{"$ref":"#/parameters/apic_x_auth_token"},{"$ref":"#/parameters/apic_project_id"},{"$ref":"#/parameters/apic_instance_id"},{"description":"创建流控策略的请求体","in":"body","name":"CreateRequestThrottlingPolicyV2RequestBody","required":true,"schema":{"$ref":"#/definitions/ThrottleBaseInfo"}}],"responses":{"201":{"description":"Created","examples":{"application/json":{"api_call_limits":800,"app_call_limits":300,"bind_num":0,"create_time":"2020-07-31T08:44:02.205366118Z","enable_adaptive_control":"FALSE","id":"3437448ad06f4e0c91a224183116e965","ip_call_limits":600,"is_inclu_special_throttle":2,"name":"throttle_demo","remark":"Total: 800 calls/second; user: 500 calls/second; app: 300 calls/second; IP address: 600 calls/second","time_interval":1,"time_unit":"SECOND","type":1,"user_call_limits":500}},"schema":{"$ref":"#/definitions/ThrottlesInfo"}},"400":{"description":"Bad Request","examples":{"application/json":{"error_code":"APIG.2011","error_msg":"Invalid parameter value,parameterName:name. Please refer to the support documentation"}},"schema":{"$ref":"#/definitions/ErrorMsg"}},"401":{"description":"Unauthorized","examples":{"application/json":{"error_code":"APIG.1002","error_msg":"Incorrect token or token resolution failed"}},"schema":{"$ref":"#/definitions/ErrorMsg"}},"403":{"description":"Forbidden","examples":{"application/json":{"error_code":"APIG.1005","error_msg":"No permissions to request this method"}},"schema":{"$ref":"#/definitions/ErrorMsg"}},"500":{"description":"Internal Server Error","examples":{"application/json":{"error_code":"APIG.9999","error_msg":"System error"}},"schema":{"$ref":"#/definitions/ErrorMsg"}}},"schemes":["https"],"summary":"创建流控策略","tags":["专享版-流控策略管理"],"x-api-framework":"RestfulAPI","x-api-position":"管理面","x-api-type":"open-api","x-api-user":"IAM普通租户","x-apigateway-request-type":"public","x-is-registered":"Y","x-open-region-cloud":"hws,hws_hk,cmcc,ctc,dt,g42,hk_g42,hk_sbc,hk_tm,hws_eu,hws_ocb,ocb,sbc,tm,srg,ax","x-order":1,"x-produc-type":"apig","x-request-examples-1":{"api_call_limits":800,"app_call_limits":300,"enable_adaptive_control":"FALSE","ip_call_limits":600,"name":"throttle_demo","remark":"Total: 800 calls/second; user: 500 calls/second; app: 300 calls/second; IP address: 600 calls/second","time_interval":1,"time_unit":"SECOND","type":1,"user_call_limits":500},"x-request-examples-description-1":"创建一个流控策略,API流量限制为800,用户流量限制为500,app流量限制为300,源IP流量限制为600,时长为1秒","x-support-sdk":"Y"}}},"product_short":"APIG","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建流控策略","tags":"专享版-流控策略管理","uri":null,"version":"2.0"}