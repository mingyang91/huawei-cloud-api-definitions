{"base_path":"/v2","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"OrchestrationBaseInfo":{"description":"编排规则。\n\n单个实例允许创建的编排规则有配额限制,具体请参见产品介绍的“配额说明”章节。","properties":{"is_preprocessing":{"description":"是否为预处理策略,预处理策略只会生成临时参数作为后面参数编排规则的入参标记。当为预处理策略时,该编排规则不能作为除default之外的最后一个编排规则。","example":false,"type":"boolean"},"orchestration_mapped_param":{"$ref":"#/definitions/OrchestrationMappedParam","description":"编排后的参数配置,isPreprocessing为false时必填。"},"orchestration_name":{"description":"编排映射规则名称。\n\n支持英文,数字,下划线,且只能以英文开头,3-64个字符,同一实例下不允许重名。","example":"orchestration_demo","maxLength":64,"minLength":3,"pattern":"^[a-zA-Z][a-zA-Z0-9_]{2,63}$","type":"string"},"orchestration_strategy":{"description":"编排策略,有以下几种策略类型:\n- list:列表;\n- hash:哈希;\n- range:区间;\n- hash_range: 哈希+区间;\n- none_value: 空值映射;\n- default: 默认值映射;\n- head_n: 截取前n项;\n- tail_n: 截取后n项;\n当编排策略为list时,orchestration_map列表长度*map_param_list长度不超过3000。","enum":["list","hash","range","hash_range","none_value","default","head_n","tail_n"],"example":"range","type":"string"}},"required":["orchestration_name","orchestration_strategy"]},"OrchestrationCreate":{"allOf":[{"$ref":"#/definitions/OrchestrationBaseInfo"},{"properties":{"orchestration_map":{"description":"编排映射规则列表,列表长度范围为1-300。\n编排映射规则的生效优先级与列表顺序保持一致,列表中靠前的配置匹配优先级较高。\n映射规则不能重复,当orchestration_strategy=list时,map_param_list的列表也不能包含重复元素。","items":{"$ref":"#/definitions/OrchestrationMap"},"maxItems":300,"minItems":1,"type":"array"}},"type":"object"}]},"OrchestrationInfo":{"allOf":[{"$ref":"#/definitions/OrchestrationCreate"},{"properties":{"orchestration_create_time":{"description":"编排规则创建时间。","example":"2023-07-02T12:31:23.353Z","format":"date-time","type":"string"},"orchestration_id":{"description":"编排规则编号。","example":"yt655e81d9cb4424bf704ef2b0ac7600","type":"string"},"orchestration_update_time":{"description":"编排规则更新时间。","example":"2023-07-02T12:31:23.353Z","format":"date-time","type":"string"}},"type":"object"}],"description":"编排规则详情。"},"OrchestrationMap":{"description":"编排映射规则。","properties":{"intercept_length":{"description":"截取长度,取值范围为1-100,当策略类型为head_n和tail_n时必填,当截取长度大于参数长度时,截取参数的结果为完整参数。","example":2,"maximum":100,"minimum":1,"type":"integer"},"map_param_list":{"description":"用于映射编排后参数的列表配置,当orchestration_strategy=list时必填,列表长度范围为0-3000。\n\n列表的取值只支持英文,数字,中划线和下划线,1-128个字符。","items":{"maxLength":128,"minLength":1,"pattern":"^[a-zA-Z0-9-_]{1,128}$","type":"string"},"maxItems":3000,"minItems":0,"type":"array"},"map_param_range":{"$ref":"#/definitions/OrchestrationMapParamRange","description":"用于映射编排后参数的区间配置,当orchestration_strategy=range或hash_range时必填。"},"mapped_param_value":{"description":"编排后的参数取值,只支持英文和数字,1-128个字符。\n当orchestration_strategy为hash、head_n、tail_n,或者is_preprocessing为false时,非必填,其他情况必填。","example":"1","maxLength":128,"minLength":0,"pattern":"^[a-zA-Z0-9]{1,128}$","type":"string"}}},"OrchestrationMapParamRange":{"description":"参数区间编排配置。","properties":{"range_end":{"description":"区间终止值。\n\n为可以转换成integer的string,转换后的range_end的范围为0-9223372036854775807,\nrange_start不大于range_end。","example":"1000","pattern":"^(\\d|[1-9]\\d{1,17}|[1-8]\\d{18}|9[01]\\d{17}|92[01]\\d{16}|922[0-2]\\d{15}|9223[0-2]\\d{14}|92233[0-6]\\d{13}|922337[01]\\d{12}|92233720[0-2]\\d{10}|922337203[0-5]\\d{9}|9223372036[0-7]\\d{8}|92233720368[0-4]\\d{7}|922337203685[0-3]\\d{6}|9223372036854[0-6]\\d{5}|92233720368547[0-6]\\d{4}|922337203685477[0-4]\\d{3}|9223372036854775[0-7]\\d{2}|922337203685477580[0-7])$","type":"string"},"range_start":{"description":"区间起始值。\n\n为可以转换成integer的string,转换后的range_start的范围为0-9223372036854775807,\nrange_start不大于range_end。","example":"1","pattern":"^(\\d|[1-9]\\d{1,17}|[1-8]\\d{18}|9[01]\\d{17}|92[01]\\d{16}|922[0-2]\\d{15}|9223[0-2]\\d{14}|92233[0-6]\\d{13}|922337[01]\\d{12}|92233720[0-2]\\d{10}|922337203[0-5]\\d{9}|9223372036[0-7]\\d{8}|92233720368[0-4]\\d{7}|922337203685[0-3]\\d{6}|9223372036854[0-6]\\d{5}|92233720368547[0-6]\\d{4}|922337203685477[0-4]\\d{3}|9223372036854775[0-7]\\d{2}|922337203685477580[0-7])$","type":"string"}}},"OrchestrationMappedParam":{"description":"编排后的参数配置。","properties":{"mapped_param_location":{"description":"编排后的参数位置,支持query和header。","enum":["query","header"],"example":"header","type":"string"},"mapped_param_name":{"description":"编排后的请求参数名,只支持英文,数字,中划线,必须以英文开头,1-128个字符,不能与已有的参数重名,默认会透传到后端。","example":"mapped-param","maxLength":128,"minLength":1,"pattern":"^[a-zA-Z][a-zA-Z0-9-]{0,127}$","type":"string"},"mapped_param_type":{"description":"编排后的参数类型,支持string和number。","enum":["string","number"],"example":"string","type":"string"}},"required":["mapped_param_name","mapped_param_type","mapped_param_location"]},"ResponseModel":{"properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误描述","type":"string"}},"required":["error_code","error_msg"]}},"description":null,"group_id":"d0b771ab4a6d46a895580726f0d5479b","host":"apig.cn-north-4.myhuaweicloud.com","id":"1fa78e0100c745e88517c9cf22a19c25","info_version":"v2","method":"post","name":"CreateOrchestration","parameters":{"apic_instance_id":{"description":"实例ID,在API网关控制台的“实例信息”中获取。","in":"path","name":"instance_id","required":true,"type":"string","x-example":"f0fa1789-3b76-433b-a787-9892951c620e","x-sec-authority-parameter":"Y"},"apic_project_id":{"description":"项目ID,获取方式请参见[获取项目ID](apig-api-180713009.xml)。","in":"path","name":"project_id","required":true,"type":"string","x-example":"73d69ae0cfcf460190522d06b60f05ad","x-sec-authority-parameter":"Y"},"apic_x_auth_token":{"description":"用户Token。通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."}},"paths":{"/{project_id}/apigw/instances/{instance_id}/orchestrations":{"post":{"description":"创建编排规则","operationId":"CreateOrchestration","parameters":[{"$ref":"#/parameters/apic_project_id"},{"$ref":"#/parameters/apic_instance_id"},{"$ref":"#/parameters/apic_x_auth_token"},{"description":"创建编排规则的请求体。","in":"body","name":"CreateOrchestrationRequestBody","required":true,"schema":{"$ref":"#/definitions/OrchestrationCreate"}}],"responses":{"201":{"description":"Created","examples":{"application/json":{"orchestration_create_time":"2023-07-02T12:31:23.353Z","orchestration_id":"76545e81d9cb4424bf704ef2b0ac7600","orchestration_map":[{"map_param_list":["10001","10002"],"mapped_param_value":"1"},{"map_param_list":["10003","10004"],"mapped_param_value":"2"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_1","orchestration_strategy":"list","orchestration_update_time":"2023-07-02T13:31:23.353Z"},"application/json-1":{"orchestration_create_time":"2023-07-02T12:31:23.353Z","orchestration_id":"yt655e81d9cb4424bf704ef2b0ac7600","orchestration_map":[{"map_param_range":{"range_end":"1000","range_start":"1"},"mapped_param_value":"1"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_2","orchestration_strategy":"range","orchestration_update_time":"2023-07-02T13:31:23.353Z"},"application/json-2":{"orchestration_create_time":"2023-07-02T12:31:23.353Z","orchestration_id":"a7655e81d9cb4424bf704ef2b0ac7600","orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_3","orchestration_strategy":"hash","orchestration_update_time":"2023-07-02T13:31:23.353Z"}},"schema":{"$ref":"#/definitions/OrchestrationInfo"}},"400":{"description":"Bad Request","examples":{"application/json":{"error_code":"APIG.2012","error_msg":"Invalid parameter value,parameterName:instance_id. Please refer to the support documentation"}},"schema":{"$ref":"#/definitions/ResponseModel"}},"401":{"description":"Unauthorized","examples":{"application/json":{"error_code":"APIG.1002","error_msg":"Incorrect token or token resolution failed"}},"schema":{"$ref":"#/definitions/ResponseModel"}},"403":{"description":"Forbidden","examples":{"application/json":{"error_code":"APIG.1005","error_msg":"No permissions to request this method"}},"schema":{"$ref":"#/definitions/ResponseModel"}},"404":{"description":"Not Found","examples":{"application/json":{"error_code":"APIG.3030","error_msg":"The instance does not exist;id:f0fa1789-3b76-433b-a787-9892951c620ec"}},"schema":{"$ref":"#/definitions/ResponseModel"}},"500":{"description":"Internal Server Error","examples":{"application/json":{"error_code":"APIG.9999","error_msg":"System error"}},"schema":{"$ref":"#/definitions/ResponseModel"}}},"schemes":["https"],"summary":"创建编排规则","tags":["专享版-编排规则管理"],"x-api-framework":"RestfulAPI","x-api-highrisk":"N","x-api-position":"Region_ZONE","x-api-type":"open-api","x-api-user":"IAM_User","x-api-version":"V2","x-apiErrorCodes":[],"x-apigateway-request-type":"public","x-hybridcloud":true,"x-is-registered":"Y","x-open-region-cloud":"hws,hws_hk","x-order":1,"x-request-examples-1":{"is_preprocessing":false,"orchestration_map":[{"map_param_list":["10001","10002"],"mapped_param_value":"1"},{"map_param_list":["10003","10004"],"mapped_param_value":"2"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_1","orchestration_strategy":"list"},"x-request-examples-2":{"orchestration_map":[{"map_param_range":{"range_end":"1000","range_start":"1"},"mapped_param_value":"1"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_2","orchestration_strategy":"range"},"x-request-examples-3":{"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_3","orchestration_strategy":"hash"},"x-request-examples-4":{"orchestration_map":[{"map_param_range":{"range_end":"1000","range_start":"1"},"mapped_param_value":"1"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_4","orchestration_strategy":"hash_range"},"x-request-examples-5":{"orchestration_map":[{"mapped_param_value":"1"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_5","orchestration_strategy":"none_value"},"x-request-examples-6":{"orchestration_map":[{"mapped_param_value":"1"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_6","orchestration_strategy":"default"},"x-request-examples-7":{"orchestration_map":[{"intercept_length":10,"mapped_param_value":"1"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_7","orchestration_strategy":"head_n"},"x-request-examples-8":{"orchestration_map":[{"intercept_length":10,"mapped_param_value":"1"}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_8","orchestration_strategy":"tail_n"},"x-request-examples-9":{"is_preprocessing":true,"orchestration_map":[{"intercept_length":10}],"orchestration_mapped_param":{"mapped_param_location":"header","mapped_param_name":"shared-tag","mapped_param_type":"number"},"orchestration_name":"orchestration_demo_8","orchestration_strategy":"tail_n"},"x-request-examples-description-1":"创建list策略编排规则示例。","x-request-examples-description-2":"创建range策略编排规则示例。","x-request-examples-description-3":"创建hash策略编排规则示例。","x-request-examples-description-4":"创建hash_range策略编排规则示例。","x-request-examples-description-5":"创建none_value策略编排规则示例。","x-request-examples-description-6":"创建default策略编排规则示例。","x-request-examples-description-7":"创建head_n策略编排规则示例。","x-request-examples-description-8":"创建tail_n策略编排规则示例。","x-request-examples-description-9":"创建tail_n预处理策略编排规则示例。","x-sec-auditlog":"Y","x-sec-authority-parameter-body":null,"x-sec-authority-parameter-url":"project_id,instance_id","x-sec-privacy-parameter":null,"x-sec-sensitiveinfo":null,"x-sec-upload-download":0,"x-sec-userinput-untrust":null,"x-support-sdk":"Y"}}},"product_short":"APIG","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建编排规则","tags":"专享版-编排规则管理","uri":null,"version":"2.0"}