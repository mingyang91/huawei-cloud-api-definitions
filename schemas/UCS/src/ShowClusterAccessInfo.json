{"base_path":null,"components":null,"consumes":"","definitions":{},"description":null,"group_id":"51968f2e01f5406291357ae9c8b522a0","host":"ucs.myhuaweicloud.com","id":"f943f705f441457da9426e77c8cdd959","info_version":"v1","method":"get","name":"ShowClusterAccessInfo","parameters":{},"paths":{"/v1/clusters/{clusterid}/accessinfo":{"get":{"consumes":["application/json"],"description":"该API接口用于获取集群接入信息;传入的cluster ID必须符合k8s UUID的格式规则;同时需要用户有对应集群证书的获取权限,否则会鉴权失败;agent证书只可以下载一次。仅用于获取三方集群的集群接入信息,CCE集群不从该接口获取,如果传入CCE集群ID,返回码为400","operationId":"ShowClusterAccessInfo","parameters":[{"description":"集群ID","in":"path","name":"clusterid","required":true,"type":"string"},{"description":"身份认证信息","in":"header","maxLength":16384,"minLength":1,"name":"X-Auth-Token","required":true,"type":"string"},{"description":"VPC终端节点的IP地址。私网接入的集群必填,且必须是打通线下集群的VPC终端节点。\n\n创建VPC终端节点及查询IP地址的方法请参见[创建终端节点](https://support.huaweicloud.com/usermanual-ucs/ucs_01_0336.html#section2)。","in":"query","name":"vpcendpoint","required":false,"type":"string"},{"description":"接入region,私网接入的集群必填","in":"query","name":"region","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"返回集群接入信息;如果已经调用过该接口则返回“已下载”","examples":{"application/json":"[\n  {\n    \"apiVersion\": \"apps/v1\",\n    \"kind\": \"Deployment\",\n    \"metadata\": {\n      \"labels\": {\n        \"app\": \"proxy-agent\"\n      },\n      \"name\": \"proxy-agent\",\n      \"namespace\": \"kube-system\"\n    },\n    \"spec\": {\n      \"replicas\": 2,\n      \"template\": {\n        \"metadata\": {\n          \"labels\": {\n            \"app\": \"proxy-agent\"\n          }\n        },\n        \"spec\": {\n          \"tolerations\": [\n            {\n              \"key\": \"role\",\n              \"operator\": \"Equal\",\n              \"value\": \"manage\"\n            }\n          ],\n          \"containers\": [\n            {\n              \"command\": [\n                \"/proxy-agent\"\n              ],\n              \"args\": [\n                \"--logtostderr=true\",\n                \"--ca-cert=/var/certs/agent/ca.crt\",\n                \"--agent-cert=/var/certs/agent/proxy-agent.crt\",\n                \"--agent-key=/var/certs/agent/proxy-agent.key\",\n                \"--proxy-server-host=proxyurl.ucs.myhuaweicloud.com\",\n                \"--proxy-server-port=30123\",\n                \"--agent-id={uuid}\",\n                \"--agent-identifiers=host={ip_addr}\"\n              ],\n              \"image\": \"{image_addr}\",\n              \"imagePullPolicy\": \"IfNotPresent\",\n              \"name\": \"proxy-agent\"\n            }\n          ],\n          \"priorityClassName\": \"system-cluster-critical\",\n          \"hostAliases\": [\n            {\n              \"ip\": \"{ip_addr}\",\n              \"hostnames\": [\n                \"proxyurl.ucs.myhuaweicloud.com\"\n              ]\n            }\n          ]\n        }\n      }\n    }\n  },\n  {\n    \"apiVersion\": \"v1\",\n    \"kind\": \"Secret\",\n    \"metadata\": {\n      \"name\": \"proxy-agent-cert\",\n      \"namespace\": \"kube-system\"\n    },\n    \"type\": \"Opaque\",\n    \"data\": {\n      \"ca.crt\": \"{ca crt}\",\n      \"proxy-agent.crt\": \"{proxy-agent crt}\",\n      \"proxy-agent.key\": \"{proxy-agent key}\",\n      \"common_shared.key\": \"{common_shared key}\",\n      \"root.key\": \"{root key}\"\n    }\n  }\n]"},"schema":{"items":{"format":"byte","pattern":"^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$","type":"string"},"type":"array"}},"400":{"description":"客户端请求错误,服务器无法执行请求","schema":{"type":"string"}},"403":{"description":"服务器拒绝执行请求","schema":{"type":"string"}},"500":{"description":"服务器内部错误","schema":{"type":"string"}}},"summary":"获取集群接入信息","tags":["UCS集群"],"x-api-type":"open-api","x-apidesigner":5,"x-is-registered":"Y","x-is-support-cmc":"Y","x-order":5,"x-support-sdk":"Y"}}},"product_short":"UCS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"获取集群接入信息","tags":"UCS集群","uri":null,"version":"2.0"}