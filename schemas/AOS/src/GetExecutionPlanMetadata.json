{"base_path":null,"components":null,"consumes":"[\"application/json\"]","definitions":{"CommonErrorResponse":{"description":"通用错误响应体","properties":{"details":{"description":"权限拒绝时服务返回的详细错误信息。","items":{"$ref":"#/definitions/Detail"},"type":"array","x-omitempty":true},"encoded_authorization_message":{"description":"包含有关未经授权请求的信息。","type":"string","x-omitempty":true},"error_code":{"description":"响应码","maxLength":11,"minLength":11,"type":"string"},"error_msg":{"description":"响应消息","type":"string"}},"type":"object"},"Detail":{"properties":{"error_code":{"description":"响应码","type":"string"},"error_msg":{"description":"响应消息","type":"string"}},"type":"object"},"EncryptionStructure":{"description":"如果用户传递的var_value是已经加密过的,可以通过声明此项以要求资源编排服务在使用前进行解密,目前暂时只支持KMS加解密","properties":{"kms":{"$ref":"#/definitions/KmsStructure"}},"required":["kms"],"type":"object"},"ExecutionPlanDescriptionPrimitiveTypeHolder":{"example":{"description":"My First Hello World Execution Plan"},"properties":{"description":{"description":"执行计划的描述。可用于客户识别自己的执行计划。","maxLength":1024,"minLength":0,"type":"string","x-omitempty":true}},"type":"object"},"ExecutionPlanIdPrimitiveTypeHolder":{"example":{"execution_plan_id":"4abf1770-2760-4339-9c18-427fa115db6a"},"properties":{"execution_plan_id":{"description":"执行计划(execution_plan)的唯一ID。\n\n此Id由资源编排服务在生成执行计划的时候生成,为UUID。\n\n由于执行计划名仅仅在同一时间下唯一,即用户允许先生成一个叫HelloWorld的执行计划,删除,再重新创建一个同名执行计划。\n\n对于团队并行开发,用户可能希望确保,当前我操作的执行计划就是我认为的那个,而不是其他队友删除后创建的同名执行计划。因此,使用ID就可以做到强匹配。\n\n资源编排服务保证每次创建的执行计划所对应的ID都不相同,更新不会影响ID。如果给予的execution_plan_id和当前执行计划的ID不一致,则返回400\n\n**注意:**\n* 创建执行计划后,资源编排服务持久化请求并立即返回,客户端不等待请求最终处理完成,用户无法实时感知请求处理结果\n* 资源编排服务最终会将异步部署请求排队,在服务端空闲的情况下逐个处理。用户最大等待时长为1小时","maxLength":36,"minLength":36,"pattern":"^[a-z0-9]+[a-z0-9-]*$","type":"string","x-isnullable":true}},"type":"object"},"ExecutionPlanNamePrimitiveTypeHolder":{"example":{"execution_plan_name":"MyHelloWorldExecutionPlanName"},"properties":{"execution_plan_name":{"description":"执行计划的名称。此名字在domain_id+区域+project_id+stack_id下应唯一,可以使用中文、大小写英文、数字、下划线、中划线。首字符需为中文或者英文,区分大小写。","maxLength":128,"minLength":1,"pattern":"^[一-龥A-Za-z]+[一-龥A-Za-z0-9_-]*$","type":"string"}},"required":["execution_plan_name"],"type":"object"},"ExecutionPlanStatusMessagePrimitiveTypeHolder":{"example":{"status_message":"example status message."},"properties":{"status_message":{"description":"当执行计划的状态为创建失败状态(即为 `CREATION_FAILED` 时),将会展示简要的错误信息总结以供debug","type":"string"}},"type":"object"},"ExecutionPlanStatusPrimitiveTypeHolder":{"example":{"status":"AVAILABLE"},"properties":{"status":{"description":"执行计划的状态\n* `CREATION_IN_PROGRESS` - 正在创建,请等待\n* `CREATION_FAILED` - 创建失败,请从status_message获取错误信息汇总\n* `AVAILABLE` - 创建完成,可以调用ApplyExecutionPlan API进行执行\n* `APPLY_IN_PROGRESS` - 执行中,可通过GetStackMetadata查询资源栈状态,通过ListStackEvents获取执行过程中产生的资源栈事件\n* `APPLIED` - 已执行","enum":["CREATION_IN_PROGRESS","CREATION_FAILED","AVAILABLE","APPLY_IN_PROGRESS","APPLIED"],"type":"string"}},"type":"object"},"ExecutionPlanSummary":{"properties":{"resource_add":{"description":"新增资源数","type":"integer"},"resource_delete":{"description":"删除资源数","type":"integer"},"resource_import":{"description":"导入资源数","type":"integer"},"resource_update":{"description":"更新资源数","type":"integer"}},"type":"object"},"GetExecutionPlanMetadataResponseBody":{"allOf":[{"$ref":"#/definitions/StackIdPrimitiveTypeHolder"},{"$ref":"#/definitions/StackNamePrimitiveTypeHolder"},{"$ref":"#/definitions/ExecutionPlanIdPrimitiveTypeHolder"},{"$ref":"#/definitions/ExecutionPlanNamePrimitiveTypeHolder"},{"$ref":"#/definitions/ExecutionPlanDescriptionPrimitiveTypeHolder"},{"$ref":"#/definitions/VarsStructurePrimitiveTypeHolder"},{"$ref":"#/definitions/VarsUriContentPrimitiveTypeHolder"},{"$ref":"#/definitions/VarsBodyPrimitiveTypeHolder"},{"$ref":"#/definitions/ExecutionPlanStatusPrimitiveTypeHolder"},{"$ref":"#/definitions/ExecutionPlanStatusMessagePrimitiveTypeHolder"},{"example":{"apply_time":"1970-01-01T00:00:00Z","create_time":"1970-01-01T00:00:00Z"},"properties":{"apply_time":{"description":"执行计划的执行时间\n格式遵循RFC3339,即yyyy-mm-ddTHH:MM:SSZ,如1970-01-01T00:00:00Z","type":"string"},"create_time":{"description":"执行计划的生成时间\n格式遵循RFC3339,即yyyy-mm-ddTHH:MM:SSZ,如1970-01-01T00:00:00Z","type":"string"},"summary":{"$ref":"#/definitions/ExecutionPlanSummary","description":"执行计划结果的摘要信息,包括:\n  * 即将新增的资源数量\n  * 即将更新的资源数量\n  * 即将删除的资源数量\n\n**注意:**\n  * 只有当执行计划状态为`AVAILABLE`、`APPLY_IN_PROGRESS`、`APPLIED`时,才会返回摘要信息\n  * 由于资源栈中记录的资源状态和远端的资源状态不一致而导致的Drift(资源状态漂移)产生的资源变更也将包含在本摘要信息中"}},"type":"object"}]},"KmsStructure":{"description":"如果用户给予的var_value是经过KMS加密的,可以通过传递相关加密信息,资源编排服务在使用的时候会帮助用户进行KMS解密\n\n更多关于KMS加密以及KMS加密的样例代码请见:[KMS加密使用场景介绍](https://support.huaweicloud.com/productdesc-dew/dew_01_0006.html)\n\n\n**注意:**\n  * 请确保用户给予资源编排服务的委托中包含对指定密钥ID的操作权限\n  * KMS每个月有免费试用的额度,如果超过,则KMS需要收费,此费用不是资源编排服务收取,具体标准见:[https://www.huaweicloud.com/pricing.html?tab=detail#/dew](https://www.huaweicloud.com/pricing.html?tab=detail#/dew)\n  * KMS加密只代表资源编排服务在存储和传输的时候传递的是密文,但是在stack-events中依然是明文,如果希望在log中以密文形式对待,请在模板中声明sensitive,更多关于sensitive的介绍见:[https://learn.hashicorp.com/tutorials/terraform/sensitive-variables](https://learn.hashicorp.com/tutorials/terraform/sensitive-variables)","properties":{"cipher_text":{"description":"数据加密密钥所对应的密文","maxLength":2048,"minLength":2,"type":"string"},"id":{"description":"解密时,资源编排服务应该使用的KMS密钥的ID,通常是加密时所使用的密钥ID","maxLength":36,"minLength":36,"pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","type":"string"}},"required":["cipher_text","id"],"type":"object"},"StackIdPrimitiveTypeHolder":{"example":{"stack_id":"1b15e005-bdbb-4bd7-8f9a-a09b6774b4b3"},"properties":{"stack_id":{"description":"资源栈(stack)的唯一ID。\n\n此ID由资源编排服务在生成资源栈的时候生成,为UUID。\n\n由于资源栈名仅仅在同一时间下唯一,即用户允许先生成一个叫HelloWorld的资源栈,删除,再重新创建一个同名资源栈。\n\n对于团队并行开发,用户可能希望确保,当前我操作的资源栈就是我认为的那个,而不是其他队友删除后创建的同名资源栈。因此,使用ID就可以做到强匹配。\n\n资源编排服务保证每次创建的资源栈所对应的ID都不相同,更新不会影响ID。如果给予的stack_id和当前资源栈的ID不一致,则返回400","type":"string"}},"type":"object"},"StackNamePrimitiveTypeHolder":{"example":{"stack_name":"MyHelloWorldStackName"},"properties":{"stack_name":{"description":"资源栈的名称。此名字在domain_id+区域+project_id下应唯一,可以使用中文、大小写英文、数字、下划线、中划线。首字符需为中文或者英文,区分大小写。","maxLength":128,"minLength":1,"pattern":"^[一-龥A-Za-z]+[一-龥A-Za-z0-9_-]*$","type":"string"}},"required":["stack_name"],"type":"object"},"VarsBodyPrimitiveTypeHolder":{"example":{"vars_body":""},"properties":{"vars_body":{"description":"HCL参数文件的内容。HCL模板支持参数传入,即,同一个模板可以给予不同的参数而达到不同的效果。\n\n* vars_body使用HCL的tfvars格式,用户可以将“.tfvars”中的内容提交到vars_body中\n\n* 资源编排服务支持vars_body和vars_uri,如果以上两种方式中声明了同一个变量,将报错400\n\n* 如果vars_body过大,可以使用vars_uri\n\n* 资源栈集不支持敏感数据加密,资源编排服务会直接明文使用、log、展示、存储对应的vars_body。","maxLength":51200,"minLength":0,"type":"string"}},"type":"object"},"VarsStructure":{"description":"HCL支持参数,即,同一个模板可以给予不同的参数而达到不同的效果。\n\nvar_structure可以允许客户提交最简单的字符串类型的参数\n\n资源编排服务支持vars_structure,vars_body和vars_uri,如果以上三种方式中声明了同一个变量,将报错400\n\nvars_structure中的值只支持简单的字符串类型,如果需要使用其他类型,需要用户自己在HCL引用时转换,\n或者用户可以使用vars_uri、vars_body,vars_uri和vars_body中支持HCL支持的各种类型以及复杂结构\n\n如果vars_structure过大,可以使用vars_uri\n\n注意:vars中不应该传递任何敏感信息,资源编排服务会直接明文使用、log、展示和存储对应的vars","properties":{"encryption":{"$ref":"#/definitions/EncryptionStructure"},"var_key":{"description":"参数的名字","maxLength":32,"minLength":1,"pattern":"^[a-zA-Z]+[a-zA-Z0-9-_]*$","type":"string"},"var_value":{"description":"参数的值。\n\n注意,参数需要以字符串形式存在,如果是数字,也需要以字符串形式存在,如'10'。\n\n如果需要支持不同类型,或者复杂结构,请使用vars_uri或vars_body","maxLength":2048,"minLength":0,"type":"string"}},"required":["var_key","var_value"],"type":"object"},"VarsStructurePrimitiveTypeHolder":{"example":{"vars_structure":[{"encryption":{"kms":{"cipher_text":"jslkjreiqpeorikshshlld","id":"344d38b3-267e-435c-a1e1-f50356162173"}},"var_key":"region","var_value":"cn-north-7"}]},"properties":{"vars_structure":{"description":"HCL参数结构。HCL模板支持参数传入,即,同一个模板可以给予不同的参数而达到不同的效果。\n\n* var_structure可以允许客户提交最简单的字符串类型的参数\n\n* 资源编排服务支持vars_structure,vars_body和vars_uri,如果以上三种方式中声明了同一个变量,将报错400\n\n* vars_structure中的值只支持简单的字符串类型,如果需要使用其他类型,需要用户自己在HCL引用时转换,\n或者用户可以使用vars_uri、vars_body,vars_uri和vars_body中支持HCL支持的各种类型以及复杂结构\n\n* 如果vars_structure过大,可以使用vars_uri\n\n* 注意:vars_structure中默认不应该含有任何敏感信息,资源编排服务会直接明文使用、log、展示和存储对应的vars。如为敏感信息,建议设置encryption字段开启加密","items":{"$ref":"#/definitions/VarsStructure"},"maxItems":100,"minItems":0,"type":"array","x-omitempty":true}},"type":"object"},"VarsUriContentPrimitiveTypeHolder":{"example":{"vars_uri_content":"my_hello_world_key=my_hello_world_value"},"properties":{"vars_uri_content":{"description":"vars_uri对应的文件内容","type":"string"}},"type":"object"}},"description":null,"group_id":"ffbc0f3a195c4338b5218addf5d56a6c","host":"rfs.cn-north-4.myhuaweicloud.com","id":"6ca3f1102e7f484a8f3e8bb28f48c20d","info_version":"v1","method":"get","name":"GetExecutionPlanMetadata","parameters":{},"paths":{"/v1/{project_id}/stacks/{stack_name}/execution-plans/{execution_plan_name}/metadata":{"get":{"description":"获取执行计划元数据(GetExecutionPlanMetadata)\n\n该API可以获取指定执行计划的元数据,包括资源栈ID、资源栈名称、执行计划ID、执行计划名称、执行计划描述、执行计划的创建时间和执行时间、执行计划状态等信息。\n\n具体信息见GetExecutionPlanMetadataResponseBody。\n\n如果需要获取执行计划的具体内容,请调用GetExecutionPlan。","operationId":"GetExecutionPlanMetadata","parameters":[{"description":"用户指定的,对于此请求的唯一ID,用于定位某个请求,推荐使用UUID","in":"header","maxLength":128,"minLength":36,"name":"Client-Request-Id","pattern":"^[A-Za-z0-9]+[A-Za-z0-9-]*$","required":true,"type":"string"},{"description":"项目ID,可以从调用API处获取,也可以从控制台获取。\n\n[项目ID获取方式](https://support.huaweicloud.com/api-ticket/ticket_api_20002.html)","in":"path","maxLength":64,"minLength":3,"name":"project_id","pattern":"^[A-Za-z0-9-]+$","required":true,"type":"string"},{"description":"资源栈的名称。此名字在domain_id+区域+project_id下应唯一,可以使用中文、大小写英文、数字、下划线、中划线。首字符需为中文或者英文,区分大小写。","in":"path","maxLength":128,"minLength":1,"name":"stack_name","pattern":"^[一-龥A-Za-z]+[一-龥A-Za-z0-9_-]*$","required":true,"type":"string"},{"description":"执行计划的名称。此名字在domain_id+区域+project_id+stack_id下应唯一,可以使用中文、大小写英文、数字、下划线、中划线。首字符需为中文或者英文,区分大小写。","in":"path","maxLength":128,"minLength":1,"name":"execution_plan_name","pattern":"^[一-龥A-Za-z]+[一-龥A-Za-z0-9_-]*$","required":true,"type":"string"},{"description":"资源栈(stack)的唯一ID。\n\n此ID由资源编排服务在生成资源栈的时候生成,为UUID。\n\n由于资源栈名仅仅在同一时间下唯一,即用户允许先生成一个叫HelloWorld的资源栈,删除,再重新创建一个同名资源栈。\n\n对于团队并行开发,用户可能希望确保,当前我操作的资源栈就是我认为的那个,而不是其他队友删除后创建的同名资源栈。因此,使用ID就可以做到强匹配。\n\n资源编排服务保证每次创建的资源栈所对应的ID都不相同,更新不会影响ID。如果给予的stack_id和当前资源栈的ID不一致,则返回400","in":"query","maxLength":36,"minLength":36,"name":"stack_id","pattern":"^[a-z0-9]+[a-z0-9-]*$","required":false,"type":"string","x-isnullable":true},{"description":"执行计划(execution_plan)的唯一ID。\n\n此ID由资源编排服务在生成执行计划的时候生成,为UUID。\n\n由于执行计划名仅仅在同一时间下唯一,即用户允许先生成一个叫HelloWorld的执行计划,删除,再重新创建一个同名执行计划。\n\n对于团队并行开发,用户可能希望确保,当前我操作的执行计划就是我认为的那个,而不是其他队友删除后创建的同名执行计划。因此,使用ID就可以做到强匹配。\n\n资源编排服务保证每次创建的执行计划所对应的ID都不相同,更新不会影响ID。如果给予的execution_plan_id和当前执行计划的ID不一致,则返回400","in":"query","maxLength":36,"minLength":36,"name":"execution_plan_id","pattern":"^[a-z0-9]+[a-z0-9-]*$","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"获取成功","examples":{"x-response-examples-1":{"apply_time":"2023-05-17T11:56:40Z","create_time":"2023-05-16T03:37:24Z","execution_plan_id":"ebc0979a-c617-4382-9147-57fc83a634aa","execution_plan_name":"my_first_execution_plan","stack_id":"f689e9fd-97e7-4185-bd8a-7d5f708d45d7","stack_name":"my_hello_world_stack","status":"APPLIED","summary":{"resource_add":2}}},"schema":{"$ref":"#/definitions/GetExecutionPlanMetadataResponseBody"}},"400":{"description":"用户请求非法","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"401":{"description":"用户身份认证失败","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"403":{"description":"用户无权限调用此API","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"404":{"description":"1. 执行计划不存在\n2. 资源栈不存在","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"429":{"description":"请求数量过多","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"500":{"description":"服务器内部错误","schema":{"$ref":"#/definitions/CommonErrorResponse"}}},"summary":"获取执行计划元数据","tags":["Execution Plan"],"x-api-type":"open-api","x-is-registered":"Y","x-request-examples-description-1":"获取指定执行计划的元数据","x-request-examples-description-2":"获取指定执行计划的元数据,并提供资源栈id和执行计划id以校验是否与当前资源栈和执行计划匹配","x-request-examples-url-1":"GET https://{endpoint}/v1/ba2b9930c977f71edaeaa3a5e96a8ff1/stacks/my_hello_world_stack/execution-plans/my_first_execution_plan/metadata","x-request-examples-url-2":"GET https://{endpoint}/v1/ba2b9930c977f71edaeaa3a5e96a8ff1/stacks/my_hello_world_stack/execution-plans/my_first_execution_plan/metadata?stack_id=ea6a4f0e-ee8a-494e-b12a-8be4a1e65af2&execution_plan_id=fb5e781e-a27d-46e2-9954-242753857a9f","x-support-sdk":"Y"}}},"product_short":"AOS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":{"apig-auth-app":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-type":"AppSigv1"},"apig-auth-app-optional":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-opt":{"access-auth-type":"optional"},"x-apigateway-auth-type":"AppSigv1"},"apig-auth-iam":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM"},"apig-auth-iam-none":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM_NONE"},"token":{"in":"header","name":"X-Auth-Token","type":"apiKey"}},"summary":"获取执行计划元数据","tags":"资源编排-执行计划","uri":null,"version":"2.0"}