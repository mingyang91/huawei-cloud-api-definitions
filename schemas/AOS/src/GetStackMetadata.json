{"base_path":null,"components":null,"consumes":"[\"application/json\"]","definitions":{"AgenciesPrimitiveTypeHolder":{"example":{"agencies":[{"agency_name":"my_agency","provider_name":"huaweicloud"}]},"properties":{"agencies":{"description":"委托授权的信息。\n\nRFS仅在创建资源栈(触发部署)、创建执行计划、部署资源栈、删除资源栈等涉及资源操作的请求中使用委托,且该委托仅作用于与之绑定的Provider对资源的操作中。如果委托中提供的权限不足,有可能导致相关资源操作失败。\n\n[创建委托及授权方式](https://support.huaweicloud.com/usermanual-iam/iam_06_0002.html)","items":{"$ref":"#/definitions/Agency"},"maxItems":10,"minItems":0,"type":"array","x-omitempty":true}},"type":"object"},"Agency":{"description":"委托授权的信息","properties":{"agency_name":{"description":"对应provider所使用的IAM委托名称,资源编排服务会使用此委托的权限去访问、创建对应provider的资源。agency_name和agency_urn必须有且只有一个存在","maxLength":64,"minLength":1,"type":"string","x-isnullable":true,"x-omitempty":true},"agency_urn":{"description":"委托URN\n\n当用户定义Agency时,agency_name和agency_urn 必须有且只有一个存在。\n\n推荐用户在使用信任委托时给予agency_urn,agency_name只支持接收普通委托名称,如果给予了信任委托名称,则会在部署模板时失败。","pattern":"^(iam:\\*?:[A-Za-z0-9-]{1,64}:agency:.{1,64})?$","type":"string","x-isnullable":true,"x-omitempty":true},"provider_name":{"description":"用户使用的provider的名字。如果用户给予的provider_name含有重复的值,则返回400","maxLength":128,"minLength":1,"type":"string"}},"required":["provider_name"],"type":"object"},"CommonErrorResponse":{"description":"通用错误响应体","properties":{"details":{"description":"权限拒绝时服务返回的详细错误信息。","items":{"$ref":"#/definitions/Detail"},"type":"array","x-omitempty":true},"encoded_authorization_message":{"description":"包含有关未经授权请求的信息。","type":"string","x-omitempty":true},"error_code":{"description":"响应码","maxLength":11,"minLength":11,"type":"string"},"error_msg":{"description":"响应消息","type":"string"}},"type":"object"},"Detail":{"properties":{"error_code":{"description":"响应码","type":"string"},"error_msg":{"description":"响应消息","type":"string"}},"type":"object"},"EnableAutoRollbackPrimitiveTypeHolder":{"example":{"enable_auto_rollback":false},"properties":{"enable_auto_rollback":{"description":"自动回滚的标识位,如果不传默认为false,即默认不开启资源栈自动回滚(自动回滚开启后,如果部署失败,则会自动回滚,并返回上一个稳定状态)\n\n*在UpdateStack API中,如果该参数未在RequestBody中给予,则不会对资源栈的自动回滚属性进行更新*\n*该属性与使用模板导入资源功能互斥,如果资源栈的自动回滚设置为true,则不允许部署包含导入资源的模板*","type":"boolean","x-isnullable":true,"x-omitempty":false}},"type":"object"},"EnableDeletionProtectionPrimitiveTypeHolder":{"example":{"enable_deletion_protection":false},"properties":{"enable_deletion_protection":{"description":"删除保护的标识位,如果不传默认为false,即默认不开启资源栈删除保护(删除保护开启后资源栈不允许被删除)\n\n*在UpdateStack API中,如果该参数未在RequestBody中给予,则不会对资源栈的删除保护属性进行更新*","type":"boolean","x-isnullable":true,"x-omitempty":false}},"type":"object"},"EncryptionStructure":{"description":"如果用户传递的var_value是已经加密过的,可以通过声明此项以要求资源编排服务在使用前进行解密,目前暂时只支持KMS加解密","properties":{"kms":{"$ref":"#/definitions/KmsStructure"}},"required":["kms"],"type":"object"},"GetStackMetadataResponseBody":{"allOf":[{"$ref":"#/definitions/StackIdPrimitiveTypeHolder"},{"$ref":"#/definitions/StackNamePrimitiveTypeHolder"},{"$ref":"#/definitions/StackDescriptionPrimitiveTypeHolder"},{"$ref":"#/definitions/VarsStructurePrimitiveTypeHolder"},{"$ref":"#/definitions/VarsBodyPrimitiveTypeHolder"},{"$ref":"#/definitions/EnableDeletionProtectionPrimitiveTypeHolder"},{"$ref":"#/definitions/EnableAutoRollbackPrimitiveTypeHolder"},{"$ref":"#/definitions/StackStatusPrimitiveTypeHolder"},{"$ref":"#/definitions/AgenciesPrimitiveTypeHolder"},{"$ref":"#/definitions/StackStatusMessagePrimitiveTypeHolder"},{"$ref":"#/definitions/VarsUriContentPrimitiveTypeHolder"},{"example":{"create_time":"1970-01-01T00:00:00Z","update_time":"1970-01-01T00:00:00Z"},"properties":{"create_time":{"description":"资源栈的生成时间\n格式遵循RFC3339,即yyyy-mm-ddTHH:MM:SSZ,如1970-01-01T00:00:00Z","type":"string"},"update_time":{"description":"资源栈的更新时间(更新场景包括元数据更新场景和部署场景)\n格式遵循RFC3339,即yyyy-mm-ddTHH:MM:SSZ,如1970-01-01T00:00:00Z","type":"string"}},"type":"object"}]},"KmsStructure":{"description":"如果用户给予的var_value是经过KMS加密的,可以通过传递相关加密信息,资源编排服务在使用的时候会帮助用户进行KMS解密\n\n更多关于KMS加密以及KMS加密的样例代码请见:[KMS加密使用场景介绍](https://support.huaweicloud.com/productdesc-dew/dew_01_0006.html)\n\n\n**注意:**\n  * 请确保用户给予资源编排服务的委托中包含对指定密钥ID的操作权限\n  * KMS每个月有免费试用的额度,如果超过,则KMS需要收费,此费用不是资源编排服务收取,具体标准见:[https://www.huaweicloud.com/pricing.html?tab=detail#/dew](https://www.huaweicloud.com/pricing.html?tab=detail#/dew)\n  * KMS加密只代表资源编排服务在存储和传输的时候传递的是密文,但是在stack-events中依然是明文,如果希望在log中以密文形式对待,请在模板中声明sensitive,更多关于sensitive的介绍见:[https://learn.hashicorp.com/tutorials/terraform/sensitive-variables](https://learn.hashicorp.com/tutorials/terraform/sensitive-variables)","properties":{"cipher_text":{"description":"数据加密密钥所对应的密文","maxLength":2048,"minLength":2,"type":"string"},"id":{"description":"解密时,资源编排服务应该使用的KMS密钥的ID,通常是加密时所使用的密钥ID","maxLength":36,"minLength":36,"pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","type":"string"}},"required":["cipher_text","id"],"type":"object"},"StackDescriptionPrimitiveTypeHolder":{"example":{"description":"My First Hello World Stack"},"properties":{"description":{"description":"资源栈的描述。可用于客户识别自己的资源栈。","maxLength":1024,"minLength":0,"type":"string","x-omitempty":true}},"type":"object"},"StackIdPrimitiveTypeHolder":{"example":{"stack_id":"1b15e005-bdbb-4bd7-8f9a-a09b6774b4b3"},"properties":{"stack_id":{"description":"资源栈(stack)的唯一ID。\n\n此ID由资源编排服务在生成资源栈的时候生成,为UUID。\n\n由于资源栈名仅仅在同一时间下唯一,即用户允许先生成一个叫HelloWorld的资源栈,删除,再重新创建一个同名资源栈。\n\n对于团队并行开发,用户可能希望确保,当前我操作的资源栈就是我认为的那个,而不是其他队友删除后创建的同名资源栈。因此,使用ID就可以做到强匹配。\n\n资源编排服务保证每次创建的资源栈所对应的ID都不相同,更新不会影响ID。如果给予的stack_id和当前资源栈的ID不一致,则返回400","type":"string"}},"type":"object"},"StackNamePrimitiveTypeHolder":{"example":{"stack_name":"MyHelloWorldStackName"},"properties":{"stack_name":{"description":"资源栈的名称。此名字在domain_id+区域+project_id下应唯一,可以使用中文、大小写英文、数字、下划线、中划线。首字符需为中文或者英文,区分大小写。","maxLength":128,"minLength":1,"pattern":"^[一-龥A-Za-z]+[一-龥A-Za-z0-9_-]*$","type":"string"}},"required":["stack_name"],"type":"object"},"StackStatusMessagePrimitiveTypeHolder":{"example":{"status_message":"example status message."},"properties":{"status_message":{"description":"当资源栈的状态为任意失败状态(即以 `FAILED` 结尾时),将会展示简要的错误信息总结以供debug","type":"string"}},"type":"object"},"StackStatusPrimitiveTypeHolder":{"example":{"status":"CREATION_COMPLETE"},"properties":{"status":{"description":"资源栈的状态\n* `CREATION_COMPLETE` - 生成空资源栈完成,并没有任何部署\n* `DEPLOYMENT_IN_PROGRESS` - 正在部署,请等待\n* `DEPLOYMENT_FAILED` - 部署失败。请从status_message获取错误信息汇总,或者调用ListStackEvents获得事件详情\n* `DEPLOYMENT_COMPLETE` - 部署完成\n* `ROLLBACK_IN_PROGRESS` - 部署失败,正在回滚,请等待\n* `ROLLBACK_FAILED` - 回滚失败。请从status_message获取错误信息汇总,或者调用ListStackEvents获得事件详情\n* `ROLLBACK_COMPLETE` - 回滚完成\n* `DELETION_IN_PROGRESS` - 正在删除,请等待\n* `DELETION_FAILED` - 删除失败。请从status_message获取错误信息汇总,或者调用ListStackEvents获得事件详情","enum":["CREATION_COMPLETE","DEPLOYMENT_IN_PROGRESS","DEPLOYMENT_FAILED","DEPLOYMENT_COMPLETE","ROLLBACK_IN_PROGRESS","ROLLBACK_FAILED","ROLLBACK_COMPLETE","DELETION_IN_PROGRESS","DELETION_FAILED"],"type":"string"}},"type":"object"},"VarsBodyPrimitiveTypeHolder":{"example":{"vars_body":""},"properties":{"vars_body":{"description":"HCL参数文件的内容。HCL模板支持参数传入,即,同一个模板可以给予不同的参数而达到不同的效果。\n\n* vars_body使用HCL的tfvars格式,用户可以将“.tfvars”中的内容提交到vars_body中\n\n* 资源编排服务支持vars_body和vars_uri,如果以上两种方式中声明了同一个变量,将报错400\n\n* 如果vars_body过大,可以使用vars_uri\n\n* 资源栈集不支持敏感数据加密,资源编排服务会直接明文使用、log、展示、存储对应的vars_body。","maxLength":51200,"minLength":0,"type":"string"}},"type":"object"},"VarsStructure":{"description":"HCL支持参数,即,同一个模板可以给予不同的参数而达到不同的效果。\n\nvar_structure可以允许客户提交最简单的字符串类型的参数\n\n资源编排服务支持vars_structure,vars_body和vars_uri,如果以上三种方式中声明了同一个变量,将报错400\n\nvars_structure中的值只支持简单的字符串类型,如果需要使用其他类型,需要用户自己在HCL引用时转换,\n或者用户可以使用vars_uri、vars_body,vars_uri和vars_body中支持HCL支持的各种类型以及复杂结构\n\n如果vars_structure过大,可以使用vars_uri\n\n注意:vars中不应该传递任何敏感信息,资源编排服务会直接明文使用、log、展示和存储对应的vars","properties":{"encryption":{"$ref":"#/definitions/EncryptionStructure"},"var_key":{"description":"参数的名字","maxLength":32,"minLength":1,"pattern":"^[a-zA-Z]+[a-zA-Z0-9-_]*$","type":"string"},"var_value":{"description":"参数的值。\n\n注意,参数需要以字符串形式存在,如果是数字,也需要以字符串形式存在,如'10'。\n\n如果需要支持不同类型,或者复杂结构,请使用vars_uri或vars_body","maxLength":2048,"minLength":0,"type":"string"}},"required":["var_key","var_value"],"type":"object"},"VarsStructurePrimitiveTypeHolder":{"example":{"vars_structure":[{"encryption":{"kms":{"cipher_text":"jslkjreiqpeorikshshlld","id":"344d38b3-267e-435c-a1e1-f50356162173"}},"var_key":"region","var_value":"cn-north-7"}]},"properties":{"vars_structure":{"description":"HCL参数结构。HCL模板支持参数传入,即,同一个模板可以给予不同的参数而达到不同的效果。\n\n* var_structure可以允许客户提交最简单的字符串类型的参数\n\n* 资源编排服务支持vars_structure,vars_body和vars_uri,如果以上三种方式中声明了同一个变量,将报错400\n\n* vars_structure中的值只支持简单的字符串类型,如果需要使用其他类型,需要用户自己在HCL引用时转换,\n或者用户可以使用vars_uri、vars_body,vars_uri和vars_body中支持HCL支持的各种类型以及复杂结构\n\n* 如果vars_structure过大,可以使用vars_uri\n\n* 注意:vars_structure中默认不应该含有任何敏感信息,资源编排服务会直接明文使用、log、展示和存储对应的vars。如为敏感信息,建议设置encryption字段开启加密","items":{"$ref":"#/definitions/VarsStructure"},"maxItems":100,"minItems":0,"type":"array","x-omitempty":true}},"type":"object"},"VarsUriContentPrimitiveTypeHolder":{"example":{"vars_uri_content":"my_hello_world_key=my_hello_world_value"},"properties":{"vars_uri_content":{"description":"vars_uri对应的文件内容","type":"string"}},"type":"object"}},"description":null,"group_id":"ffbc0f3a195c4338b5218addf5d56a6c","host":"rfs.cn-north-4.myhuaweicloud.com","id":"d2c411d8816847f6ad4f58b105f1fbe2","info_version":"v1","method":"get","name":"GetStackMetadata","parameters":{},"paths":{"/v1/{project_id}/stacks/{stack_name}/metadata":{"get":{"description":"获取资源栈元数据(GetStackMetadata)\n\n此API用于获取指定资源栈的元数据,包括资源栈ID、资源栈名称、资源栈描述、创建时间、更新时间、资源栈状态、委托授权等信息。\n\n具体信息见GetStackMetadataResponseBody。\n\n注:\n当资源栈状态处于非终态(即以`IN_PROGRESS`结尾,详细见下方)状态时,资源栈的元数据信息处于转变阶段,可能为部署前的状态,也可能为部署后的状态。\n只有当资源栈状态处于终态(即以`COMPLETE`或`FAILED`结尾,详细见下方)时,资源栈的元数据信息才是部署后的状态\n\n非终态状态包括但不限于以下状态:\n  * 正在部署(DEPLOYMENT_IN_PROGRESS)\n  * 正在回滚(ROLLBACK_IN_PROGRESS)\n  * 正在删除(DELETION_IN_PROGRESS)\n\n终态状态包括但不限于以下状态:\n  * 生成空资源栈完成(CREATION_COMPLETE)\n  * 部署失败(DEPLOYMENT_FAILED)\n  * 部署完成(DEPLOYMENT_COMPLETE)\n  * 回滚失败(ROLLBACK_FAILED)\n  * 回滚完成(ROLLBACK_COMPLETE)\n  * 删除失败(DELETION_FAILED)","operationId":"GetStackMetadata","parameters":[{"description":"用户指定的,对于此请求的唯一ID,用于定位某个请求,推荐使用UUID","in":"header","maxLength":128,"minLength":36,"name":"Client-Request-Id","pattern":"^[A-Za-z0-9]+[A-Za-z0-9-]*$","required":true,"type":"string"},{"description":"项目ID,可以从调用API处获取,也可以从控制台获取。\n\n[项目ID获取方式](https://support.huaweicloud.com/api-ticket/ticket_api_20002.html)","in":"path","maxLength":64,"minLength":3,"name":"project_id","pattern":"^[A-Za-z0-9-]+$","required":true,"type":"string"},{"description":"资源栈的名称。此名字在domain_id+区域+project_id下应唯一,可以使用中文、大小写英文、数字、下划线、中划线。首字符需为中文或者英文,区分大小写。","in":"path","maxLength":128,"minLength":1,"name":"stack_name","pattern":"^[一-龥A-Za-z]+[一-龥A-Za-z0-9_-]*$","required":true,"type":"string"},{"description":"资源栈(stack)的唯一ID。\n\n此ID由资源编排服务在生成资源栈的时候生成,为UUID。\n\n由于资源栈名仅仅在同一时间下唯一,即用户允许先生成一个叫HelloWorld的资源栈,删除,再重新创建一个同名资源栈。\n\n对于团队并行开发,用户可能希望确保,当前我操作的资源栈就是我认为的那个,而不是其他队友删除后创建的同名资源栈。因此,使用ID就可以做到强匹配。\n\n资源编排服务保证每次创建的资源栈所对应的ID都不相同,更新不会影响ID。如果给予的stack_id和当前资源栈的ID不一致,则返回400","in":"query","maxLength":36,"minLength":36,"name":"stack_id","pattern":"^[a-z0-9]+[a-z0-9-]*$","required":false,"type":"string","x-isnullable":true}],"produces":["application/json"],"responses":{"200":{"description":"获取成功","examples":{"x-response-examples-1":{"agencies":[{"agency_name":"rf_admin_trust","provider_name":"huaweicloud"}],"create_time":"2023-03-16T03:28:20Z","description":"my hello world stack","enable_auto_rollback":false,"enable_deletion_protection":false,"stack_id":"f689e9fd-97e7-4185-bd8a-7d5f708d45d7","stack_name":"my_hello_world_stack","status":"DEPLOYMENT_COMPLETE","update_time":"2023-05-24T08:56:10Z"}},"schema":{"$ref":"#/definitions/GetStackMetadataResponseBody"}},"400":{"description":"用户请求非法","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"401":{"description":"用户身份认证失败","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"403":{"description":"用户无权限调用此API","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"404":{"description":"资源栈不存在","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"429":{"description":"请求数量过多","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"500":{"description":"服务器内部错误","schema":{"$ref":"#/definitions/CommonErrorResponse"}}},"summary":"获取资源栈元数据","tags":["Stack"],"x-api-type":"open-api","x-is-registered":"Y","x-request-examples-description-1":"获取资源栈元数据","x-request-examples-description-2":"获取资源栈元数据,并提供资源栈id以校验是否与当前资源栈匹配","x-request-examples-url-1":"GET https://{endpoint}/v1/ba2b9930c977f71edaeaa3a5e96a8ff1/stacks/my_hello_world_stack/metadata","x-request-examples-url-2":"GET https://{endpoint}/v1/ba2b9930c977f71edaeaa3a5e96a8ff1/stacks/my_hello_world_stack/metadata?stack_id=ea6a4f0e-ee8a-494e-b12a-8be4a1e65af2","x-support-sdk":"Y"}}},"product_short":"AOS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":{"apig-auth-app":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-type":"AppSigv1"},"apig-auth-app-optional":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-opt":{"access-auth-type":"optional"},"x-apigateway-auth-type":"AppSigv1"},"apig-auth-iam":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM"},"apig-auth-iam-none":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM_NONE"},"token":{"in":"header","name":"X-Auth-Token","type":"apiKey"}},"summary":"获取资源栈元数据","tags":"资源编排-资源栈","uri":null,"version":"2.0"}