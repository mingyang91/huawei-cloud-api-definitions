{"base_path":null,"components":null,"consumes":"[\"application/json\"]","definitions":{"CommonErrorResponse":{"description":"通用错误响应体","properties":{"details":{"description":"权限拒绝时服务返回的详细错误信息。","items":{"$ref":"#/definitions/Detail"},"type":"array","x-omitempty":true},"encoded_authorization_message":{"description":"包含有关未经授权请求的信息。","type":"string","x-omitempty":true},"error_code":{"description":"响应码","maxLength":11,"minLength":11,"type":"string"},"error_msg":{"description":"响应消息","type":"string"}},"type":"object"},"Detail":{"properties":{"error_code":{"description":"响应码","type":"string"},"error_msg":{"description":"响应消息","type":"string"}},"type":"object"},"ExecutionPlanDiffAttribute":{"properties":{"name":{"description":"当前资源将要被修改的参数的名字。","type":"string"},"previous_value":{"description":"当前资源被修改的参数的原始值。\n\n如果是资源创建的场景,则previous_value为空\n\n如果远端资源产生了偏差,则同一个资源会返回两个ExecutionPlanItem,其中一个的drifted为true,另一个的drifted为false\n  * drifted为true的previous_value为资源栈中所维持的资源属性和状态\n  * drifted为false的previous_value为provider请求远端资源后,远端资源所返回的资源属性和状态\n\n如果远端资源未产生偏差,则只会返回一个drifted为false的ExecutionPlanItem\n  * drifted为false的previous_value为资源栈中所维持的资源属性和状态","type":"string"},"target_value":{"description":"当前资源被修改的参数的目的值。\n\n如果是资源删除的场景,则target_value为空\n\n如果远端资源产生了偏差,则同一个资源会返回两个ExecutionPlanItem,其中一个的drifted为true,另一个的drifted为false\n  * drifted为true的target_value为provider请求远端资源后,远端资源所返回的资源属性和状态\n  * drifted为false的target_value为基于用户模板更新的资源属性和状态\n\n如果远端资源未产生偏差,则只会返回一个drifted为false的ExecutionPlanItem\n  * drifted为false的target_value为基于用户模板更新的资源属性和状态","type":"string"}},"type":"object"},"ExecutionPlanItem":{"allOf":[{"$ref":"#/definitions/ResourceTypePrimitiveTypeHolder"},{"$ref":"#/definitions/ResourceNamePrimitiveTypeHolder"},{"$ref":"#/definitions/IndexPrimitiveTypeHolder"},{"properties":{"action":{"description":"资源变更的类型\n* `ADD` - 新增资源\n* `ADD_THEN_DELETE` - 由不可更新的资源返回,先创建新资源,再删除旧资源\n* `DELETE ` - 删除资源\n* `DELETE_THEN_ADD` - 由不可更新的资源返回,先删除旧资源,再创建新资源\n* `UPDATE` - 更新资源 \n* `NO_OPERATION` - 仅变更资源的依赖关系,但是对资源本身并无修改的操作","enum":["ADD","ADD_THEN_DELETE","DELETE","DELETE_THEN_ADD","UPDATE","NO_OPERATION"],"type":"string"},"action_reason":{"description":"触发该项目变更的原因,例如用户更新模板;远端删除资源等等","type":"string"},"attributes":{"description":"执行计划项目中变更的属性,当无属性变更时为空列表。","items":{"$ref":"#/definitions/ExecutionPlanDiffAttribute"},"type":"array"},"drifted":{"description":"当前资源的变更是否由偏差导致。\n\n偏差,也叫漂移。指的是资源被资源编排服务创建以后,又经历过非资源编排服务触发的修改,如手动修改、调用SDK修改等,使得资源的配置与本服务所记录的资源的配置不一致。这种不一致便称为偏差。\n\n当资源产生偏差以后:\n* 如果用户试图创建执行计划,则会提示用户产生偏差\n* 如果用户直接部署,则偏差有可能被覆盖,资源编排服务只保证资源和模板最终一致。\n\n资源的偏差有两种类型:\n* 资源定位属性被修改:如果是定位属性被修改,常见于删除后重建,此时资源已经不属于同一个资源。资源编排服务会认为此资源已经被删除,会尝试创建一个新的资源。\n* 资源普通属性被修改:如果是普通属性被修改,则资源编排服务依然可以找到资源,但是下次部署会尝试修复偏差,即将资源保持和模板最终一致。\n\n**注:资源编排服务团队极力推荐,如果资源是通过本服务创建的,请一直使用本服务进行维护和更新以确保资源和模板保持一致。建议非紧急事件以外的情况不要手动调整。**","type":"boolean"},"imported":{"description":"当前资源的变更是否是导入的。","type":"boolean"},"mode":{"description":"资源模式\n* `DATA` - 指可以在模板解析期间运行和获取服务端数据的资源类型,不会操作基础设施组件\n* `RESOURCE` - 指通过模板管理的由服务定义的基础设施组件抽象,可以是物理资源也可以是逻辑资源","enum":["DATA","RESOURCE"],"type":"string"},"provider_name":{"description":"该项目所属的provider名称。","type":"string"},"resource_id":{"description":"资源的物理ID,是唯一ID,由为该资源提供服务的provider、云服务或其他服务提供方在资源部署的时候生成","type":"string","x-omitempty":true}},"type":"object"}]},"GetExecutionPlanResponseBody":{"properties":{"execution_plan_items":{"description":"执行计划项目的列表","items":{"$ref":"#/definitions/ExecutionPlanItem"},"type":"array","x-omitempty":true}},"type":"object"},"IndexPrimitiveTypeHolder":{"properties":{"index":{"description":"资源的索引,如果用户在模板中使用了count或for_each则会返回index。如果index出现,则resource_name + index可以作为该资源的一种标识\n\n如果用户在模板中使用count,则index为从0开始的数字\n\n以HCL格式的模板为例,用户在模板中可以通过`huaweicloud_vpc.my_hello_world_vpc[0]`和`huaweicloud_vpc.my_hello_world_vpc[1]`标识两个资源\n\n```hcl\nresource \"huaweicloud_vpc\" \"my_hello_world_vpc\" {\n  count = 2\n  name = \"test_vpc\"\n}\n```\n\n以json格式的模板为例,用户在模板中可以通过`huaweicloud_vpc.my_hello_world_vpc[0]`和`huaweicloud_vpc.my_hello_world_vpc[1]`标识两个资源\n\n```json\n{\n  \"resource\": {\n    \"huaweicloud_vpc\": {\n      \"my_hello_world_vpc\": {\n        \"name\": \"test_vpc\",\n        \"count\": 2\n      }\n    }\n  }\n}\n```\n\n如果用户在模板中使用for_each,则index为用户自定义的字符串\n\n以HCL格式的模板为例,用户在模板中可以通过`huaweicloud_vpc.my_hello_world_vpc[\"vpc1\"]`和`huaweicloud_vpc.my_hello_world_vpc[\"vpc2\"]`标识两个资源\n\n```hcl\nresource \"huaweicloud_vpc\" \"my_hello_world_vpc\" {\n  for_each = {\n    \"vpc1\" = \"test_vpc\"\n    \"vpc2\" = \"test_vpc\"\n  }\n  name = each.value\n}\n```\n\n以json格式的模板为例,用户在模板中可以通过`huaweicloud_vpc.my_hello_world_vpc[\"vpc1\"]`和`huaweicloud_vpc.my_hello_world_vpc[\"vpc2\"]`标识两个资源\n\n```json\n{\n  \"resource\": {\n    \"huaweicloud_vpc\": {\n      \"my_hello_world_vpc\": {\n        \"for_each\": {\n          \"vpc1\": \"test_vpc\",\n          \"vpc2\": \"test_vpc\"\n        }\n        \"name\": \"${each.value}\"\n      }\n    }\n  }\n}\n```","type":"string","x-omitempty":true}},"type":"object"},"ResourceNamePrimitiveTypeHolder":{"example":{"resource_name":"my_hello_world_vpc"},"properties":{"resource_name":{"description":"资源的名称,默认为资源的逻辑名称\n\n以HCL格式的模板为例,resource_name 为 my_hello_world_vpc\n\n```hcl\nresource \"huaweicloud_vpc\" \"my_hello_world_vpc\" {\n  name = \"test_vpc\"\n}\n```\n\n以json格式的模板为例,resource_name 为 my_hello_world_vpc\n\n```json\n{\n  \"resource\": {\n    \"huaweicloud_vpc\": {\n      \"my_hello_world_vpc\": {\n        \"name\": \"test_vpc\"\n      }\n    }\n  }\n}\n```","type":"string"}},"type":"object"},"ResourceTypePrimitiveTypeHolder":{"example":{"resource_type":"huaweicloud_vpc"},"properties":{"resource_type":{"description":"资源的类型\n\n以HCL格式的模板为例,resource_type 为 huaweicloud_vpc\n\n```hcl\nresource \"huaweicloud_vpc\" \"my_hello_world_vpc\" {\n  name = \"test_vpc\"\n}\n```\n\n以json格式的模板为例,resource_type 为 huaweicloud_vpc\n\n```json\n{\n  \"resource\": {\n    \"huaweicloud_vpc\": {\n      \"my_hello_world_vpc\": {\n        \"name\": \"test_vpc\"\n      }\n    }\n  }\n}\n```","type":"string"}},"type":"object"}},"description":null,"group_id":"ffbc0f3a195c4338b5218addf5d56a6c","host":"rfs.cn-north-4.myhuaweicloud.com","id":"ad06cdf53589432a8caac2cea4b45f5d","info_version":"v1","method":"get","name":"GetExecutionPlan","parameters":{},"paths":{"/v1/{project_id}/stacks/{stack_name}/execution-plans/{execution_plan_name}":{"get":{"description":"获取执行计划(GetExecutionPlan)\n\n此API用于获取指定执行计划的详细内容(即执行计划项目),用户可通过此API得知指定执行计划在执行后,资源栈中的资源会发生何种变化\n\n如果执行计划状态为`CREATION_IN_PROGRESS`或`CREATION_FAILED`,则不返回执行计划项目列表","operationId":"GetExecutionPlan","parameters":[{"description":"用户指定的,对于此请求的唯一ID,用于定位某个请求,推荐使用UUID","in":"header","maxLength":128,"minLength":36,"name":"Client-Request-Id","pattern":"^[A-Za-z0-9]+[A-Za-z0-9-]*$","required":true,"type":"string"},{"description":"项目ID,可以从调用API处获取,也可以从控制台获取。\n\n[项目ID获取方式](https://support.huaweicloud.com/api-ticket/ticket_api_20002.html)","in":"path","maxLength":64,"minLength":3,"name":"project_id","pattern":"^[A-Za-z0-9-]+$","required":true,"type":"string"},{"description":"资源栈的名称。此名字在domain_id+区域+project_id下应唯一,可以使用中文、大小写英文、数字、下划线、中划线。首字符需为中文或者英文,区分大小写。","in":"path","maxLength":128,"minLength":1,"name":"stack_name","pattern":"^[一-龥A-Za-z]+[一-龥A-Za-z0-9_-]*$","required":true,"type":"string"},{"description":"执行计划的名称。此名字在domain_id+区域+project_id+stack_id下应唯一,可以使用中文、大小写英文、数字、下划线、中划线。首字符需为中文或者英文,区分大小写。","in":"path","maxLength":128,"minLength":1,"name":"execution_plan_name","pattern":"^[一-龥A-Za-z]+[一-龥A-Za-z0-9_-]*$","required":true,"type":"string"},{"description":"资源栈(stack)的唯一ID。\n\n此ID由资源编排服务在生成资源栈的时候生成,为UUID。\n\n由于资源栈名仅仅在同一时间下唯一,即用户允许先生成一个叫HelloWorld的资源栈,删除,再重新创建一个同名资源栈。\n\n对于团队并行开发,用户可能希望确保,当前我操作的资源栈就是我认为的那个,而不是其他队友删除后创建的同名资源栈。因此,使用ID就可以做到强匹配。\n\n资源编排服务保证每次创建的资源栈所对应的ID都不相同,更新不会影响ID。如果给予的stack_id和当前资源栈的ID不一致,则返回400","in":"query","maxLength":36,"minLength":36,"name":"stack_id","pattern":"^[a-z0-9]+[a-z0-9-]*$","required":false,"type":"string","x-isnullable":true},{"description":"执行计划(execution_plan)的唯一ID。\n\n此ID由资源编排服务在生成执行计划的时候生成,为UUID。\n\n由于执行计划名仅仅在同一时间下唯一,即用户允许先生成一个叫HelloWorld的执行计划,删除,再重新创建一个同名执行计划。\n\n对于团队并行开发,用户可能希望确保,当前我操作的执行计划就是我认为的那个,而不是其他队友删除后创建的同名执行计划。因此,使用ID就可以做到强匹配。\n\n资源编排服务保证每次创建的执行计划所对应的ID都不相同,更新不会影响ID。如果给予的execution_plan_id和当前执行计划的ID不一致,则返回400","in":"query","maxLength":36,"minLength":36,"name":"execution_plan_id","pattern":"^[a-z0-9]+[a-z0-9-]*$","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"获取成功","examples":{"x-response-examples-1":{"execution_plan_items":[{"action":"ADD","attributes":[{"name":"cidr","target_value":"172.16.0.0/16"},{"name":"dhcp_enable","target_value":"true"},{"name":"dns_list","target_value":"(will be generated after apply)"},{"name":"gateway_ip","target_value":"192.168.128.1"},{"name":"id","target_value":"(will be generated after apply)"},{"name":"name","target_value":"subnet_demo"},{"name":"region"},{"name":"site_id","target_value":"mock_site_id"},{"name":"site_info","target_value":"(will be generated after apply)"},{"name":"status","target_value":"(will be generated after apply)"},{"name":"timeouts"},{"name":"vpc_id","target_value":"mock_vpc_id"}],"mode":"RESOURCE","provider_name":"huawei.com/provider/huaweicloud","resource_name":"subnet","resource_type":"huaweicloud_iec_vpc_subnet"},{"action":"ADD","attributes":[{"name":"cidr","target_value":"172.16.0.0/16"},{"name":"description"},{"name":"enterprise_project_id","target_value":"(will be generated after apply)"},{"name":"id","target_value":"(will be generated after apply)"},{"name":"name","target_value":"test_name"},{"name":"region","target_value":"(will be generated after apply)"},{"name":"routes","target_value":"(will be generated after apply)"},{"name":"secondary_cidr"},{"name":"status","target_value":"(will be generated after apply)"},{"name":"tags"},{"name":"timeouts"}],"mode":"RESOURCE","provider_name":"huawei.com/provider/huaweicloud","resource_name":"vpc","resource_type":"huaweicloud_vpc"}]}},"schema":{"$ref":"#/definitions/GetExecutionPlanResponseBody"}},"400":{"description":"用户请求非法","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"401":{"description":"用户身份认证失败","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"403":{"description":"用户无权限调用此API","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"404":{"description":"1. 资源栈不存在\n2. 执行计划不存在","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"429":{"description":"请求数量过多","schema":{"$ref":"#/definitions/CommonErrorResponse"}},"500":{"description":"服务器内部错误","schema":{"$ref":"#/definitions/CommonErrorResponse"}}},"summary":"获取执行计划","tags":["Execution Plan"],"x-api-type":"open-api","x-is-registered":"Y","x-request-examples-description-1":"获取指定执行计划的详细内容(即执行计划项目)","x-request-examples-description-2":"获取指定执行计划的详细内容(即执行计划项目),并提供资源栈id和执行计划id以校验是否与当前资源栈和执行计划匹配","x-request-examples-url-1":"GET https://{endpoint}/v1/ba2b9930c977f71edaeaa3a5e96a8ff1/stacks/my_hello_world_stack/execution-plans/my_first_execution_plan","x-request-examples-url-2":"GET https://{endpoint}/v1/ba2b9930c977f71edaeaa3a5e96a8ff1/stacks/my_hello_world_stack/execution-plans/my_first_execution_plan?stack_id=ea6a4f0e-ee8a-494e-b12a-8be4a1e65af2&execution_plan_id=fb5e781e-a27d-46e2-9954-242753857a9f","x-support-sdk":"Y"}}},"product_short":"AOS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":{"apig-auth-app":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-type":"AppSigv1"},"apig-auth-app-optional":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-opt":{"access-auth-type":"optional"},"x-apigateway-auth-type":"AppSigv1"},"apig-auth-iam":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM"},"apig-auth-iam-none":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM_NONE"},"token":{"in":"header","name":"X-Auth-Token","type":"apiKey"}},"summary":"获取执行计划","tags":"资源编排-执行计划","uri":null,"version":"2.0"}