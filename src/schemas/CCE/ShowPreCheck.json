{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"NodeInfo":{"description":"节点检查状态","properties":{"name":{"description":"节点名称","type":"string"},"nodeType":{"description":"节点类型","type":"string"},"status":{"description":"状态","type":"string"},"uid":{"description":"节点UID","type":"string"}}},"NodeStageStatus":{"description":"节点检查状态","properties":{"itemsStatus":{"description":"检查项状态集合","items":{"$ref":"#/definitions/PreCheckItemStatus"},"type":"array"},"nodeInfo":{"$ref":"#/definitions/NodeInfo","description":"节点信息","type":"string"}}},"PreCheckItemStatus":{"description":"检查项状态信息","properties":{"errorCodes":{"description":"错误码集合","items":{"description":"错误码","type":"string"},"type":"array"},"group":{"description":"检查项分组,取值如下\n- LimitCheck: 集群限制检查\n- MasterCheck:控制节点检查\n- NodeCheck:用户节点检查\n- AddonCheck:插件检查\n- ExecuteException:检查流程错误","type":"string"},"kind":{"description":"检查项类型,取值如下\n- Exception: 异常类,需要用户解决\n- Risk:风险类,用户确认后可选择跳过","type":"string"},"level":{"description":"检查项风险级别,取值如下\n- Info: 提示级别\n- Warning:风险级别\n- Fatal:严重级别","type":"string"},"message":{"description":"提示信息","type":"string"},"name":{"description":"检查项名称","type":"string"},"phase":{"description":"状态,取值如下\n- Init: 初始化\n- Running 运行中\n- Success 成功\n- Failed 失败","type":"string"},"riskSource":{"$ref":"#/definitions/riskSource","description":"风险项"}}},"PrecheckClusterTaskResponseBody":{"properties":{"apiVersion":{"description":"api版本,默认为v3","type":"string"},"kind":{"description":"资源类型,默认为PreCheckTask","type":"string"},"metadata":{"$ref":"#/definitions/PrecheckTaskMetadata","description":"升级前检查任务元数据信息"},"spec":{"$ref":"#/definitions/PrecheckSpec","description":"升级前检查任务信息"},"status":{"$ref":"#/definitions/PrecheckStatus","description":"升级前检查任务状态"}}},"PrecheckSpec":{"properties":{"clusterID":{"description":"集群ID","type":"string"},"clusterVersion":{"description":"集群版本","type":"string"},"skippedCheckItemList":{"description":"跳过检查的项目列表","items":{"$ref":"#/definitions/skippedCheckItemList"},"type":"array"},"targetVersion":{"description":"升级目标版本","type":"string"}}},"PrecheckStatus":{"description":"升级前检查状态","properties":{"addonCheckStatus":{"$ref":"#/definitions/addonCheckStatus","description":"插件检查状态"},"clusterCheckStatus":{"$ref":"#/definitions/clusterCheckStatus","description":"集群限制检查状态"},"expireTimeStamp":{"description":"检查结果过期时间","type":"string"},"message":{"description":"信息,一般是执行错误的日志信息","type":"string"},"nodeCheckStatus":{"$ref":"#/definitions/nodeCheckStatus","description":"节点检查状态"},"phase":{"description":"状态,取值如下\n- Init: 初始化\n- Running 运行中\n- Success 成功\n- Failed 失败\n- Error 错误","type":"string"}}},"PrecheckTaskMetadata":{"description":"升级前检查任务元数据","properties":{"creationTimestamp":{"description":"任务创建时间","type":"string"},"uid":{"description":"任务ID","type":"string"},"updateTimestamp":{"description":"任务更新时间","type":"string"}}},"addonCheckStatus":{"description":"插件限制检查状态","properties":{"itemsStatus":{"description":"检查项状态集合","items":{"$ref":"#/definitions/PreCheckItemStatus"},"type":"array"},"phase":{"description":"状态,取值如下\n- Init: 初始化\n- Running 运行中\n- Success 成功\n- Failed 失败","type":"string"}}},"addonRisks":{"description":"节点风险来源","properties":{"addonTemplateName":{"description":"插件模板名称","type":"string"},"alias":{"description":"插件别名","type":"string"}}},"clusterCheckStatus":{"description":"集群限制检查状态","properties":{"itemsStatus":{"description":"检查项状态集合","items":{"$ref":"#/definitions/PreCheckItemStatus"},"type":"array"},"phase":{"description":"状态,取值如下\n- Init: 初始化\n- Running 运行中\n- Success 成功\n- Failed 失败","type":"string"}}},"configurationRisks":{"description":"配置风险项来源","properties":{"field":{"description":"参数值","type":"string"},"nodeMsg":{"description":"节点信息","type":"string"},"operation":{"description":"修改操作类型","type":"string"},"originalValue":{"description":"原始值","type":"string"},"package":{"description":"组件名称","type":"string"},"sourceFile":{"description":"涉及文件路径","type":"string"},"value":{"description":"当前值","type":"string"}}},"deprecatedAPIRisks":{"description":"废弃API风险来源","properties":{"url":{"description":"请求路径,如/apis/policy/v1beta1/podsecuritypolicies","type":"string"},"userAgent":{"description":"客户端信息","type":"string"}}},"nodeCheckStatus":{"description":"节点限制检查状态","properties":{"nodeStageStatus":{"description":"节点检查状态","items":{"$ref":"#/definitions/NodeStageStatus"},"type":"array"},"phase":{"description":"状态,取值如下\n- Init: 初始化\n- Running 运行中\n- Success 成功\n- Failed 失败","type":"string"}}},"nodeRisks":{"description":"节点风险来源","properties":{"NodeID":{"description":"用户节点ID","type":"string"}}},"resourceSelector":{"description":"资源标签选择器,匹配Kubernetes中node资源","properties":{"key":{"description":"标签键值,取值如下\n- node.uid:节点UID。","enum":["node.uid"],"type":"string"},"operator":{"description":"标签逻辑运算符,当前支持如下取值\n- In","enum":["In"],"type":"string"},"values":{"description":"标签值列表","items":{"description":"标签值","type":"string"},"type":"array"}},"required":["key","operator"]},"riskSource":{"description":"风险项来源","properties":{"addonRisks":{"description":"插件风险","items":{"$ref":"#/definitions/addonRisks"},"type":"array"},"configurationRisks":{"description":"配置风险项","items":{"$ref":"#/definitions/configurationRisks"},"type":"array"},"deprecatedAPIRisks":{"description":"废弃API风险","items":{"$ref":"#/definitions/deprecatedAPIRisks"},"type":"array"},"nodeRisks":{"description":"节点风险","items":{"$ref":"#/definitions/nodeRisks"},"type":"array"}}},"skippedCheckItemList":{"properties":{"name":{"description":"跳过的检查项名称","type":"string"},"resourceSelector":{"$ref":"#/definitions/resourceSelector","description":"资源标签选择器,仅节点检查涉及该参数,集群检查和插件检查不涉及。"}}}},"description":null,"group_id":"394aeee55c894cd89bc6a709f45ae609","host":"cce.cn-north-4.myhuaweicloud.com","id":"d16c7c2fe2254846a3b0c3a6ae32b9dd","info_version":"v3","method":"get","name":"ShowPreCheck","parameters":{"param_path_clusterid":{"description":"集群ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"cluster_id","pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","required":true,"type":"string","x-order":2},"param_path_projectid":{"description":"项目ID,获取方式请参见[如何获取接口URI中参数](cce_02_0271.xml)。","in":"path","name":"project_id","required":true,"type":"string","x-order":1},"param_path_taskid":{"description":"升级任务ID,调用集群升级API后从响应体中uid字段获取。","in":"path","name":"task_id","pattern":"^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$","required":true,"type":"string","x-order":7}},"paths":{"/api/v3/projects/{project_id}/clusters/{cluster_id}/operation/precheck/tasks/{task_id}":{"get":{"description":"获取集群升级前检查任务详情,任务ID由调用集群检查API后从响应体中uid字段获取。","operationId":"ShowPreCheck","parameters":[{"$ref":"#/parameters/param_path_projectid"},{"$ref":"#/parameters/param_path_clusterid"},{"$ref":"#/parameters/param_path_taskid"}],"produces":["application/json"],"responses":{"200":{"description":"表示获取集群升级前检查任务详情成功。","examples":{"application/json":{"apiVersion":"v3","kind":"PreCheckTask","metadata":{"creationTimestamp":"2023-11-25 07:20:04.592972 +0000 UTC","uid":"f61e008c-1600-41c0-9bde-121de5a30660","updateTimestamp":"2023-11-25 07:21:05.518966 +0000 UTC"},"spec":{"clusterVersion":"v1.19.16-r4","targetVersion":"v1.23.5-r0"},"status":{"addonCheckStatus":{"itemsStatus":[{"group":"AddonCheck","kind":"Exception","level":"Warning","message":"check item succeed","name":"AddonLimit","phase":"Success","riskSource":{}},{"group":"AddonCheck","kind":"Exception","level":"Fatal","message":"check item succeed","name":"CoreDNSConfLimit","phase":"Success","riskSource":{}}],"phase":"Success"},"clusterCheckStatus":{"itemsStatus":[{"group":"LimitCheck","kind":"Risk","level":"Info","message":"check item succeed","name":"DeprecatedApiCheck","phase":"Success","riskSource":{}},{"group":"LimitCheck","kind":"Risk","level":"Warning","message":"check item succeed","name":"NodeContainerdPodRestartRisk","phase":"Success","riskSource":{}},{"group":"LimitCheck","kind":"Exception","level":"Fatal","message":"check item succeed","name":"ResiduePackageVersion","phase":"Success","riskSource":{}}],"phase":"Success"},"expireTimeStamp":"2023-11-25 08:21:05.518966 +0000 UTC","nodeCheckStatus":{"phase":"Success"},"phase":"Success"}}},"schema":{"$ref":"#/definitions/PrecheckClusterTaskResponseBody"}}},"summary":"获取集群升级前检查任务详情","tags":["集群升级"],"x-api-type":"open-api","x-apiexplorer-hide":"false","x-constraint":"","x-is-registered":"Y","x-name":"获取集群升级前检查任务详情","x-open-region-cloud":"hws,hws_hk","x-order":8,"x-publishpath":"","x-scope":"Commercial","x-support-sdk":"Y"}}},"product_short":"CCE","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"获取集群升级前检查任务详情","tags":"集群升级","uri":null,"version":"2.0"}