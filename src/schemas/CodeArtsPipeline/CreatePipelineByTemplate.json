{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"ErrorResponse":{"example":{"error_code":"DEVCP.00000001","error_msg":"The format of message is error"},"properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误信息","type":"string"}},"type":"object"},"InstanceResponse":{"description":"流水线创建响应体","properties":{"task_id":{"description":"实例ID","example":"eafaff0bf9094d3d8456d13dddf67b40","type":"string"}},"required":["task_id"]},"PipelineParam":{"description":"流水线参数","example":{"description":"这是一个文本参数","is_default":true,"is_static":true,"name":"pipeline2020","paramtype":"normal","value":"cloudpipeline"},"properties":{"description":{"description":"流水线参数描述","type":"string"},"is_default":{"description":"是否默认参数","type":"boolean"},"is_static":{"description":"是否静态参数","type":"boolean"},"name":{"description":"流水线参数名字","type":"string"},"param_type":{"description":"流水线参数类型","type":"string"},"value":{"description":"流水线参数值","type":"string"}},"required":["name","value","description","param_type","is_static","is_default"]},"Source":{"description":"源码仓库参数","example":{"branch":"","branch_list":[],"branches":[],"codehub_id":"487938","codehub_name":"aabbccdd","disable":true,"git_url":"git@xxx/aabbccdd.git","hook_flag":false,"init_id":1,"scm_type":"codehub","web_url":"https://xxx/codehub/487938/home"},"properties":{"branch":{"description":"触发分支","type":"string"},"branch_list":{"description":"分支列表","items":{"type":"string"},"type":"array"},"branches":{"description":"触发分支","items":{"type":"string"},"type":"array"},"codehub_id":{"description":"源码仓ID","type":"string"},"codehub_name":{"description":"源码仓名字","type":"string"},"disable":{"description":"是否废弃","type":"boolean"},"git_url":{"description":"源码仓ssh地址","type":"string"},"hook_flag":{"description":"是否开启触发执行流水线功能","type":"boolean"},"init_id":{"description":"初始化ID","type":"string"},"scm_type":{"description":"源码仓来源","type":"string"},"web_url":{"description":"源码仓首页url","type":"string"}},"required":["codehub_name","branches","scm_type","hook_flag","branch","git_url","codehub_id","web_url","branch_list","init_id","disable"],"type":"object"},"TemplateCddl":{"description":"创建流水线接口入参","properties":{"flow":{"additionalProperties":{"additionalProperties":{"type":"string"},"type":"object"},"description":"编排flow详情,描述流水线内各阶段任务的串并行关系。map类型数据,key为阶段名字,默认第一阶段initial,最后阶段为final,其余名字以'state_数字'标识。value为该阶段内任务(以'Task_数字'标识)以及后续阶段的标识。本字段为描述流水线基础编排数据之一,建议可通过流水线真实界面基于模板创建接口中获取","type":"object"},"states":{"additionalProperties":{"$ref":"#/definitions/TemplateState"},"description":"编排State详情,map类型数据。本字段为描述流水线基础编排数据之一,建议可通过流水线真实界面基于模板创建接口中获取","type":"object"},"workflow":{"$ref":"#/definitions/Workflow","description":"参数详情","type":"object"}},"required":["flow","states","workflow"]},"TemplateState":{"description":"子任务参数","example":{"display_name":"默认任务","dsl_method":"buildJob","execution_mode":"parallel","is_execute":true,"is_manual_execution":false,"is_show_codehub_url":false,"job_id":"00012","job_name":"Maven","job_parameter_validate":false,"module_or_template_id":"00012","module_or_template_name":"Maven","name":"Task_2","parameters":{},"project_id":"3560a08e3c5143c5bb0236e0ef910926","type":"task"},"properties":{"display_name":{"description":"任务在流水线页面展示名字","type":"string"},"dsl_method":{"description":"流水线可挂载任务类型","type":"string"},"execution_mode":{"description":"控制阶段下任务的串并行(type是task的execution_mode值为null,type是stage的execution_mode可选parallel(并行)或者serial(串行))","type":"string"},"is_execute":{"description":"是否执行","type":"boolean"},"is_manual_execution":{"description":"是否手动执行","type":"boolean"},"is_show_codehub_url":{"description":"是否显示代码仓URL","type":"boolean"},"job_id":{"description":"执行任务ID","type":"string"},"job_name":{"description":"执行任务名字","type":"string"},"job_parameter_validate":{"description":"任务参数是否校验","type":"boolean"},"module_or_template_id":{"description":"模板任务ID","type":"string"},"module_or_template_name":{"description":"模板任务名字","type":"string"},"name":{"description":"任务名字","type":"string"},"parameters":{"additionalProperties":{"type":"object"},"description":"任务参数,map类型数据","type":"object"},"project_id":{"description":"任务所属项目ID","type":"string"},"type":{"description":"任务类型","type":"string"}},"required":["type","name","module_or_template_id","module_or_template_name","display_name","dsl_method","parameters","is_manual_execution","job_parameter_validate","is_show_codehub_url","is_execute","job_id","job_name","project_id","execution_mode"]},"Workflow":{"description":"流水线参数详情","example":{"name":"pipeline-20200316144601","parameter":[{"$ref":"#/definitions/PipelineParam/example"}],"project_id":"3560a08e3c5143c5bb0236e0ef910926","project_name":"CloudPipeline专用测试","source":[{"$ref":"#/definitions/Source/example"}]},"properties":{"name":{"description":"流水线名字","type":"string"},"parameter":{"description":"任务类型,list类型数据","items":{"$ref":"#/definitions/PipelineParam"},"type":"array"},"project_id":{"description":"项目ID","type":"string"},"project_name":{"description":"项目名字","type":"string"},"source":{"description":"源码仓,list类型数据","items":{"$ref":"#/definitions/Source"},"type":"array"}},"required":["parameter","source","name","project_id","project_name"]}},"description":null,"group_id":"030b4771a0bd4a949ed5e26f50da9017","host":"cloudpipeline-ext.cn-north-4.myhuaweicloud.com","id":"f8a5ccfecd66485f828855297da144a8","info_version":"v2","method":"post","name":"CreatePipelineByTemplate","parameters":{},"paths":{"/v3/templates/task":{"post":{"consumes":["application/json"],"deprecated":false,"description":"基于模板快速创建流水线及流水线内任务","operationId":"CreatePipelineByTemplate","parameters":[{"description":"用户Token。\n\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":false,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."},{"description":"创建流水线参数","in":"body","name":"CreatePipelineByTemplateRequestBody","required":true,"schema":{"$ref":"#/definitions/TemplateCddl"}}],"produces":["application/json"],"responses":{"201":{"description":"OK","examples":{"application/json":{"task_id":"eafaff0bf9094d3d8456d13dddf67b40"}},"schema":{"$ref":"#/definitions/InstanceResponse"}},"400":{"description":"Bad request","schema":{"$ref":"#/definitions/ErrorResponse"}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"},"404":{"description":"Not Found"}},"security":[{"apig-auth-iam":[]}],"summary":"基于模板快速创建流水线及流水线内任务","tags":["流水线管理"],"x-apigateway-backend":{"httpEndpoints":{"address":"10.63.38.190:40115","description":"","method":"POST","path":"/cloudinit/cloudinit/v3/templates/task","scheme":"https","timeout":30000},"type":"HTTP"},"x-apigateway-cors":false,"x-apigateway-match-mode":"NORMAL","x-apigateway-request-type":"public","x-first-open-time":"2020-03-21","x-is-registered":"Y","x-name":"基于模板快速创建流水线及各个任务","x-request-examples-1":{"Task_1":{"display_name":"默认任务","dsl_method":"deployMan","execution_mode":null,"is_execute":true,"is_manual_execution":false,"is_show_codehub_url":false,"job_id":"6efb0b24e2e9489eb0e53ee12904a19e","job_name":"SpringBoot应用部署","job_parameter_validate":true,"module_or_template_id":"6efb0b24e2e9489eb0e53ee12904a19e","module_or_template_name":"SpringBoot应用部署","name":"Task_1","parameters":{"download_path":{"display_type":"text","static":true,"value":"/usr/local/"},"host_group":{"display_type":"host_group","displayname":"testlh","static":false,"value":"4af439373cf745278ac55f96fe401fa8"},"jdk_path":{"display_type":"text","static":true,"value":"/usr/local/jdk"},"package_url":{"display_type":"text","static":false,"value":"ss"},"service_port":{"display_type":"text","static":false,"value":"ss"},"spring_path":{"display_type":"text","static":false,"value":"aa"}},"params":null,"project_id":"3560a08e3c5143c5bb0236e0ef910926","type":"task"},"Task_2":{"display_name":"默认任务","dsl_method":"buildJob","execution_mode":null,"is_execute":true,"is_manual_execution":false,"is_show_codehub_url":false,"job_id":"00012","job_name":"Maven","job_parameter_validate":true,"module_or_template_id":"00012","module_or_template_name":"Maven","name":"Task_2","parameters":{"__repository__":{"repo_name":"aabbccdd","url":"git@xxx/aabbccdd.git"}},"params":null,"project_id":"3560a08e3c5143c5bb0236e0ef910926","type":"task"},"final":{"display_name":"结束","dsl_method":"final","execution_mode":"parallel","is_manual_execution":false,"module_or_template_id":null,"module_or_template_name":null,"name":"final","parameters":null,"params":null,"type":"stage"},"initial":{"display_name":"源代码","dsl_method":"initial","execution_mode":"parallel","is_manual_execution":false,"module_or_template_id":null,"module_or_template_name":null,"name":"initial","parameters":{"display":"hidden"},"params":null,"type":"stage"},"state_3":{"display_name":"源代码","dsl_method":"source","execution_mode":"parallel","is_manual_execution":false,"module_or_template_id":null,"module_or_template_name":null,"name":"state_3","parameters":null,"params":null,"type":"stage"},"state_4":{"display_name":"构建","dsl_method":"build","execution_mode":"parallel","is_manual_execution":false,"module_or_template_id":null,"module_or_template_name":null,"name":"state_4","parameters":null,"params":null,"type":"stage"},"state_5":{"display_name":"发布仓库","dsl_method":"release","execution_mode":"parallel","is_manual_execution":false,"module_or_template_id":null,"module_or_template_name":null,"name":"state_5","parameters":null,"params":null,"type":"stage"}},"x-request-examples-url-1":"POST https://{endpoint}/v3/templates/task","x-support-sdk":"Y"}}},"product_short":"CodeArtsPipeline","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":{"apig-auth-app":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-type":"AppSigv1"},"apig-auth-iam":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM"},"apig-auth-iam-none":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM_NONE"}},"summary":"基于模板快速创建流水线及流水线内任务","tags":"流水线管理","uri":null,"version":"2.0"}