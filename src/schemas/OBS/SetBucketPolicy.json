{"base_path":"/","components":null,"consumes":"[\"application/xml;charset=UTF-8\"]","definitions":{"Error":{"description":"错误响应消息体\n","properties":{"Code":{"description":"错误响应消息体XML中错误响应对应的HTTP消息返回码,具体的错误码请参见[错误码-表2](https://support.huaweicloud.com/api-obs/obs_04_0115.html#obs_04_0115__d0e843)。\n","type":"string"},"HostId":{"description":"返回该消息的服务端ID。\n","type":"string"},"Message":{"description":"错误响应消息体XML中具体错误更全面、详细的英文解释,具体的错误消息请参见[错误码-表2](https://support.huaweicloud.com/api-obs/obs_04_0115.html#obs_04_0115__d0e843)。\n","type":"string"},"RequestId":{"description":"本次错误请求的请求ID,用于错误定位。\n","type":"string"},"Resource":{"description":"该错误相关的桶或对象资源。\n","type":"string"}}},"PrincipalID":{"description":"OBS支持的Principal或NotPrincipal有匿名用户、特定租户、特定用户、联合身份用户,委托用户。\n","example":["domain/783fc6652cf246c096ea836694f71855:user/*"],"items":{"type":"string"},"type":"array"},"SetBucketPolicyRequestBody":{"properties":{"Statement":{"items":{"$ref":"#/definitions/Statement"},"type":"array"}},"xml":{"name":"Policy"}},"Statement":{"description":"桶策略描述。Policy由多条statement组成,也可以是一条。\n\n在单条statement中,Action与NotAction必须二选一,Resource与NotResource必须二选一,Principal与NotPrincipal必须二选一。\n\n详细介绍请参见[桶策略参数说明](https://support.huaweicloud.com/perms-cfg-obs/obs_40_0041.html)。\n","properties":{"Action":{"description":"可选关键字,指定本条statement作用的操作,Action字段为OBS支持的所有操作集合,以字符串形式表示,不区分大小写。支持通配符“*”,表示该资源能进行的所有操作。例如:\"Action\":[\"List*\", \"Get*\"]。\n可选,Action与NotAction选其一。\n","example":["List*","Get*"],"items":{"type":"string"},"type":"array"},"Condition":{"description":"除了指定效果、被授权用户、资源、动作外,桶策略还可以指定生效条件。只有当条件设置的表达式与访问请求中的值匹配时,桶策略才生效。条件是可选参数,用户可以根据业务需要选择是否使用。\n\n条件由条件运算符、键、值三部分组成,最终组成一个条件表达式,决定桶策略生效的条件。同一个条件运算符中,如果存在多个相同的键,则只会保留最后一个键。条件运算符、键两者之间存在互相限制的关联关系,例如:\n条件运算符选择了一个String类型的,比如StringEquals,键就只能选择String类型的,比如UserAgent。\n键选择了一个Date类型,比如CurrentTime,条件运算符就只能选择Date类型的,比如DateEquals。\n\nCondition判断类型和键如[桶策略参数说明表4-7](https://support.huaweicloud.com/perms-cfg-obs/obs_40_0041.html#section3)所示。\n","example":"\"Condition\" : {\n  \"DateGreaterThan\" : {\n  \"CurrentTime\" : \"2015-07-01T12:00:00Z\"\n  },\n  \"DateLessThan\": {\n  \"CurrentTime\" : \"2018-04-16T15:00:00Z\"\n  },\n  \"IpAddress\" : {\n  \"SourceIp\" : [\"192.168.176.0/24\",\"192.168.143.0/24\"]\n  }\n}\n","type":"object"},"Effect":{"description":"必选关键字,效果,指定本条statement的权限是允许还是拒绝,Effect的值必须为Allow或者Deny。\n","enum":["Allow","Deny"],"example":"Allow","type":"string"},"NotAction":{"description":"可选关键字,指定一组操作,statement匹配除该组操作之外的其他操作。 取值同Action。\n可选,Action与NotAction选其一。\n","example":["List*","Get*"],"items":{"type":"string"},"type":"array"},"NotPrincipal":{"description":"可选关键字,不被授权人,statement匹配除此之外的其他人。取值同Principal。\n\n可选,NotPrincipal与Principal选其一。\n","properties":{"ID":{"$ref":"#/definitions/PrincipalID"}}},"NotResource":{"description":"可选关键字,指定一组资源,statement匹配除该组资源之外的其他资源。 取值同Resource。\n可选,Resource与NotResource选其一。\n","example":["examplebucket/*","examplebucket"],"items":{"type":"string"},"type":"array"},"Principal":{"description":"可选关键字,被授权人,指定本条statement权限针对的Domain以及User,支持通配符“*”,表示所有用户。当对Domain下所有用户授权时,Principal格式为domain/domainid:user/*。当对某个User进行授权时,Principal格式为domain/domainid:user/userId或者domain/domainid:user/userName。\n\n如果通过控制台进行桶清单配置,控制台会自动生成目标桶的桶策略。目标桶的桶策略中Principal取值则固定为{\"Service\": \"obs\"}。关于桶清单的详细介绍请参见[桶清单说明](https://support.huaweicloud.com/ugobs-obs/obs_41_0044.html)。\n\n可选,Principal与NotPrincipal选其一。\n","properties":{"ID":{"$ref":"#/definitions/PrincipalID"}}},"Resource":{"description":"可选关键字,指定statement起作用的一组资源,支持通配符“*”,表示所有资源。\n可选,Resource与NotResource选其一。\n","example":["examplebucket/*","examplebucket"],"items":{"type":"string"},"type":"array"},"Sid":{"description":"statement Id,可选关键字,描述statement的字符串。\n","example":"Stmt1375240018061","type":"string"}},"required":["Effect"]}},"description":null,"group_id":"7d10a01d10854bd59cf6189eebfb9c7d","host":"obs.cn-north-4.myhuaweicloud.com","id":"333a69f707174dbeb3e66cbf581d8f48","info_version":"v1","method":"put","name":"SetBucketPolicy","parameters":{},"paths":{"/":{"put":{"consumes":["application/json"],"description":"该接口的实现使用policy子资源创建或者修改一个桶的策略。如果桶已经存在一个策略,那么当前请求中的策略将完全覆盖桶中现存的策略。单个桶的桶策略条数(statement)没有限制,但一个桶中所有桶策略的JSON描述总大小不能超过20KB。\n\n要使用该接口,使用者要求必须是桶的所有者,或者是桶所有者的子用户且具有设置桶策略的权限。\n\n使用桶策略进行权限控制请参考《对象存储服务权限配置指南》的[OBS权限控制概述](https://support.huaweicloud.com/perms-cfg-obs/obs_40_0001.html)章节。\n","operationId":"SetBucketPolicy","parameters":[{"description":"请求消息中可带的签名信息。\n","in":"header","name":"Authorization","required":true,"type":"string"},{"description":"请求发起端的日期和时间,例如:Wed, 27 Jun 2018 13:39:15 +0000。\n默认值:无。\n条件:如果消息头中带了x-obs-date字段,则可以不带该字段,其他情况下必选。\n","in":"header","name":"Date","required":false,"type":"string","x-apiexplorer-format":"date-gmt"},{"description":"请求的桶名称。\n","in":"query","maxLength":63,"minLength":3,"name":"bucket_name","required":true,"type":"string","x-location-cname":true},{"allowEmptyValue":true,"description":"policy表示请求桶策略API。\n","in":"query","maxLength":0,"minLength":0,"name":"policy","required":true,"type":"string"},{"description":"桶策略的信息。\n","in":"body","name":"SetBucketPolicyRequestBody","required":true,"schema":{"$ref":"#/definitions/SetBucketPolicyRequestBody"}}],"responses":{"204":{"description":"成功响应消息\n","headers":{"Connection":{"description":"指明与服务器的连接是长连接还是短连接。\n","type":"string"},"Content-Length":{"description":"响应消息体的字节长度。\n","type":"string"},"Date":{"description":"OBS系统响应的时间。\n","type":"string"},"ETag":{"description":"对象的base64编码的128位MD5摘要。ETag是对象内容的唯一标识,可以通过该值识别对象内容是否有变化。比如上传对象时ETag为A,下载对象时ETag为B,则说明对象内容发生了变化。实际的ETag是对象的哈希值。ETag只反映变化的内容,而不是其元数据。上传的对象或拷贝操作创建的对象,通过MD5加密后都有唯一的ETag。如果通过多段上传对象,则无论加密方法如何,MD5会拆分ETag,此类情况ETag就不是MD5的摘要。\n","type":"string"},"x-obs-id-2":{"description":"帮助定位问题的特殊符号。\n","type":"string"},"x-obs-request-id":{"description":"由OBS创建来唯一确定本次请求的值,可以通过该值来定位问题。\n","type":"string"}}},"400":{"description":"请求失败响应消息。\n","schema":{"$ref":"#/definitions/Error"}}},"summary":"设置桶策略","tags":["桶的高级配置"],"x-is-registered":"Y","x-request-examples-1":"PUT /?policy HTTP/1.1\nHost: examplebucket.obs.cn-north-4.myhuaweicloud.com\nDate: WED, 01 Jul 2015 02:32:25 GMT\nAuthorization: OBS H4IPJX0TQTHTHEBQQCEC:jZiAT8Vx4azWEvPRMWi0X5BpJMA=\n\n{\n    \"Statement\": [\n        {\n            \"Sid\": \"Stmt1375240018061\",\n            \"Action\": [\n                \"GetBucketLogging\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"logging.bucket\",\n            \"Principal\": {\n                \"ID\": [\n                    \"domain/783fc6652cf246c096ea836694f71855:user/*\"\n                ]\n            }\n        }\n    ]\n}","x-request-examples-url-1":"/?policy","x-support-sdk":"N"}}},"product_short":"OBS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"设置桶策略","tags":"桶的高级配置","uri":null,"version":"2.0"}