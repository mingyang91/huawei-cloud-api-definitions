{"base_path":"/","components":null,"consumes":"[\"application/xml;charset=UTF-8\"]","definitions":{"AbortIncompleteMultipartUpload":{"description":"生命周期配置中表示未合并的多段任务(碎片)的过期属性Container。\n如果没有Transition, Expiration, NoncurrentVersionExpiration, NoncurrentVersionTransition则必选。\n","properties":{"DaysAfterInitiation":{"description":"指定未合并的多段任务(碎片)的生命周期规则,在多段任务初始化过后多少天生效。\n如果有AbortIncompleteMultipartUpload则必选。\n","format":"int32","minimum":0,"type":"integer"}}},"Error":{"description":"错误响应消息体\n","properties":{"Code":{"description":"错误响应消息体XML中错误响应对应的HTTP消息返回码,具体的错误码请参见[错误码-表2](https://support.huaweicloud.com/api-obs/obs_04_0115.html#obs_04_0115__d0e843)。\n","type":"string"},"HostId":{"description":"返回该消息的服务端ID。\n","type":"string"},"Message":{"description":"错误响应消息体XML中具体错误更全面、详细的英文解释,具体的错误消息请参见[错误码-表2](https://support.huaweicloud.com/api-obs/obs_04_0115.html#obs_04_0115__d0e843)。\n","type":"string"},"RequestId":{"description":"本次错误请求的请求ID,用于错误定位。\n","type":"string"},"Resource":{"description":"该错误相关的桶或对象资源。\n","type":"string"}}},"Expiration":{"properties":{"Date":{"description":"指定OBS对该日期之前的对象执行生命周期规则。日期格式必须为ISO8601的格式,并且为UTC的零点。\n例如:2018-01-01T00:00:00.000Z,表示将最后修改时间早于2018-01-01T00:00:00.000Z的对象删除或转换成其他存储类型,等于或晚于这个时间的对象不会被删除或转储。\n\n如果没有Days元素,则必选。\n","type":"string"},"Days":{"description":"指定生命周期规则在对象最后更新过后多少天生效(仅针对对象的最新版本)。\n\n如果没有Date元素,则必选。","format":"int32","minimum":0,"type":"integer"}}},"NoncurrentVersionExpiration":{"description":"生命周期配置中表示历史版本过期时间的Container。您可以将该动作设置在已启用多版本(或暂停)的桶,来让系统删除对象的满足特定生命周期的历史版本(仅针对历史版本)。","properties":{"NoncurrentDays":{"description":"表示对象在成为历史版本之后第几天时规则生效(仅针对历史版本)。\n如果有NoncurrentVersionExpiration或NoncurrentVersionTransition元素,则必选。","format":"int32","minimum":0,"type":"integer"}}},"NoncurrentVersionTransition":{"description":"生命周期配置中表示对象的历史版本迁移时间和迁移后对象存储级别的元素。\n","properties":{"NoncurrentDays":{"description":"表示对象在成为历史版本之后第几天时规则生效(仅针对历史版本)。\n","format":"int32","minimum":0,"type":"integer"},"StorageClass":{"description":"表示对象将被修改成存储级别。\n取值范围: WARM或COLD\n","enum":["WARM","COLD"],"type":"string"}}},"Rule":{"description":"具体某一条生命周期配置的Container。\n","properties":{"AbortIncompleteMultipartUpload":{"$ref":"#/definitions/AbortIncompleteMultipartUpload","description":"生命周期配置中表示未合并的多段任务(碎片)的过期属性Container。\n如果没有Transition, Expiration, NoncurrentVersionExpiration, NoncurrentVersionTransition则必选。\n"},"Expiration":{"$ref":"#/definitions/Expiration","description":"生命周期配置中表示过期时间的Container(仅针对对象的最新版本)。\n如果没有Transition, NoncurrentVersionTransition, NoncurrentVersionExpiration, AbortIncompleteMultipartUpload则必选。\n"},"ID":{"description":"一条Rule的标识,由不超过255个字符的字符串组成。\n","type":"string"},"NoncurrentVersionExpiration":{"$ref":"#/definitions/NoncurrentVersionExpiration","description":"生命周期配置中表示历史版本过期时间的Container。您可以将该动作设置在已启用多版本(或暂停)的桶,来让系统删除对象的满足特定生命周期的历史版本(仅针对历史版本)。\n"},"NoncurrentVersionTransition":{"description":"生命周期配置中表示对象的历史版本迁移时间和迁移后对象存储级别的元素。\n","items":{"$ref":"#/definitions/NoncurrentVersionTransition"},"type":"array"},"Prefix":{"description":"对象名前缀,用以标识哪些对象可以匹配到当前这条Rule。\n\n约束:\n1.当按前缀配置时,如果指定的前缀名与某条已配置的生命周期规则指定的前缀名存在包含关系,OBS会将两条规则视为同一条,而禁止您配置本条规则。例如,系统中已存在指定前缀名为“abc”的规则,则不允许再配置指定前缀以“abc”字段开头的规则。\n2.如果已存在按前缀配置的生命周期规则,则不允许再新增配置到整个桶的规则。\n","type":"string"},"Status":{"description":"标识当前这条Rule是否启用。\n","enum":["Enabled","Disabled"],"type":"string"},"Transition":{"description":"生命周期配置中表示迁移时间和迁移后对象存储级别的元素(仅针对对象的最新版本)。\n如果没有NoncurrentVersionTransition, Expiration, NoncurrentVersionExpiration, AbortIncompleteMultipartUpload则必选。\n","items":{"$ref":"#/definitions/Transition"},"type":"array"}},"required":["Prefix","Status"]},"SetBucketLifecycleRequestBody":{"description":"桶的生命周期配置信息。\n\n如果桶的多版本是Enabled或者Suspended,那么可以设置NoncurrentVersionTransition或NoncurrentVersionExpiration来控制对象的历史版本的生命周期。一个历史版本的生命周期,取决于它成为历史版本的时刻(即被新版本覆盖的那个时刻)和NoncurrentDays。对于删除来说,例如NoncurrentDays配置为1的话,表示当一个版本成为历史版本之后,再过1天才能删除。对象A的版本V1创建于1号,5号的时候又上传新的版本V2,此时V1成为历史版本,那么再过1天,7号的0点,V1就过期了。如果该版本不满足删除,迁移配置NoncurrentDays为1,StorageClass为WARM的话,表示当一个版本成为历史版本之后,再过1天转为温对象。对象A的版本V1创建于1号,5号的时候又上传新的版本V2,此时V1成为历史版本,那么再过1天,7号的0点,V1就会迁移成温对象了。(备注:对象过期后被删除或对象迁移的时间可能会有一定的延迟,一般不超过48小时。)\n如果桶的多版本是Enabled或者Suspended,且最新版本对象满足Expiration规则时的处理:\n桶当前的多版本状态为Enabled:\n如果对象的最新版本不是deletemarker,则该对象会产生一个新的deletemarker;\n\n如果最新版本是deletemarker,且该对象只有这一个版本,则这个版本会被删除;\n\n如果最新版本是deletemarker,且对象还有其他版本,则该对象的所有版本维持不变,没有新增和删除,也不会被修改(即无任何变化)。\n\n桶当前的多版本状态为Suspended:\n如果对象的最新版本不是deletemarker,且版本不是null版本,则会产生一个新的null版本的deletemarker;\n\n如果对象的最新版本不是deletemarker,且版本是null版本,则这个null版本会被新产生的null版本的deletemarker覆盖;\n\n如果最新版本是deletemarker,且该对象只有这一个版本,则这个版本会被删除;\n\n如果最新版本是deletemarker,且对象还有其他版本,则该对象的所有版本维持不变,没有新增和删除,也不会被修改(即无任何变化)。\n\n如果桶的多版本是Enabled或者Suspended,且最新版本对象满足Transition规则时的处理:\n如果对象的最新版本是deletemarker,则这个版本不被迁移;\n如果最新版本不是deletemarker,且该对象满足迁移条件,则这个版本会被迁移。\n","properties":{"Rule":{"items":{"$ref":"#/definitions/Rule"},"type":"array"}},"required":["Rule"],"xml":{"name":"LifecycleConfiguration"}},"Transition":{"description":"生命周期配置中表示迁移时间和迁移后对象存储级别的元素(仅针对对象的最新版本)\n\n类型:XML","properties":{"Date":{"description":"指定OBS对该日期之前的对象执行生命周期规则。日期格式必须为ISO8601的格式,并且为UTC的零点。\n例如:2018-01-01T00:00:00.000Z,表示将最后修改时间早于2018-01-01T00:00:00.000Z的对象删除或转换成其他存储类型,等于或晚于这个时间的对象不会被删除或转储。\n\n如果没有Days元素,则必选。\n","type":"string"},"Days":{"description":"指定生命周期规则在对象最后更新过后多少天生效(仅针对对象的最新版本)。\n\n如果没有Date元素,则必选。\n","format":"int32","minimum":0,"type":"integer"},"StorageClass":{"description":"表示对象将被修改成存储级别。\n取值范围: WARM或COLD\n","enum":["WARM","COLD"],"type":"string"}}}},"description":null,"group_id":"7d10a01d10854bd59cf6189eebfb9c7d","host":"obs.cn-north-4.myhuaweicloud.com","id":"b7d40580faf246bab3425523313d8746","info_version":"v1","method":"put","name":"SetBucketLifecycle","parameters":{},"paths":{"/":{"put":{"consumes":["application/xml"],"description":"OBS系统支持指定规则来实现定时删除或迁移桶中对象,这就是生命周期配置。典型的应用场景如:\n  周期性上传的日志文件,可能只需要保留一个星期或一个月,到期后要删除它们。\n  某些文档在一段时间内经常访问,但是超过一定时间后就可能不会再访问了。这种文档您可能会先选择归档,然后在一定时间后删除。\n  桶的最低转温和转冷的时间可以配置,取值范围为24~8640。\n\n本接口实现为桶创建或更新生命周期配置信息。\n\n说明:\n对象生命周期到期以后,对象将会永久删除,无法恢复。\n\n要正确执行此操作,需要确保执行者有PutLifecycleConfiguration权限。默认情况下只有桶的所有者可以执行此操作,也可以通过设置桶策略或用户策略授权给其他用户。\n\n生命周期配置实现了定时删除对象和定时迁移对象的功能,所以如果想要阻止用户删除或迁移对象,以下几项操作的权限都应该被禁止:\n\nDeleteObject\nDeleteObjectVersion\nPutLifecycleConfiguration\n如果想要阻止用户管理桶的生命周期配置,应该禁止PutLifecycleConfiguration权限。\n","operationId":"SetBucketLifecycle","parameters":[{"description":"请求消息中可带的签名信息。\n","in":"header","name":"Authorization","required":true,"type":"string"},{"description":"请求发起端的日期和时间,例如:Wed, 27 Jun 2018 13:39:15 +0000。\n默认值:无。\n条件:如果消息头中带了x-obs-date字段,则可以不带该字段,其他情况下必选。\n","in":"header","name":"Date","required":false,"type":"string","x-apiexplorer-format":"date-gmt"},{"description":"按照RFC 1864标准计算出消息体的MD5摘要字符串,即消息体128-bit MD5值经过base64编码后得到的字符串。也支持设置Content-SHA256头域,其值为消息体256-bit SHA256值经过base64编码后得到的字符串,Content-MD5和Content-SHA256二选一。\n示例:n58IG6hfM7vqI4K0vnWpog==\n","in":"header","name":"Content-MD5","required":true,"type":"string"},{"description":"请求的桶名称。\n","in":"query","maxLength":63,"minLength":3,"name":"bucket_name","required":true,"type":"string","x-location-cname":true},{"allowEmptyValue":true,"description":"lifecycle表示请求桶声明周期API。\n","in":"query","maxLength":0,"minLength":0,"name":"lifecycle","required":true,"type":"string"},{"description":"桶的生命周期配置信息。\n","in":"body","name":"SetBucketLifecycleRequestBody","required":true,"schema":{"$ref":"#/definitions/SetBucketLifecycleRequestBody"}}],"produces":["application/xml"],"responses":{"200":{"description":"成功请求响应。\n","headers":{"Connection":{"description":"指明与服务器的连接是长连接还是短连接。\n","type":"string"},"Content-Length":{"description":"响应消息体的字节长度。\n","type":"string"},"Date":{"description":"OBS系统响应的时间。\n","type":"string"},"ETag":{"description":"对象的base64编码的128位MD5摘要。ETag是对象内容的唯一标识,可以通过该值识别对象内容是否有变化。比如上传对象时ETag为A,下载对象时ETag为B,则说明对象内容发生了变化。实际的ETag是对象的哈希值。ETag只反映变化的内容,而不是其元数据。上传的对象或拷贝操作创建的对象,通过MD5加密后都有唯一的ETag。如果通过多段上传对象,则无论加密方法如何,MD5会拆分ETag,此类情况ETag就不是MD5的摘要。\n","type":"string"},"x-obs-id-2":{"description":"帮助定位问题的特殊符号。\n","type":"string"},"x-obs-request-id":{"description":"由OBS创建来唯一确定本次请求的值,可以通过该值来定位问题。\n","type":"string"}}},"400":{"description":"请求失败响应消息。\n","schema":{"$ref":"#/definitions/Error"}}},"summary":"设置桶的生命周期配置","tags":["桶的高级配置"],"x-is-registered":"Y","x-request-examples-1":"PUT /?lifecycle HTTP/1.1\nUser-Agent: curl/7.29.0\nHost: examplebucket.obs.cn-north-4.myhuaweicloud.com\nAccept: */*\nDate: WED, 01 Jul 2015 03:05:34 GMT\nAuthorization: OBS H4IPJX0TQTHTHEBQQCEC:DpSAlmLX/BTdjxU5HOEwflhM0WI=\nContent-MD5: ujCZn5p3fmczNiQQxdsGaQ==\nContent-Length: 919\n\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<LifecycleConfiguration> \n  <Rule> \n    <ID>delete-2-days</ID>  \n    <Prefix>test/</Prefix>  \n    <Status>Enabled</Status>  \n    <Expiration> \n      <Days>70</Days> \n    </Expiration>  \n    <NoncurrentVersionExpiration> \n      <NoncurrentDays>70</NoncurrentDays> \n    </NoncurrentVersionExpiration>\n    <Transition> \n      <Days>30</Days>  \n      <StorageClass>WARM</StorageClass> \n    </Transition>  \n    <Transition> \n      <Days>60</Days>  \n      <StorageClass>COLD</StorageClass> \n    </Transition>  \n    <NoncurrentVersionTransition> \n      <NoncurrentDays>30</NoncurrentDays>  \n      <StorageClass>WARM</StorageClass> \n    </NoncurrentVersionTransition>  \n    <NoncurrentVersionTransition> \n      <NoncurrentDays>60</NoncurrentDays>  \n      <StorageClass>COLD</StorageClass> \n    </NoncurrentVersionTransition> \n    <AbortIncompleteMultipartUpload>\n        <DaysAfterInitiation>10</DaysAfterInitiation>\n    </AbortIncompleteMultipartUpload>\n  </Rule>\n</LifecycleConfiguration>\n","x-request-examples-url-1":"/?lifecycle","x-support-sdk":"N"}}},"product_short":"OBS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"设置桶的生命周期配置","tags":"桶的高级配置","uri":null,"version":"2.0"}