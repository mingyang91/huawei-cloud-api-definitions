{"base_path":"/","components":null,"consumes":"[\"application/xml;charset=UTF-8\"]","definitions":{"Error":{"description":"错误响应消息体\n","properties":{"Code":{"description":"错误响应消息体XML中错误响应对应的HTTP消息返回码,具体的错误码请参见[错误码-表2](https://support.huaweicloud.com/api-obs/obs_04_0115.html#obs_04_0115__d0e843)。\n","type":"string"},"HostId":{"description":"返回该消息的服务端ID。\n","type":"string"},"Message":{"description":"错误响应消息体XML中具体错误更全面、详细的英文解释,具体的错误消息请参见[错误码-表2](https://support.huaweicloud.com/api-obs/obs_04_0115.html#obs_04_0115__d0e843)。\n","type":"string"},"RequestId":{"description":"本次错误请求的请求ID,用于错误定位。\n","type":"string"},"Resource":{"description":"该错误相关的桶或对象资源。\n","type":"string"}}},"FilterObject":{"description":"定义过滤规则的元素,该规则用以匹配对象名前缀和后缀。\n","properties":{"FilterRule":{"items":{"$ref":"#/definitions/FilterRule"},"type":"array"}}},"FilterRule":{"description":"定义过滤规则键值对的元素。\n","properties":{"Name":{"description":"指定规则按对象名前缀或后缀进行过滤。\n","type":"string"},"Value":{"description":"指定的对象名关键字,根据Name元素定义的前缀或后缀,输入需要过滤的对象的关键字信息,字符越长匹配精度越高,最大可支持1024个字符。\n","maxLength":1024,"type":"string"}}},"FunctionStageConfiguration":{"description":"配置函数服务的元素。\n","properties":{"Event":{"description":"需要发布通知消息的事件类型。\n说明:在一个TopicConfiguration、FunctionStageConfiguration配置项中可以添加多个事件类型。\n合法值:\n上传对象操作可以取以下值:\nObjectCreated:Put\nObjectCreated:Post\nObjectCreated:Copy\nObjectCreated:CompleteMultipartUpload\n\n或者使用通配符支持所有上传操作\nObjectCreated:*\n\n删除对象操作可以取以下值:\nObjectRemoved:Delete\nObjectRemoved:DeleteMarkerCreated\n\n或者使用通配符支持所有删除操作\nObjectRemoved:*\n","type":"string"},"Filter":{"description":"Object的元素,用以保存过滤对象名的一组规则。\n","properties":{"Object":{"$ref":"#/definitions/FilterObject"}}},"FunctionStage":{"description":"函数服务中函数的URN,当OBS检测到桶中发生特定的事件后,将会发送消息至函数服务调用执行该函数。\n若添加父元素FunctionStageConfiguration,本元素是必选项。\n","type":"string"},"Id":{"description":"每项事件通知配置的唯一标识,若是用户未指定ID,系统将自动分配一个ID。\n","type":"string"},"Topic":{"description":"事件通知主题的URN,当OBS检测到桶中发生特定的事件后,将会发布通知消息至该主题,可以在[消息通知服务主题](https://console.huaweicloud.com/smn/?region=cn-north-4#/topics/list)部分找到具体值。\n模板:<Topic>urn:smn:region:project_id:smn_topic</Topic>\n","type":"string"}}},"SetBucketNotificationRequestBody":{"description":"配置桶事件通知的根元素,如果子元素为空,说明消息通知功能处于关闭状态。\n","properties":{"FunctionStageConfiguration":{"items":{"$ref":"#/definitions/FunctionStageConfiguration"},"type":"array"},"TopicConfiguration":{"items":{"$ref":"#/definitions/TopicConfiguration"},"type":"array"}},"xml":{"name":"NotificationConfiguration"}},"TopicConfiguration":{"description":"配置事件通知主题的元素。\n","properties":{"Event":{"description":"需要发布通知消息的事件类型。\n说明:在一个TopicConfiguration、FunctionStageConfiguration配置项中可以添加多个事件类型。\n合法值:\n上传对象操作可以取以下值:\nObjectCreated:Put\nObjectCreated:Post\nObjectCreated:Copy\nObjectCreated:CompleteMultipartUpload\n\n或者使用通配符支持所有上传操作\nObjectCreated:*\n\n删除对象操作可以取以下值:\nObjectRemoved:Delete\nObjectRemoved:DeleteMarkerCreated\n\n或者使用通配符支持所有删除操作\nObjectRemoved:*\n","type":"string"},"Filter":{"description":"Object的元素,用以保存过滤对象名的一组规则。\n","properties":{"Object":{"$ref":"#/definitions/FilterObject"}}},"Id":{"description":"每项事件通知配置的唯一标识,若是用户未指定ID,系统将自动分配一个ID。\n","type":"string"},"Topic":{"description":"事件通知主题的URN,当OBS检测到桶中发生特定的事件后,将会发布通知消息至该主题,可以在[消息通知服务主题](https://console.huaweicloud.com/smn/?region=cn-north-4#/topics/list)部分找到具体值。\n模板:<Topic>urn:smn:region:project_id:smn_topic</Topic>\n","type":"string"}}}},"description":null,"group_id":"7d10a01d10854bd59cf6189eebfb9c7d","host":"obs.cn-north-4.myhuaweicloud.com","id":"bed1f61e6ccf479f8bfeb48209a49a57","info_version":"v1","method":"put","name":"SetBucketNotification","parameters":{},"paths":{"/":{"put":{"consumes":["application/xml"],"description":"OBS消息通知功能能够帮助您对桶的重要的操作及时通知到您,确保您安全、及时知道发生在桶上的关键事件。\n\n默认情况下,您的桶没有配置事件通知。这个时候桶的通知配置将是一个空NotificationConfiguration。对已配置有事件通知的桶,可以通过添加空NotificationConfiguration元素禁用消息通知功能。\n\n<NotificationConfiguration>\n</NotificationConfiguration> \n\n目前对象存储服务(OBS)支持包括简单通知服务(SMN)、函数工作流服务(FunctionGraph)在内的两种桶通知服务配置。以SMN为例,当OBS接收到配置消息通知的请求后,会验证指定的消息通知服务(SMN)主题是否存在及主题策略是否授权给了对象存储服务,验证通过后会向该主题订阅者发送一个测试消息通知。\n\n为了能成功执行此配置操作,需要确保执行者拥有PutBucketNotification权限。默认情况下只有桶的所有者拥有该权限,但可以通过设置桶策略授权给其他用户。\n","operationId":"SetBucketNotification","parameters":[{"description":"请求消息中可带的签名信息。\n","in":"header","name":"Authorization","required":true,"type":"string"},{"description":"请求发起端的日期和时间,例如:Wed, 27 Jun 2018 13:39:15 +0000。\n默认值:无。\n条件:如果消息头中带了x-obs-date字段,则可以不带该字段,其他情况下必选。\n","in":"header","name":"Date","required":false,"type":"string","x-apiexplorer-format":"date-gmt"},{"description":"请求的桶名称。\n","in":"query","maxLength":63,"minLength":3,"name":"bucket_name","required":true,"type":"string","x-location-cname":true},{"allowEmptyValue":true,"description":"notification表示请求桶的消息通知配置API。\n","in":"query","maxLength":0,"minLength":0,"name":"notification","required":true,"type":"string"},{"description":"桶事件通知配置信息。\n","in":"body","name":"SetBucketNotificationRequestBody","required":true,"schema":{"$ref":"#/definitions/SetBucketNotificationRequestBody"}}],"produces":["application/xml"],"responses":{"200":{"description":"请求成功响应消息。\n","headers":{"Connection":{"description":"指明与服务器的连接是长连接还是短连接。\n","type":"string"},"Content-Length":{"description":"响应消息体的字节长度。\n","type":"string"},"Date":{"description":"OBS系统响应的时间。\n","type":"string"},"ETag":{"description":"对象的base64编码的128位MD5摘要。ETag是对象内容的唯一标识,可以通过该值识别对象内容是否有变化。比如上传对象时ETag为A,下载对象时ETag为B,则说明对象内容发生了变化。实际的ETag是对象的哈希值。ETag只反映变化的内容,而不是其元数据。上传的对象或拷贝操作创建的对象,通过MD5加密后都有唯一的ETag。如果通过多段上传对象,则无论加密方法如何,MD5会拆分ETag,此类情况ETag就不是MD5的摘要。\n","type":"string"},"x-obs-id-2":{"description":"帮助定位问题的特殊符号。\n","type":"string"},"x-obs-request-id":{"description":"由OBS创建来唯一确定本次请求的值,可以通过该值来定位问题。\n","type":"string"}}},"400":{"description":"请求失败响应消息。\n除了公共的错误码外,此接口还会返回一些其他的错误码。下面列出本接口的一些常见错误,以及可能原因。\n|错误码|描述|HTTP状态码|\n|---|---|---|\n|InvalidArgument|该错误可能是由于下列原因导致。指定了不支持的event。指定的URN不存在或者填写错误,请确认URN合法。指定的URN中的区域与桶所在的区域不一致,请确保桶所在的区域与URN中的区域一致。指定的过滤规则之间存在互相包含或者重叠。|400 Bad Request|\n"},"403":{"description":"请求失败响应消息。\n除了公共的错误码外,此接口还会返回一些其他的错误码。下面列出本接口的一些常见错误,以及可能原因。\n|错误码|描述|HTTP状态码|\n|---|---|---|\n|AccessDenied|执行者不是桶的所有者,或者还未被授权PutBucketNotification权限。|403 Forbidden|\n","schema":{"$ref":"#/definitions/Error"}}},"summary":"设置桶的消息通知配置","tags":["桶的高级配置"],"x-is-registered":"Y","x-request-examples-1":"PUT /?notification HTTP/1.1\nUser-Agent: curl/7.29.0\nHost: examplebucket.obs.cn-north-4.myhuaweicloud.com\nAccept: */*\nDate: WED, 01 Jul 2015 03:15:45 GMT\nAuthorization: OBS H4IPJX0TQTHTHEBQQCEC:uRTt8YTkAqJCUfWfYkveEcIGAC0=\nContent-Length: 538\n\n<NotificationConfiguration> \n  <TopicConfiguration> \n    <Id>ConfigurationId</Id>  \n    <Filter>\n      <Object>\n        <FilterRule>\n          <Name>prefix</Name>\n          <Value>object</Value>\n        </FilterRule>\n        <FilterRule>\n          <Name>suffix</Name>\n          <Value>txt</Value>\n        </FilterRule>\n      </Object> \n    </Filter>  \n    <Topic>urn:smn:cn-east-3:4b29a3cb5bd64581bda5714566814bb7:tet555</Topic>  \n    <Event>ObjectCreated:Put</Event> \n  </TopicConfiguration>\n</NotificationConfiguration>\n","x-request-examples-url-1":"/?notification","x-support-sdk":"Y"}}},"product_short":"OBS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"设置桶的消息通知配置","tags":"桶的高级配置","uri":null,"version":"2.0"}