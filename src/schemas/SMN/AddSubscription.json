{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"AddSubscriptionRequestBody":{"properties":{"endpoint":{"description":"说明:\n\nhttp协议,接入点必须以“http://”开头。\n\nhttps协议,接入点必须以“https://”开头。\n\nemail协议,接入点必须是邮件地址。\n\nsms协议,接入点必须是一个电话号码。\n\nfunctionstage协议,接入点必须是一个函数。\n\nfunctiongraph协议,接入点必须是一个函数工作流。\n\ndms协议,接入点必须是一个消息队列。\n\napplication协议,接入点必须是一个应用平台的设备终端。\n\ncallnotify协议,接入点必须是一个电话号码。\n\ndingding协议,接入点必须是一个钉钉群机器人的地址。\n\nwechat协议,接入点必须是一个微信群机器人的地址。\n\nfeishu协议,接入点必须是一个飞书群机器人的地址。\n\nwelink协议,接入点必须是一个welink的群号。","example":"xxx@xxx.com","type":"string"},"extension":{"$ref":"#/definitions/SubscriptionExtension","description":"扩展信息。"},"protocol":{"description":"不同协议对应不同的endpoint(接受消息的接入点)。\n目前支持的协议包括:\n\n“email”:邮件传输协议,endpoint为邮箱地址。\n\n“sms”:短信传输协议,endpoint为手机号码。\n\n“functionstage”:FunctionGraph(函数)传输协议,endpoint为一个函数。\n\n“functiongraph”:FunctionGraph(工作流)传输协议,endpoint为由一组函数编排成的工作流。\n\n“http”、“https”:HTTP/HTTPS传输协议,endpoint为URL。\n\n“callnotify”:语音通知传输协议,endpoint为手机号码。\n\n“wechat”:微信群机器人传输协议。\n\n“dingding”:钉钉群机器人传输协议。\n\n“feishu”:飞书群机器人传输协议。\n\n“welink”:welink群机器人传输协议。","example":"email","type":"string"},"remark":{"description":"备注。最大支持128字节,约42个中文,必须是UTF-8编码的字符串,否则无法正常显示中文。","example":"运维","type":"string"}},"required":["protocol","endpoint"],"type":"object"},"AddSubscriptionResponseBody":{"properties":{"request_id":{"description":"请求的唯一标识ID。","example":"fdbabe38ead6482b8574f82a3d1168e9","type":"string"},"subscription_urn":{"description":"订阅者的唯一资源标识。","example":"urn:smn:regionId:762bdb3251034f268af0e395c53ea09b:test_topic_v1:2e778e84408e44058e6cbc6d3c377837","type":"string"}},"required":["request_id","subscription_urn"]},"FailedResp":{"properties":{"code":{"description":"服务异常错误信息编码。","example":"SMN.0167","type":"string"},"message":{"description":"服务异常错误信息描述。","example":"xxxxxxxx","type":"string"},"request_id":{"description":"请求的唯一标识ID。","example":"6a63a18b8bab40ffb71ebd9cb80d0085","type":"string"}},"required":["request_id","code","message"]},"SubscriptionExtension":{"properties":{"client_id":{"description":"该字段为welink订阅下的租户ID字段,由租户从welink方获取。当protocol值为welink时,该字段为必填字段。","example":"202209081117015156XXXXX","type":"string"},"client_secret":{"description":"该字段为welink订阅下的租户获取的client secret字段,由租户从welink方获取。当protocol值为welink时,该字段为必填字段。","example":"fa7f59b7-6e72-4734-a136-ecb582XXXXX","type":"string"},"keyword":{"description":"该字段为关键字字段。当protocol协议为feishu时,这里的keyword字段和sign_secret字段二者必选其一。当用户在飞书或钉钉机器人端添加关键字校验的安全策略时,这里的关键字必须是飞书或钉钉端所填写的关键字之一。","example":"XXX","type":"string"},"sign_secret":{"description":"这是加签密钥字段。当protocol协议为feishu或dingding时,这个字段和keyword字段二者必选且只能选其一,密钥配置必须与客户在飞书或钉钉客户端的密钥配置完全一致。例如,如果在飞书端配置了密钥并且没有配置关键字,则在此处填入从飞书获取的密钥字段,如果在飞书端没有配置密钥并且配置了关键字,则不填写该字段。","example":"XXX-XXXX","type":"string"}},"type":"object"}},"description":null,"group_id":"28d7e20abf9b4048b20fdaf3ce746d32","host":"smn.cn-north-4.myhuaweicloud.com","id":"87ac668fa1ee4096b397980b18473fa0","info_version":"v2","method":"post","name":"AddSubscription","parameters":{"X-Auth-Token":{"description":"用户Token。\n\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."}},"paths":{"/v2/{project_id}/notifications/topics/{topic_urn}/subscriptions":{"post":{"consumes":[],"deprecated":false,"description":"为指定Topic添加一个订阅者,如果订阅者的状态为未确认,则向订阅者发送一个确认的消息。待订阅者进行ConfirmSubscription确认后,该订阅者才能收到Topic发布的消息。单Topic默认可添加10000个订阅者,高并发场景下,可能会出现订阅者数量超过10000仍添加成功的情况,此为正常现象。接口是幂等的,如果添加已存在的订阅者,则返回成功,且status code为200,否则status code为201。","operationId":"AddSubscription","parameters":[{"description":"项目ID。\n\n获取项目ID请参考 [获取项目ID](smn_api_66000.xml)。","in":"path","name":"project_id","required":true,"type":"string","x-example":"2c31ed520xxxxxxebedb6e81xxxxxxxx"},{"description":"Topic的唯一的资源标识,可通过[查询主题列表](smn_api_51004.xml)获取该标识。","in":"path","name":"topic_urn","required":true,"type":"string","x-example":"urn:smn:regionId:f96188c7ccaf4ffba0c9aa149ab2bd57:test_topic_v2"},{"$ref":"#/parameters/X-Auth-Token"},{"in":"body","name":"AddSubscriptionRequestBody","schema":{"$ref":"#/definitions/AddSubscriptionRequestBody"}}],"produces":[],"responses":{"201":{"description":"OK","examples":{"application/json":[{"request_id":"6a63a18b8bab40ffb71ebd9cb80d0085","subscription_urn":"urn:smn:regionId:762bdb3251034f268af0e395c53ea09b:test_topic_v1:2e778e84408e44058e6cbc6d3c377837"}]},"schema":{"$ref":"#/definitions/AddSubscriptionResponseBody"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/FailedResp"}},"403":{"description":"Unauthorized","schema":{"$ref":"#/definitions/FailedResp"}},"404":{"description":"Not Found","schema":{"$ref":"#/definitions/FailedResp"}},"500":{"description":"Internal Server Error","schema":{"$ref":"#/definitions/FailedResp"}}},"summary":"订阅","tags":["订阅操作"],"x-apiexplorer-hide":"N","x-iftype":"externalAPI","x-is-registered":"Y","x-name":"订阅","x-open-region-cloud":"hk,hc,otc,ocb,hcso,g42","x-request-examples-1":{"endpoint":"xxx@xxx.com","protocol":"email","remark":"运维"},"x-request-examples-description-1":"在名称为test_topic_v1的主题下添加一个邮件订阅者","x-request-examples-text-1":{"endpoint":"xxx@xxx.com","protocol":"email","remark":"运维"},"x-request-examples-url-1":"POST https://{SMN_Endpoint}/v2/{project_id}/notifications/topics/urn:smn:regionId:762bdb3251034f268af0e395c53ea09b:test_topic_v1/subscriptions","x-support-sdk":"Y"}}},"product_short":"SMN","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"订阅","tags":"订阅操作","uri":null,"version":"2.0"}