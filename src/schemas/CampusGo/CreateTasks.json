{"base_path":"/v2","components":null,"consumes":"","definitions":{"CreateResponseBody":{"properties":{"id":{"description":"创建出的服务作业ID","example":"f98acbxxxxxxxxxxxxxxxxxxxx011462","pattern":"^[0-9a-f]{32}|task\\w{8}$","type":"string"}},"required":["id"],"type":"object"},"CreateTasksRequestBody":{"properties":{"description":{"description":"作业的描述","example":"flowcount task test","maxLength":500,"minLength":0,"type":"string"},"edge_pool_id":{"description":"仅边缘作业需填且必填,作业运行指定的边缘运行池ID","example":"6be5aaxxxxxxxxxxxxxxxxxxxxde56ac","pattern":"^[0-9a-f]{32}|edgestreampool\\w{8}$","type":"string"},"input":{"$ref":"#/definitions/TaskInput"},"name":{"description":"作业的名称","example":"flowcount-task","pattern":"^[\\u4E00-\\u9FA5a-zA-Z0-9_-]{1,100}$","type":"string"},"output":{"$ref":"#/definitions/TaskOutput"},"resource_order_id":{"description":"作业指定的算法能力包包周期订单ID","example":"da64bexxxxxxxxxxxxxxxxxxxxeca64f","pattern":"^[0-9a-f]{32}$","type":"string"},"service_config":{"$ref":"#/definitions/TaskServiceConfig"},"service_version":{"description":"作业对应服务的版本号","example":"1.0","pattern":"^\\d{1,3}\\.\\d{1,3}$","type":"string"}},"required":["name","service_version","input","output"],"type":"object"},"CreateTasksResponseBody":{"items":{"$ref":"#/definitions/CreateResponseBody"},"maxItems":50,"minItems":1,"type":"array"},"ErrorResponseBody":{"properties":{"error_code":{"description":"服务内部错误码","example":"IVA.0004","pattern":"^IVA.\\d{4}$","type":"string"},"error_msg":{"description":"错误信息","example":"The request param is invalid.","maxLength":4096,"minLength":0,"type":"string"}},"required":["error_code","error_msg"],"type":"object"},"TaskInput":{"description":"作业的输入配置","properties":{"data":{"description":"作业的输入详情,针对不同的输入类型有不同的配置。创建时允许填写多路输入,但更新时,obs以外其余的输入类型只允许填写一路输入","items":{"$ref":"#/definitions/TaskInputData"},"maxItems":50,"minItems":1,"type":"array"},"type":{"description":"作业的输入类型,必填。可选类型有obs(对象存储服务存储的文件),vis(视频接入服务的视频流),url(指定的文件地址或取流地址),edgecamera(绑定在IEF的边缘摄像头),edgerestful(从自定义的流媒体服务器通过Restful接口获取取流地址),vcn(VCN设备)。","enum":["obs","vis","url","edgecamera","edgerestful","vcn"],"example":"obs","type":"string"},"vcn":{"$ref":"#/definitions/TaskInputVcn"}},"required":["type","data"],"type":"object"},"TaskInputData":{"description":"输入数据的配置信息","properties":{"bucket":{"description":"OBS桶名,当输入为obs类型是必选","example":"obs-iva","maxLength":63,"pattern":"^[a-z0-9](?!.*[-.][-.].*)([a-z0-9-.]{1,61})[a-z0-9]$","type":"string"},"certificate_check":{"description":"是否需要对https请求进行证书校验,当输入为edgerestful类型时必选","example":false,"type":"boolean"},"device_id":{"description":"VCN设备ID,当输入为vcn类型时必选","example":"46459876132169871364#abb6541c6d546c65ffee16ebaf5ce9ca","pattern":"^([0-9]{20}[#]{1}[a-zA-Z0-9]{32})|([0-9]{20}[#]{1}[0-9]{1,10}[#]{1}[a-zA-Z0-9]{32})$","type":"string"},"headers":{"description":"获取视频流的restful请求携带的请求头,当输入为edgerestful类型时可选","example":{"Content-Type":"application/json"},"maxProperties":10,"minProperties":1,"type":"object"},"id":{"description":"IEF挂载的边缘设备的ID,当输入为edgecamera类型时必选","example":"dd8xxxxx-xxxx-xxxx-xxxx-xxxxxx2f5bcb","format":"uuid","maxLength":63,"pattern":"^[a-zA-Z0-9][a-zA-Z0-9_-]{0,63}$","type":"string"},"index":{"description":"可选,当前输入的序号,从0开始递增,不可重复","maximum":49,"minimum":0,"type":"integer"},"path":{"description":"OBS的路径,当输入为obs类型时必选","example":"/input/test.mp4","maxLength":1023,"pattern":"^(?![/.\\s])(?!.*//.*)([^:*?\"<>|\\\\]{0,1023})(?<![.\\s])$","type":"string"},"rtsp_path_in_response":{"description":"restful请求返回的body中,视频流地址的路径,当输入为edgerestful类型时必选","example":"data/url","maxLength":1024,"pattern":"^([-A-Za-z0-9+&?=~_][-A-Za-z0-9+&/?=~_]+[-A-Za-z0-9+&/?=~_]|[A-Za-z]+)$","type":"string"},"stream_name":{"description":"VIS的视频流名称,当输入为vis类型时必选","example":"stream-test","pattern":"^[-A-Za-z0-9_]{1,80}$","type":"string"},"stream_type":{"description":"准备进行分析的码流,其中1代表主码流,2代表子码流1,3代表子码流2,当输入为vcn类型时可选","example":1,"format":"int32","maximum":3,"minimum":1,"type":"integer"},"url":{"description":"url输入源的地址或者获取视频流地址的restful请求地址,当输入为url或者edgerestful类型时必选","example":"https://livestream.com/live/stream-test","format":"uri","maxLength":1000,"pattern":"^(https?|rtsp|rtmp|ftp|file):\\/\\/[-A-Za-z0-9+&@*#/%?=~_|!:,.;]+[-A-Za-z0-9+&@*#/%=~_|]$","type":"string"}},"type":"object"},"TaskInputVcn":{"description":"VCN服务器信息,只有输入为vcn时才可以且必须使用","properties":{"ip":{"description":"VCN服务器的IP地址","example":"10.10.10.10","format":"ipv4","type":"string"},"password":{"description":"VCN服务器的与账号对应的密码","example":"password@test","format":"password","pattern":"^.{1,1000}$","type":"string"},"port":{"description":"VCN服务器的端口号","example":60,"format":"int32","maximum":65535,"minimum":0,"type":"integer"},"username":{"description":"VCN服务器的账号名","example":"user_test","pattern":"^.{1,100}$","type":"string"}},"required":["ip","port","username","password"],"type":"object"},"TaskOutput":{"description":"作业的输出配置","maxProperties":5,"minProperties":1,"properties":{"dis":{"$ref":"#/definitions/TaskOutputDis"},"localpath":{"$ref":"#/definitions/TaskOutputLocalpath"},"obs":{"$ref":"#/definitions/TaskOutputObs"},"webhook":{"$ref":"#/definitions/TaskOutputWebhook"}},"type":"object"},"TaskOutputDis":{"description":"输出为dis类型时的配置信息","properties":{"data_category":{"description":"作业输出数据类别的列表,当输出类型下有这个列表时,表示希望这个输出类型下存放dataCategory列表内的数据,部分服务需要","example":["FaceImage"],"items":{"type":"string"},"maxItems":10,"minItems":0,"type":"array","uniqueItems":true},"stream_name":{"description":"DIS流名称","example":"dis-test","maxLength":64,"pattern":"^[-A-Za-z0-9_]{1,64}$","type":"string"}},"required":["stream_name"],"type":"object"},"TaskOutputLocalpath":{"description":"输出为localpath类型时的配置信息","properties":{"data_category":{"description":"作业输出数据类别的列表,当输出类型下有这个列表时,表示希望这个输出类型下存放dataCategory列表内的数据,部分服务需要","example":["FaceImage"],"items":{"type":"string"},"maxItems":10,"minItems":0,"type":"array","uniqueItems":true},"mount_source_path":{"description":"挂载的源路径,存放作业运行结果的路径,必须为linux路径","example":"/usr/local/","maxLength":255,"pattern":"^(/[\\w-.]+)+/?$","type":"string"}},"required":["mount_source_path"],"type":"object"},"TaskOutputObs":{"description":"输出为obs类型时的配置信息","properties":{"bucket":{"description":"OBS桶名","example":"obs-iva","maxLength":63,"pattern":"^[a-z0-9](?!.*[-.][-.].*)([a-z0-9-.]{1,61})[a-z0-9]$","type":"string"},"data_category":{"description":"作业输出数据类别的列表,当输出类型下有这个列表时,表示希望这个输出类型下存放dataCategory列表内的数据,部分服务需要","example":["FaceImage"],"items":{"type":"string"},"maxItems":10,"minItems":0,"type":"array","uniqueItems":true},"path":{"description":"OBS的路径","example":"output/","maxLength":1023,"pattern":"^(?![/.\\s])(?!.*//.*)([^:*?\"<>|\\\\]{0,1023})(?<![.\\s])$","type":"string"}},"required":["bucket","path"],"type":"object"},"TaskOutputWebhook":{"description":"输出为webhook类型时的配置信息","properties":{"data_category":{"description":"作业输出数据类别的列表,当输出类型下有这个列表时,表示希望这个输出类型下存放dataCategory列表内的数据,部分服务需要","example":["FaceImage"],"items":{"type":"string"},"maxItems":10,"minItems":0,"type":"array","uniqueItems":true},"headers":{"description":"结果回调时需要携带的请求头","example":{"appId":"10000000","appKey":"24bnaxxxxxxxxxxxxxxxj9sdf"},"maxProperties":10,"minProperties":1,"type":"object"},"url":{"description":"结果回调地址","example":"https://api.huawei.com/v1/tasks","format":"uri","maxLength":1000,"pattern":"^(https?|rtsp|rtmp|ftp|file):\\/\\/[-A-Za-z0-9+&@*#/%?=~_|!:,.;]+[-A-Za-z0-9+&@*#/%=~_|]$","type":"string"}},"required":["url","headers"],"type":"object"},"TaskServiceConfig":{"description":"作业运行时指定的算法配置参数,见园区智能体API参考文档[API参考文档](https://support.huaweicloud.com/api-campusgo/campusgo_03_0013.html)","minProperties":1,"properties":{"common":{"description":"根据不同服务,填写对应的服务配置参数json结构体","example":{"attribute_detection_sw":1,"heatmap_detection_interval":60,"heatmap_detection_sw":0,"heatmap_point_interval":4,"line_count_interval":2,"line_detection_sw":1,"region_count_interval":2,"region_detection_sw":1,"target_roi":null},"type":"object"}},"type":"object"}},"description":null,"group_id":"c2b9a308c3e4442d974904d9ba1a074f","host":"iva.cn-north-4.myhuaweicloud.com","id":"02fd301862aa4d2c8fbfabda10756731","info_version":"v2","method":"post","name":"CreateTasks","parameters":{},"paths":{"/{project_id}/services/{service_name}/tasks":{"post":{"consumes":["application/json"],"description":"该接口用于创建服务作业","operationId":"CreateTasks","parameters":[{"description":"用户项目ID","in":"path","name":"project_id","pattern":"^[a-zA-Z0-9-]{1,64}$","required":true,"type":"string"},{"description":"服务API,具体API名称见园区智能体提供的API参考列表中URI描述[API列表](https://support.huaweicloud.com/api-campusgo/campusgo_03_0013.html)","in":"path","maxLength":100,"minLength":2,"name":"service_name","pattern":"^[a-z][a-z-]{0,98}[a-z]$","required":true,"type":"string"},{"description":"创建服务作业的请求体","in":"body","name":"CreateTasksRequestBody","required":true,"schema":{"$ref":"#/definitions/CreateTasksRequestBody"}}],"produces":["application/json"],"responses":{"201":{"description":"创建服务作业成功","schema":{"$ref":"#/definitions/CreateTasksResponseBody"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/ErrorResponseBody"}}},"summary":"创建服务作业","tags":["服务作业管理"],"x-apiErrorCodes":[],"x-is-registered":"Y","x-request-examples-1":{"description":"flowcount task test","edge_pool_id":"9358ac0425b24a07b3258cffa2f0f0d6","input":{"data":[{"id":"aec5857c-222f-4aa9-be39-23654e118886","index":0}],"type":"edgecamera"},"name":"flowcount-task","output":{"dis":{"stream_name":"dis-flowcount"}},"resource_order_id":"840a5cf90d4a4bbaa71f251dfe8fe64e","service_config":{"common":{"attribute_detection_sw":0,"heatmap_detection_interval":60,"heatmap_detection_sw":0,"heatmap_point_interval":4,"line_count_interval":2,"line_detection_sw":1,"region_count_interval":2,"region_detection_sw":1,"target_roi":"{\"lines\":[{\"data\":[[560,680],[1185,506]],\"properties\":{\"side1_name\":\"Side1\",\"side2_name\":\"Side2\"}}],\"polygons\":[{\"data\":[[0,0],[0,1080],[1920,1080],[1920,0]]}]}"}},"service_version":"3.0"},"x-request-examples-description-1":"人流量作业创建,使用输入源为边缘摄像头,输出为dis","x-request-examples-text-1":{"description":"flowcount task test","edge_pool_id":"9358ac0425b24a07b3258cffa2f0f0d6","input":{"data":[{"id":"aec5857c-222f-4aa9-be39-23654e118886","index":0}],"type":"edgecamera"},"name":"flowcount-task","output":{"dis":{"stream_name":"dis-flowcount"}},"resource_order_id":"840a5cf90d4a4bbaa71f251dfe8fe64e","service_config":{"common":{"attribute_detection_sw":0,"heatmap_detection_interval":60,"heatmap_detection_sw":0,"heatmap_point_interval":4,"line_count_interval":2,"line_detection_sw":1,"region_count_interval":2,"region_detection_sw":1,"target_roi":"{\"lines\":[{\"data\":[[560,680],[1185,506]],\"properties\":{\"side1_name\":\"Side1\",\"side2_name\":\"Side2\"}}],\"polygons\":[{\"data\":[[0,0],[0,1080],[1920,1080],[1920,0]]}]}"}},"service_version":"3.0"},"x-request-examples-url-1":"/v2/{project_id}/services/c-flowcount-edge/tasks","x-support-sdk":"Y"}}},"product_short":"CampusGo","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建服务作业","tags":"服务作业管理","uri":null,"version":"2.0"}