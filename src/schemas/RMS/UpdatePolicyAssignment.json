{"base_path":null,"components":{"parameters":{"AuthToken":{"description":"用户Token。\n获取Token,请参考《统一身份认证服务API参考》的“获取用户Token”章节。请求响应成功后在响应消息头中包含的“X-Subject-Token”的值即为Token值。","in":"header","name":"X-Auth-Token","required":true,"schema":{"type":"string"}},"DomainId":{"description":"帐号ID","in":"path","name":"domain_id","required":true,"schema":{"maxLength":36,"pattern":"[\\w-]+","type":"string"}},"PolicyAssignmentId":{"description":"规则ID","in":"path","name":"policy_assignment_id","required":true,"schema":{"maxLength":36,"pattern":"[\\w-]+","type":"string"}}},"schemas":{"CustomPolicy":{"description":"自定义合规规则","properties":{"auth_type":{"description":"自定义合规规则调用function方式","enum":["agency"],"type":"string"},"auth_value":{"additionalProperties":{"description":"规则参数值。","type":"object"},"description":"method参数值,method为agency时,为{\"agency_name\":rms_fg_agency}, rms_fg_agency为授权RMS调用FunctionGraph接口的委托名称","type":"object"},"function_urn":{"description":"自定义函数的urn","maxLength":1024,"type":"string"}},"required":["function_urn","auth_type"],"type":"object"},"ErrorResp":{"description":"异常错误","properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误消息内容","type":"string"}},"type":"object"},"PolicyAssignment":{"description":"规则","properties":{"created":{"description":"规则创建时间","type":"string"},"created_by":{"description":"规则的创建者","type":"string"},"custom_policy":{"$ref":"#/components/schemas/CustomPolicy"},"description":{"description":"规则描述","type":"string"},"id":{"description":"规则ID","type":"string"},"name":{"description":"规则名字","type":"string"},"parameters":{"additionalProperties":{"$ref":"#/components/schemas/PolicyParameterValue"},"description":"规则参数","type":"object"},"period":{"description":"触发周期值,可选值:One_Hour, Three_Hours, Six_Hours, Twelve_Hours, TwentyFour_Hours","type":"string"},"policy_assignment_type":{"description":"规则类型,包括预定义合规规则(builtin)和用户自定义合规规则(custom)","enum":["builtin","custom"],"type":"string"},"policy_definition_id":{"description":"规则的策略ID","type":"string"},"policy_filter":{"$ref":"#/components/schemas/PolicyFilterDefinition"},"state":{"description":"规则状态","type":"string"},"updated":{"description":"规则更新时间","type":"string"}},"type":"object"},"PolicyAssignmentRequestBody":{"description":"规则请求体","properties":{"custom_policy":{"$ref":"#/components/schemas/CustomPolicy"},"description":{"description":"规则描述","maxLength":512,"type":"string"},"name":{"description":"规则名字","maxLength":64,"pattern":"[^']+","type":"string"},"parameters":{"additionalProperties":{"$ref":"#/components/schemas/PolicyParameterValue"},"description":"规则参数","maxProperties":10,"minProperties":0,"type":"object"},"period":{"description":"触发周期值,可选值:One_Hour, Three_Hours, Six_Hours, Twelve_Hours, TwentyFour_Hours","enum":["One_Hour","Three_Hours","Six_Hours","Twelve_Hours","TwentyFour_Hours"],"type":"string"},"policy_assignment_type":{"description":"规则类型,包括预定义合规规则(builtin)和用户自定义合规规则(custom)","enum":["builtin","custom"],"type":"string"},"policy_definition_id":{"description":"策略定义ID","maxLength":36,"pattern":"[\\w-]+","type":"string"},"policy_filter":{"$ref":"#/components/schemas/PolicyFilterDefinition"}},"required":["name"],"type":"object"},"PolicyFilterDefinition":{"description":"规则过滤器","properties":{"region_id":{"description":"区域ID","maxLength":128,"type":"string"},"resource_id":{"description":"资源ID","maxLength":512,"type":"string"},"resource_provider":{"description":"云服务名称","maxLength":128,"type":"string"},"resource_type":{"description":"资源类型","maxLength":128,"type":"string"},"tag_key":{"description":"标签键","maxLength":128,"type":"string"},"tag_value":{"description":"标签值","maxLength":256,"type":"string"}},"type":"object"},"PolicyParameterValue":{"description":"规则参数值","properties":{"value":{"description":"规则参数值","type":"object"}},"type":"object"}}},"consumes":"","definitions":null,"description":null,"group_id":"71684d03de7545d7bdc1ae5caf95614f","host":"rms.myhuaweicloud.com","id":"c9c7e176590d4530a2ebbfdbc7e4a05a","info_version":"v1","method":"put","name":"UpdatePolicyAssignment","parameters":null,"paths":{"/v1/resource-manager/domains/{domain_id}/policy-assignments/{policy_assignment_id}":{"put":{"description":"更新用户的合规规则","operationId":"UpdatePolicyAssignment","parameters":[{"$ref":"#/components/parameters/AuthToken"},{"$ref":"#/components/parameters/DomainId"},{"$ref":"#/components/parameters/PolicyAssignmentId"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PolicyAssignmentRequestBody"}}},"description":"合规规则对象"},"responses":{"200":{"content":{"application/json":{"example":{"created":"2020-11-20T07:03:00","description":"云硬盘未挂载给任何云服务器,视为“不合规”","id":"5fb76a240f2daf0b9662a04d","name":"volume-inuse-check","parameters":{},"policy_definition_id":"5fa36558aa1e6afc05a3d0a7","policy_filter":{"region_id":null,"resource_id":null,"resource_provider":"evs","resource_type":"volumes","tag_key":null,"tag_value":null},"state":"Enabled","updated":"2020-11-20T07:03:00"},"schema":{"$ref":"#/components/schemas/PolicyAssignment"}}},"description":"操作成功"},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"输入参数不合法"},"403":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"用户认证失败或没有操作权限"},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"合规规则未找到"},"500":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"服务器内部错误"}},"security":[{"PkiTokenAuth":[]}],"summary":"更新合规规则","tags":["Policy"],"x-is-registered":"Y","x-publishpath":"rms_04_0505","x-request-examples-1":{"description":"The ECS resource is non-compliant if the image it used is not in the allowed list","name":"allowed-images-by-id","parameters":{"listOfAllowedImages":{"value":["ea0d6e0e-99c3-406d-a873-3bb45462b624"]}},"policy_definition_id":"5f3c8b9a9811a13739a32ed9","policy_filter":{"resource_provider":"ecs","resource_type":"cloudservers"}},"x-request-examples-description-1":"","x-request-examples-url-1":"PUT https://{endpoint}/v1/resource-manager/domains/{domain_id}/policy-assignments/{policy_assignment_id}","x-support-sdk":"Y"}}},"product_short":"RMS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"更新合规规则","tags":"合规性","uri":null,"version":"3.0.0"}