{"base_path":null,"components":{"parameters":{"AuthToken":{"description":"用户Token。\n获取Token,请参考《统一身份认证服务API参考》的“获取用户Token”章节。请求响应成功后在响应消息头中包含的“X-Subject-Token”的值即为Token值。","in":"header","name":"X-Auth-Token","required":true,"schema":{"type":"string"}}},"schemas":{"ErrorResp":{"description":"异常错误","properties":{"error_code":{"description":"错误码","type":"string"},"error_msg":{"description":"错误消息内容","type":"string"}},"type":"object"},"PageInfo":{"description":"分页对象","properties":{"current_count":{"description":"当前页的资源数量","format":"int32","maximum":200,"minimum":0,"type":"integer"},"next_marker":{"description":"下一页的marker","type":"string"}},"type":"object"},"PolicyDefinition":{"description":"策略定义","properties":{"description":{"description":"策略描述","type":"string"},"id":{"description":"策略id","type":"string"},"keywords":{"description":"关键词列表","items":{"description":"关键字","type":"string"},"type":"array"},"name":{"description":"策略名字","type":"string"},"parameters":{"additionalProperties":{"$ref":"#/components/schemas/PolicyParameterDefinition"},"description":"策略参数","type":"object"},"policy_rule":{"description":"策略规则","type":"object"},"policy_rule_type":{"description":"策略语法类型","type":"string"},"policy_type":{"description":"策略类型","type":"string"},"trigger_type":{"description":"触发器类型,可选值:resource, period","type":"string"}},"type":"object"},"PolicyDefinitionListResult":{"description":"策略定义集合返回","properties":{"page_info":{"$ref":"#/components/schemas/PageInfo"},"value":{"description":"策略定义列表","items":{"$ref":"#/components/schemas/PolicyDefinition"},"type":"array"}},"type":"object"},"PolicyParameterDefinition":{"description":"策略参数定义","properties":{"allowed_values":{"description":"策略参数允许值列表","items":{"description":"策略参数允许值","type":"object"},"type":"array"},"default_value":{"description":"策略参数默认值","type":"string"},"description":{"description":"策略参数描述","type":"string"},"name":{"description":"策略参数名字","type":"string"},"type":{"description":"策略参数类型","enum":["Array","Boolean","Integer","Float","String","DateTime"],"type":"string"}},"type":"object"}}},"consumes":"","definitions":null,"description":null,"group_id":"71684d03de7545d7bdc1ae5caf95614f","host":"rms.myhuaweicloud.com","id":"be9d732c36cc4c639badb7bdb0ddd3f3","info_version":"v1","method":"get","name":"ListBuiltInPolicyDefinitions","parameters":null,"paths":{"/v1/resource-manager/policy-definitions":{"get":{"description":"列出用户的内置策略","operationId":"ListBuiltInPolicyDefinitions","parameters":[{"$ref":"#/components/parameters/AuthToken"},{"description":"选择接口返回的信息的语言,默认为\"zh-cn\"中文","in":"header","name":"X-Language","required":false,"schema":{"default":"zh-cn","type":"string"}}],"responses":{"200":{"content":{"application/json":{"example":{"page_info":{"current_count":9,"next_marker":null},"value":[{"description":"已挂载的云硬盘未进行加密,视为“不合规”","id":"5fa365476eed194ccb2c04d1","keywords":["evs","ecs"],"name":"volumes-encrypted-check","parameters":{},"policy_rule":{"allOf":[{"comparator":"equals","pattern":"evs","value":"${resource().provider}"},{"comparator":"equals","pattern":"volumes","value":"${resource().type}"},{"comparator":"equals","pattern":"in-use","value":"${resource().properties.status}"},{"anyOf":[{"comparator":"notContainsKey","pattern":"systemEncrypted","value":"${resource().properties.metadata}"},{"comparator":"equals","pattern":"0","value":"${resource().properties.metadata.systemEncrypted}"}]}]},"policy_rule_type":"dsl","policy_type":"builtin"},{"description":"指定一个标签,不具有此标签的资源,视为“不合规”","id":"5fa9f89b6eed194ccb2c04db","keywords":["tag"],"name":"required-tag-check","parameters":{"specifiedTagKey":{"allowed_values":null,"default_value":null,"description":"the specified tag key","name":null,"type":"String"},"specifiedTagValue":{"allowed_values":null,"default_value":null,"description":"The list of allowed tag value, permit all if empty","name":null,"type":"Array"}},"policy_rule":{"anyOf":[{"comparator":"equals","pattern":false,"value":"${contains(resource().tags, parameters('specifiedTagKey'))}"},{"allOf":[{"comparator":"greater","pattern":0,"value":"${length(parameters('specifiedTagValue'))}"},{"comparator":"notIn","pattern":"${parameters('specifiedTagValue')}","value":"${getValue(resource().tags, parameters('specifiedTagKey'))}"}]}]},"policy_rule_type":"dsl","policy_type":"builtin"},{"description":"指定允许的云硬盘类型列表,云硬盘的类型不在指定的范围内,视为“不合规”","id":"5fa265c0aa1e6afc05a0ff07","keywords":["ecs","ims"],"name":"allowed-images-by-id","parameters":{"listOfAllowedImages":{"allowed_values":null,"default_value":null,"description":"The list of allowed image IDs","name":null,"type":"Array"}},"policy_rule":{"allOf":[{"comparator":"equals","pattern":"ecs","value":"${resource().provider}"},{"comparator":"equals","pattern":"cloudservers","value":"${resource().type}"},{"comparator":"notIn","pattern":"${parameters('listOfAllowedImages')}","value":"${resource().properties.metadata.meteringImageId}"}]},"policy_rule_type":"dsl","policy_type":"builtin"},{"description":"云硬盘未挂载给任何云服务器,视为“不合规”","id":"5fa36558aa1e6afc05a3d0a7","keywords":["evs"],"name":"volume-inuse-check","parameters":{},"policy_rule":{"allOf":[{"comparator":"equals","pattern":"evs","value":"${resource().provider}"},{"comparator":"equals","pattern":"volumes","value":"${resource().type}"},{"comparator":"equals","pattern":"available","value":"${resource().properties.status}"}]},"policy_rule_type":"dsl","policy_type":"builtin"},{"description":"指定允许的规格列表,云硬盘的规格不在指定的范围内,视为“不合规”","id":"5fa3a1196eed194ccb2c04d7","keywords":["evs"],"name":"allowed_volume_specs","parameters":{"listOfAllowedSpecs":{"allowed_values":null,"default_value":null,"description":"The list of allowed disk specifications","name":null,"type":"Array"}},"policy_rule":{"allOf":[{"comparator":"equals","pattern":"evs","value":"${resource().provider}"},{"comparator":"equals","pattern":"volumes","value":"${resource().type}"},{"comparator":"notIn","pattern":"${parameters('listOfAllowedSpecs')}","value":"${resource().properties.volumeType}"}]},"policy_rule_type":"dsl","policy_type":"builtin"},{"description":"ECS资源的规格不在指定的范围内,视为“不合规”","id":"5f8d549bffeecc14f1fb522a","keywords":["ecs"],"name":"allowed_ecs_flavors","parameters":{"listOfAllowedFlavors":{"allowed_values":null,"default_value":null,"description":"The list of allowed flavor types","name":null,"type":"Array"}},"policy_rule":{"allOf":[{"comparator":"equals","pattern":"ecs","value":"${resource().provider}"},{"comparator":"equals","pattern":"cloudservers","value":"${resource().type}"},{"comparator":"notIn","pattern":"${parameters('listOfAllowedFlavors')}","value":"${resource().properties.flavor.name}"}]},"policy_rule_type":"dsl","policy_type":"builtin"},{"description":"弹性公网IP未进行任何绑定,视为“不合规”","id":"5fa3a1196eed194ccb2c04d5","keywords":["vpc"],"name":"eip-unbound-check","parameters":{},"policy_rule":{"allOf":[{"comparator":"equals","pattern":"vpc","value":"${resource().provider}"},{"comparator":"equals","pattern":"publicips","value":"${resource().type}"},{"comparator":"equals","pattern":"DOWN","value":"${resource().properties.status}"}]},"policy_rule_type":"dsl","policy_type":"builtin"},{"description":"ECS资源具有公网IP,视为“不合规”","id":"5f8d5428ffeecc14f1fb5205","keywords":["ecs"],"name":"ecs-instance-no-public-ip","parameters":{},"policy_rule":{"allOf":[{"comparator":"equals","pattern":"ecs","value":"${resource().provider}"},{"comparator":"equals","pattern":"cloudservers","value":"${resource().type}"},{"comparator":"greater","pattern":0,"value":"${length(filter(resource().properties.addresses, lambda x: equals(x.OsExtIpsType, 'floating')))}"}]},"policy_rule_type":"dsl","policy_type":"builtin"},{"description":"指定虚拟私有云ID,不属于此VPC的ECS资源,视为“不合规”","id":"5fa265c0aa1e6afc05a0ff10","keywords":["ecs","vpc"],"name":"ecs-instance-in-vpc","parameters":{"vpcId":{"allowed_values":null,"default_value":null,"description":"VPC ID that contains the ECS instance","name":null,"type":"String"}},"policy_rule":{"allOf":[{"comparator":"equals","pattern":"ecs","value":"${resource().provider}"},{"comparator":"equals","pattern":"cloudservers","value":"${resource().type}"},{"comparator":"notEquals","pattern":"${parameters('vpcId')}","value":"${resource().properties.metadata.vpcId}"}]},"policy_rule_type":"dsl","policy_type":"builtin"}]},"schema":{"$ref":"#/components/schemas/PolicyDefinitionListResult"}}},"description":"操作成功"},"400":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"参数不合法"},"403":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"用户认证失败,或没有操作权限"},"404":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"资源未找到"},"500":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResp"}}},"description":"服务器内部错误"}},"security":[{"PkiTokenAuth":[]}],"summary":"列出内置策略","tags":["Policy"],"x-is-registered":"Y","x-publishpath":"rms_04_0501","x-support-sdk":"Y"}}},"product_short":"RMS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"列出内置策略","tags":"合规性","uri":null,"version":"3.0.0"}