{"base_path":"/","components":null,"consumes":"[\"application/json\"]","definitions":{"ErrorResponse":{"properties":{"error_code":{"description":"错误码。","example":"DBS.200001","type":"string"},"error_msg":{"description":"错误消息。","example":"参数错误。","type":"string"}},"required":["error_code","error_msg"]},"ListLtsSlowLogsRequestBody":{"properties":{"collection_keywords":{"description":"根据多个数据库表名关键字模糊搜索日志,表示匹配至少一个关键字。\n- 最多支持10个关键字。\n- 每个关键字最大长度不超过128个字符。","items":{"type":"string"},"type":"array"},"database_keywords":{"description":"根据多个数据库表名关键字模糊搜索日志,表示匹配至少一个关键字。\n- 最多支持10个关键字。\n- 每个关键字最大长度不超过64个字符。","items":{"type":"string"},"type":"array"},"end_time":{"description":"结束时间,格式为“yyyy-mm-ddThh:mm:ssZ”。\n其中,T指某个时间的开始;Z指时区偏移量,例如北京时间偏移显示为+0800。注:结束时间不能晚于当前时间。","type":"string"},"keywords":{"description":"根据多个关键字搜索日志全文,表示同时匹配所有关键字。\n- 最多支持10个关键字。\n- 每个关键字最大长度不超过512个字符。","items":{"type":"string"},"type":"array"},"limit":{"description":"表示每次查询的日志条数,最大限制100条。","type":"integer"},"line_num":{"description":"日志单行序列号,第一次查询时不需要此参数,下一次查询时需要使用,可从上一次查询的返回信息中获取。\n说明:当次查询从line_num的下一条日志开始查询,不包含当前line_num日志。","type":"string"},"max_cost_time":{"description":"支持根据最大执行时间范围查找日志。单位:ms","type":"integer"},"min_cost_time":{"description":"支持根据最小执行时间范围查找日志。单位:ms","type":"integer"},"node_id":{"description":"节点ID,取空值,表示查询实例下所有允许查询的节点。\n使用请参考《DDS API参考》的“查询实例列表和详情”响应消息表“nodes 数据结构说明”的“id”。允许查询的节点如下:\n- 集群实例下面的 shard节点\n- 副本集、单节点实例下面的所有节点","type":"string"},"operate_type":{"description":"语句类型,取空值,表示查询所有语句类型。","enum":["insert","query","update","remove","getmore","command","killcursors"],"type":"string"},"start_time":{"description":"开始时间,格式为“yyyy-mm-ddThh:mm:ssZ”。\n其中,T指某个时间的开始;Z指时区偏移量,例如北京时间偏移显示为+0800。注:开始时间不得早于当前时间30天。","type":"string"}},"required":["start_time","end_time","limit"]},"ListLtsSlowLogsResponseBody":{"properties":{"slow_logs":{"description":"慢日志具体信息。","items":{"$ref":"#/definitions/SlowLogDetail"},"type":"array"}},"required":["slow_logs"]},"SlowLogDetail":{"properties":{"collection":{"description":"日志所属的数据库表名。","example":"testDb","type":"string"},"cost_time":{"description":"执行时间。单位:ms","example":60,"type":"integer"},"database":{"description":"日志所属的数据库库名。","example":"geography","type":"string"},"docs_returned":{"description":"返回的文档数。","example":0,"type":"integer"},"docs_scanned":{"description":"扫描的文档数。","example":0,"type":"integer"},"line_num":{"description":"日志单行序列号","example":"1595659490239433658","type":"string"},"lock_time":{"description":"等待锁时间。单位:us","example":10,"type":"integer"},"log_time":{"description":"日志产生时间,UTC时间。\n格式为“yyyy-mm-ddThh:mm:ssZ”。 其中,T指某个时间的开始;Z指时区偏移量,例如北京时间偏移显示为+0800。","example":"2020-11-15T22:49:38.643000Z","type":"string"},"node_id":{"description":"节点ID。","example":"dbd0b65ed0c34125a0b04d4e5ba67e66no02","type":"string"},"node_name":{"description":"节点名称。","example":"Test_replica_node_2","type":"string"},"operate_type":{"description":"语句类型。","example":"query","type":"string"},"whole_message":{"description":"执行语句。","example":"testDb","type":"string"}},"required":["node_name","node_id","whole_message","operate_type","cost_time","lock_time","docs_returned","docs_scanned","database","collection","log_time","line_num"]}},"description":null,"group_id":"a2654930c2d440c78366c9c164a23e86","host":"dds.cn-north-4.myhuaweicloud.com","id":"89f8c7ad73634e74bfeec942d65721d8","info_version":"v3","method":"post","name":"ListLtsSlowLogs","parameters":{},"paths":{"/v3.1/{project_id}/instances/{instance_id}/slow-logs":{"post":{"description":"查询数据库慢日志信息。","operationId":"ListLtsSlowLogs","parameters":[{"description":"用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"******"},{"description":"租户在某一region下的project ID。","in":"path","name":"project_id","required":true,"type":"string","x-example":"619d3e78f61b4be68bc5aa0b59edcf7b"},{"description":"实例ID,可以调用“查询实例列表和详情”接口获取。如果未申请实例,可以调用“创建实例”接口创建。","in":"path","name":"instance_id","required":true,"type":"string","x-example":"91f020b75c1c4bdd8d83933033ff9308in02"},{"description":"请求体。","in":"body","name":"ListLtsSlowLogsRequestBody:","required":true,"schema":{"$ref":"#/definitions/ListLtsSlowLogsRequestBody"}}],"responses":{"200":{"description":"Success.","examples":{"application/json":{"slow_logs":[{"collection":"testCollection","cost_time":60,"database":"testDb","docs_returned":0,"docs_scanned":0,"line_num":"1595659490239433659","lock_time":10,"log_time":"2022-09-15T22:49:38.643000Z","node_id":"dbd0b65ed0c34125a0b04d4e5ba67e66no02","node_name":"Test_replica_node_2","operate_type":"query","whole_message":"{\"responseLength\": 230, \"ts\": {\"$date\": 1605480486800}, \"ninserted\": 1, \"locks\": {\"oplog\": {\"acquireCount\": {\"w\": 1}}, \"Global\": {\"acquireCount\": {\"r\": 3, \"w\": 2}}, \"Collection\": {\"acquireCount\": {\"w\": 2}}, \"Database\": {\"acquireCount\": {\"w\": 3}}}, \"numYield\": 0, \"ns\": \"geographySpace.tiles\"}"}]}},"schema":{"$ref":"#/definitions/ListLtsSlowLogsResponseBody"}},"default":{"description":"Client or server error.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"summary":"查询数据库慢日志","tags":["获取日志信息"],"x-constraint":"- 在入参start_time和end_time的时间段内。\n- 当次查询的日志起始行号line_num须从上一次查询的日志返回信息中获取,第一次查询可不传。\n- 每页查询最大限制100条。\n- 慢日志最多保存30天。","x-is-registered":"N","x-request-examples-1":{"collection_keywords":["testCollection"],"database_keywords":["testDB"],"end_time":"2022-09-16T10:41:14+0800","keywords":["log","test"],"limit":100,"line_num":"1595659490239433658","max_cost_time":100,"min_cost_time":50,"node_id":"dbd0b65ed0c34125a0b04d4e5ba67e66no02","operate_type":"query","start_time":"2022-09-06T10:41:14+0800"},"x-request-examples-description-1":"","x-request-examples-url-1":"POST https://{endpoint}/v3.1/0483b6b16e954cb88930a360d2c4e663/instances/6ade8143870047b8999aba8f1891b48ein02/slow-logs","x-support-sdk":"Y"}}},"product_short":"DDS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"查询数据库慢日志","tags":"获取日志信息","uri":null,"version":"2.0"}