{"base_path":null,"components":null,"consumes":"","definitions":{"BusinessTopoRequest":{"description":"获取应用拓扑数据的请求参数。","properties":{"direction":{"description":"方向,可为空。","type":"string"},"end_time":{"description":"结束时间。","type":"string"},"env_tag_list":{"description":"环境标签列表,可为空。","items":{"format":"int64","type":"integer"},"type":"array"},"filter_user":{"description":"过滤。","type":"boolean"},"start_time":{"description":"开始时间。","type":"string"},"target_business_id":{"description":"目标应用id。","format":"int64","type":"integer"}},"required":["target_business_id","end_time","start_time"],"type":"object"},"CollectorConfigModel":{"description":"采集器配置。","properties":{"detail_view_config":{"$ref":"#/definitions/DetailViewConfigModel","description":"详情视图配置。"},"line_view_config":{"$ref":"#/definitions/LineViewConfigModel","description":"指向线视图配置。"}},"type":"object"},"DetailViewConfigModel":{"description":"详情视图配置。","properties":{"detail_view_item_list":{"description":"视图函数集合。","items":{"$ref":"#/definitions/DetailViewItem"},"type":"array"},"filter_prefix":{"description":"过滤参数。","type":"string"},"metric_set":{"description":"视图对应的指标集的名称。","type":"string"}},"type":"object"},"DetailViewItem":{"description":"节点详情视图函数信息。","properties":{"as":{"description":"作为。","type":"string"},"function":{"description":"表达式。","type":"string"}},"type":"object"},"LineViewConfigModel":{"description":"指向线视图配置。","properties":{"filter_prefix":{"description":"过滤参数。","type":"string"},"line_view_item_list":{"description":"视图函数集合。","items":{"$ref":"#/definitions/LineViewItem"},"type":"array"},"metric_set":{"description":"视图对应的指标集的名称。","type":"string"}},"type":"object"},"LineViewItem":{"description":"连接线视图函数详情。","properties":{"as":{"description":"作为。","type":"string"},"function":{"description":"表达式。","type":"string"}},"type":"object"},"TopoLine":{"description":"组件之间调用指向线。","properties":{"collector":{"description":"采集器名称。","type":"string"},"direction":{"description":"指向。","type":"string"},"filter_value":{"description":"过滤值。","type":"string"},"from_node":{"description":"开始节点。","type":"string"},"hints":{"additionalProperties":{"type":"string"},"description":"线条上的提示信息。","type":"object"},"target_env_id":{"description":"环境id。","format":"int64","type":"integer"},"to_node":{"description":"结束节点。","type":"string"}},"type":"object"},"TopoNode":{"description":"组件节点。","properties":{"env_id":{"description":"环境id。","format":"int64","type":"integer"},"node_id":{"description":"节点id。","type":"string"},"node_name":{"description":"节点名称。","type":"string"},"node_type":{"description":"节点类型。","type":"string"}},"type":"object"},"TopoResult":{"description":"拓扑图返回结果。","properties":{"collector_config":{"additionalProperties":{"$ref":"#/definitions/CollectorConfigModel"},"description":"采集器配置。","type":"object"},"line_list":{"description":"组件之间调用指向线列表。","items":{"$ref":"#/definitions/TopoLine"},"type":"array"},"node_list":{"description":"组件节点列表。","items":{"$ref":"#/definitions/TopoNode"},"type":"array"},"real_end_time":{"description":"结束时间。","format":"int64","type":"integer"},"real_start_time":{"description":"开始时间。","format":"int64","type":"integer"}},"type":"object"}},"description":null,"group_id":"948fcecbff6f450fbe29bcc3e90c3eca","host":"apm2.cn-north-4.myhuaweicloud.com","id":"7575397c0f9342ccb76e97e0dbcf6e16","info_version":"v1","method":"post","name":"SearchBusinessTopology","parameters":{},"paths":{"/v1/apm2/openapi/topology/business-search":{"post":{"description":"查询应用级别全局拓扑图信息。","operationId":"SearchBusinessTopology","parameters":[{"description":"从IAM服务获取的用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"},{"description":"应用id。","format":"int64","in":"header","name":"x-business-id","required":true,"type":"integer"},{"description":"获取应用拓扑数据的请求参数。","in":"body","name":"businessTopoRequest","required":true,"schema":{"$ref":"#/definitions/BusinessTopoRequest"}}],"produces":["application/json"],"responses":{"200":{"description":"OK,请求响应成功。","examples":{"application/json":{"collector_config":{"Mysql":{"detail_view_config":{"detail_view_item_list":[{"as":"count","function":"SUM(invokeCount)"},{"as":"rt","function":"SUM(totalTime)/SUM(invokeCount)"},{"as":"errorCount","function":"SUM(errorCount)"}],"group_by":"db","metric_set":"connection"},"line_view_config":{"filter_prefix":null,"line_view_item_list":[{"as":"count","function":"SUM(invokeCount)"},{"as":"rt","function":"SUM(totalTime)/SUM(invokeCount)"},{"as":"errorCount","function":"SUM(errorCount)"}],"metric_set":"total"}},"Url":{"detail_view_config":null,"line_view_config":{"filter_prefix":"clusterId=","line_view_item_list":[{"as":"count","function":"SUM(invokeCount)"},{"as":"rt","function":"SUM(totalTime)/SUM(invokeCount)"},{"as":"errorCount","function":"SUM(errorCount)"}],"metric_set":"user"}}},"line_list":[{"collector":"Url","direction":"in","filter_value":"user","from_node":"user","hints":{"count":"272","error":"0","rt":"0.09"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"47","from_node":"47","hints":{"count":"780","error":"0","rt":"10.28"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"4394","from_node":"4394","hints":{"count":"694","error":"0","rt":"29.49"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"46","from_node":"46","hints":{"count":"843","error":"0","rt":"10.41"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"4397","from_node":"4397","hints":{"count":"175","error":"0","rt":"41.54"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"48","from_node":"48","hints":{"count":"47","error":"0","rt":"39.47"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"4396","from_node":"4396","hints":{"count":"167","error":"0","rt":"36.15"},"target_env_id":51,"to_node":"51"},{"collector":"Mysql","direction":"out","filter_value":"Mysql","from_node":"51","hints":{"count":"97402","error":"14","rt":"1.12"},"target_env_id":51,"to_node":"Mysql"},{"collector":"Url","direction":"in","filter_value":"1104","from_node":"1104","hints":{"count":"156","error":"0","rt":"0.98"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"913","from_node":"913","hints":{"count":"686","error":"0","rt":"64.91"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"3568","from_node":"3568","hints":{"count":"563","error":"0","rt":"30.67"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"54","from_node":"54","hints":{"count":"682","error":"0","rt":"1.86"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"43","from_node":"43","hints":{"count":"409","error":"0","rt":"1.03"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"42","from_node":"42","hints":{"count":"401","error":"0","rt":"1.26"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"53","from_node":"53","hints":{"count":"1035","error":"0","rt":"3.78"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"45","from_node":"45","hints":{"count":"48","error":"0","rt":"31.25"},"target_env_id":51,"to_node":"51"},{"collector":"Url","direction":"in","filter_value":"55","from_node":"55","hints":{"count":"94","error":"0","rt":"1.13"},"target_env_id":51,"to_node":"51"}],"node_list":[{"env_id":55,"node_id":"55","node_name":"apm-task:cn-east-204","node_type":"Env"},{"env_id":45,"node_id":"45","node_name":"apm-api:cn-east-204-az2","node_type":"Env"},{"env_id":4394,"node_id":"4394","node_name":"apm-archive:cn-east-204","node_type":"Env"},{"env_id":46,"node_id":"46","node_name":"apm-store:cn-east-204-az1","node_type":"Env"},{"env_id":47,"node_id":"47","node_name":"apm-store:cn-east-204-az2","node_type":"Env"},{"env_id":48,"node_id":"48","node_name":"apm-api:cn-east-204-az1","node_type":"Env"},{"env_id":4396,"node_id":"4396","node_name":"apm-pu-task:cn-east-204-az1","node_type":"Env"},{"env_id":4397,"node_id":"4397","node_name":"apm-pu-task:cn-east-204-az2","node_type":"Env"},{"env_id":1104,"node_id":"1104","node_name":"apm-deliver:cn-east-204","node_type":"Env"},{"env_id":3568,"node_id":"3568","node_name":"apm-merge:cn-east-204","node_type":"Env"},{"env_id":null,"node_id":"Mysql","node_name":"Mysql","node_type":"Mysql"},{"env_id":913,"node_id":"913","node_name":"apm-alarm:cn-east-204","node_type":"Env"},{"env_id":51,"node_id":"51","node_name":"config-web:cn-east-204","node_type":"Env"},{"env_id":null,"node_id":"user","node_name":"user","node_type":"Env"},{"env_id":42,"node_id":"42","node_name":"apm-access:cn-east-204-AZ1","node_type":"Env"},{"env_id":53,"node_id":"53","node_name":"apm-master:cn-east-204","node_type":"Env"},{"env_id":54,"node_id":"54","node_name":"apm-front:cn-east-204","node_type":"Env"},{"env_id":43,"node_id":"43","node_name":"apm-access:cn-east-204-AZ2","node_type":"Env"}],"real_end_time":1667466896000,"real_start_time":1667465696000}},"schema":{"$ref":"#/definitions/TopoResult"}},"401":{"description":"Unauthorized,没有权限。","schema":{"type":"string"}},"403":{"description":"Forbidden,禁止访问。","schema":{"type":"string"}},"404":{"description":"Not Found,没有找到要请求的资源。","schema":{"type":"string"}}},"summary":"查询应用全局拓扑图","tags":["TOPOLOGY"],"x-hybridcloud":true,"x-is-registered":"Y","x-request-examples-1":{"direction":"","end_time":1667463725000,"env_tag_list":[],"filter_user":true,"start_time":1667462525000,"target_business_id":6},"x-request-examples-description-1":"入参为开始结束时间,应用id。","x-request-examples-text-1":{"direction":"","end_time":1667463725000,"env_tag_list":[],"filter_user":true,"start_time":1667462525000,"target_business_id":6},"x-request-examples-url-1":"/v1/apm2/openapi/topology/business-search","x-support-sdk":"Y"}}},"product_short":"APM","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":{"apig-auth-app":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-type":"AppSigv1"},"apig-auth-app-optional":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-opt":{"access-auth-type":"optional"},"x-apigateway-auth-type":"AppSigv1"},"apig-auth-iam":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM"},"apig-auth-iam-none":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM_NONE"}},"summary":"查询应用全局拓扑图","tags":"TOPOLOGY","uri":null,"version":"2.0"}