{"base_path":null,"components":null,"consumes":"","definitions":{"ClientSpanInfo":{"description":"span信息。","properties":{"app_id":{"description":"组件id。","format":"int64","type":"integer"},"biz_code":{"description":"业务状态码的采集。","type":"string"},"biz_id":{"description":"应用id。","format":"int64","type":"integer"},"class_name":{"description":"类名。","type":"string"},"code":{"description":"状态码,针对http的调用有效。","format":"int32","type":"integer"},"domain_id":{"description":"租户id。","format":"int32","type":"integer"},"env_id":{"description":"环境Iid。","format":"int64","type":"integer"},"error_reasons":{"description":"报错原因。","type":"string"},"global_path":{"description":"虚拟traceId经过的path路径。","type":"string"},"global_trace_id":{"description":"vTraceId,虚拟traceI。","type":"string"},"has_error":{"description":"是否报错。","type":"boolean"},"http_method":{"description":"这里的method实际上是tags里面的http_method,只有url监控项才有。","type":"string"},"instance_id":{"description":"实例id。","format":"int64","type":"integer"},"is_async":{"description":"是否异步。","type":"boolean"},"real_source":{"description":"根event 的时候存在,实际调用的url。","type":"string"},"source":{"description":"只有是根event也就是span的时候有值。","type":"string"},"span_id":{"description":"span id。","type":"string"},"start_time":{"description":"开始时间。","format":"int64","type":"integer"},"tags":{"additionalProperties":{"type":"string"},"description":"包含用户自定义参数,header或body体里的内容,httpMethod, bizCode,以及后续可能新增参数。","type":"object"},"time_used":{"description":"耗时。","format":"int64","type":"integer"},"trace_id":{"description":"traceId。","type":"string"},"type":{"description":"类型,mysql,kafka等。","type":"string"}},"type":"object"},"OrderParam":{"properties":{"field":{"description":"timeUsed:响应时间,startTime:产生时间。","type":"string"},"order":{"description":"ASC:正序,DESC:逆序。","enum":["ASC","DESC"],"example":"","type":"string"}},"type":"object"},"TraceSearchParam":{"description":"查询span数据请求参数模型。","properties":{"app_id":{"description":"组件id。","format":"int64","type":"integer"},"biz_code":{"description":"业务状态码的采集。","type":"string"},"biz_id":{"description":"应用id。","format":"int64","type":"integer"},"class_name":{"description":"类名。","type":"string"},"code":{"description":"状态码,针对http的调用有效。","format":"int32","type":"integer"},"codes":{"description":"字符串格式的的状态码,用于支持多个状态码查询。","items":{"format":"int32","type":"integer"},"type":"array"},"contain_tags_content":{"description":"搜索结果是否包含tags内容详情。","type":"boolean"},"domain_id":{"description":"租户id。","format":"int32","type":"integer"},"end_time_string":{"description":"结束时间。","type":"string"},"env_id":{"description":"环境id。","format":"int64","type":"integer"},"error_reasons":{"description":"错误类型。","type":"string"},"global_path":{"description":"虚拟traceId经过的path路径。","type":"string"},"global_trace_id":{"description":"vTraceId,虚拟traceId,一个vTraceId对应多个实际的traceId, vTraceId会从开始一直往下应用传输。","type":"string"},"has_error":{"description":"是否有错误。","type":"boolean"},"http_method":{"description":"这里的method实际上是tags里面的http_method,只有url监控项才有。","type":"string"},"instance_id":{"description":"实例id。","format":"int64","type":"integer"},"is_async":{"description":"是否异步的event。","type":"boolean"},"order_param":{"$ref":"#/definitions/OrderParam","description":"排序参数。"},"page":{"description":"查询第几页的数据,默认查询第一页。","format":"int32","type":"integer"},"page_size":{"description":"每一页返回的行数。","format":"int32","type":"integer"},"parameters":{"description":"参数。","type":"string"},"real_source":{"description":"根event 的时候存在,实际调用的url。","type":"string"},"real_source_full_match":{"description":"是否为精确搜索。","type":"boolean"},"region":{"description":"region名称。","type":"string"},"source":{"description":"只有是根event也就是span的时候有值。","type":"string"},"source_full_match":{"description":"全匹配搜索。","type":"boolean"},"span_id":{"description":"代表一次rpc的调用的id,对于root的调用,值为字符串1,对于当前span调用的下一个spanId编号为1-1,1-2等格式,以此往后类推。","type":"string"},"start_time":{"description":"开始时间。","format":"int64","type":"integer"},"start_time_string":{"description":"开始时间。","type":"string"},"tags":{"additionalProperties":{"type":"string"},"description":"包含用户自定义参数,header或body体里的内容,httpMethod, bizCode,以及后续可能新增参数。","type":"object"},"tags_content":{"description":"header或body体,或自定义参数,或其他tags里字段的关键词搜索。","type":"string"},"time_used":{"description":"耗时。","format":"int64","type":"integer"},"time_used_max":{"description":"最大耗时。","type":"string"},"time_used_min":{"description":"最小耗时。","format":"int64","type":"integer"},"trace_id":{"description":"在root的span调用产生的全局id,以此往后透传。","type":"string"},"type":{"description":"类型。","type":"string"}},"required":["region","biz_id"],"type":"object"},"TraceSearchResponse":{"description":"调用链搜索核心层返回参数。","properties":{"span_info_list":{"description":"span信息。","items":{"$ref":"#/definitions/ClientSpanInfo"},"type":"array"},"total":{"description":"返回的总数。","format":"int32","type":"integer"}},"type":"object"}},"description":null,"group_id":"948fcecbff6f450fbe29bcc3e90c3eca","host":"apm2.cn-north-4.myhuaweicloud.com","id":"914f43c128a84c9e86239418da1ab74a","info_version":"v1","method":"post","name":"ShowSpanSearch","parameters":{},"paths":{"/v1/apm2/openapi/view/trace/span-search":{"post":{"description":"span数据查询接口。","operationId":"ShowSpanSearch","parameters":[{"description":"查询span数据请求参数模型。","in":"body","name":"traceSearchParam","required":true,"schema":{"$ref":"#/definitions/TraceSearchParam"}},{"description":"应用id。","format":"int64","in":"header","name":"x-business-id","required":true,"type":"integer"},{"description":"从IAM服务获取的用户Token。","in":"header","name":"X-Auth-Token","required":true,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK,请求响应成功。","examples":{"application/json":{"span_info_list":[{"app_id":11,"app_name":"apm-pu-task","async":false,"biz_code":null,"biz_id":162,"class_name":"org/apache/catalina/core/StandardHostValve","code":200,"domain_id":1,"env_id":11,"env_name":"suzhou-roma-2","error_reasons":null,"estimated_end_time":null,"estimated_start_time":null,"global_path":null,"global_trace_id":"16-1666684411910-1326","has_error":false,"http_method":"GET","instance_id":16,"instance_name":"apm2-apm-pu-task-6b5bbfc84d-gtrrs(172.16.3.7)","is_async":false,"real_source":"/apm2/health/v1/health-check","region":"suzhou-roma-2","source":"/apm2/health/v1/health-check","span_id":"1","start_time":1666684411910,"tags":{},"time_used":1,"trace_id":"16-1666684411910-1326","type":"Tomcat"},{"app_id":11,"app_name":"apm-pu-task","async":false,"biz_code":null,"biz_id":162,"class_name":"org/apache/catalina/core/StandardHostValve","code":200,"domain_id":1,"env_id":11,"env_name":"suzhou-roma-2","error_reasons":null,"estimated_end_time":null,"estimated_start_time":null,"global_path":null,"global_trace_id":"15-1666684400114-1332","has_error":false,"http_method":"GET","instance_id":15,"instance_name":"apm2-apm-pu-task-6b5bbfc84d-rxlhr(172.16.3.39)","is_async":false,"real_source":"/apm2/health/v1/health-check","region":"suzhou-roma-2","source":"/apm2/health/v1/health-check","span_id":"1","start_time":1666684400114,"tags":{},"time_used":0,"trace_id":"15-1666684400114-1332","type":"Tomcat"}],"total":2}},"schema":{"$ref":"#/definitions/TraceSearchResponse"}},"401":{"description":"Unauthorized,没有权限。","schema":{"type":"string"}},"403":{"description":"Forbidden,禁止访问。","schema":{"type":"string"}},"404":{"description":"Not Found,没有找到要请求的资源。","schema":{"type":"string"}}},"summary":"查询span数据","tags":["VIEW"],"x-hybridcloud":true,"x-is-registered":"Y","x-request-examples-1":{"biz_id":162,"codes":[],"end_time_string":"2022-10-25 10:23:16","page":1,"page_size":15,"region":"suzhou-roma-2","start_time_string":"2022-10-25 10:03:16"},"x-request-examples-description-1":"入参为region 、应用id、分页信息、起止时间和状态码集合,为空时查询全部。","x-request-examples-text-1":{"biz_id":162,"codes":[],"end_time_string":"2022-10-25 10:23:16","page":1,"page_size":15,"region":"suzhou-roma-2","start_time_string":"2022-10-25 10:03:16"},"x-request-examples-url-1":"/v1/apm2/openapi/view/trace/span-search","x-support-sdk":"Y"}}},"product_short":"APM","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":{"apig-auth-app":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-type":"AppSigv1"},"apig-auth-app-optional":{"in":"header","name":"Authorization","type":"apiKey","x-apigateway-auth-opt":{"access-auth-type":"optional"},"x-apigateway-auth-type":"AppSigv1"},"apig-auth-iam":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM"},"apig-auth-iam-none":{"in":"header","name":"unused","type":"apiKey","x-apigateway-auth-type":"IAM_NONE"}},"summary":"查询span数据","tags":"VIEW","uri":null,"version":"2.0"}