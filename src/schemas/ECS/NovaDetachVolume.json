{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{},"description":null,"group_id":"395cf9dd07ff44ddb50f92797b2a85de","host":"ecs.cn-north-4.myhuaweicloud.com","id":"664bfff93eaf4fc4a32de874cc2e52b4","info_version":"v2","method":"delete","name":"NovaDetachVolume","parameters":{"X-Auth-Token":{"description":"用户Token。\n\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXXX..."},"project_id":{"description":"项目ID。","in":"path","name":"project_id","required":true,"type":"string","x-example":"2b31ed520xxxxxxebedb6e57xxxxxxxx"},"server_id":{"description":"云服务器ID。","in":"path","name":"server_id","required":true,"type":"string","x-example":"e6b99563-xxxx-xxxx-xxxx-1820d4fd2a67"}},"paths":{"/v2.1/{project_id}/servers/{server_id}/os-volume_attachments/{volume_id}":{"delete":{"consumes":[],"deprecated":false,"description":"弹性云服务器卸载磁盘。","operationId":"NovaDetachVolume","parameters":[{"$ref":"#/parameters/project_id"},{"$ref":"#/parameters/server_id"},{"description":"磁盘ID。","in":"path","name":"volume_id","required":true,"type":"string","x-example":"a26887c6-c47b-4654-abb5-dfadf7d3f803","x-order":5},{"default":0,"description":"在线强制卸载磁盘标志位。\n\n默认为0,为1时代表强制卸载。","format":"int32","in":"query","name":"delete_flag","required":false,"type":"integer","x-example":0,"x-order":2},{"$ref":"#/parameters/X-Auth-Token"}],"produces":[],"responses":{"202":{"description":"Accepted"}},"summary":"卸载云服务器磁盘","tags":["磁盘管理"],"x-api_level":"1","x-apiexplorer-hide":"false","x-constraint":"弹性云服务器状态为stopped时支持系统盘(也就是/dev/sda挂载点)和用户盘的卸载,没有操作系统限制,也不需要在弹性云服务器内部安装vmtools。\n\n弹性云服务器状态为active态时有如下约束限制:\n\n1. 仅支持对数据盘盘位(非/dev/sda挂载点)的卸载。\n2. 请确认弹性云服务器已安装vmtools并且正常启用,否则会导致卸载失败。\n3. 对于Linux弹性云服务器,由于操作系统限制,需要客户先登录弹性云服务器,执行umount命令,取消待卸载磁盘与文件系统之间的关联,并确保没有程序正在对该磁盘进行读写操作。否则,卸载磁盘将失败。\n4. 对于Windows弹性云服务器,在线卸载磁盘,请确保没有程序正在对该磁盘进行读写操作。否则,将造成数据丢失。\n5. 支持在线卸载云硬盘的操作系统包括如下两个部分:\n6. 在线强制卸载磁盘功能当前仅支持KVM弹性云服务器的VBD磁盘使用。\n \n    对于XEN虚拟化类型的弹性云服务器、裸金属服务器、以及KVM弹性云服务器的其他磁盘类型,调用该接口时,仅支持在线卸载功能。\t \n\n\t- 第一部分请参见外部镜像文件的镜像格式和操作系统类型。\n\t- 第二部分如表1所示。\n\n\t  \t表1 支持在线卸载云硬盘的操作系统\n\n| 操作系统 | 版本 |\n| ------- | ------- |\n| CentOS  | 7.3 64bit     |\n| CentOS  | 7.2 64bit     |\n| CentOS  | 6.8 64bit     |\n| CentOS  | 6.7 64bit     |\n| Debian  | 8.6.0 64bit     |\n| Debian  | 8.5.0 64bit     |\n| Fedora  | 25 64bit     |\n| Fedora  | 24 64bit     |\n| SUSE  | SUSE Linux Enterprise Server 12 SP2 64bit     |\n| SUSE  | SUSE Linux Enterprise Server 12 SP1 64bit     |\n| SUSE  | SUSE Linux Enterprise Server 11 SP4 64bit     |\n| SUSE  | SUSE Linux Enterprise Server 12 64bit     |\n| OpenSUSE  | 42.2 64bit     |\n| OpenSUSE  | 42.1 64bit     |\n| Oracle Linux Server release  | 7.3 64bit     |\n| Oracle Linux Server release  | 7.2 64bit     |\n| Oracle Linux Server release  | 6.8 64bit     |\n| Oracle Linux Server release  | 6.7 64bit     |\n| Ubuntu Server  | 16.04 64bit     |\n| Ubuntu Server  | 14.04 64bit     |\n| Ubuntu Server  | 14.04.4 64bit     |\n| Windows(不支持在线卸载SCSI类型的云硬盘)  | Windows Server 2008 R2 Enterprise 64bit     |\n| Windows(不支持在线卸载SCSI类型的云硬盘)  | Windows Server 2008 R2 Enterprise 64bit     |\n| Windows(不支持在线卸载SCSI类型的云硬盘)  | Windows Server 2016 R2 Standard 64bit|\n| Redhat Linux Enterprise  | \t7.3 64bit     |\n| Redhat Linux Enterprise  | 6.8 64bit    |\n\n7. 在线强制卸载的磁盘会占用盘符和pci地址,因此,该盘符和pci地址不能被再次分配。\n8. 磁盘强制卸载后,仍会占用该弹性云服务器磁盘的配额。\n9. 系统盘不支持在线强制卸载功能。\n10. 磁盘在挂载有文件系统的情况下被强制卸载,需要用户手动卸载所挂载的文件系统目录。\n11. 被强制卸载的磁盘如果创建了逻辑分区,该逻辑分区将不可用。\n12. 磁盘强制卸载后,弹性云服务器内部会有残留,建议重启。","x-first-open-time":"2018-3-30","x-hybridcloud":"true","x-is-registered":"Y","x-name":"卸载云服务器磁盘","x-obc":"Y","x-open-region-cloud":"hc,hk,otc,tlf,ctc","x-order":48,"x-publishpath":"","x-registered_to":"nova","x-request-examples-1":"DELETE https://{endpoint}/v2.1/6fbe9263116a4b68818cf1edce16bc4f/servers/ab258e25-e351-47c7-b6e3-0749c5d9ed6a/os-volume_attachments/54667652-3029-4af8-9222-2d53066fd61c","x-request-examples-description-1":"","x-request-examples-text-1":"DELETE https://{endpoint}/v2.1/6fbe9263116a4b68818cf1edce16bc4f/servers/ab258e25-e351-47c7-b6e3-0749c5d9ed6a/os-volume_attachments/54667652-3029-4af8-9222-2d53066fd61c","x-request-examples-url-1":"","x-scope":"Commercial","x-source":"Native","x-support-sdk":"N","x-version":"v2.1"}}},"product_short":"ECS","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"卸载云服务器磁盘","tags":"磁盘管理","uri":null,"version":"2.0"}