{"base_path":"/","components":null,"consumes":"[\"application/json;charset=UTF-8\"]","definitions":{"CheckpointCreate":{"properties":{"created_at":{"description":"创建时间,例如:\"2020-02-05T10:38:34.209782\"","type":"string","x-huawei-extraAnnotation":""},"extra_info":{"$ref":"#/definitions/CheckpointExtraInfoResp","description":"","x-huawei-extraAnnotation":""},"id":{"description":"还原点ID","type":"string"},"project_id":{"description":"项目ID","type":"string"},"status":{"description":"状态:available,deleting,protecting,deleted,error-deleting,error","enum":["available","deleting","protecting","deleted","error-deleting","error"],"type":"string","x-huawei-extraAnnotation":""},"vault":{"$ref":"#/definitions/CheckpointPlanCreate","description":"存储库信息"}},"required":["created_at","id","project_id","status"]},"CheckpointCreateSkippedResource":{"description":"备份时跳过的资源","properties":{"code":{"description":"请参见[错误码](ErrorCode.xml)。","type":"string","x-huawei-extraAnnotation":""},"id":{"description":"资源ID","type":"string"},"name":{"description":"资源名称","type":"string"},"reason":{"description":"跳过原因,例如:该资源正在备份中。","type":"string","x-huawei-extraAnnotation":""},"type":{"description":"资源类型","type":"string"}}},"CheckpointExtraInfoResp":{"properties":{"description":{"description":"备份描述","type":"string"},"name":{"description":"备份名称","type":"string"},"retention_duration":{"description":"备份保留天数","format":"int32","type":"integer"}}},"CheckpointParam":{"properties":{"auto_trigger":{"default":false,"description":"是否自动触发,true:自动触发,false:非自动触发。","type":"boolean","x-huawei-extraAnnotation":""},"description":{"description":"备份描述","maxLength":255,"minLength":0,"pattern":"^[^<>]*$","type":"string"},"incremental":{"default":true,"description":"是否增量备份,true:增量备份,false:非增量备份。","type":"boolean","x-huawei-extraAnnotation":""},"name":{"description":"备份名称","maxLength":64,"minLength":1,"pattern":"^[\\u4E00-\\u9FA5\\uf900-\\ufa2da-zA-Z0-9_\\-]*$","type":"string"},"resource_details":{"description":"资源详情","items":{"$ref":"#/definitions/Resource","description":""},"maxItems":256,"minItems":0,"type":"array","x-huawei-extraAnnotation":""},"resources":{"description":"待备份的资源id列表:uuid","items":{"type":"string"},"type":"array"}}},"CheckpointPlanCreate":{"properties":{"id":{"description":"存储库id","type":"string"},"name":{"description":"存储库名称","type":"string"},"resources":{"description":"备份对象","items":{"$ref":"#/definitions/CheckpointResourceResp","description":""},"type":"array"},"skipped_resources":{"description":"备份时跳过的资源列表","items":{"$ref":"#/definitions/CheckpointCreateSkippedResource"},"type":"array"}},"required":["id","name"]},"CheckpointResourceResp":{"properties":{"backup_count":{"description":"副本数量","type":"string","x-huawei-extraAnnotation":""},"backup_size":{"description":"副本大小","type":"string","x-huawei-extraAnnotation":""},"extra_info":{"description":"资源附加信息","type":"string"},"id":{"description":"待备份资源id","type":"string"},"name":{"description":"待备份资源名称","type":"string"},"protect_status":{"description":"保护状态。available(可用),error(错误),protecting(备份中),restoring(恢复中),removing(删除中)。","enum":["available","error","protecting","restoring","removing"],"type":"string","x-huawei-extraAnnotation":""},"resource_size":{"description":"资源已分配容量,单位为GB","type":"string","x-huawei-extraAnnotation":""},"type":{"description":"待备份资源的类型: OS::Nova::Server, OS::Cinder::Volume, OS::Ironic::BareMetalServer, OS::Native::Server, OS::Sfs::Turbo, OS::Workspace::DesktopV2","type":"string"}},"required":["id","name","type"]},"CheckpointResp":{"description":"还原点响应","properties":{"checkpoint":{"$ref":"#/definitions/CheckpointCreate","description":"还原点信息"}},"required":["checkpoint"]},"Resource":{"properties":{"extra_info":{"$ref":"#/definitions/ResourceExtraInfo","description":"资源附加信息","x-open-region-cloud":"hc,hk"},"id":{"description":"待备份资源id","type":"string"},"name":{"description":"待备份资源名称,长度限制:0-255","maxLength":255,"minLength":0,"type":"string","x-huawei-extraAnnotation":""},"type":{"description":"待备份资源的类型, 云服务器: OS::Nova::Server, 云硬盘: OS::Cinder::Volume, 裸金属服务器: OS::Ironic::BareMetalServer, 线下本地服务器: OS::Native::Server, 弹性文件系统: OS::Sfs::Turbo, 云桌面:OS::Workspace::DesktopV2","type":"string","x-huawei-extraAnnotation":""}},"required":["id","type"]},"ResourceExtraInfo":{"properties":{"exclude_volumes":{"description":"需要排除备份的卷id。仅在多系统盘备份特性中有效,排除不需要备份的磁盘。当虚拟机新绑定磁盘时,也能继续排除之前设置不用备份的卷。","items":{"description":"","type":"string"},"type":"array","x-open-region-cloud":"hc,hk,otc,ocb,hcso,sbc,g42,hcso_dt"}}},"ResourceExtraInfoIncludeVolumes":{"description":"","properties":{"id":{"description":"卷ID,仅支持uuid","type":"string","x-open-region-cloud":"hc,hk"},"os_version":{"description":"操作系统类型","type":"string","x-open-region-cloud":"hc,hk"}},"required":["id"]},"VaultBackup":{"properties":{"parameters":{"$ref":"#/definitions/CheckpointParam","description":"参数"},"vault_id":{"description":"存储库ID","type":"string"}},"required":["vault_id"]},"VaultBackupReq":{"properties":{"checkpoint":{"$ref":"#/definitions/VaultBackup","description":"存储库执行备份参数"}},"required":["checkpoint"]}},"description":null,"group_id":"11b1e4b30d524dacb6891902e04115dd","host":"cbr.cn-north-4.myhuaweicloud.com","id":"73e322ade4ff4ce0b8cef61c2280c81c","info_version":"v1","method":"post","name":"CreateCheckpoint","parameters":{},"paths":{"/v3/{project_id}/checkpoints":{"post":{"consumes":[],"deprecated":false,"description":"对存储库执行备份,生成备份还原点","operationId":"CreateCheckpoint","parameters":[{"description":"项目ID","in":"path","name":"project_id","required":true,"type":"string","x-order":1},{"description":"vault维度执行备份","in":"body","name":"CreateCheckpointRequestBody","required":true,"schema":{"$ref":"#/definitions/VaultBackupReq"},"x-order":2},{"description":"用户Token。\n通过调用IAM服务获取用户Token接口获取(响应消息头中X-Subject-Token的值)。","in":"header","name":"X-Auth-Token","required":true,"type":"string","x-example":"MIIDkgYJKoZIhvcNAQcCoIIDgzCCXXXXX...","x-order":3}],"produces":[],"responses":{"200":{"description":"执行备份返回的checkpoint信息","examples":{"application/json":{"checkpoint":{"created_at":"2019-05-10T07:59:12.733403","extra_info":{"description":"backup_description","name":"backup_name","retention_duration":-1},"id":"8b0851a8-adf3-4f4c-a914-dead08bf9664","project_id":"4229d7a45436489f8c3dc2b1d35d4987","status":"protecting","vault":{"id":"3b5816b5-f29c-4172-9d9a-76c719a659ce","name":"vault-be94","resources":[{"extra_info":null,"id":"94eba8b2-acc9-4d82-badc-127144cc5526","name":"ecs-1f0f-0002","protect_status":"available","resource_size":"40","type":"OS::Nova::Server"}],"skipped_resources":[]}}}},"schema":{"$ref":"#/definitions/CheckpointResp"}}},"summary":"创建备份还原点","tags":["还原点"],"x-apiErrorCodes":[{"errorCode":"6113","errorDescription":"该存储库状态不支持备份","httpStatus":"100","parentId":"ibca62aa132c41b7b0a79cd2b97fea38","solution":""},{"errorCode":"1001","errorDescription":"保管库正在执行备份","httpStatus":"400","parentId":"ibca62aa132c41b7b0a79cd2b97fea38","solution":""},{"errorCode":"6114","errorDescription":"存储库使用容量超出总容量","httpStatus":"400","parentId":"ibca62aa132c41b7b0a79cd2b97fea38","solution":""},{"errorCode":"9900","errorDescription":"参数检查失败","httpStatus":"400","parentId":"ibca62aa132c41b7b0a79cd2b97fea38","solution":""},{"errorCode":"BackupService.2010","errorDescription":"资源正在恢复中。","errorDescriptionEn":"Resource %(resource_id)s is restoring.","errorMessage":"资源正在恢复中。","httpStatus":"400","parentId":"ibca62aa132c41b7b0a79cd2b97fea38","solution":"请稍后再试。","solutionEn":"Please try again later."}],"x-apiexplorer-hide":"false","x-constraint":"","x-first-open-time":"","x-hybridcloud":"","x-is-registered":"Y","x-name":"创建备份还原点","x-open-region-cloud":"hc,hk,otc,obc,ctc,hcso,sbc,g42,tm,cmcc,hk-g42,hcso_dt","x-order":21,"x-publishpath":"","x-request-examples-1":{"checkpoint":{"parameters":{"auto_trigger":true,"description":"backup_description","incremental":true,"name":"backup_name","resources":["94eba8b2-acc9-4d82-badc-127144cc5526"]},"vault_id":"3b5816b5-f29c-4172-9d9a-76c719a659ce"}},"x-request-examples-description-1":"备份创建","x-request-examples-text-1":"{\n  \"checkpoint\": {\n    \"parameters\": {\n      \"auto_trigger\": true,\n      \"description\": \"backup_description\",\n      \"incremental\": true,\n      \"name\": \"backup_name\",\n      \"resources\": [\n        \"94eba8b2-acc9-4d82-badc-127144cc5526\"\n      ]\n    },\n    \"vault_id\": \"3b5816b5-f29c-4172-9d9a-76c719a659ce\"\n  }\n}","x-request-examples-url-1":"POST https://{endpoint}/v3/f841e01fd2b14e7fa41b6ae7aa6b0594/checkpoints","x-scope":"Commercial","x-source":"SelfDeveloped","x-support-sdk":"Y"}}},"product_short":"CBR","region_id":"cn-north-4","schemes":["HTTPS"],"security_definitions":null,"summary":"创建备份还原点","tags":"还原点","uri":null,"version":"2.0"}